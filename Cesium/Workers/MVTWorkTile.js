/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.98
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */

define(["./createTaskProcessorWorker","./when-b60132fc","./pbf-2b242707","./earcut-2.2.1-20c8012f"],function(ca,ne,jn,fa){"use strict";function Rr(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}Rr.prototype.encode=function(e){return this._stringToNumber[e]},Rr.prototype.decode=function(e){return this._numberToString[e]};var ha={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};function ve(e,t){t===void 0&&(t=1);var r=0,n=0;return{members:e.map(function(i){var a=da(i.type),o=r=Hn(r,Math.max(t,a)),s=i.components||1;return n=Math.max(n,a),r+=a*s,{name:i.name,type:i.type,components:s,offset:o}}),size:Hn(r,Math.max(n,t)),alignment:t}}function da(e){return ha[e].BYTES_PER_ELEMENT}function Hn(e,t){return Math.ceil(e/t)*t}var Yt=1,$r=function(e,t){var r=t.pixelRatio,n=t.version,i=t.stretchX,a=t.stretchY,o=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=i,this.stretchY=a,this.content=o,this.version=n},ar={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};ar.tl.get=function(){return[this.paddedRect.x+Yt,this.paddedRect.y+Yt]},ar.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-Yt,this.paddedRect.y+this.paddedRect.h-Yt]},ar.tlbr.get=function(){return this.tl.concat(this.br)},ar.displaySize.get=function(){return[(this.paddedRect.w-2*Yt)/this.pixelRatio,(this.paddedRect.h-2*Yt)/this.pixelRatio]},Object.defineProperties($r.prototype,ar);var Ae=function(e,t){Yn(this,e,4,t)};function Yn(e,t,r,n){var i=t.width,a=t.height;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==i*a*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(i*a*r);return e.width=i,e.height=a,e.data=n,e}function ya(e,t,r){var n=t.width,i=t.height;if(n!==e.width||i!==e.height){var a=Yn({},{width:n,height:i},r);Qn(e,a,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,i)},r),e.width=n,e.height=i,e.data=a.data}}function Qn(e,t,r,n,i,a){if(i.width===0||i.height===0)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var o=e.data,s=t.data,u=0;u<i.height;u++)for(var p=((r.y+u)*e.width+r.x)*a,c=((n.y+u)*t.width+n.x)*a,f=0;f<i.width*a;f++)s[c+f]=o[p+f];return t}function ma(e){for(var t=0,r=0,n=0,i=e;n<i.length;n+=1){var a=i[n];t+=a.w*a.h,r=Math.max(r,a.w)}e.sort(function(g,x){return x.h-g.h});for(var o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],s=0,u=0,p=0,c=e;p<c.length;p+=1)for(var f=c[p],h=o.length-1;h>=0;h--){var d=o[h];if(!(f.w>d.w||f.h>d.h)){if(f.x=d.x,f.y=d.y,u=Math.max(u,f.y+f.h),s=Math.max(s,f.x+f.w),f.w===d.w&&f.h===d.h){var v=o.pop();h<o.length&&(o[h]=v)}else f.h===d.h?(d.x+=f.w,d.w-=f.w):f.w===d.w?(d.y+=f.h,d.h-=f.h):(o.push({x:d.x+f.w,y:d.y,w:d.w-f.w,h:f.h}),d.y+=f.h,d.h-=f.h);break}}return{w:s,h:u,fill:t/(s*u)||0}}Ae.prototype.resize=function(e){ya(this,e,4)},Ae.prototype.replace=function(e,t){t?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e},Ae.prototype.clone=function(){return new Ae({width:this.width,height:this.height},new Uint8Array(this.data))},Ae.copy=function(e,t,r,n,i){Qn(e,t,r,n,i,4)};var Qt=1,or=function(e,t){var r={},n={};this.haveRenderCallbacks=[];var i=[];this.addImages(e,r,i),this.addImages(t,n,i);var a=ma(i),o=a.w,s=a.h,u=new Ae({width:o||1,height:s||1});for(var p in e){var c=e[p],f=r[p].paddedRect;Ae.copy(c.data,u,{x:0,y:0},{x:f.x+Qt,y:f.y+Qt},c.data)}for(var h in t){var d=t[h],v=n[h].paddedRect,g=v.x+Qt,x=v.y+Qt,b=d.data.width,_=d.data.height;Ae.copy(d.data,u,{x:0,y:0},{x:g,y:x},d.data),Ae.copy(d.data,u,{x:0,y:_-1},{x:g,y:x-1},{width:b,height:1}),Ae.copy(d.data,u,{x:0,y:0},{x:g,y:x+_},{width:b,height:1}),Ae.copy(d.data,u,{x:b-1,y:0},{x:g-1,y:x},{width:1,height:_}),Ae.copy(d.data,u,{x:0,y:0},{x:g+b,y:x},{width:1,height:_})}this.image=u,this.iconPositions=r,this.patternPositions=n};or.prototype.addImages=function(e,t,r){for(var n in e){var i=e[n],a={x:0,y:0,w:i.data.width+2*Qt,h:i.data.height+2*Qt};r.push(a),t[n]=new $r(a,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n)}},or.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},or.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var n=e.tl,i=n[0],a=n[1];r.update(t.data,void 0,{x:i,y:a})}};var Wn={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function sr(e){return(e=Math.round(e))<0?0:e>255?255:e}function Kn(e){return e<0?0:e>1?1:e}function Nr(e){return e[e.length-1]==="%"?sr(parseFloat(e)/100*255):sr(parseInt(e))}function Pr(e){return e[e.length-1]==="%"?Kn(parseFloat(e)/100):Kn(parseFloat(e))}function en(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}function va(e){var t,r=e.replace(/ /g,"").toLowerCase();if(r in Wn)return Wn[r].slice();if(r[0]==="#")return r.length===4?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:r.length===7&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var n=r.indexOf("("),i=r.indexOf(")");if(n!==-1&&i+1===r.length){var a=r.substr(0,n),o=r.substr(n+1,i-(n+1)).split(","),s=1;switch(a){case"rgba":if(o.length!==4)return null;s=Pr(o.pop());case"rgb":return o.length!==3?null:[Nr(o[0]),Nr(o[1]),Nr(o[2]),s];case"hsla":if(o.length!==4)return null;s=Pr(o.pop());case"hsl":if(o.length!==3)return null;var u=(parseFloat(o[0])%360+360)%360/360,p=Pr(o[1]),c=Pr(o[2]),f=c<=.5?c*(p+1):c+p-c*p,h=2*c-f;return[sr(255*en(h,f,u+1/3)),sr(255*en(h,f,u)),sr(255*en(h,f,u-1/3)),s];default:return null}}return null}var N=function(e,t,r,n){n===void 0&&(n=1),this.r=e,this.g=t,this.b=r,this.a=n};N.parse=function(e){if(e){if(e instanceof N)return e;if(typeof e=="string"){var t=va(e);if(t)return new N(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},N.prototype.toString=function(){var e=this.toArray(),t=e[0],r=e[1],n=e[2],i=e[3];return"rgba("+Math.round(t)+","+Math.round(r)+","+Math.round(n)+","+i+")"},N.prototype.toArray=function(){var e=this,t=e.r,r=e.g,n=e.b,i=e.a;return i===0?[0,0,0,0]:[255*t/i,255*r/i,255*n/i,i]},N.black=new N(0,0,0,1),N.white=new N(1,1,1,1),N.transparent=new N(0,0,0,0),N.red=new N(1,0,0,1);var ga={kind:"null"},xa={kind:"number"},ba={kind:"string"},_a={kind:"boolean"},wa={kind:"color"},Ea={kind:"object"},Ta={kind:"value"},Aa={kind:"formatted"},Ia={kind:"resolvedImage"};function Sa(e,t){return{kind:"array",itemType:e,N:t}}function tn(e){if(e.kind==="array"){var t=tn(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var ka=[ga,xa,ba,_a,wa,Aa,Ea,Sa(Ta),Ia];function ur(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ur(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,n=ka;r<n.length;r+=1)if(!ur(n[r],t))return null}}return"Expected "+tn(e)+" but found "+tn(t)+" instead."}var lr=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};lr.prototype.compare=function(e,t){return this.collator.compare(e,t)},lr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Fr=function(e,t,r,n,i){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i},ue=function(e){this.sections=e};ue.fromString=function(e){return new ue([new Fr(e,null,null,null,null)])},ue.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},ue.factory=function(e){return e instanceof ue?e:ue.fromString(e)},ue.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},ue.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var n=r[t];if(n.image)e.push(["image",n.image.name]);else{e.push(n.text);var i={};n.fontStack&&(i["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(i["font-scale"]=n.scale),n.textColor&&(i["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(i)}}return e};var Ie=function(e){this.name=e.name,this.available=e.available};Ie.prototype.toString=function(){return this.name},Ie.fromString=function(e){return new Ie({name:e,available:!1})},Ie.prototype.serialize=function(){return["image",this.name]};var Ma={kind:"null"},Oa={kind:"number"},za={kind:"string"},Ra={kind:"boolean"},Pa={kind:"color"},Fa={kind:"object"},Jn={kind:"value"},Ca={kind:"collator"},Da={kind:"formatted"},Ua={kind:"resolvedImage"};function Ba(e,t){return{kind:"array",itemType:e,N:t}}function J(){}J.validateRGBA=function(e,t,r,n){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?n===void 0||typeof n=="number"&&n>=0&&n<=1?null:"Invalid rgba value ["+[e,t,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof n=="number"?[e,t,r,n]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."},J.isValue=function(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof N||e instanceof lr||e instanceof ue||e instanceof Ie)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1){var n=r[t];if(!J.isValue(n))return!1}return!0}if(typeof e=="object"){for(var i in e)if(!J.isValue(e[i]))return!1;return!0}return!1},J.typeOf=function(e){if(e===null)return Ma;if(typeof e=="string")return za;if(typeof e=="boolean")return Ra;if(typeof e=="number")return Oa;if(e instanceof N)return Pa;if(e instanceof lr)return Ca;if(e instanceof ue)return Da;if(e instanceof Ie)return Ua;if(Array.isArray(e)){for(var t,r=e.length,n=0,i=e;n<i.length;n+=1){var a=i[n],o=J.typeOf(a);if(t){if(t===o)continue;t=Jn;break}t=o}return Ba(t||Jn,r)}return Fa},J.toString$1=function(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof N||e instanceof ue||e instanceof Ie?e.toString():JSON.stringify(e)};var Va={kind:"number"},La={kind:"string"},Xa={kind:"boolean"},qa={kind:"object"},Zn={kind:"value"};function ja(e,t){return{kind:"array",itemType:e,N:t}}var rn={string:La,number:Va,boolean:Xa,object:qa},ge=function(e,t){this.type=e,this.args=t};ge.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,n=1,i=e[0];if(i==="array"){var a,o;if(e.length>2){var s=e[1];if(typeof s!="string"||!(s in rn)||s==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);a=rn[s],n++}else a=Zn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],n++}r=ja(a,o)}else r=rn[i];for(var u=[];n<e.length;n++){var p=t.parse(e[n],n,Zn);if(!p)return null;u.push(p)}return new ge(r,u)},ge.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!ur(this.type,J.typeOf(r)))return r;if(t===this.args.length-1)throw new RuntimeError("Expected value to be of type "+toString(this.type)+", but found "+toString(J.typeOf(r))+" instead.")}return null},ge.prototype.eachChild=function(e){this.args.forEach(e)},ge.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.args.map(function(t){return t.possibleOutputs()}))},ge.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var n=e.N;(typeof n=="number"||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map(function(i){return i.serialize()}))};var Ha={kind:"number"},Ya={kind:"value"};function Qa(e,t){return{kind:"array",itemType:e,N:t}}var St=function(e,t,r){this.type=e,this.index=t,this.input=r};St.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Ha),n=t.parse(e[2],2,Qa(t.expectedType||Ya));if(!r||!n)return null;var i=n.type;return new St(i.itemType,r,n)},St.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new RuntimeError("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new RuntimeError("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new RuntimeError("Array index must be an integer, but found "+t+" instead.");return r[t]},St.prototype.eachChild=function(e){e(this.index),e(this.input)},St.prototype.possibleOutputs=function(){return[void 0]},St.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Wa={kind:"boolean"},kt=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};kt.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var n=[],i=1;i<e.length-1;i+=2){var a=t.parse(e[i],i,Wa);if(!a)return null;var o=t.parse(e[i+1],i+1,r);if(!o)return null;n.push([a,o]),r=r||o.type}var s=t.parse(e[e.length-1],e.length-1,r);return s?new kt(r,n,s):null},kt.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],i=n[0],a=n[1];if(i.evaluate(e))return a.evaluate(e)}return this.otherwise.evaluate(e)},kt.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],i=n[0],a=n[1];e(i),e(a)}e(this.otherwise)},kt.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.branches.map(function(t){return t[0],t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},kt.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ka={kind:"value"},ut=function(e,t){this.type=e,this.args=t};ut.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,n=t.expectedType;n&&n.kind!=="value"&&(r=n);for(var i=[],a=0,o=e.slice(1);a<o.length;a+=1){var s=o[a],u=t.parse(s,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!u)return null;r=r||u.type,i.push(u)}var p=n&&i.some(function(c){return ur(n,c.type)});return new ut(p?Ka:r,i)},ut.prototype.evaluate=function(e){for(var t,r=null,n=0,i=0,a=this.args;i<a.length&&(n++,(r=a[i].evaluate(e))&&r instanceof Ie&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),r===null);i+=1);return r},ut.prototype.eachChild=function(e){this.args.forEach(e)},ut.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.args.map(function(t){return t.possibleOutputs()}))},ut.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ja={kind:"number"},Za={kind:"string"},Ga={kind:"boolean"},$a={kind:"color"},Na={kind:"value"},eo={"to-boolean":Ga,"to-color":$a,"to-number":Ja,"to-string":Za},Le=function(e,t){this.type=e,this.args=t};Le.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var n=eo[r],i=[],a=1;a<e.length;a++){var o=t.parse(e[a],a,Na);if(!o)return null;i.push(o)}return new Le(n,i)},Le.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,n=0,i=this.args;n<i.length;n+=1){if(r=null,(t=i[n].evaluate(e))instanceof Color)return t;if(typeof t=="string"){var a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":validateRGBA(t[0],t[1],t[2],t[3])))return new Color(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new RuntimeError(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var o=null,s=0,u=this.args;s<u.length;s+=1){if((o=u[s].evaluate(e))===null)return 0;var p=Number(o);if(!isNaN(p))return p}throw new RuntimeError("Could not convert "+JSON.stringify(o)+" to number.")}return this.type.kind==="formatted"?Formatted.fromString(J.toString$1(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ie.fromString(J.toString$1(this.args[0].evaluate(e))):J.toString$1(this.args[0].evaluate(e))},Le.prototype.eachChild=function(e){this.args.forEach(e)},Le.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.args.map(function(t){return t.possibleOutputs()}))},Le.prototype.serialize=function(){if(this.type.kind==="formatted")return new FormatExpression([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ImageExpression(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var to={kind:"string"},Gn={kind:"boolean"},ro={kind:"collator"},Mt=function(e,t,r){this.type=ro,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};Mt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var n=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,Gn);if(!n)return null;var i=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,Gn);if(!i)return null;var a=null;return r.locale&&!(a=t.parse(r.locale,1,to))?null:new Mt(n,i,a)},Mt.prototype.evaluate=function(e){return new lr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Mt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Mt.prototype.possibleOutputs=function(){return[void 0]},Mt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var no={kind:"boolean"},$n={kind:"value"},io={kind:"collator"};function Nn(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function ao(e,t,r){return t===r}function oo(e,t,r){return t!==r}function so(e,t,r){return t<r}function uo(e,t,r){return t>r}function lo(e,t,r){return t<=r}function po(e,t,r){return t>=r}function ei(e,t,r,n){return n.compare(t,r)===0}function co(e,t,r,n){return!ei(0,t,r,n)}function fo(e,t,r,n){return n.compare(t,r)<0}function ho(e,t,r,n){return n.compare(t,r)>0}function yo(e,t,r,n){return n.compare(t,r)<=0}function mo(e,t,r,n){return n.compare(t,r)>=0}function Wt(e,t,r){var n=e!=="=="&&e!=="!=";return function(){function i(a,o,s){this.type=no,this.lhs=a,this.rhs=o,this.collator=s,this.hasUntypedArgument=a.type.kind==="value"||o.type.kind==="value"}return i.parse=function(a,o){if(a.length!==3&&a.length!==4)return o.error("Expected two or three arguments.");var s=a[0],u=o.parse(a[1],1,$n);if(!u)return null;if(!Nn(s,u.type))return o.concat(1).error('"'+s+`" comparisons are not supported for type '`+toString(u.type)+"'.");var p=o.parse(a[2],2,$n);if(!p)return null;if(!Nn(s,p.type))return o.concat(2).error('"'+s+`" comparisons are not supported for type '`+toString(p.type)+"'.");if(u.type.kind!==p.type.kind&&u.type.kind!=="value"&&p.type.kind!=="value")return o.error("Cannot compare types '"+toString(u.type)+"' and '"+toString(p.type)+"'.");n&&(u.type.kind==="value"&&p.type.kind!=="value"?u=new ge(p.type,[u]):u.type.kind!=="value"&&p.type.kind==="value"&&(p=new ge(u.type,[p])));var c=null;if(a.length===4){if(u.type.kind!=="string"&&p.type.kind!=="string"&&u.type.kind!=="value"&&p.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(!(c=o.parse(a[3],3,io)))return null}return new i(u,p,c)},i.prototype.evaluate=function(a){var o=this.lhs.evaluate(a),s=this.rhs.evaluate(a);if(n&&this.hasUntypedArgument){var u=J.typeOf(o),p=J.typeOf(s);if(u.kind!==p.kind||u.kind!=="string"&&u.kind!=="number")throw new RuntimeError('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+u.kind+", "+p.kind+") instead.")}if(this.collator&&!n&&this.hasUntypedArgument){var c=J.typeOf(o),f=J.typeOf(s);if(c.kind!=="string"||f.kind!=="string")return t(a,o,s)}return this.collator?r(a,o,s,this.collator.evaluate(a)):t(a,o,s)},i.prototype.eachChild=function(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)},i.prototype.possibleOutputs=function(){return[!0,!1]},i.prototype.serialize=function(){var a=[e];return this.eachChild(function(o){a.push(o.serialize())}),a},i}()}var Fe={};Fe.Equals=Wt("==",ao,ei),Fe.NotEquals=Wt("!=",oo,co),Fe.LessThan=Wt("<",so,fo),Fe.GreaterThan=Wt(">",uo,ho),Fe.LessThanOrEqual=Wt("<=",lo,yo),Fe.GreaterThanOrEqual=Wt(">=",po,mo);var vo={kind:"number"},go={kind:"string"},xo={kind:"color"},bo={kind:"value"},_o={kind:"formatted"},wo={kind:"resolvedImage"};function Eo(e,t){return{kind:"array",itemType:e,N:t}}var lt=function(e){this.type=_o,this.sections=e};lt.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var n=[],i=!1,a=1;a<=e.length-1;++a){var o=e[a];if(i&&typeof o=="object"&&!Array.isArray(o)){i=!1;var s=null;if(o["font-scale"]&&!(s=t.parse(o["font-scale"],1,vo)))return null;var u=null;if(o["text-font"]&&!(u=t.parse(o["text-font"],1,Eo(go))))return null;var p=null;if(o["text-color"]&&!(p=t.parse(o["text-color"],1,xo)))return null;var c=n[n.length-1];c.scale=s,c.font=u,c.textColor=p}else{var f=t.parse(e[a],1,bo);if(!f)return null;var h=f.type.kind;if(h!=="string"&&h!=="value"&&h!=="null"&&h!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:f,scale:null,font:null,textColor:null})}}return new lt(n)},lt.prototype.evaluate=function(e){return new ue(this.sections.map(function(t){var r=t.content.evaluate(e);return J.typeOf(r)===wo?new Fr("",r,null,null,null):new Fr(J.toString$1(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},lt.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var n=r[t];e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}},lt.prototype.possibleOutputs=function(){return[void 0]},lt.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var n=r[t];e.push(n.content.serialize());var i={};n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),n.textColor&&(i["text-color"]=n.textColor.serialize()),e.push(i)}return e};var To={kind:"string"},Ao={kind:"resolvedImage"},Ot=function(e){this.type=Ao,this.input=e};Ot.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,To);return r?new Ot(r):t.error("No image name provided.")},Ot.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=!1;return e.availableImages&&e.availableImages.indexOf(t)>-1&&(r=!0),new Ie({name:t,available:r})},Ot.prototype.eachChild=function(e){e(this.input)},Ot.prototype.possibleOutputs=function(){return[void 0]},Ot.prototype.serialize=function(){return["image",this.input.serialize()]};var le=function(e,t,r,n,i){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(var a=0,o=i;a<o.length;a+=1){var s=o[a],u=s[0],p=s[1];this.labels.push(u),this.outputs.push(p)}},Io={kind:"number"},So={kind:"color"};function nn(e,t,r,n){var i=n-r,a=e-r;return i===0?0:t===1?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}le.interpolationFactor=function(e,t,r,n){var i=0;if(e.name==="exponential")i=nn(t,e.base,r,n);else if(e.name==="linear")i=nn(t,1,r,n);else if(e.name==="cubic-bezier"){var a=e.controlPoints;i=new unitbezier(a[0],a[1],a[2],a[3]).solve(nn(t,1,r,n))}return i},le.parse=function(e,t){var r=e[0],n=e[1],i=e[2],a=e.slice(3);if(!Array.isArray(n)||n.length===0)return t.error("Expected an interpolation type expression.",1);if(n[0]==="linear")n={name:"linear"};else if(n[0]==="exponential"){var o=n[1];if(typeof o!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:o}}else{if(n[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(n[0]),1,0);var s=n.slice(1);if(s.length!==4||s.some(function(x){return typeof x!="number"||x<0||x>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:s}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(i=t.parse(i,2,Io)))return null;var u=[],p=null;r==="interpolate-hcl"||r==="interpolate-lab"?p=So:t.expectedType&&t.expectedType.kind!=="value"&&(p=t.expectedType);for(var c=0;c<a.length;c+=2){var f=a[c],h=a[c+1],d=c+3,v=c+4;if(typeof f!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(u.length&&u[u.length-1][0]>=f)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var g=t.parse(h,v,p);if(!g)return null;p=p||g.type,u.push([f,g])}return p.kind==="number"||p.kind==="color"||p.kind==="array"&&p.itemType.kind==="number"&&typeof p.N=="number"?new le(p,r,n,i,u):t.error("Type "+toString(p)+" is not interpolatable.")},le.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);var a=findStopLessThanOrEqualTo(t,n),o=t[a],s=t[a+1],u=le.interpolationFactor(this.interpolation,n,o,s),p=r[a].evaluate(e),c=r[a+1].evaluate(e);return this.operator==="interpolate"?interpolate[this.type.kind.toLowerCase()](p,c,u):this.operator==="interpolate-hcl"?hcl.reverse(hcl.interpolate(hcl.forward(p),hcl.forward(c),u)):lab.reverse(lab.interpolate(lab.forward(p),lab.forward(c),u))},le.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},le.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.outputs.map(function(t){return t.possibleOutputs()}))},le.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var ko={kind:"boolean"},ti={kind:"value"};function Mo(e){return e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value"}function Oo(e){return typeof e=="boolean"||typeof e=="string"||typeof e=="number"}function zo(e){return Array.isArray(e)||typeof e=="string"}var zt=function(e,t){this.type=ko,this.needle=e,this.haystack=t};zt.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,ti),n=t.parse(e[2],2,ti);return r&&n?Mo(r.type)?new zt(r,n):t.error("Expected first argument to be of type boolean, string, number or null, but found "+toString(r.type)+" instead"):null},zt.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!t||!r)return!1;if(!Oo(t))throw new RuntimeError("Expected first argument to be of type boolean, string or number, but found "+toString(typeOf(t))+" instead.");if(!zo(r))throw new RuntimeError("Expected second argument to be of type array or string, but found "+toString(typeOf(r))+" instead.");return r.indexOf(t)>=0},zt.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},zt.prototype.possibleOutputs=function(){return[!0,!1]},zt.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var pt=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};pt.prototype.evaluate=function(e){return this.result.evaluate(e)},pt.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},pt.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],n=1;n<e.length-1;n+=2){var i=e[n];if(typeof i!="string")return t.error("Expected string, but found "+typeof i+" instead.",n);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);var a=t.parse(e[n+1],n+1);if(!a)return null;r.push([i,a])}var o=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return o?new pt(r,o):null},pt.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},pt.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var n=r[t],i=n[0],a=n[1];e.push(i,a.serialize())}return e.push(this.result.serialize()),e};var Ro={kind:"number"},Rt=function(e){this.type=Ro,this.input=e};Rt.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+toString(r.type)+" instead."):new Rt(r):null},Rt.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new RuntimeError("Expected value to be of type string or array, but found "+toString(typeOf(t))+" instead.")},Rt.prototype.eachChild=function(e){e(this.input)},Rt.prototype.possibleOutputs=function(){return[void 0]},Rt.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ne=function(e,t){this.type=e,this.value=t};Ne.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!J.isValue(e[1]))return t.error("invalid value");var r=e[1],n=J.typeOf(r),i=t.expectedType;return n.kind!=="array"||n.N!==0||!i||i.kind!=="array"||typeof i.N=="number"&&i.N!==0||(n=i),new Ne(n,r)},Ne.prototype.evaluate=function(){return this.value},Ne.prototype.eachChild=function(){},Ne.prototype.possibleOutputs=function(){return[this.value]},Ne.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Color?["rgba"].concat(this.value.toArray()):this.value instanceof ue?this.value.serialize():this.value};var Po={kind:"value"},Pt=function(e,t,r,n,i,a){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=a};Pt.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,n;t.expectedType&&t.expectedType.kind!=="value"&&(n=t.expectedType);for(var i={},a=[],o=2;o<e.length-1;o+=2){var s=e[o],u=e[o+1];Array.isArray(s)||(s=[s]);var p=t.concat(o);if(s.length===0)return p.error("Expected at least one branch label.");for(var c=0,f=s;c<f.length;c+=1){var h=f[c];if(typeof h!="number"&&typeof h!="string")return p.error("Branch labels must be numbers or strings.");if(typeof h=="number"&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return p.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof h=="number"&&Math.floor(h)!==h)return p.error("Numeric branch labels must be integer values.");if(r){if(p.checkSubtype(r,J.typeOf(h)))return null}else r=J.typeOf(h);if(i[String(h)]!==void 0)return p.error("Branch labels must be unique.");i[String(h)]=a.length}var d=t.parse(u,o,n);if(!d)return null;n=n||d.type,a.push(d)}var v=t.parse(e[1],1,Po);if(!v)return null;var g=t.parse(e[e.length-1],e.length-1,n);return g?v.type.kind!=="value"&&t.concat(1).checkSubtype(r,v.type)?null:new Pt(r,n,v,i,a,g):null},Pt.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(J.typeOf(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Pt.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Pt.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},Pt.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],n={},i=0,a=Object.keys(this.cases).sort();i<a.length;i+=1){var o=a[i];(f=n[this.cases[o]])===void 0?(n[this.cases[o]]=r.length,r.push([this.cases[o],[o]])):r[f][1].push(o)}for(var s=function(d){return e.inputType.kind==="number"?Number(d):d},u=0,p=r;u<p.length;u+=1){var c=p[u],f=c[0],h=c[1];h.length===1?t.push(s(h[0])):t.push(h.map(s)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var an={kind:"number"},on={kind:"string"},Ft=function(e,t,r,n,i){this.type=on,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i};function ri(e,t){for(var r,n,i=e.length-1,a=0,o=i,s=0;a<=o;)if(r=e[s=Math.floor((a+o)/2)],n=e[s+1],r<=t){if(s===i||t<n)return s;a=s+1}else{if(!(r>t))throw new RuntimeError("Input is not a number.");o=s-1}return 0}Ft.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,an);if(!r)return null;var n=e[2];if(typeof n!="object"||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");var i=null;if(n.locale&&!(i=t.parse(n.locale,1,on)))return null;var a=null;if(n.currency&&!(a=t.parse(n.currency,1,on)))return null;var o=null;if(n["min-fraction-digits"]&&!(o=t.parse(n["min-fraction-digits"],1,an)))return null;var s=null;return n["max-fraction-digits"]&&!(s=t.parse(n["max-fraction-digits"],1,an))?null:new Ft(r,i,a,o,s)},Ft.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Ft.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Ft.prototype.possibleOutputs=function(){return[void 0]},Ft.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Fo={kind:"number"},ct=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var n=0,i=r;n<i.length;n+=1){var a=i[n],o=a[0],s=a[1];this.labels.push(o),this.outputs.push(s)}};ct.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Fo);if(!r)return null;var n=[],i=null;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var a=1;a<e.length;a+=2){var o=a===1?-1/0:e[a],s=e[a+1],u=a,p=a+1;if(typeof o!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(n.length&&n[n.length-1][0]>=o)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var c=t.parse(s,p,i);if(!c)return null;i=i||c.type,n.push([o,c])}return new ct(i,r,n)},ct.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var i=t.length;return n>=t[i-1]?r[i-1].evaluate(e):r[ri(t,n)].evaluate(e)},ct.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},ct.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.outputs.map(function(t){return t.possibleOutputs()}))},ct.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Ct=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Ct.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Ct(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Ct.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ct.prototype.eachChild=function(){},Ct.prototype.possibleOutputs=function(){return[void 0]},Ct.prototype.serialize=function(){return["var",this.name]};var Dt={"==":Fe.Equals,"!=":Fe.NotEquals,">":Fe.GreaterThan,"<":Fe.LessThan,">=":Fe.GreaterThanOrEqual,"<=":Fe.LessThanOrEqual,array:ge,at:St,boolean:ge,case:kt,coalesce:ut,collator:Mt,format:lt,image:Ot,in:zt,interpolate:le,"interpolate-hcl":le,"interpolate-lab":le,length:Rt,let:pt,literal:Ne,match:Pt,number:ge,"number-format":Ft,object:ge,step:ct,string:ge,"to-boolean":Le,"to-color":Le,"to-number":Le,"to-string":Le,var:Ct};function k(){}var pr={};for(var sn in k.register=function(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),pr[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}},k.register("Object",Object),k.register("Color",N),k.register("ResolvedImage",Ie),k.register("ImageAtlas",or),k.register("ImagePosition",$r),k.register("RGBAImage",Ae),k.register("Formatted",ue),k.register("FormattedSection",Fr),Dt)Dt[sn]._classRegistryKey||k.register("Expression_"+sn,Dt[sn]);function ni(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}k.serialize=function(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ni(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var n=[],i=0,a=e;i<a.length;i+=1){var o=a[i];n.push(k.serialize(o,t))}return n}if(typeof e=="object"){var s=e.constructor,u=s._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");var p=s.serialize?s.serialize(e,t):{};if(!s.serialize){for(var c in e)if(e.hasOwnProperty(c)&&!(pr[u].omit.indexOf(c)>=0)){var f=e[c];typeof f!="function"&&(p[c]=pr[u].shallow.indexOf(c)>=0?f:k.serialize(f,t))}e instanceof Error&&(p.message=e.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof e)},k.deserialize=function(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ni(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(k.deserialize);if(typeof e=="object"){var t=e.$name||"Object",r=pr[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var n=Object.create(r.prototype),i=0,a=Object.keys(e);i<a.length;i+=1){var o=a[i];if(o!=="$name"){var s=e[o];n[o]=pr[t].shallow.indexOf(o)>=0?s:k.deserialize(s)}}return n}throw new Error("can't deserialize object of type "+typeof e)};var ii=function(){this.first=!0};ii.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Se=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ii,this.transition={})};Se.prototype.isSupportedScript=function(e){return!1},Se.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Se.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var Xe=8192;function ai(e,t,r){return Math.min(r,Math.max(t,e))}function Co(e){return{min:-1*Math.pow(2,e-1),max:Math.pow(2,e-1)-1}}var ft=Co(15);function cr(e){for(var t=Xe/e.extent,r=e.loadGeometry(),n=0;n<r.length;n++)for(var i=r[n],a=0;a<i.length;a++){var o=i[a];o.x=Math.round(o.x*t),o.y=Xe-Math.round(o.y*t),(o.x<ft.min||o.x>ft.max||o.y<ft.min||o.y>ft.max)&&(o.x=ai(o.x,ft.min,ft.max),o.y=ai(o.y,ft.min,ft.max))}return r}var xe=function(e){e===void 0&&(e=[]),this.segments=e};xe.prototype.prepareSegment=function(e,t,r,n){var i=this.segments[this.segments.length-1];return(!i||i.vertexLength+e>xe.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n)&&(i={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},n!==void 0&&(i.sortKey=n),this.segments.push(i)),i},xe.prototype.get=function(){return this.segments},xe.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var n in r.vaos)r.vaos[n].destroy()}},xe.simpleSegment=function(e,t,r,n){return new xe([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])},xe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,k.register("SegmentVector",xe);var Do=128,Uo=5,de=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};de.serialize=function(e,t){return e.isTransferred&&console.log("StructArray array.isTransferred."),e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},de.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},de.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},de.prototype.clear=function(){this.length=0},de.prototype.resize=function(e){this.reserve(e),this.length=e},de.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*Uo),Do),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},de.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var un=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,n,i,a,o,s){var u=this.length;return this.resize(u+1),this.emplace(u,r,n,i,a,o,s)},t.prototype.emplace=function(r,n,i,a,o,s,u){var p=4*r,c=8*r;return this.int16[p+0]=n,this.int16[p+1]=i,this.uint8[c+4]=a,this.uint8[c+5]=o,this.uint8[c+6]=s,this.uint8[c+7]=u,r},t}(de);un.prototype.bytesPerElement=8,k.register("StructArrayLayout2i4ub8",un);var Kt=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i)},t.prototype.emplace=function(r,n,i,a){var o=3*r;return this.uint16[o+0]=n,this.uint16[o+1]=i,this.uint16[o+2]=a,r},t}(de);Kt.prototype.bytesPerElement=6,k.register("StructArrayLayout3ui6",Kt);var Ut=function(){this.ids=[],this.positions=[],this.indexed=!1};function ln(e,t,r,n){if(!(r>=n)){for(var i=e[r+n>>1],a=r-1,o=n+1;;){do a++;while(e[a]<i);do o--;while(e[o]>i);if(a>=o)break;Cr(e,a,o),Cr(t,3*a,3*o),Cr(t,3*a+1,3*o+1),Cr(t,3*a+2,3*o+2)}ln(e,t,r,o),ln(e,t,o+1,n)}}function Cr(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}Ut.prototype.add=function(e,t,r,n){this.ids.push(e),this.positions.push(t,r,n)},Ut.prototype.getPositions=function(e){for(var t=0,r=this.ids.length-1;t<r;){var n=t+r>>1;this.ids[n]>=e?r=n:t=n+1}for(var i=[];this.ids[t]===e;){var a=this.positions[3*t],o=this.positions[3*t+1],s=this.positions[3*t+2];i.push({index:a,start:o,end:s}),t++}return i},Ut.serialize=function(e,t){var r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return ln(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}},Ut.deserialize=function(e){var t=new Ut;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t},k.register("FeaturePositionMap",Ut);var Ce=function(e,t,r){this.property=e,this.value=t,this.parameters=r};function ht(){}Ce.prototype.isConstant=function(){return this.value.kind==="constant"},Ce.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Ce.prototype.evaluate=function(e,t,r){return this.property.evaluate(this.value,this.parameters,e,t,r)},ht.supportsPropertyExpression=function(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"},ht.supportsZoomExpression=function(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1},ht.supportsInterpolation=function(e){return!!e.expression&&e.expression.interpolated};var De={},Bt=function(e,t){this.gl=e.gl,this.location=t};De.Uniform1i=function(e){function t(r,n){e.call(this,r,n),this.current=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Bt),De.Uniform1f=function(e){function t(r,n){e.call(this,r,n),this.current=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Bt),De.Uniform2f=function(e){function t(r,n){e.call(this,r,n),this.current=[0,0]}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Bt),De.Uniform3f=function(e){function t(r,n){e.call(this,r,n),this.current=[0,0,0]}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Bt),De.Uniform4f=function(e){function t(r,n){e.call(this,r,n),this.current=[0,0,0,0]}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Bt),De.UniformColor=function(e){function t(r,n){e.call(this,r,n),this.current=N.transparent}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Bt);var Bo=new Float32Array(16);De.UniformMatrix4f=function(e){function t(r,n){e.call(this,r,n),this.current=Bo}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(r){this.gl.uniformMatrix4fv(this.location,!1,r)},t}(Bt);var dt=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,n,i,a,o,s,u,p){var c=this.length;return this.resize(c+1),this.emplace(c,r,n,i,a,o,s,u,p)},t.prototype.emplace=function(r,n,i,a,o,s,u,p,c){var f=8*r;return this.uint16[f+0]=n,this.uint16[f+1]=i,this.uint16[f+2]=a,this.uint16[f+3]=o,this.uint16[f+4]=s,this.uint16[f+5]=u,this.uint16[f+6]=p,this.uint16[f+7]=c,r},t}(de);dt.prototype.bytesPerElement=16,k.register("StructArrayLayout8ui16",dt);var Dr=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},t.prototype.emplace=function(r,n,i){var a=2*r;return this.float32[a+0]=n,this.float32[a+1]=i,r},t}(de);Dr.prototype.bytesPerElement=8,k.register("StructArrayLayout2f8",Dr);var pn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,n,i,a){var o=this.length;return this.resize(o+1),this.emplace(o,r,n,i,a)},t.prototype.emplace=function(r,n,i,a,o){var s=4*r;return this.float32[s+0]=n,this.float32[s+1]=i,this.float32[s+2]=a,this.float32[s+3]=o,r},t}(de);pn.prototype.bytesPerElement=16,k.register("StructArrayLayout4f16",pn);var cn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var n=this.length;return this.resize(n+1),this.emplace(n,r)},t.prototype.emplace=function(r,n){var i=1*r;return this.float32[i+0]=n,r},t}(de);function fn(e,t,r){return Math.min(r,Math.max(t,e))}function oi(e,t){return 256*(e=fn(Math.floor(e),0,255))+(t=fn(Math.floor(t),0,255))}function Jt(e){return[oi(255*e.r,255*e.g),oi(255*e.b,255*e.a)]}cn.prototype.bytesPerElement=4,k.register("StructArrayLayout1f4",cn);var be=function(e,t,r){this.value=e,this.names=t,this.uniformNames=this.names.map(function(n){return"u_"+n}),this.type=r,this.maxValue=-1/0};be.prototype.defines=function(){return this.names.map(function(e){return"#define HAS_UNIFORM_u_"+e})},be.prototype.setConstantPatternPositions=function(){},be.prototype.populatePaintArray=function(){},be.prototype.updatePaintArray=function(){},be.prototype.upload=function(){},be.prototype.destroy=function(){},be.prototype.setUniforms=function(e,t,r,n){t.set(n.constantOr(this.value))},be.prototype.getBinding=function(e,t){return this.type==="color"?new De.UniformColor(e,t):new De.Uniform1f(e,t)},be.serialize=function(e){var t=e.value,r=e.names,n=e.type;return{value:k.serialize(t),names:r,type:n}},be.deserialize=function(e){var t=e.value,r=e.names,n=e.type;return new be(k.deserialize(t),r,n)};var qe=function(e,t,r){this.value=e,this.names=t,this.uniformNames=this.names.map(function(n){return"u_"+n}),this.type=r,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};qe.prototype.defines=function(){return this.names.map(function(e){return"#define HAS_UNIFORM_u_"+e})},qe.prototype.populatePaintArray=function(){},qe.prototype.updatePaintArray=function(){},qe.prototype.upload=function(){},qe.prototype.destroy=function(){},qe.prototype.setConstantPatternPositions=function(e,t){this.patternPositions.patternTo=e.tlbr,this.patternPositions.patternFrom=t.tlbr},qe.prototype.setUniforms=function(e,t,r,n,i){var a=this.patternPositions;i==="u_pattern_to"&&a.patternTo&&t.set(a.patternTo),i==="u_pattern_from"&&a.patternFrom&&t.set(a.patternFrom)},qe.prototype.getBinding=function(e,t){return new De.Uniform4f(e,t)};var Ue=function(e,t,r,n){this.expression=e,this.names=t,this.type=r,this.uniformNames=this.names.map(function(i){return"a_"+i}),this.maxValue=-1/0,this.paintVertexAttributes=t.map(function(i){return{name:"a_"+i,type:"Float32",components:r==="color"?2:1,offset:0}}),this.paintVertexArray=new n};Ue.prototype.defines=function(){return[]},Ue.prototype.setConstantPatternPositions=function(){},Ue.prototype.populatePaintArray=function(e,t,r,n){var i=this.paintVertexArray,a=i.length;i.reserve(e);var o=this.expression.evaluate(new EvaluationParameters(0),t,{},[],n);if(this.type==="color")for(var s=Jt(o),u=a;u<e;u++)i.emplaceBack(s[0],s[1]);else{for(var p=a;p<e;p++)i.emplaceBack(o);this.maxValue=Math.max(this.maxValue,o)}},Ue.prototype.updatePaintArray=function(e,t,r,n){var i=this.paintVertexArray,a=this.expression.evaluate({zoom:0},r,n);if(this.type==="color")for(var o=Jt(a),s=e;s<t;s++)i.emplace(s,o[0],o[1]);else{for(var u=e;u<t;u++)i.emplace(u,a);this.maxValue=Math.max(this.maxValue,a)}},Ue.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ue.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ue.prototype.setUniforms=function(e,t){t.set(0)},Ue.prototype.getBinding=function(e,t){return new De.Uniform1f(e,t)};var ke=function(e,t,r,n,i,a){this.expression=e,this.names=t,this.uniformNames=this.names.map(function(s){return"u_"+s+"_t"}),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=-1/0;var o=a;this.paintVertexAttributes=t.map(function(s){return{name:"a_"+s,type:"Float32",components:r==="color"?4:2,offset:0}}),this.paintVertexArray=new o};ke.prototype.defines=function(){return[]},ke.prototype.setConstantPatternPositions=function(){},ke.prototype.populatePaintArray=function(e,t,r,n){var i=this.paintVertexArray,a=i.length;i.reserve(e);var o=this.expression.evaluate(new EvaluationParameters(this.zoom),t,{},[],n),s=this.expression.evaluate(new EvaluationParameters(this.zoom+1),t,{},[],n);if(this.type==="color")for(var u=Jt(o),p=Jt(s),c=a;c<e;c++)i.emplaceBack(u[0],u[1],p[0],p[1]);else{for(var f=a;f<e;f++)i.emplaceBack(o,s);this.maxValue=Math.max(this.maxValue,o,s)}},ke.prototype.updatePaintArray=function(e,t,r,n){var i=this.paintVertexArray,a=this.expression.evaluate({zoom:this.zoom},r,n),o=this.expression.evaluate({zoom:this.zoom+1},r,n);if(this.type==="color")for(var s=Jt(a),u=Jt(o),p=e;p<t;p++)i.emplace(p,s[0],s[1],u[0],u[1]);else{for(var c=e;c<t;c++)i.emplace(c,a,o);this.maxValue=Math.max(this.maxValue,a,o)}},ke.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ke.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ke.prototype.interpolationFactor=function(e){return this.useIntegerZoom&&(e=Math.floor(e)),fn(this.expression.interpolationFactor(e,this.zoom,this.zoom+1),0,1)},ke.prototype.setUniforms=function(e,t,r){t.set(this.interpolationFactor(r.zoom))},ke.prototype.getBinding=function(e,t){return new De.Uniform1f(e,t)};var je=function(e,t,r,n,i,a,o){this.expression=e,this.names=t,this.type=r,this.uniformNames=this.names.map(function(s){return"u_"+s+"_t"}),this.useIntegerZoom=n,this.zoom=i,this.maxValue=-1/0,this.layerId=o,this.paintVertexAttributes=t.map(function(s){return{name:"a_"+s,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a};je.prototype.defines=function(){return[]},je.prototype.setConstantPatternPositions=function(){},je.prototype.populatePaintArray=function(e,t,r){var n=this.zoomInPaintVertexArray,i=this.zoomOutPaintVertexArray,a=this.layerId,o=n.length;if(n.reserve(e),i.reserve(e),r&&t.patterns&&t.patterns[a]){var s=t.patterns[a],u=s.min,p=s.mid,c=s.max,f=r[u],h=r[p],d=r[c];if(!f||!h||!d)return;for(var v=o;v<e;v++)n.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1]),i.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1])}},je.prototype.updatePaintArray=function(e,t,r,n,i){var a=this.zoomInPaintVertexArray,o=this.zoomOutPaintVertexArray,s=this.layerId;if(i&&r.patterns&&r.patterns[s]){var u=r.patterns[s],p=u.min,c=u.mid,f=u.max,h=i[p],d=i[c],v=i[f];if(!h||!d||!v)return;for(var g=e;g<t;g++)a.emplace(g,d.tl[0],d.tl[1],d.br[0],d.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1]),o.emplace(g,d.tl[0],d.tl[1],d.br[0],d.br[1],v.tl[0],v.tl[1],v.br[0],v.br[1])}},je.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},je.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},je.prototype.setUniforms=function(e,t){t.set(0)},je.prototype.getBinding=function(e,t){return new Uniform1f(e,t)};var _e=function(){this.binders={},this.cacheKey="",this._buffers=[]};function Vo(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"text-show-background":["show-background"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Lo(e){return{"line-pattern":{source:dt,composite:dt},"fill-pattern":{source:dt,composite:dt},"fill-extrusion-pattern":{source:dt,composite:dt}}[e]}function hn(e,t,r){var n={color:{source:Dr,composite:pn},number:{source:cn,composite:Dr}},i=Lo(e);return i&&i[r]||n[t][r]}_e.createDynamic=function(e,t,r){var n=new _e,i=[];for(var a in e.paint._values)if(r(a)){var o=e.paint.get(a);if(o instanceof Ce&&ht.supportsPropertyExpression(o.property.specification)){var s=Vo(a,e.type),u=o.property.specification.type,p=o.property.useIntegerZoom;if(o.property.specification["property-type"]==="cross-faded"||o.property.specification["property-type"]==="cross-faded-data-driven")if(o.value.kind==="constant")n.binders[a]=new qe(o.value.value,s,u),i.push("/u_"+a);else{var c=hn(a,u,"source");n.binders[a]=new je(o.value,s,u,p,t,c,e.id),i.push("/a_"+a)}else if(o.value.kind==="constant")n.binders[a]=new be(o.value.value,s,u),i.push("/u_"+a);else if(o.value.kind==="source"){var f=hn(a,u,"source");n.binders[a]=new Ue(o.value,s,u,f),i.push("/a_"+a)}else{var h=hn(a,u,"composite");n.binders[a]=new ke(o.value,s,u,p,t,h),i.push("/z_"+a)}}}return n.cacheKey=i.sort().join(""),n},_e.prototype.populatePaintArrays=function(e,t,r,n,i){for(var a in this.binders)this.binders[a].populatePaintArray(e,t,n,i)},_e.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders)this.binders[r].setConstantPatternPositions(e,t)},_e.prototype.updatePaintArrays=function(e,t,r,n,i){var a=!1;for(var o in e)for(var s=0,u=t.getPositions(+o);s<u.length;s+=1){var p=u[s],c=r.feature(p.index);for(var f in this.binders){var h=this.binders[f];if(!(h instanceof be||h instanceof qe)&&h.expression.isStateDependent===!0){var d=n.paint.get(f);h.expression=d.value,h.updatePaintArray(p.start,p.end,c,e[o],i),a=!0}}}return a},_e.prototype.defines=function(){var e=[];for(var t in this.binders)e.push.apply(e,this.binders[t].defines());return e},_e.prototype.getPaintVertexBuffers=function(){return this._buffers},_e.prototype.getUniforms=function(e,t){var r=[];for(var n in this.binders)for(var i=this.binders[n],a=0,o=i.uniformNames;a<o.length;a+=1){var s=o[a];if(t[s]){var u=i.getBinding(e,t[s]);r.push({name:s,property:n,binding:u})}}return r},_e.prototype.setUniforms=function(e,t,r,n){for(var i=0,a=t;i<a.length;i+=1){var o=a[i],s=o.name,u=o.property,p=o.binding;this.binders[u].setUniforms(e,p,n,r.get(u),s)}},_e.prototype.updatePatternPaintBuffers=function(e){var t=[];for(var r in this.binders){var n=this.binders[r];if(n instanceof je){var i=e.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&t.push(i)}else(n instanceof Ue||n instanceof ke)&&n.paintVertexBuffer&&t.push(n.paintVertexBuffer)}this._buffers=t},_e.prototype.upload=function(e){for(var t in this.binders)this.binders[t].upload(e);var r=[];for(var n in this.binders){var i=this.binders[n];(i instanceof Ue||i instanceof ke)&&i.paintVertexBuffer&&r.push(i.paintVertexBuffer)}this._buffers=r},_e.prototype.destroy=function(){for(var e in this.binders)this.binders[e].destroy()},k.register("ConstantBinder",be),k.register("CrossFadedConstantBinder",qe),k.register("SourceExpressionBinder",Ue),k.register("CrossFadedCompositeBinder",je),k.register("CompositeExpressionBinder",ke),k.register("ProgramConfiguration",_e,{omit:["_buffers"]});var et=function(e,t,r,n){n===void 0&&(n=function(){return!0}),this.programConfigurations={};for(var i=0,a=t;i<a.length;i+=1){var o=a[i];this.programConfigurations[o.id]=_e.createDynamic(o,r,n),this.programConfigurations[o.id].layoutAttributes=e}this.needsUpload=!1,this._featureMap=new Ut,this._bufferOffset=0};function si(e,t,r,n,i){for(var a=i.patternDependencies,o=0,s=t;o<s.length;o+=1){var u=s[o],p=u.paint.get(e+"-pattern").value;if(p.kind!=="constant"){var c=p.evaluate({zoom:n-1},r,{},i.availableImages),f=p.evaluate({zoom:n},r,{},i.availableImages),h=p.evaluate({zoom:n+1},r,{},i.availableImages);c=c&&c.name?c.name:c,f=f&&f.name?f.name:f,h=h&&h.name?h.name:h,a[c]=!0,a[f]=!0,a[h]=!0,r.patterns[u.id]={min:c,mid:f,max:h}}}return r}et.prototype.populatePaintArrays=function(e,t,r,n,i){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(e,t,r,n,i);t.id!==void 0&&this._featureMap.add(+t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},et.prototype.updatePaintArrays=function(e,t,r,n){for(var i=0,a=r;i<a.length;i+=1){var o=a[i];this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,t,o,n)||this.needsUpload}},et.prototype.get=function(e){return this.programConfigurations[e]},et.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},et.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},k.register("ProgramConfigurationSet",et);var Xo=["Unknown","Point","LineString","Polygon"],dn=ve([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),ui=dn.members;dn.size,dn.alignment;var li=63,qo=Math.cos(Math.PI/180*37.5),jo=15,Ho=20,Yo=15,pi=.5,ci=Math.pow(2,Yo-1)/pi,pe=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new un,this.indexArray=new Kt,this.programConfigurations=new et(ui,e.layers,e.zoom),this.segments=new xe,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Qo(e,t,r,n,i){fi(e,t,r||0,n||e.length-1,i||Wo)}function fi(e,t,r,n,i){for(;n>r;){if(n-r>600){var a=n-r+1,o=t-r+1,s=Math.log(a),u=.5*Math.exp(2*s/3),p=.5*Math.sqrt(s*u*(a-u)/a)*(o-a/2<0?-1:1);fi(e,t,Math.max(r,Math.floor(t-o*u/a+p)),Math.min(n,Math.floor(t+(a-o)*u/a+p)),i)}var c=e[t],f=r,h=n;for(fr(e,r,t),i(e[n],c)>0&&fr(e,r,n);f<h;){for(fr(e,f,h),f++,h--;i(e[f],c)<0;)f++;for(;i(e[h],c)>0;)h--}i(e[r],c)===0?fr(e,r,h):fr(e,++h,n),h<=t&&(r=h+1),t<=h&&(n=h-1)}}function fr(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Wo(e,t){return e<t?-1:e>t?1:0}function Ko(e){for(var t=0,r=0,n=e.length,i=n-1,a=void 0,o=void 0;r<n;i=r++)a=e[r],t+=((o=e[i]).x-a.x)*(a.y+o.y);return t}function Jo(e,t){var r=e.length;if(r<=1)return[e];for(var n,i,a=[],o=0;o<r;o++){var s=Ko(e[o]);s!==0&&(e[o].area=Math.abs(s),i===void 0&&(i=s<0),i===s<0?(n&&a.push(n),n=[e[o]]):n.push(e[o]))}if(n&&a.push(n),t>1)for(var u=0;u<a.length;u++)a[u].length<=t||(Qo(a[u],t,1,a[u].length-1,Zo),a[u]=a[u].slice(0,t));return a}function Zo(e,t){return t.area-e.area}pe.prototype.populate=function(e,t){this.hasPattern=!1;for(var r=this.layers[0].layout.get("line-sort-key"),n=[],i=0,a=e;i<a.length;i+=1){var o=a[i],s=o.feature,u=o.index,p=o.sourceLayerIndex;if(this.layers[0]._featureFilter(new Se(0),s)){var c=cr(s),f=r?r.evaluate(s,{}):void 0,h={id:s.id,properties:s.properties,type:s.type,sourceLayerIndex:p,index:u,geometry:c,patterns:{},sortKey:f};n.push(h)}}r&&n.sort(function(L,F){return L.sortKey-F.sortKey});for(var d=0,v=n;d<v.length;d+=1){var g=v[d],x=g,b=x.geometry,_=x.index,S=x.sourceLayerIndex;if(this.hasPattern){var A=si("line",this.layers,g,this.zoom,t);this.patternFeatures.push(A)}else this.addFeature(g,b,_,{});var O=e[_].feature;t.featureIndex.insert(O,b,_,S,this.index)}},pe.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},pe.prototype.addFeatures=function(e,t){for(var r=0,n=this.patternFeatures;r<n.length;r+=1){var i=n[r];this.addFeature(i,i.geometry,i.index,t)}},pe.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},pe.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},pe.prototype.upload=function(e){if(!this.uploaded){if(this.layoutVertexArray==null)return;this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ui),this.indexBuffer=e.createIndexBuffer(this.indexArray)}this.programConfigurations.upload(e),this.uploaded=!0},pe.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},pe.prototype.clear=function(){ne.defined(this.layoutVertexArray)&&(this.layoutVertexArray=null),ne.defined(this.indexArray)&&(this.indexArray=null)},pe.prototype.addFeature=function(e,t,r,n){for(var i=this.layers[0].layout,a=i.get("line-join").evaluate(e,{}),o=i.get("line-cap"),s=i.get("line-miter-limit"),u=i.get("line-round-limit"),p=0,c=t;p<c.length;p+=1){var f=c[p];this.addLine(f,e,a,o,s,u,r,n)}},pe.prototype.addLine=function(e,t,r,n,i,a,o,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+t.properties.mapbox_clip_start,this.clipEnd=+t.properties.mapbox_clip_end;for(var u=0;u<e.length-1;u++)this.totalDistance+=e[u].dist(e[u+1])}for(var p=Xo[t.type]==="Polygon",c=e.length;c>=2&&e[c-1].equals(e[c-2]);)c--;for(var f=0;f<c-1&&e[f].equals(e[f+1]);)f++;if(!(c<(p?3:2))){r==="bevel"&&(i=1.05);var h,d=this.overscaling<=16?jo*Xe/(512*this.overscaling):0,v=this.segments.prepareSegment(10*c,this.layoutVertexArray,this.indexArray),g=void 0,x=void 0,b=void 0,_=void 0;this.e1=this.e2=-1,p&&(h=e[c-2],_=e[f].sub(h)._unit()._perp());for(var S=f;S<c;S++)if(!(x=p&&S===c-1?e[f+1]:e[S+1])||!e[S].equals(x)){_&&(b=_),h&&(g=h),h=e[S],_=x?x.sub(h)._unit()._perp():b;var A=(b=b||_).add(_);A.x===0&&A.y===0||A._unit();var O=b.x*_.x+b.y*_.y,L=A.x*_.x+A.y*_.y,F=L!==0?1/L:1/0,B=2*Math.sqrt(2-2*L),W=L<qo&&g&&x,H=b.x*_.y-b.y*_.x>0;if(W&&S>f){var G=h.dist(g);if(G>2*d){var oe=h.sub(h.sub(g)._mult(d/G)._round());this.updateDistance(g,oe),this.addCurrentVertex(oe,b,0,0,v),g=oe}}var he=g&&x,D=he?r:p?"butt":n;if(he&&D==="round"&&(F<a?D="miter":F<=2&&(D="fakeround")),D==="miter"&&F>i&&(D="bevel"),D==="bevel"&&(F>2&&(D="flipbevel"),F<i&&(D="miter")),g&&this.updateDistance(g,h),D==="miter")A._mult(F),this.addCurrentVertex(h,A,0,0,v);else if(D==="flipbevel"){if(F>100)A=_.mult(-1);else{var ye=F*b.add(_).mag()/b.sub(_).mag();A._perp()._mult(ye*(H?-1:1))}this.addCurrentVertex(h,A,0,0,v),this.addCurrentVertex(h,A.mult(-1),0,0,v)}else if(D==="bevel"||D==="fakeround"){var me=-Math.sqrt(F*F-1),Ze=H?me:0,ot=H?0:me;if(g&&this.addCurrentVertex(h,b,Ze,ot,v),D==="fakeround")for(var se=Math.round(180*B/Math.PI/Ho),Ve=1;Ve<se;Ve++){var Re=Ve/se;if(Re!==.5){var Ge=Re-.5;Re+=Re*Ge*(Re-1)*((1.0904+O*(O*(3.55645-1.43519*O)-3.2452))*Ge*Ge+(.848013+O*(.215638*O-1.06021)))}var $e=_.sub(b)._mult(Re)._add(b)._unit()._mult(H?-1:1);this.addHalfVertex(h,$e.x,$e.y,!1,H,0,v)}x&&this.addCurrentVertex(h,_,-Ze,-ot,v)}else if(D==="butt")this.addCurrentVertex(h,A,0,0,v);else if(D==="square"){var Ye=g?1:-1;this.addCurrentVertex(h,A,Ye,Ye,v)}else D==="round"&&(g&&(this.addCurrentVertex(h,b,0,0,v),this.addCurrentVertex(h,b,1,1,v,!0)),x&&(this.addCurrentVertex(h,_,-1,-1,v,!0),this.addCurrentVertex(h,_,0,0,v)));if(W&&S<c-1){var st=h.dist(x);if(st>2*d){var Or=h.add(x.sub(h)._mult(d/st)._round());this.updateDistance(h,Or),this.addCurrentVertex(Or,_,0,0,v),h=Or}}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,s)}},pe.prototype.addCurrentVertex=function(e,t,r,n,i,a){a===void 0&&(a=!1);var o=t.x+t.y*r,s=t.y-t.x*r,u=-t.x+t.y*n,p=-t.y-t.x*n;this.addHalfVertex(e,o,s,a,!1,r,i),this.addHalfVertex(e,u,p,a,!0,-n,i),this.distance>ci/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,n,i,a))},pe.prototype.addHalfVertex=function(e,t,r,n,i,a,o){var s=e.x,u=e.y,p=this.scaledDistance*pi;this.layoutVertexArray.emplaceBack((s<<1)+(n?1:0),(u<<1)+(i?1:0),Math.round(li*t)+128,Math.round(li*r)+128,1+(a===0?0:a<0?-1:1)|(63&p)<<2,p>>6);var c=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),o.primitiveLength++),i?this.e2=c:this.e1=c},pe.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(ci-1):this.distance},k.register("LineBucket",pe,{omit:["layers","patternFeatures"]});var Ur=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},t.prototype.emplace=function(r,n,i){var a=2*r;return this.int16[a+0]=n,this.int16[a+1]=i,r},t}(de);Ur.prototype.bytesPerElement=4,k.register("StructArrayLayout2i4",Ur);var yn,mn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},t.prototype.emplace=function(r,n,i){var a=2*r;return this.uint16[a+0]=n,this.uint16[a+1]=i,r},t}(de);function Go(e,t,r){for(var n=r.patternDependencies,i=!1,a=0,o=t;a<o.length;a+=1){var s=o[a].paint.get(e+"-pattern");s.isConstant()||(i=!0);var u=s.constantOr(null);u&&(i=!0,n[u.to]=!0,n[u.from]=!0)}return i}if(mn.prototype.bytesPerElement=4,k.register("StructArrayLayout2ui4",mn),typeof WebAssembly<"u"){let e=function(y){e.shown||(e.shown={}),e.shown[y]||(e.shown[y]=1)},t=function(y,m,T){switch((m=m||"i8").charAt(m.length-1)==="*"&&(m="i32"),m){case"i1":case"i8":return Zt[y>>0];case"i16":return _n[y>>1];case"i32":case"i64":return rt[y>>2];case"float":return vi[y>>2];case"double":return gi[y>>3];default:w("invalid type for getValue: "+m)}return null},r=function(y,m){y||w("Assertion failed: "+m)},n=function(y){var m=l["_"+y];return r(m,"Cannot call unknown function "+y+", make sure it is exported"),m},i=function(y,m,T,C,$){var re={string:function(Qe){var zr=0;if(Qe!=null&&Qe!==0){var pa=1+(Qe.length<<2);p(Qe,zr=En(pa),pa)}return zr},array:function(Qe){var zr=En(Qe.length);return c(Qe,zr),zr}},q=n(y),U=[],Pe=0;if(r(m!=="array",'Return type should not be "array".'),C)for(var Te=0;Te<C.length;Te++){var ir=re[T[Te]];ir?(Pe===0&&(Pe=Tn()),U[Te]=ir(C[Te])):U[Te]=C[Te]}var qn=q.apply(null,U);return qn=function(Qe){return m==="string"?s(Qe):m==="boolean"?Boolean(Qe):Qe}(qn),Pe!==0&&Ii(Pe),qn},a=function(y,m,T,C){return function(){return i(y,m,T,arguments)}},o=function(y,m,T){for(var C=m+T,$=m;y[$]&&!($>=C);)++$;if($-m>16&&y.subarray&&mi)return mi.decode(y.subarray(m,$));for(var re="";m<$;){var q=y[m++];if(128&q){var U=63&y[m++];if((224&q)!=192){var Pe=63&y[m++];if((240&q)==224?q=(15&q)<<12|U<<6|Pe:((248&q)!=240&&e("Invalid UTF-8 leading byte 0x"+q.toString(16)+" encountered when deserializing a UTF-8 string on the asm.js/wasm heap to a JS string!"),q=(7&q)<<18|U<<12|Pe<<6|63&y[m++]),q<65536)re+=String.fromCharCode(q);else{var Te=q-65536;re+=String.fromCharCode(55296|Te>>10,56320|1023&Te)}}else re+=String.fromCharCode((31&q)<<6|U)}else re+=String.fromCharCode(q)}return re},s=function(y,m){return y?o(mt,y,m):""},u=function(y,m,T,C){if(!(C>0))return 0;for(var $=T,re=T+C-1,q=0;q<y.length;++q){var U=y.charCodeAt(q);if(U>=55296&&U<=57343&&(U=65536+((1023&U)<<10)|1023&y.charCodeAt(++q)),U<=127){if(T>=re)break;m[T++]=U}else if(U<=2047){if(T+1>=re)break;m[T++]=192|U>>6,m[T++]=128|63&U}else if(U<=65535){if(T+2>=re)break;m[T++]=224|U>>12,m[T++]=128|U>>6&63,m[T++]=128|63&U}else{if(T+3>=re)break;U>=2097152&&e("Invalid Unicode code point 0x"+U.toString(16)+" encountered when serializing a JS string to an UTF-8 string on the asm.js/wasm heap! (Valid unicode code points should be in range 0-0x1FFFFF)."),m[T++]=240|U>>18,m[T++]=128|U>>12&63,m[T++]=128|U>>6&63,m[T++]=128|63&U}}return m[T]=0,T-$},p=function(y,m,T){return r(typeof T=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),u(y,mt,m,T)},c=function(y,m){r(y.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),Zt.set(y,m)},f=function(){var y=new Error;if(!y.stack){try{throw new Error(0)}catch(m){y=m}if(!y.stack)return"(no stack trace available)"}return y.stack.toString()},h=function(y,m){return y%m>0&&(y+=m-y%m),y},d=function(){l.HEAP8=Zt=new Int8Array(ce),l.HEAP16=_n=new Int16Array(ce),l.HEAP32=rt=new Int32Array(ce),l.HEAPU8=mt=new Uint8Array(ce),l.HEAPU16=new Uint16Array(ce),l.HEAPU32=Lt=new Uint32Array(ce),l.HEAPF32=vi=new Float32Array(ce),l.HEAPF64=gi=new Float64Array(ce)},v=function(){Lt[(vt>>2)-1]==34821223&&Lt[(vt>>2)-2]==2310721022||w("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x02135467, but received 0x"+Lt[(vt>>2)-2].toString(16)+" "+Lt[(vt>>2)-1].toString(16)),rt[0]!==1668509029&&w("Runtime error: The application has corrupted its heap memory area (address zero)!")},g=function(y){w("Stack overflow! Attempted to allocate "+y+" bytes on the stack, but stack has only "+(vt-Tn()+y)+" bytes available!")},x=function(y){for(;y.length>0;){var m=y.shift();if(typeof m!="function"){var T=m.func;typeof T=="number"?m.arg===void 0?l.dynCall_v(T):l.dynCall_vi(T,m.arg):T(m.arg===void 0?null:m.arg)}else m()}},b=function(){if(l.preRun)for(typeof l.preRun=="function"&&(l.preRun=[l.preRun]);l.preRun.length;)y=l.preRun.shift(),wi.unshift(y);var y;x(wi)},_=function(){if(v(),l.postRun)for(typeof l.postRun=="function"&&(l.postRun=[l.postRun]);l.postRun.length;)y=l.postRun.shift(),Ei.unshift(y);var y;x(Ei)},S=function(y){Xt++,l.monitorRunDependencies&&l.monitorRunDependencies(Xt),y&&(r(!Br[y]),Br[y]=1,qt===null&&typeof setInterval<"u"&&(qt=setInterval(function(){if(bn)return clearInterval(qt),void(qt=null)},1e4)))},A=function(y){if(Xt--,l.monitorRunDependencies&&l.monitorRunDependencies(Xt),y&&(r(Br[y]),delete Br[y]),Xt==0&&(qt!==null&&(clearInterval(qt),qt=null),mr)){var m=mr;mr=null,m()}},O=function(y){return String.prototype.startsWith?y.startsWith(Ti):y.indexOf(Ti)===0},L=function(){try{if(l.wasmBinary)return new Uint8Array(l.wasmBinary);if(l.readBinary)return l.readBinary(xt);throw"both async and sync fetching of the wasm failed"}catch(y){w(y)}},F=function(y){var m={env:y,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:$o};function T(q,U){var Pe=q.exports;l.asm=Pe,A("wasm-instantiate")}S("wasm-instantiate");var C=l;function $(q){r(l===C,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),C=null,T(q.instance)}function re(q){return(l.wasmBinary||!dr&&!Vt||typeof fetch!="function"?new Promise(function(U,Pe){U(L())}):fetch(xt,{credentials:"same-origin"}).then(function(U){if(!U.ok)throw"failed to load wasm binary file at '"+xt+"'";return U.arrayBuffer()}).catch(function(){return L()})).then(function(U){return WebAssembly.instantiate(U,m)}).then(q,function(U){})}if(l.instantiateWasm)try{return l.instantiateWasm(m,T)}catch{return!1}return function(){if(l.wasmBinary||typeof WebAssembly.instantiateStreaming!="function"||O(xt)||typeof fetch!="function")return re($);fetch(xt,{credentials:"same-origin"}).then(function(q){return WebAssembly.instantiateStreaming(q,m).then($,function(U){re($)})})}(),{}},B=function(y){return Es(y)},W=function(y){y&&Gt[y].refcount++},H=function(y){if(!y||Gt[y])return y;for(var m in Gt)for(var T=+m,C=Gt[T].adjusted,$=C.length,re=0;re<$;re++)if(C[re]===y)return T;return y},G=function(y){var m=Gt[y];return m&&!m.caught&&(m.caught=!0,vr.uncaught_exception--),m&&(m.rethrown=!1),as.push(y),W(H(y)),y},oe=function(y,m,T){throw Gt[y]={ptr:y,adjusted:[y],type:m,destructor:T,refcount:0,caught:!1,rethrown:!1},"uncaught_exception"in vr?vr.uncaught_exception++:vr.uncaught_exception=1,y+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."},he=function(){return!!vr.uncaught_exception},D=function(){},ye=function(){},me=function(y,m){Z.varargs=m;try{return Z.getStreamFromFD(),Z.get(),Z.get(),Z.get(),Z.get(),w("it should not be possible to operate on streams when !SYSCALLS_REQUIRE_FILESYSTEM"),0}catch(T){return ie!==void 0&&T instanceof ie.ErrnoError||w(T),-T.errno}},Ze=function(){var y=l._fflush;y&&y(0);var m=Z.buffers;m[1].length&&Z.printChar(1,10),m[2].length&&Z.printChar(2,10)},ot=function(y,m){Z.varargs=m;try{for(var T=Z.get(),C=Z.get(),$=Z.get(),re=0,q=0;q<$;q++){for(var U=rt[C+8*q>>2],Pe=rt[C+(8*q+4)>>2],Te=0;Te<Pe;Te++)Z.printChar(T,mt[U+Te]);re+=Pe}return re}catch(ir){return ie!==void 0&&ir instanceof ie.ErrnoError||w(ir),-ir.errno}},se=function(y,m){Z.varargs=m;try{return 0}catch(T){return ie!==void 0&&T instanceof ie.ErrnoError||w(T),-T.errno}},Ve=function(y,m){Z.varargs=m;try{return Z.getStreamFromFD(),w("it should not be possible to operate on streams when !SYSCALLS_REQUIRE_FILESYSTEM"),0}catch(T){return ie!==void 0&&T instanceof ie.ErrnoError||w(T),-T.errno}},Re=function(){},Ge=function(){l.abort()},$e=function(){return Zt.length},Ye=function(y,m,T){mt.set(mt.subarray(m,m+T),y)},st=function(y){if(!l.___errno_location)return y;rt[l.___errno_location()>>2]=y},Or=function(y){w("Cannot enlarge memory arrays to size "+y+" bytes (OOM). Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+Zt.length+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")},la=function(y){y=h(y,65536);var m=ce.byteLength;try{return yr.grow((y-m)/65536)!==-1&&(ce=yr.buffer,!0)}catch(T){return console.error("emscripten_realloc_buffer: Attempted to grow from "+m+" bytes to "+y+" bytes, but got error: "+T),!1}},ep=function(y){var m=$e();r(y>m);var T=65536,C=2147418112;if(y>C)return!1;for(var $=Math.max(m,16777216);$<y;)($=$<=536870912?h(2*$,T):Math.min(h((3*$+2147483648)/4,T),C))===m&&e("Cannot ask for more memory since we reached the practical limit in browsers (which is just below 2GB), so the request would have failed. Requesting only "+Zt.length);return!!la($)&&(d(),!0)},tp=function(y){ee("Invalid function pointer called with signature 'ii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},rp=function(y){ee("Invalid function pointer called with signature 'iidiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},np=function(y){ee("Invalid function pointer called with signature 'iiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},ip=function(y){ee("Invalid function pointer called with signature 'jiji'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},ap=function(y){ee("Invalid function pointer called with signature 'v'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},op=function(y){ee("Invalid function pointer called with signature 'vi'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},sp=function(y){ee("Invalid function pointer called with signature 'vii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},up=function(y){ee("Invalid function pointer called with signature 'viiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},lp=function(y){ee("Invalid function pointer called with signature 'viiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},pp=function(y){ee("Invalid function pointer called with signature 'viiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),ee("Build with ASSERTIONS=2 for more info."),w(y)},Gr=function(y){this.name="ExitStatus",this.message="Program terminated with exit("+y+")",this.status=y},Xn=function(y){function m(){l.calledRun||(l.calledRun=!0,bn||(v(),z||(z=!0,x(rs)),v(),x(ns),l.onRuntimeInitialized&&l.onRuntimeInitialized(),r(!l._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),_()))}y=y||l.arguments,Xt>0||(r((3&vt)==0),Lt[(vt>>2)-1]=34821223,Lt[(vt>>2)-2]=2310721022,b(),Xt>0||l.calledRun||(l.setStatus?(l.setStatus("Running..."),setTimeout(function(){setTimeout(function(){l.setStatus("")},1),m()},1)):m(),v()))},w=function(y){l.onAbort&&l.onAbort(y),bn=!0;var m,T="abort("+(y=y!==void 0?'"'+y+'"':"")+") at "+(m=f(),l.extraStackTrace&&(m+=`
`+l.extraStackTrace()),m.replace(/__Z[\w\d_]+/g,function(C){return C==C?C:C+" ["+C+"]"}));throw Si&&Si.forEach(function(C){T=C(T,y)}),T};var yt,l=l!==void 0?l:{},hr={};for(yt in l)l.hasOwnProperty(yt)&&(hr[yt]=l[yt]);l.arguments=[],l.thisProgram="./this.program",l.quit=function(y,m){throw m},l.preRun=[],l.postRun=[];var dr=!1,Vt=!1,vn=!1,hi=!1;if(dr=typeof window=="object",Vt=typeof importScripts=="function",vn=typeof process=="object"&&typeof require=="function"&&!dr&&!Vt,hi=!dr&&!vn&&!Vt,l.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var gn,xn,tt="";if(vn)tt=__dirname+"/",l.read=function(y,m){var T;return gn||(gn=require("fs")),xn||(xn=require("path")),y=xn.normalize(y),T=gn.readFileSync(y),m?T:T.toString()},l.readBinary=function(y){var m=l.read(y,!0);return m.buffer||(m=new Uint8Array(m)),r(m.buffer),m},process.argv.length>1&&(l.thisProgram=process.argv[1].replace(/\\/g,"/")),l.arguments=process.argv.slice(2),typeof module<"u"&&(module.exports=l),process.on("uncaughtException",function(y){if(!(y instanceof Gr))throw y}),process.on("unhandledRejection",w),l.quit=function(y){process.exit(y)},l.inspect=function(){return"[Emscripten Module object]"};else if(hi)typeof read<"u"&&(l.read=function(y){return read(y)}),l.readBinary=function(y){var m;return typeof readbuffer=="function"?new Uint8Array(readbuffer(y)):(r(typeof(m=read(y,"binary"))=="object"),m)},typeof scriptArgs<"u"?l.arguments=scriptArgs:arguments!==void 0&&(l.arguments=arguments),typeof quit=="function"&&(l.quit=function(y){quit(y)});else{if(!dr&&!Vt)throw new Error("environment detection error");Vt?tt=self.location.href:document.currentScript&&(tt=document.currentScript.src),tt=tt.indexOf("blob:")!==0?tt.substr(0,tt.lastIndexOf("/")+1):"",l.read=function(y){var m=new XMLHttpRequest;return m.open("GET",y,!1),m.send(null),m.responseText},Vt&&(l.readBinary=function(y){var m=new XMLHttpRequest;return m.open("GET",y,!1),m.responseType="arraybuffer",m.send(null),new Uint8Array(m.response)}),l.readAsync=function(y,m,T){var C=new XMLHttpRequest;C.open("GET",y,!0),C.responseType="arraybuffer",C.onload=function(){C.status==200||C.status==0&&C.response?m(C.response):T()},C.onerror=T,C.send(null)},l.setWindowTitle=function(y){document.title=y}}var di=l.print||(typeof console<"u"?console.log.bind(console):typeof print<"u"?print:null),ee=l.printErr||(typeof printErr<"u"?printErr:typeof console<"u"&&console.warn.bind(console)||di);for(yt in hr)hr.hasOwnProperty(yt)&&(l[yt]=hr[yt]);hr=void 0,r(l.memoryInitializerPrefixURL===void 0,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),r(l.pthreadMainPrefixURL===void 0,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),r(l.cdInitializerPrefixURL===void 0,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),r(l.filePackagePrefixURL===void 0,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),Tn=Ii=En=function(){w("cannot use the stack before compiled code is ready to run, and has provided stack access")};var $o={"f64-rem":function(y,m){return y%m},debugger:function(){}};new Array(0);var yr,yi=0,No=function(y){yi=y},es=function(){return yi};typeof WebAssembly!="object"&&w("No WebAssembly support found. Build with -s WASM=0 to target JavaScript instead.");var bn=!1,mi=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;typeof TextDecoder<"u"&&new TextDecoder("utf-16le");var ce,Zt,mt,_n,rt,Lt,vi,gi,xi=65536,ts=5872,vt=5248752,bi=5248752,_i=5840;r(ts%16==0,"stack must start aligned"),r(bi%16==0,"heap must start aligned");var wn=5242880;l.TOTAL_STACK&&r(wn===l.TOTAL_STACK,"the stack size can no longer be determined at runtime");var gt=l.TOTAL_MEMORY||16777216;if(gt<wn&&ee("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+gt+"! (TOTAL_STACK="+wn+")"),r(typeof Int32Array<"u"&&typeof Float64Array<"u"&&Int32Array.prototype.subarray!==void 0&&Int32Array.prototype.set!==void 0,"JS engine does not provide full typed array support"),l.buffer?r((ce=l.buffer).byteLength===gt,"provided buffer should be "+gt+" bytes, but it is "+ce.byteLength):(typeof WebAssembly=="object"&&typeof WebAssembly.Memory=="function"?(r(gt%xi==0),yr=new WebAssembly.Memory({initial:gt/xi}),ce=yr.buffer):ce=new ArrayBuffer(gt),r(ce.byteLength===gt)),d(),rt[_i>>2]=bi,rt[0]=1668509029,_n[1]=25459,mt[2]!==115||mt[3]!==99)throw"Runtime error: expected the system to be little-endian!";var wi=[],rs=[],ns=[],Ei=[],z=!1,R=!1;r(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),r(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),r(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),r(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var Xt=0,qt=null,mr=null,Br={};l.preloadedImages={},l.preloadedAudios={};var ie={error:function(){w("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){ie.error()},createDataFile:function(){ie.error()},createPreloadedFile:function(){ie.error()},createLazyFile:function(){ie.error()},open:function(){ie.error()},mkdev:function(){ie.error()},registerDevice:function(){ie.error()},analyzePath:function(){ie.error()},loadFilesFromDB:function(){ie.error()},ErrnoError:function(){ie.error()}};l.FS_createDataFile=ie.createDataFile,l.FS_createPreloadedFile=ie.createPreloadedFile;var xt,Ti="data:application/octet-stream;base64,",is=typeof window>"u"?self:window;O(xt=is.location.href.endsWith(".openrealspace")?"../../static/Build/Cesium/ThirdParty/earcut.wasm":"ThirdParty/earcut.wasm")||(yn=xt,xt=l.locateFile?l.locateFile(yn,tt):tt+yn),l.asm=function(y,m,T){m.memory=yr,m.table=new WebAssembly.Table({initial:260,maximum:260,element:"anyfunc"}),m.__memory_base=1024,m.__table_base=0;var C=F(m);return r(C,"binaryen setup failed (no wasm support?)"),C};var Ai=5856;r(Ai%8==0);var Gt={},as=[],Z={buffers:[null,[],[]],printChar:function(y,m){var T=Z.buffers[y];r(T),m===0||m===10?((y===1?di:ee)(o(T,0)),T.length=0):T.push(m)},varargs:0,get:function(y){return Z.varargs+=4,rt[Z.varargs-4>>2]},getStr:function(){return s(Z.get())},get64:function(){var y=Z.get(),m=Z.get();return r(y>=0?m===0:m===-1),y},getZero:function(){r(Z.get()===0)}},os={},ss={abort:w,setTempRet0:No,getTempRet0:es,abortStackOverflow:g,nullFunc_ii:tp,nullFunc_iidiiii:rp,nullFunc_iiii:np,nullFunc_jiji:ip,nullFunc_v:ap,nullFunc_vi:op,nullFunc_vii:sp,nullFunc_viiii:up,nullFunc_viiiii:lp,nullFunc_viiiiii:pp,___cxa_allocate_exception:B,___cxa_begin_catch:G,___cxa_throw:oe,___cxa_uncaught_exception:he,___exception_addRef:W,___exception_deAdjust:H,___gxx_personality_v0:D,___lock:ye,___setErrNo:st,___syscall140:me,___syscall146:ot,___syscall54:se,___syscall6:Ve,___unlock:Re,_abort:Ge,_emscripten_get_heap_size:$e,_emscripten_memcpy_big:Ye,_emscripten_resize_heap:ep,abortOnCannotGrowMemory:Or,emscripten_realloc_buffer:la,flush_NO_FILESYSTEM:Ze,tempDoublePtr:Ai,DYNAMICTOP_PTR:_i},Y=l.asm(os,ss,ce),us=Y.__ZSt18uncaught_exceptionv;Y.__ZSt18uncaught_exceptionv=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),us.apply(null,arguments)};var ls=Y.___cxa_can_catch;Y.___cxa_can_catch=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ls.apply(null,arguments)};var ps=Y.___cxa_is_pointer_type;Y.___cxa_is_pointer_type=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ps.apply(null,arguments)};var cs=Y.___errno_location;Y.___errno_location=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),cs.apply(null,arguments)};var fs=Y._earcut;Y._earcut=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),fs.apply(null,arguments)};var hs=Y._fflush;Y._fflush=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),hs.apply(null,arguments)};var ds=Y._free;Y._free=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ds.apply(null,arguments)};var ys=Y._llvm_maxnum_f64;Y._llvm_maxnum_f64=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ys.apply(null,arguments)};var ms=Y._llvm_minnum_f64;Y._llvm_minnum_f64=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ms.apply(null,arguments)};var vs=Y._malloc;Y._malloc=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),vs.apply(null,arguments)};var gs=Y._sbrk;Y._sbrk=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),gs.apply(null,arguments)};var xs=Y.establishStackSpace;Y.establishStackSpace=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),xs.apply(null,arguments)};var bs=Y.stackAlloc;Y.stackAlloc=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),bs.apply(null,arguments)};var _s=Y.stackRestore;Y.stackRestore=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),_s.apply(null,arguments)};var ws=Y.stackSave;Y.stackSave=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ws.apply(null,arguments)},l.asm=Y;var vr=l.__ZSt18uncaught_exceptionv=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.__ZSt18uncaught_exceptionv.apply(null,arguments)};l.___cxa_can_catch=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.___cxa_can_catch.apply(null,arguments)},l.___cxa_is_pointer_type=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.___cxa_is_pointer_type.apply(null,arguments)},l.___errno_location=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.___errno_location.apply(null,arguments)},l._earcut=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._earcut.apply(null,arguments)},l._emscripten_replace_memory=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._emscripten_replace_memory.apply(null,arguments)},l._fflush=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._fflush.apply(null,arguments)},l._free=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._free.apply(null,arguments)},l._llvm_maxnum_f64=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._llvm_maxnum_f64.apply(null,arguments)},l._llvm_minnum_f64=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._llvm_minnum_f64.apply(null,arguments)};var Es=l._malloc=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._malloc.apply(null,arguments)};l._memcpy=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._memcpy.apply(null,arguments)},l._memset=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._memset.apply(null,arguments)},l._sbrk=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm._sbrk.apply(null,arguments)},l.establishStackSpace=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.establishStackSpace.apply(null,arguments)};var En=l.stackAlloc=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.stackAlloc.apply(null,arguments)},Ii=l.stackRestore=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.stackRestore.apply(null,arguments)},Tn=l.stackSave=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.stackSave.apply(null,arguments)};l.dynCall_ii=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_ii.apply(null,arguments)},l.dynCall_iidiiii=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_iidiiii.apply(null,arguments)},l.dynCall_iiii=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_iiii.apply(null,arguments)},l.dynCall_jiji=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_jiji.apply(null,arguments)},l.dynCall_v=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_v.apply(null,arguments)},l.dynCall_vi=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_vi.apply(null,arguments)},l.dynCall_vii=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_vii.apply(null,arguments)},l.dynCall_viiii=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_viiii.apply(null,arguments)},l.dynCall_viiiii=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_viiiii.apply(null,arguments)},l.dynCall_viiiiii=function(){return r(z,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),r(!R,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),l.asm.dynCall_viiiiii.apply(null,arguments)},l.asm=Y,l.intArrayFromString||(l.intArrayFromString=function(){w("'intArrayFromString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.intArrayToString||(l.intArrayToString=function(){w("'intArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.ccall=i,l.cwrap=a,l.setValue||(l.setValue=function(){w("'setValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.getValue=t,l.allocate||(l.allocate=function(){w("'allocate' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.getMemory||(l.getMemory=function(){w("'getMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.AsciiToString||(l.AsciiToString=function(){w("'AsciiToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stringToAscii||(l.stringToAscii=function(){w("'stringToAscii' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.UTF8ArrayToString||(l.UTF8ArrayToString=function(){w("'UTF8ArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.UTF8ToString||(l.UTF8ToString=function(){w("'UTF8ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stringToUTF8Array||(l.stringToUTF8Array=function(){w("'stringToUTF8Array' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stringToUTF8||(l.stringToUTF8=function(){w("'stringToUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.lengthBytesUTF8||(l.lengthBytesUTF8=function(){w("'lengthBytesUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.UTF16ToString||(l.UTF16ToString=function(){w("'UTF16ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stringToUTF16||(l.stringToUTF16=function(){w("'stringToUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.lengthBytesUTF16||(l.lengthBytesUTF16=function(){w("'lengthBytesUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.UTF32ToString||(l.UTF32ToString=function(){w("'UTF32ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stringToUTF32||(l.stringToUTF32=function(){w("'stringToUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.lengthBytesUTF32||(l.lengthBytesUTF32=function(){w("'lengthBytesUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.allocateUTF8||(l.allocateUTF8=function(){w("'allocateUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stackTrace||(l.stackTrace=function(){w("'stackTrace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.addOnPreRun||(l.addOnPreRun=function(){w("'addOnPreRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.addOnInit||(l.addOnInit=function(){w("'addOnInit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.addOnPreMain||(l.addOnPreMain=function(){w("'addOnPreMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.addOnExit||(l.addOnExit=function(){w("'addOnExit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.addOnPostRun||(l.addOnPostRun=function(){w("'addOnPostRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.writeStringToMemory||(l.writeStringToMemory=function(){w("'writeStringToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.writeArrayToMemory||(l.writeArrayToMemory=function(){w("'writeArrayToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.writeAsciiToMemory||(l.writeAsciiToMemory=function(){w("'writeAsciiToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.addRunDependency||(l.addRunDependency=function(){w("'addRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.removeRunDependency||(l.removeRunDependency=function(){w("'removeRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.ENV||(l.ENV=function(){w("'ENV' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.FS||(l.FS=function(){w("'FS' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.FS_createFolder||(l.FS_createFolder=function(){w("'FS_createFolder' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.FS_createPath||(l.FS_createPath=function(){w("'FS_createPath' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.FS_createDataFile||(l.FS_createDataFile=function(){w("'FS_createDataFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.FS_createPreloadedFile||(l.FS_createPreloadedFile=function(){w("'FS_createPreloadedFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.FS_createLazyFile||(l.FS_createLazyFile=function(){w("'FS_createLazyFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.FS_createLink||(l.FS_createLink=function(){w("'FS_createLink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.FS_createDevice||(l.FS_createDevice=function(){w("'FS_createDevice' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.FS_unlink||(l.FS_unlink=function(){w("'FS_unlink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),l.GL||(l.GL=function(){w("'GL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.dynamicAlloc||(l.dynamicAlloc=function(){w("'dynamicAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.warnOnce||(l.warnOnce=function(){w("'warnOnce' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.loadDynamicLibrary||(l.loadDynamicLibrary=function(){w("'loadDynamicLibrary' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.loadWebAssemblyModule||(l.loadWebAssemblyModule=function(){w("'loadWebAssemblyModule' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.getLEB||(l.getLEB=function(){w("'getLEB' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.getFunctionTables||(l.getFunctionTables=function(){w("'getFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.alignFunctionTables||(l.alignFunctionTables=function(){w("'alignFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.registerFunctions||(l.registerFunctions=function(){w("'registerFunctions' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.addFunction||(l.addFunction=function(){w("'addFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.removeFunction||(l.removeFunction=function(){w("'removeFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.getFuncWrapper||(l.getFuncWrapper=function(){w("'getFuncWrapper' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.prettyPrint||(l.prettyPrint=function(){w("'prettyPrint' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.makeBigInt||(l.makeBigInt=function(){w("'makeBigInt' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.dynCall||(l.dynCall=function(){w("'dynCall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.getCompilerSetting||(l.getCompilerSetting=function(){w("'getCompilerSetting' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stackSave||(l.stackSave=function(){w("'stackSave' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stackRestore||(l.stackRestore=function(){w("'stackRestore' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.stackAlloc||(l.stackAlloc=function(){w("'stackAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.establishStackSpace||(l.establishStackSpace=function(){w("'establishStackSpace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.print||(l.print=function(){w("'print' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.printErr||(l.printErr=function(){w("'printErr' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.getTempRet0||(l.getTempRet0=function(){w("'getTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.setTempRet0||(l.setTempRet0=function(){w("'setTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.Pointer_stringify||(l.Pointer_stringify=function(){w("'Pointer_stringify' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),l.ALLOC_NORMAL||Object.defineProperty(l,"ALLOC_NORMAL",{get:function(){w("'ALLOC_NORMAL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),l.ALLOC_STACK||Object.defineProperty(l,"ALLOC_STACK",{get:function(){w("'ALLOC_STACK' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),l.ALLOC_DYNAMIC||Object.defineProperty(l,"ALLOC_DYNAMIC",{get:function(){w("'ALLOC_DYNAMIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),l.ALLOC_NONE||Object.defineProperty(l,"ALLOC_NONE",{get:function(){w("'ALLOC_NONE' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Gr.prototype=new Error,Gr.prototype.constructor=Gr,mr=function y(){l.calledRun||Xn(),l.calledRun||(mr=y)},l.run=Xn;var Si=[];if(l.abort=w,l.preInit)for(typeof l.preInit=="function"&&(l.preInit=[l.preInit]);l.preInit.length>0;)l.preInit.pop()();l.noExitRuntime=!0,Xn()}else l=null;var Me=l,ki=!1;if(ne.defined(Me)){Me.onRuntimeInitialized=function(){ki=!0};var Ts=Me.cwrap("earcut","number",["number","number","number","number","number","number"])}var As=ve([{name:"a_pos",components:2,type:"Int16"}],4),Mi=As.members,Is=500,Be=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ur,this.indexArray=new Kt,this.indexArray2=new mn,this.programConfigurations=new et(Mi,e.layers,e.zoom),this.segments=new xe,this.segments2=new xe,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Be.prototype.populate=function(e,t){this.hasPattern=Go("fill",this.layers,t);for(var r=[],n=0,i=e;n<i.length;n+=1){var a=i[n],o=a.feature,s=a.index,u=a.sourceLayerIndex;if(this.layers[0]._featureFilter(new Se(0),o)){var p=cr(o),c={id:o.id,properties:o.properties,type:o.type,sourceLayerIndex:u,index:s,geometry:p,patterns:{},sortKey:void 0};r.push(c)}}for(var f=0,h=r;f<h.length;f+=1){var d=h[f],v=d,g=v.geometry,x=v.index,b=v.sourceLayerIndex;if(this.hasPattern){var _=si("fill",this.layers,d,this.zoom,t);this.patternFeatures.push(_)}else this.addFeature(d,g,x,{},t.indexData);var S=e[x].feature;t.featureIndex.insert(S,g,x,b,this.index)}},Be.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Be.prototype.addFeatures=function(e,t){for(var r=0,n=this.patternFeatures;r<n.length;r+=1){var i=n[r];this.addFeature(i,i.geometry,i.index,t)}},Be.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Be.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Be.prototype.upload=function(e){if(!this.uploaded){if(this.layoutVertexArray==null)return;this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Mi),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)}this.programConfigurations.upload(e),this.uploaded=!0},Be.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Be.prototype.clear=function(){ne.defined(this.layoutVertexArray)&&(this.layoutVertexArray=null),ne.defined(this.indexArray)&&(this.indexArray=null),ne.defined(this.indexArray2)&&(this.indexArray2=null)},Be.prototype.addFeature=function(e,t,r,n,i){for(var a=0,o=Jo(t,Is);a<o.length;a+=1){for(var s=o[a],u=0,p=0,c=s;p<c.length;p+=1)u+=c[p].length;for(var f,h=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray),d=h.vertexLength,v=[],g=[],x=0,b=s;x<b.length;x+=1){var _=b[x];if(_.length!==0){_!==s[0]&&g.push(v.length/2);var S=this.segments2.prepareSegment(_.length,this.layoutVertexArray,this.indexArray2),A=S.vertexLength;this.layoutVertexArray.emplaceBack(_[0].x,_[0].y),this.indexArray2.emplaceBack(A+_.length-1,A),v.push(_[0].x),v.push(_[0].y);for(var O=1;O<_.length;O++)this.layoutVertexArray.emplaceBack(_[O].x,_[O].y),this.indexArray2.emplaceBack(A+O-1,A+O),v.push(_[O].x),v.push(_[O].y);S.vertexLength+=_.length,S.primitiveLength+=_.length}}if(ne.defined(i)&&ne.defined(i[e.id]))f=i[e.id];else if(ki===!0){var L=new Int32Array(v),F=L.length,B=Me._malloc(Int32Array.BYTES_PER_ELEMENT*F);Me.HEAP32.set(L,B/Int32Array.BYTES_PER_ELEMENT);var W=new Int32Array(g),H=W.length,G=Me._malloc(Int32Array.BYTES_PER_ELEMENT*H);Me.HEAP32.set(W,G/Int32Array.BYTES_PER_ELEMENT);var oe=new Int32Array(10*F),he=Me._malloc(Int32Array.BYTES_PER_ELEMENT*F*10);Me.HEAP32.set(oe,he/Int32Array.BYTES_PER_ELEMENT);var D=Ts(B,F,G,H,2,he),ye=new Int32Array(Me.HEAP32.buffer,he,D);f=new Int32Array(ye),Me._free(B),Me._free(G),Me._free(he)}else f=fa.earcut(v,g);for(var me=0;me<f.length;me+=3)this.indexArray.emplaceBack(d+f[me],d+f[me+1],d+f[me+2]);h.vertexLength+=u,h.primitiveLength+=f.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,n)},k.register("FillBucket",Be,{omit:["layers","patternFeatures"]});var Ss=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ks=128,Ms=5,bt=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};bt.serialize=function(e,t){return e.isTransferred&&console.log("StructArray array.isTransferred."),e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},bt.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},bt.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},bt.prototype.clear=function(){this.length=0},bt.prototype.resize=function(e){this.reserve(e),this.length=e},bt.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*Ms),ks),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},bt.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Oi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i)},t.prototype.emplace=function(r,n,i,a){var o=2*r,s=4*r;return this.uint32[o+0]=n,this.uint16[s+2]=i,this.uint16[s+3]=a,r},t}(bt);Oi.prototype.bytesPerElement=8;var zi=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.featureIndex.set=function(n){this._structArray.uint32[this._pos4+0]=n},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.sourceLayerIndex.set=function(n){this._structArray.uint16[this._pos2+2]=n},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},r.bucketIndex.set=function(n){this._structArray.uint16[this._pos2+3]=n},Object.defineProperties(t.prototype,r),t}(Ss);zi.prototype.size=8;var Ri=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(r){return new zi(this,r)},t}(Oi);k.register("FeatureIndexArray",Ri,{omit:["layers","patternFeatures"]});var Os={FeatureIndexArray:Ri};function nt(e,t){this.x=e,this.y=t}function $t(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(zs,this,t)}function zs(e,t,r){e==1?t.id=r.readVarint():e==2?Rs(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function Rs(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}function Ps(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],a=0;a<t;a++){var o=Fs(e[a]);o!==0&&(n===void 0&&(n=o<0),n===o<0?(r&&i.push(r),r=[e[a]]):r.push(e[a]))}return r&&i.push(r),i}function Fs(e){for(var t,r,n=0,i=0,a=e.length,o=a-1;i<a;o=i++)t=e[i],n+=((r=e[o]).x-t.x)*(t.y+r.y);return n}function Pi(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Cs,this,t),this.length=this._features.length}function Cs(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(Ds(r))}function Ds(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return t}function Fi(e,t){this.layers=e.readFields(Us,{},t)}function Us(e,t,r){if(e===3){var n=new Pi(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}nt.prototype={clone:function(){return new nt(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),a=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},nt.convert=function(e){return e instanceof nt?e:Array.isArray(e)?new nt(e[0],e[1]):e},$t.types=["Unknown","Point","LineString","Polygon"],$t.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,a=0,o=0,s=[];e.pos<r;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}i--,n===1||n===2?(a+=e.readSVarint(),o+=e.readSVarint(),n===1&&(t&&s.push(t),t=[]),t.push(new nt(a,o))):n===7?t&&t.push(t[0].clone()):console.log("VectorTileFeature loadGeometry unknown command "+n)}return t&&s.push(t),s},$t.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,a=0,o=1/0,s=-1/0,u=1/0,p=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=7&c,n=c>>3}if(n--,r===1||r===2)(i+=e.readSVarint())<o&&(o=i),i>s&&(s=i),(a+=e.readSVarint())<u&&(u=a),a>p&&(p=a);else if(r!==7)throw new Error("unknown command "+r)}return[o,u,s,p]},$t.prototype.toGeoJSON=function(e,t,r){var n,i,a=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*t,u=this.loadGeometry(),p=$t.types[this.type];function c(d){for(var v=0;v<d.length;v++){var g=d[v],x=180-360*(g.y+s)/a;d[v]=[360*(g.x+o)/a-180,360/Math.PI*Math.atan(Math.exp(x*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(n=0;n<u.length;n++)f[n]=u[n][0];c(u=f);break;case 2:for(n=0;n<u.length;n++)c(u[n]);break;case 3:for(u=Ps(u),n=0;n<u.length;n++)for(i=0;i<u[n].length;i++)c(u[n][i])}u.length===1?u=u[0]:p="Multi"+p;var h={type:"Feature",geometry:{type:p,coordinates:u},properties:this.properties};return"id"in this&&(h.id=this.id),h},Pi.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new $t(this._pbf,t,this.extent,this._keys,this._values)};var _t=3;function He(e,t,r){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var i=new Int32Array(this.arrayBuffer);e=i[0],t=i[1],r=i[2],this.d=t+2*r;for(var a=0;a<this.d*this.d;a++){var o=i[_t+a],s=i[_t+a+1];n.push(o===s?null:i.subarray(o,s))}var u=i[_t+n.length],p=i[_t+n.length+1];this.keys=i.subarray(u,p),this.bboxes=i.subarray(p),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var f=r/t*e;this.min=-f,this.max=e+f}function X(){}He.prototype.insert=function(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},He.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},He.prototype._insertCell=function(e,t,r,n,i,a){this.cells[i].push(a)},He.prototype.query=function(e,t,r,n,i){var a=this.min,o=this.max;if(e<=a&&t<=a&&o<=r&&o<=n&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,r,n,this._queryCell,s,{},i),s},He.prototype._queryCell=function(e,t,r,n,i,a,o,s){var u=this.cells[i];if(u!==null)for(var p=this.keys,c=this.bboxes,f=0;f<u.length;f++){var h=u[f];if(o[h]===void 0){var d=4*h;(s?s(c[d+0],c[d+1],c[d+2],c[d+3]):e<=c[d+2]&&t<=c[d+3]&&r>=c[d+0]&&n>=c[d+1])?(o[h]=!0,a.push(p[h])):o[h]=!1}}},He.prototype._forEachCell=function(e,t,r,n,i,a,o,s){for(var u=this._convertToCellCoord(e),p=this._convertToCellCoord(t),c=this._convertToCellCoord(r),f=this._convertToCellCoord(n),h=u;h<=c;h++)for(var d=p;d<=f;d++){var v=this.d*d+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&i.call(this,e,t,r,n,v,a,o,s))return}},He.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},He.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},He.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=_t+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var i=new Int32Array(t+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var a=t,o=0;o<e.length;o++){var s=e[o];i[_t+o]=a,i.set(s,a),a+=s.length}return i[_t+e.length]=a,i.set(this.keys,a),a+=this.keys.length,i[_t+e.length+1]=a,i.set(this.bboxes,a),a+=this.bboxes.length,i.buffer},k.register("GridIndex",He,{omit:["layers","patternFeatures"]}),X.easeCubicInOut=function(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)},X.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var n=e.length,i=new Array(e.length),a=null;e.forEach(function(o,s){t(o,function(u,p){u&&(a=u),i[s]=p,--n==0&&r(a,i)})})},X.extend=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var n=0,i=t;n<i.length;n+=1){var a=i[n];for(var o in a)e[o]=a[o]}return e};var Bs=1;X.uniqueId=function(){return Bs++},X.uuid=function(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()},X.validateUuid=function(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},X.bindAll=function(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})},X.endsWith=function(e,t){return e.indexOf(t,e.length-t.length)!==-1},X.mapObject=function(e,t,r){var n={};for(var i in e)n[i]=t.call(r||this,e[i],i,e);return n},X.filterObject=function(e,t,r){var n={};for(var i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n},X.clone=function(e){return Array.isArray(e)?e.map(X.clone):typeof e=="object"&&e?X.mapObject(e,X.clone):e},X.deepEqual=function(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!X.deepEqual(e[r],t[r]))return!1;return!0}if(typeof e=="object"&&e!==null&&t!==null){if(typeof t!="object"||Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(!X.deepEqual(e[n],t[n]))return!1;return!0}return e===t},X.arraysIntersect=function(e,t){for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1},X.isCounterClockwise=function(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)},X.isWorker=function(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope};var An=null;X.isSafari=function(e){if(An==null){var t=e.navigator?e.navigator.userAgent:null;An=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return An},X.resolveTokens=function(e,t){return t.replace(/{([^{}]+)}/g,function(r,n){return n in e?String(e[n]):""})};var gr=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var r=0,n=t;r<n.length;r+=1){var i=n[r],a=i[0],o=i[1];this.bindings[a]=o}};gr.prototype.concat=function(e){return new gr(this,e)},gr.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},gr.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var We=function(e){function t(r,n){e.call(this,n),this.message=n,this.key=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),Vs=["Unknown","Point","LineString","Polygon"],Nt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null};function Ke(){}Nt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Nt.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Vs[this.feature.type]:this.feature.type:null},Nt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Nt.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Color.parse(e)),t},k.register("EvaluationContext",Nt),Ke.isFeatureConstant=function(e){if(e instanceof we.CompoundExpression&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name)))return!1;var t=!0;return e.eachChild(function(r){t&&!Ke.isFeatureConstant(r)&&(t=!1)}),t},Ke.isStateConstant=function(e){if(e instanceof we.CompoundExpression&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!Ke.isStateConstant(r)&&(t=!1)}),t},Ke.isGlobalPropertyConstant=function(e,t){if(e instanceof we.CompoundExpression&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(n){r&&!Ke.isGlobalPropertyConstant(n,t)&&(r=!1)}),r};var we=function(e,t,r,n,i){t===void 0&&(t=[]),n===void 0&&(n=new gr),i===void 0&&(i=[]),this.registry=e,this.path=t,this.key=t.map(function(a){return"["+a+"]"}).join(""),this.scope=n,this.errors=i,this.expectedType=r};function In(e,t){const r=t[e];return r===void 0?null:r}we.prototype.parse=function(e,t,r,n,i){return i===void 0&&(i={}),t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)},we.prototype._parse=function(e,t){function r(u,p,c){return c==="assert"?new ge(p,[u]):c==="coerce"?new Le(p,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=e[0];if(typeof n!="string")return this.error("Expression name must be a string, but found "+typeof n+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[n];if(i){var a=i.parse(e,this);if(!a)return null;if(this.expectedType){var o=this.expectedType,s=a.type;if(o.kind!=="string"&&o.kind!=="number"&&o.kind!=="boolean"&&o.kind!=="object"&&o.kind!=="array"||s.kind!=="value")if(o.kind!=="color"&&o.kind!=="formatted"&&o.kind!=="resolvedImage"||s.kind!=="value"&&s.kind!=="string"){if(this.checkSubtype(o,s))return null}else a=r(a,o,t.typeAnnotation||"coerce");else a=r(a,o,t.typeAnnotation||"assert")}return!(a instanceof Ne)&&a.type.kind,a}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return e===void 0?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof e+" instead.")},we.prototype.concat=function(e,t,r){var n=typeof e=="number"?this.path.concat(e):this.path,i=r?this.scope.concat(r):this.scope;return new we(this.registry,n,t||null,i,this.errors)},we.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var n=""+this.key+t.map(function(i){return"["+i+"]"}).join("");this.errors.push(new We(n,e))},we.prototype.checkSubtype=function(e,t){var r=ur(e,t);return r&&this.error(r),r};var Oe=function(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n};function Ls(e){return Array.isArray(e)?"("+e.map(toString).join(", ")+")":"("+toString(e.type)+"...)"}Oe.prototype.evaluate=function(e,t){return this._evaluate(e,this.args,t)},Oe.prototype.eachChild=function(e){this.args.forEach(e)},Oe.prototype.possibleOutputs=function(){return[void 0]},Oe.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Oe.parse=function(e,t){var r,n=e[0],i=Oe.definitions[n];if(!i)return t.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var a=Array.isArray(i)?i[0]:i.type,o=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=o.filter(function(G){var oe=G[0];return!Array.isArray(oe)||oe.length===e.length-1}),u=null,p=0,c=s;p<c.length;p+=1){var f=c[p],h=f[0],d=f[1];u=new we(t.registry,t.path,null,t.scope);for(var v=[],g=!1,x=1;x<e.length;x++){var b=e[x],_=Array.isArray(h)?h[x-1]:h.type,S=u.parse(b,1+v.length,_);if(!S){g=!0;break}v.push(S)}if(!g)if(Array.isArray(h)&&h.length!==v.length)u.error("Expected "+h.length+" arguments, but found "+v.length+" instead.");else{for(var A=0;A<v.length;A++){var O=Array.isArray(h)?h[A]:h.type,L=v[A];u.concat(A+1).checkSubtype(O,L.type)}if(u.errors.length===0)return new Oe(n,a,d,v)}}if(s.length===1)(r=t.errors).push.apply(r,u.errors);else{for(var F=(s.length?s:o).map(function(G){return Ls(G[0])}).join(" | "),B=[],W=1;W<e.length;W++){var H=t.parse(e[W],1+B.length);if(!H)return null;B.push(toString(H.type))}t.error("Expected arguments of type "+F+", but found ("+B.join(", ")+") instead.")}return null},Oe.register=function(e,t){for(var r in Oe.definitions=t,t)e[r]=Oe},k.register("CompoundExpression",Oe);var I={kind:"number"},K={kind:"string"},j={kind:"boolean"},Sn={kind:"color"},kn={kind:"object"},ae={kind:"value"},Xs={kind:"error"},qs={kind:"collator"};function xr(e,t){return{kind:"array",itemType:e,N:t}}function wt(e){return{type:e}}function Ci(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];r=r.evaluate(e),n=n.evaluate(e),i=i.evaluate(e);var o=a?a.evaluate(e):1,s=Values.validateRGBA(r,n,i,o);if(s)throw new RuntimeError(s);return new Color(r/255*o,n/255*o,i/255*o,o)}Oe.register(Dt,{error:[Xs,[K],function(e,t){var r=t[0];throw new RuntimeError(r.evaluate(e))}],typeof:[K,[ae],function(e,t){var r=t[0];return toString(Values.typeOf(r.evaluate(e)))}],"to-rgba":[xr(I,4),[Sn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Sn,[I,I,I],Ci],rgba:[Sn,[I,I,I,I],Ci],has:{type:j,overloads:[[[K],function(e,t){var r=t[0];return has(r.evaluate(e),e.properties())}],[[K,kn],function(e,t){var r=t[0],n=t[1];return has(r.evaluate(e),n.evaluate(e))}]]},get:{type:ae,overloads:[[[K],function(e,t){return In(t[0].evaluate(e),e.properties())}],[[K,kn],function(e,t){var r=t[0],n=t[1];return In(r.evaluate(e),n.evaluate(e))}]]},"feature-state":[ae,[K],function(e,t){return In(t[0].evaluate(e),e.featureState||{})}],properties:[kn,[],function(e){return e.properties()}],"geometry-type":[K,[],function(e){return e.geometryType()}],id:[ae,[],function(e){return e.id()}],zoom:[I,[],function(e){return e.globals.zoom}],"heatmap-density":[I,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[I,[],function(e){return e.globals.lineProgress||0}],accumulated:[ae,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[I,wt(I),function(e,t){for(var r=0,n=0,i=t;n<i.length;n+=1)r+=i[n].evaluate(e);return r}],"*":[I,wt(I),function(e,t){for(var r=1,n=0,i=t;n<i.length;n+=1)r*=i[n].evaluate(e);return r}],"-":{type:I,overloads:[[[I,I],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)-n.evaluate(e)}],[[I],function(e,t){return-t[0].evaluate(e)}]]},"/":[I,[I,I],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)/n.evaluate(e)}],"%":[I,[I,I],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)%n.evaluate(e)}],ln2:[I,[],function(){return Math.LN2}],pi:[I,[],function(){return Math.PI}],e:[I,[],function(){return Math.E}],"^":[I,[I,I],function(e,t){var r=t[0],n=t[1];return Math.pow(r.evaluate(e),n.evaluate(e))}],sqrt:[I,[I],function(e,t){var r=t[0];return Math.sqrt(r.evaluate(e))}],log10:[I,[I],function(e,t){var r=t[0];return Math.log(r.evaluate(e))/Math.LN10}],ln:[I,[I],function(e,t){var r=t[0];return Math.log(r.evaluate(e))}],log2:[I,[I],function(e,t){var r=t[0];return Math.log(r.evaluate(e))/Math.LN2}],sin:[I,[I],function(e,t){var r=t[0];return Math.sin(r.evaluate(e))}],cos:[I,[I],function(e,t){var r=t[0];return Math.cos(r.evaluate(e))}],tan:[I,[I],function(e,t){var r=t[0];return Math.tan(r.evaluate(e))}],asin:[I,[I],function(e,t){var r=t[0];return Math.asin(r.evaluate(e))}],acos:[I,[I],function(e,t){var r=t[0];return Math.acos(r.evaluate(e))}],atan:[I,[I],function(e,t){var r=t[0];return Math.atan(r.evaluate(e))}],min:[I,wt(I),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[I,wt(I),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[I,[I],function(e,t){var r=t[0];return Math.abs(r.evaluate(e))}],round:[I,[I],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[I,[I],function(e,t){var r=t[0];return Math.floor(r.evaluate(e))}],ceil:[I,[I],function(e,t){var r=t[0];return Math.ceil(r.evaluate(e))}],"filter-==":[j,[K,ae],function(e,t,r){var n=t[0],i=t[1];if(r){var a,o,s=n.value,u=i.value;if(/(\S*)\s*([+-])\s*(\S*)/.test(s)){var p=s.match(/(\S*)\s*([+-])\s*(\S*)/),c=e.properties()[p[1]],f=p[2],h=e.properties()[p[3]];switch(f){case"+":a=c+h;break;case"-":a=c-h}return a===(o=i.value)}if(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(s)){var d=s.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),v=d[1],g=(c=e.properties()[d[2]],d[3]);if(a=v=="left"?c.substring(0,g):c.substring(c.length-g),/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(u)){var x=u.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),b=x[1],_=(h=e.properties()[x[2]],x[3]);o=b=="left"?h.substring(0,_):h.substring(h.length-_)}else o=i.value;return a===o}return e.properties()[n.value]===e.properties()[i.value]}return e.properties()[n.value]===i.value}],"filter-id-==":[j,[ae],function(e,t){var r=t[0];return e.id()===r.value}],"filter-like":[j,[K,K],function(e,t){var r=t[0].value,n=t[1].value,i=e.properties();return r in i&&(/^%.*[^%]$/.test(n)?(n=n.replace("%",""),i[r].endsWith(n)):/^(?!%).+%$/.test(n)?(n=n.replace("%",""),i[r].startsWith(n)):(n=n.replace(/%/g,""),i[r].indexOf(n)>-1))}],"filter-type-==":[j,[K],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[j,[K,ae],function(e,t,r){var n,i,a=t[0],o=t[1],s=a.value,u=o.value;if(/(\S*)\s*([+-])\s*(\S*)/.test(s)){var p=s.match(/(\S*)\s*([+-])\s*(\S*)/),c=e.properties()[p[1]],f=p[2],h=e.properties()[p[3]];switch(f){case"+":n=c+h;break;case"-":n=c-h}i=o.value}else if(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(s)){var d=s.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),v=d[1],g=(c=e.properties()[d[2]],d[3]);if(n=v=="left"?c.substring(0,g):c.substring(c.length-g),/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(u)){var x=u.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),b=x[1],_=(h=e.properties()[x[2]],x[3]);i=b=="left"?h.substring(0,_):h.substring(h.length-_)}else i=o.value}else n=e.properties()[a.value],i=o.value,r&&(i=e.properties()[i]);return typeof i!="number"||isNaN(Number(n))||(n=Number(n)),typeof n==typeof i&&n<i}],"filter-id-<":[j,[ae],function(e,t){var r=t[0],n=e.id(),i=r.value;return typeof n==typeof i&&n<i}],"filter->":[j,[K,ae],function(e,t,r){var n,i,a=t[0],o=t[1],s=a.value,u=o.value;if(/(\S*)\s*([+-])\s*(\S*)/.test(s)){var p=s.match(/(\S*)\s*([+-])\s*(\S*)/),c=e.properties()[p[1]],f=p[2],h=e.properties()[p[3]];switch(f){case"+":n=c+h;break;case"-":n=c-h}i=o.value}else if(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(s)){var d=s.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),v=d[1],g=(c=e.properties()[d[2]],d[3]);if(n=v=="left"?c.substring(0,g):c.substring(c.length-g),/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(u)){var x=u.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),b=x[1],_=(h=e.properties()[x[2]],x[3]);i=b=="left"?h.substring(0,_):h.substring(h.length-_)}else i=o.value}else n=e.properties()[a.value],i=o.value,r&&(i=e.properties()[i]);return typeof i!="number"||isNaN(Number(n))||(n=Number(n)),typeof n==typeof i&&n>i}],"filter-id->":[j,[ae],function(e,t){var r=t[0],n=e.id(),i=r.value;return typeof n==typeof i&&n>i}],"filter-<=":[j,[K,ae],function(e,t,r){var n,i,a=t[0],o=t[1],s=a.value,u=o.value;if(/(\S*)\s*([+-])\s*(\S*)/.test(s)){var p=s.match(/(\S*)\s*([+-])\s*(\S*)/),c=e.properties()[p[1]],f=p[2],h=e.properties()[p[3]];switch(f){case"+":n=c+h;break;case"-":n=c-h}i=o.value}else if(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(s)){var d=s.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),v=d[1],g=(c=e.properties()[d[2]],d[3]);if(n=v=="left"?c.substring(0,g):c.substring(c.length-g),/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(u)){var x=u.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),b=x[1],_=(h=e.properties()[x[2]],x[3]);i=b=="left"?h.substring(0,_):h.substring(h.length-_)}else i=o.value}else n=e.properties()[a.value],i=o.value,r&&(i=e.properties()[i]);return typeof i!="number"||isNaN(Number(n))||(n=Number(n)),typeof n==typeof i&&n<=i}],"filter-id-<=":[j,[ae],function(e,t){var r=t[0],n=e.id(),i=r.value;return typeof n==typeof i&&n<=i}],"filter->=":[j,[K,ae],function(e,t,r){var n,i,a=t[0],o=t[1],s=a.value,u=o.value;if(/(\S*)\s*([+-])\s*(\S*)/.test(s)){var p=s.match(/(\S*)\s*([+-])\s*(\S*)/),c=e.properties()[p[1]],f=p[2],h=e.properties()[p[3]];switch(f){case"+":n=c+h;break;case"-":n=c-h}i=o.value}else if(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(s)){var d=s.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),v=d[1],g=(c=e.properties()[d[2]],d[3]);if(n=v=="left"?c.substring(0,g):c.substring(c.length-g),/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/.test(u)){var x=u.match(/^(left|right)\s*\((.+)\s*,\s*(\d+)\)/),b=x[1],_=(h=e.properties()[x[2]],x[3]);i=b=="left"?h.substring(0,_):h.substring(h.length-_)}else i=o.value}else n=e.properties()[a.value],i=o.value,r&&(i=e.properties()[i]);return typeof i!="number"||isNaN(Number(n))||(n=Number(n)),typeof n==typeof i&&n>=i}],"filter-id->=":[j,[ae],function(e,t){var r=t[0],n=e.id(),i=r.value;return typeof n==typeof i&&n>=i}],"filter-has":[j,[ae],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[j,[],function(e){return e.id()!==null}],"filter-type-in":[j,[xr(K)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[j,[xr(ae)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[j,[K,xr(ae)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[j,[K,xr(ae)],function(e,t){var r=t[0],n=t[1];return binarySearch(e.properties()[r.value],n.value,0,n.value.length-1)}],all:{type:j,overloads:[[[j,j],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)&&n.evaluate(e)}],[wt(j),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(!n[r].evaluate(e))return!1;return!0}]]},crossFields:{type:j,overloads:[[[j,j],function(e,t){var r=t[0],n=t[1];return r.evaluate(e,!0)&&n.evaluate(e,!0)}],[wt(j),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(!n[r].evaluate(e,!0))return!1;return!0}]]},any:{type:j,overloads:[[[j,j],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)||n.evaluate(e)}],[wt(j),function(e,t){for(var r=0,n=t;r<n.length;r+=1)if(n[r].evaluate(e))return!0;return!1}]]},"!":[j,[j],function(e,t,r){return!t[0].evaluate(e,r)}],"is-supported-script":[j,[K],function(e,t){var r=t[0],n=e.globals&&e.globals.isSupportedScript;return!n||n(r.evaluate(e))}],upcase:[K,[K],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[K,[K],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[K,wt(ae),function(e,t){return t.map(function(r){return Values.toString$1(r.evaluate(e))}).join("")}],"resolved-locale":[K,[qs],function(e,t){return t[0].evaluate(e).resolvedLocale()}]}),we.CompoundExpression=Oe;var br=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Nt,this._defaultValue=t?Hs(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function js(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Hs(e){return e.type==="color"&&js(e.default)?new Color(0,0,0,0):e.type==="color"?Color.parse(e.default)||null:e.default===void 0?null:e.default}br.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,i){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=i,this.expression.evaluate(this._evaluator)},br.prototype.evaluate=function(e,t,r,n,i){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=i||null;try{var a=this.expression.evaluate(this._evaluator);if(a==null||typeof a=="number"&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new RuntimeError("Expected value to be one of "+Object.keys(this._enumValues).map(function(o){return JSON.stringify(o)}).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(o){return this._warningHistory[o.message]||(this._warningHistory[o.message]=!0,typeof console<"u"&&console.warn(o.message)),this._defaultValue}},k.register("StyleExpression",br);var Di=.95047,Ui=1,Bi=1.08883,Vi=4/29,er=6/29,Li=3*er*er,Ys=er*er*er,Qs=Math.PI/180,Ws=180/Math.PI;function Mn(e){return e>Ys?Math.pow(e,1/3):e/Li+Vi}function On(e){return e>er?e*e*e:Li*(e-Vi)}function zn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Rn(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Xi(e){var t=Rn(e.r),r=Rn(e.g),n=Rn(e.b),i=Mn((.4124564*t+.3575761*r+.1804375*n)/Di),a=Mn((.2126729*t+.7151522*r+.072175*n)/Ui);return{l:116*a-16,a:500*(i-a),b:200*(a-Mn((.0193339*t+.119192*r+.9503041*n)/Bi)),alpha:e.a}}function qi(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=Ui*On(t),r=Di*On(r),n=Bi*On(n),new Color(zn(3.2404542*r-1.5371385*t-.4985314*n),zn(-.969266*r+1.8760108*t+.041556*n),zn(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}function Ks(e,t,r){return{l:number(e.l,t.l,r),a:number(e.a,t.a,r),b:number(e.b,t.b,r),alpha:number(e.alpha,t.alpha,r)}}function Js(e){var t=Xi(e),r=t.l,n=t.a,i=t.b,a=Math.atan2(i,n)*Ws;return{h:a<0?a+360:a,c:Math.sqrt(n*n+i*i),l:r,alpha:e.a}}function Zs(e){var t=e.h*Qs,r=e.c;return qi({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})}function Gs(e,t,r){var n=t-e;return e+r*(n>180||n<-180?n-360*Math.round(n/360):n)}function $s(e,t,r){return{h:Gs(e.h,t.h,r),c:number(e.c,t.c,r),l:number(e.l,t.l,r),alpha:number(e.alpha,t.alpha,r)}}var Ns={forward:Xi,reverse:qi,interpolate:Ks},eu={forward:Js,reverse:Zs,interpolate:$s},ji=Object.freeze({__proto__:null,lab:Ns,hcl:eu});function jt(){}function Vr(e){return{result:"success",value:e}}function Ht(e){return{result:"error",value:e}}jt.isExpression=function(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Dt};var tu={kind:"number"},Hi={kind:"string"},ru={kind:"boolean"},nu={kind:"color"},iu={kind:"value"},au={kind:"formatted"},ou={kind:"resolvedImage"};function su(e,t){return{kind:"array",itemType:e,N:t}}function Lr(e){var t=null;if(e instanceof pt)t=Lr(e.result);else if(e instanceof ut){for(var r of e.args)if(t=Lr(r))break}else(e instanceof ct||e instanceof le)&&e.input instanceof we.CompoundExpression&&e.input.name==="zoom"&&(t=e);return t instanceof We||e.eachChild(n=>{var i=Lr(n);i instanceof We?t=i:!t&&i?t=new We("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&i&&t!==i&&(t=new We("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Yi(e){var t={color:nu,string:Hi,number:tu,enum:Hi,boolean:ru,formatted:au,resolvedImage:ou};return e.type==="array"?su(t[e.value]||iu,e.length):t[e.type]}function uu(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function lu(e){return e}function Qi(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var n=0,i=t;n<i.length;n+=1){var a=i[n];for(var o in a)e[o]=a[o]}return e}function Wi(e,t,r){var n=e.base!==void 0?e.base:1;if(Ji(r)!=="number")return Pn(e.default,t.default);var i=e.stops.length;if(i===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];var a=ri(e.stops.map(f=>f[0]),r),o=hu(r,n,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],u=e.stops[a+1][1],p=interpolate[t.type]||lu;if(e.colorSpace&&e.colorSpace!=="rgb"){var c=ji[e.colorSpace];p=(f,h)=>c.reverse(c.interpolate(c.forward(f),c.forward(h),o))}return typeof s.evaluate=="function"?{evaluate(...f){var h=s.evaluate.apply(void 0,f),d=u.evaluate.apply(void 0,f);if(h!==void 0&&d!==void 0)return p(h,d,o)}}:p(s,u,o)}function pu(e,t,r){return t.type==="color"?r=N.parse(r):t.type==="formatted"?r=Formatted.fromString(r.toString()):t.type==="resolvedImage"?r=ResolvedImage.fromString(r.toString()):Ji(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Pn(r,e.default,t.default)}function cu(e,t){var r=new we(Dt,[],t?Yi(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?Vr(new br(n,t)):(assert(r.errors.length>0),Ht(r.errors))}function Xr(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!Ke.isStateConstant(t.expression)}function _r(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!Ke.isStateConstant(t.expression),this.interpolationType=n}function fu(e,t){if((e=cu(e,t)).result==="error")return e;var r=e.value.expression,n=Ke.isFeatureConstant(r);if(!n&&!ht.supportsPropertyExpression(t))return Ht([new We("","data expressions not supported")]);var i=Ke.isGlobalPropertyConstant(r,["zoom"]);if(!i&&!ht.supportsZoomExpression(t))return Ht([new We("","zoom expressions not supported")]);var a=Lr(r);if(!a&&!i)return Ht([new We("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof We)return Ht([a]);if(a instanceof le&&!ht.supportsInterpolation(t))return Ht([new We("",'"interpolate" expressions cannot be used with this property')]);if(!a)return Vr(new Xr(n?"constant":"source",e.value));var o=a instanceof le?a.interpolation:void 0;return Vr(new _r(n?"camera":"composite",e.value,a.labels,o))}function Ki(e,t){var r,n,i,a=t.type==="color",o=e.stops&&typeof e.stops[0][0]=="object",s=o||e.property!==void 0,u=o||!s,p=e.type||(ht.supportsInterpolation(t)?"exponential":"interval");if(a&&((e=Qi({},e)).stops&&(e.stops=e.stops.map(function(B){return[B[0],N.parse(B[1])]})),e.default?e.default=N.parse(e.default):e.default=N.parse(t.default)),e.colorSpace&&e.colorSpace!=="rgb"&&!ji[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if(p==="exponential")r=Wi;else if(p==="interval")r=evaluateIntervalFunction;else if(p==="categorical"){r=evaluateCategoricalFunction,n=Object.create(null);for(var c=0,f=e.stops;c<f.length;c+=1){var h=f[c];n[h[0]]=h[1]}i=typeof e.stops[0][0]}else{if(p!=="identity")throw new Error('Unknown function type "'+p+'"');r=pu}if(o){for(var d={},v=[],g=0;g<e.stops.length;g++){var x=e.stops[g],b=x[0].zoom;d[b]===void 0&&(d[b]={zoom:b,type:e.type,property:e.property,default:e.default,stops:[]},v.push(b)),d[b].stops.push([x[0].value,x[1]])}for(var _=[],S=0,A=v;S<A.length;S+=1){var O=A[S];_.push([d[O].zoom,Ki(d[O],t)])}var L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:le.interpolationFactor.bind(void 0,L),zoomStops:_.map(function(B){return B[0]}),evaluate:function(B,W){var H=B.zoom;return Wi({stops:_,base:e.base},t,H).evaluate(H,W)}}}if(u){var F=p==="exponential"?{name:"exponential",base:e.base!==void 0?e.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:le.interpolationFactor.bind(void 0,F),zoomStops:e.stops.map(function(B){return B[0]}),evaluate:function(B){var W=B.zoom;return r(e,t,W,n,i)}}}return{kind:"source",evaluate:function(B,W){var H=W&&W.properties?W.properties[e.property]:void 0;return H===void 0?Pn(e.default,t.default):r(e,t,H,n,i)}}}function Pn(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function hu(e,t,r,n){var i=n-r,a=e-r;return i===0?0:t===1?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}jt.createExpression=function(e,t){var r=new we(Dt,[],t?Yi(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?Vr(new br(n,t)):Ht(r.errors)},Xr.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,i,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,a)},Xr.prototype.evaluate=function(e,t,r,n,i,a){return this._styleExpression.evaluate(e,t,r,n,i,a)},k.register("ZoomConstantExpression",Xr),_r.prototype.evaluateWithoutErrorHandling=function(e,t,r,n,i,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,a)},_r.prototype.evaluate=function(e,t,r,n,i,a){return this._styleExpression.evaluate(e,t,r,n,i,a)},_r.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?le.interpolationFactor(this.interpolationType,e,t,r):0},k.register("ZoomDependentExpression",_r);var qr=function(e,t){this._parameters=e,this._specification=t,Qi(this,Ki(this._parameters,this._specification))};function Ji(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function tr(){}qr.deserialize=function(e){return new qr(e._parameters,e._specification)},qr.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}},jt.normalizePropertyExpression=function(e,t){if(uu(e))return new qr(e,t);if(jt.isExpression(e)){var r=fu(e,t);if(r.result==="error")throw new Error(r.value.map(function(i){return i.key+": "+i.message}).join(", "));return r.value}var n=e;return typeof e=="string"&&t.type==="color"&&(n=N.parse(e)),{kind:"constant",evaluate:function(){return n}}},tr.isExpressionFilter=function(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&Array.isArray(e[2]);case"!in":case"!has":case"none":case"crossFields":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":case"like":case"!like":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var n=r[t];if(!tr.isExpressionFilter(n)&&typeof n!="boolean")return!1}return!0;default:return!0}};var du={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function yu(e,t){return e<t?-1:e>t?1:0}function wr(e){if(!e)return!0;var t=e[0];return e.length<=1?t!=="any":t==="=="?Er(e[1],e[2],"=="):t==="!="?Tr(Er(e[1],e[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Er(e[1],e[2],t):t==="any"?mu(e.slice(1)):t==="all"?["all"].concat(e.slice(1).map(wr)):t==="crossFields"?["crossFields"].concat(e.slice(1).map(wr)):t==="none"?["all"].concat(e.slice(1).map(wr).map(Tr)):t==="in"?Zi(e[1],e.slice(2)):t==="!in"?Tr(Zi(e[1],e.slice(2))):t==="has"?Gi(e[1]):t==="!has"?Tr(Gi(e[1])):t==="like"?Er(e[1],e[2],"like"):t!=="!like"||Tr(Er(e[1],e[2],"like"))}function Er(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function mu(e){return["any"].concat(e.map(wr))}function Zi(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(yu)]]:["filter-in-small",e,["literal",t]]}}function Gi(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Tr(e){return["!",e]}tr.createFilter=function(e){if(e==null)return function(){return!0};tr.isExpressionFilter(e)||(e=wr(e));var t=jt.createExpression(e,du);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return function(r,n){return t.value.evaluate(r,n)}};var vu=Os.FeatureIndexArray,it=function(e,t,r){this.x=e.x,this.y=e.y,this.z=e.z,this.grid=t||new He(Xe,16,0),this.featureIndexArray=r||new vu};function gu(e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,a=0,o=e;a<o.length;a+=1){var s=o[a];t=Math.min(t,s.x),r=Math.min(r,s.y),n=Math.max(n,s.x),i=Math.max(i,s.y)}return{minX:t,minY:r,maxX:n,maxY:i}}function xu(e,t){return t-e}function bu(e,t,r){if(ne.defined(r)&&r.realtime&&ne.defined(r.zoom)){var n=r.zoom-e,i=Xe/(t*Math.pow(2,n));return i*=t/512}return Xe/t}it.prototype.insert=function(e,t,r,n,i,a,o){var s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i);var u=this.grid;o=o||0;for(var p=0;p<t.length;p++){for(var c=t[p],f=[1/0,1/0,-1/0,-1/0],h=0;h<c.length;h++){var d=c[h];f[0]=Math.min(f[0],d.x),f[1]=Math.min(f[1],d.y),f[2]=Math.max(f[2],d.x),f[3]=Math.max(f[3],d.y)}f[0]<Xe&&f[1]<Xe&&f[2]>=0&&f[3]>=0&&u.insert(s,f[0]-o,f[1]-o,f[2]+o,f[3]+o)}},it.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Fi(new jn.Pbf(this.rawTileData)).layers,this.sourceLayerCoder=new Rr(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},it.prototype.query=function(e,t,r){var n=this;this.loadVTLayers();var i=e.params||{},a=bu(this.z,e.tileSize,i),o=tr.createFilter(i.filter),s=e.queryGeometry,u=5,p=gu(s),c=[];ne.defined(i.selectTolerance)&&(u+=a*i.selectTolerance),(c=this.grid.query(p.minX-u,p.minY-u,p.maxX+u,p.maxY+u)).sort(xu);for(var f,h={},d=function(g){var x=c[g];if(x!==f){f=x;var b=n.featureIndexArray.get(x),_=null;n.loadMatchingFeature(h,b.bucketIndex,b.sourceLayerIndex,b.featureIndex,o,i.layers,t,function(S,A){return _||(_=cr(S)),A.queryIntersectsFeature(s,S,{},_,n.z,e.transform,a,e.pixelPosMatrix,e.adjustScale)})}},v=0;v<c.length;v++)d(v);return h},it.prototype.loadMatchingFeature=function(e,t,r,n,i,a,o,s){if(ne.defined(t)&&ne.defined(r)&&ne.defined(n)){var u=this.bucketLayerIDs[t];if(!a||X.arraysIntersect(a,u)){var p=this.sourceLayerCoder.decode(r),c=this.vtLayers[p].feature(n);if(i(new Se(this.z),c))for(var f=0;f<u.length;f++){var h=u[f];if(!(a&&a.indexOf(h)<0)){var d=o[h];if(d){var v=!s||s(c,d);if(v){c.layer=d.serialize();var g=e[h];g===void 0&&(g=e[h]=[]),g.push({featureIndex:n,feature:c,intersectionZ:v})}}}}}}},it.prototype.lookupSymbolFeatures=function(e,t,r,n,i,a){var o={};this.loadVTLayers();for(var s=createFilter(n),u=0,p=e;u<p.length;u+=1){var c=p[u];this.loadMatchingFeature(o,t,r,c,s,i,a)}return o},it.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var n=0,i=r[t];n<i.length;n+=1)if(e===i[n])return!0;return!1},k.register("FeatureIndex",it,{omit:["rawTileData","sourceLayerCoder","vtLayers"]});const _u=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Fn(e){var t=typeof e;if(t==="number"||t==="boolean"||t==="string"||e==null)return JSON.stringify(e);if(Array.isArray(e)){for(var r="[",n=0,i=e;n<i.length;n+=1)r+=Fn(i[n])+",";return r+"]"}for(var a=Object.keys(e).sort(),o="{",s=0;s<a.length;s++)o+=JSON.stringify(a[s])+":"+Fn(e[a[s]])+",";return o+"}"}function wu(e){for(var t="",r=0,n=_u;r<n.length;r+=1)t+="/"+Fn(e[n[r]]);return t}function Eu(e,t){for(var r={},n=0;n<e.length;n++){var i=t&&t[e[n].id]||wu(e[n]);t&&(t[e[n].id]=i);var a=r[i];a||(a=r[i]=[]),a.push(e[n])}var o=[];for(var s in r)o.push(r[s]);return o}var Tu=ve([{name:"a_pos",components:2,type:"Int16"}],4),$i=Tu.members;function jr(e,t,r,n,i){e.emplaceBack(2*t+(n+1)/2,2*r+(i+1)/2)}var Je=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this._sourceLayerIds={};var t=this;this.layerIds=this.layers.map(function(r,n){return t._sourceLayerIds[r.sourceLayer]=n,r.sourceLayer}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ur,this.indexArray=new Kt,this.segments=new xe,this.programConfigurations=new et($i,e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Je.prototype.populate=function(e,t){var r=this.layers[0],n=[],i=null;r.type==="circle"&&(i=r.layout.get("circle-sort-key"));for(var a=0,o=e;a<o.length;a+=1){var s=o[a],u=s.feature,p=s.index,c=s.sourceLayerIndex,f=s.sourceLayerId,h=this._sourceLayerIds[f],d=this.layers[h];if(d){var v=Xe/512,g=d.paint.get("circle-radius").value.value*v;if(this.layers[0]._featureFilter(new Se(0),u)){var x=cr(u),b=i?i.evaluate(u,{}):void 0,_={id:u.id,properties:u.properties,type:u.type,sourceLayerIndex:c,index:p,geometry:x,patterns:{},sortKey:b,circleRadius:g};n.push(_)}}}i&&n.sort(function(G,oe){return G.sortKey-oe.sortKey});for(var S=0,A=n;S<A.length;S+=1){var O=A[S],L=O,F=L.geometry,B=L.index,W=L.sourceLayerIndex,H=e[B].feature;this.addFeature(O,F,B),t.featureIndex.insert(H,F,B,W,this.index,void 0,L.circleRadius)}},Je.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Je.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Je.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Je.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$i),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Je.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Je.prototype.clear=function(){ne.defined(this.layoutVertexArray)&&(this.layoutVertexArray=null),ne.defined(this.indexArray)&&(this.indexArray=null)},Je.prototype.addFeature=function(e,t,r){for(var n=0,i=t;n<i.length;n+=1)for(var a=0,o=i[n];a<o.length;a+=1){var s=o[a],u=s.x,p=s.y;if(!(u<0||u>=Xe||p<0||p>=Xe)){var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),f=c.vertexLength;jr(this.layoutVertexArray,u,p,-1,-1),jr(this.layoutVertexArray,u,p,1,-1),jr(this.layoutVertexArray,u,p,1,1),jr(this.layoutVertexArray,u,p,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),c.vertexLength+=4,c.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{})},k.register("CircleBucket",Je,{omit:["layers"]});var P=function(e){this.specification=e};P.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},P.prototype.interpolate=function(e,t,r){var n=interpolate[this.specification.type];return n?n(e,t,r):e},k.register("DataConstantProperty",P);var M=function(e,t){this.specification=e,this.overrides=t};M.prototype.possiblyEvaluate=function(e,t,r){return e.expression.kind==="constant"||e.expression.kind==="camera"?new Ce(this,{kind:"constant",value:e.expression.evaluate(t,null,{},r)},t):new Ce(this,e.expression,t)},M.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Ce(this,{kind:"constant",value:void 0},e.parameters);var n=interpolate[this.specification.type];return n?new Ce(this,{kind:"constant",value:n(e.value.value,t.value.value,r)},e.parameters):e},M.prototype.evaluate=function(e,t,r,n,i){return e.kind==="constant"?e.value:e.evaluate(t,r,n,i)},k.register("DataDrivenProperty",M);var rr=function(e,t){this.property=e,this.value=t,this.expression=jt.normalizePropertyExpression(t===void 0?e.specification.default:t,e.specification)};function Au(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}rr.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},rr.prototype.possiblyEvaluate=function(e,t){return this.property.possiblyEvaluate(this,e,t)};var Cn=function(e,t,r,n,i){this.property=e,this.value=t,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)};Cn.prototype.possiblyEvaluate=function(e,t){var r=e.now||0,n=this.value.possiblyEvaluate(e,t),i=this.prior;if(i){if(r>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(r<this.begin)return i.possiblyEvaluate(e,t);var a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(e,t),n,Au(a))}return n};var Ar=function(e){this.property=e,this.value=new rr(e,void 0)};Ar.prototype.transitioned=function(e,t){return new Cn(this.property,this.value,t,X.extend({},e.transition,this.transition),e.now)},Ar.prototype.untransitioned=function(){return new Cn(this.property,this.value,null,{},0)};var Et=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var n=this.defaultPropertyValues[t]=new rr(r,void 0),i=this.defaultTransitionablePropertyValues[t]=new Ar(r);this.defaultTransitioningPropertyValues[t]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}};function Ee(){}Ee.getMaximumPaintValue=function(e,t,r){var n=t.paint.get(e).value;return n.kind==="constant"?n.value:r.programConfigurations.get(t.id).binders[e].maxValue},Ee.translateDistance=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},Ee.translate=function(e,t,r,n,i){if(!t[0]&&!t[1])return e;var a=nt.convert(t)._mult(i);r==="viewport"&&a._rotate(-n);for(var o=[],s=0;s<e.length;s++){var u=e[s];o.push(u.sub(a))}return o};var Dn=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Dn.prototype.get=function(e){return this._values[e]};var Ir=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Ir.prototype.getValue=function(e){return X.clone(this._values[e].value)},Ir.prototype.setValue=function(e,t){this._values[e]=new rr(this._values[e].property,t===null?void 0:X.clone(t))},Ir.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t],i=this.getValue(n);i!==void 0&&(e[n]=i)}return e},Ir.prototype.possiblyEvaluate=function(e,t){for(var r=new Dn(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var a=i[n];r._values[a]=this._values[a].possiblyEvaluate(e,t)}return r};var Hr=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Hr.prototype.possiblyEvaluate=function(e,t){for(var r=new Dn(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var a=i[n];r._values[a]=this._values[a].possiblyEvaluate(e,t)}return r},Hr.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1){var r=t[e];if(this._values[r].prior)return!0}return!1};var Tt=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Tt.prototype.getValue=function(e){return X.clone(this._values[e].value.value)},Tt.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ar(this._values[e].property)),this._values[e].value=new rr(this._values[e].property,t===null?void 0:X.clone(t))},Tt.prototype.getTransition=function(e){return X.clone(this._values[e].transition)},Tt.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ar(this._values[e].property)),this._values[e].transition=X.clone(t)||void 0},Tt.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t],i=this.getValue(n);i!==void 0&&(e[n]=i);var a=this.getTransition(n);a!==void 0&&(e[n+"-transition"]=a)}return e},Tt.prototype.transitioned=function(e,t){for(var r=new Hr(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var a=i[n];r._values[a]=this._values[a].transitioned(e,t._values[a])}return r},Tt.prototype.untransitioned=function(){for(var e=new Hr(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t];e._values[n]=this._values[n].untransitioned()}return e};var Yr="-transition";function Ni(e,t){return e.indexOf(t,e.length-t.length)!==-1}function te(e,t){if(this.id=e.id,this.type=e.type,e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Ir(t.layout)),t.paint)){for(var r in this._transitionablePaint=new Tt(t.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(var n in e.layout)this.setLayoutProperty(n,e.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}te.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},te.prototype.getLayoutProperty=function(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)},te.prototype.setLayoutProperty=function(e,t,r){if(t!=null&&this.id,e==="visibility")return this.visibility=t,void(this.config&&this.config.layout&&(this.config.layout.visibility=t));this._unevaluatedLayout.setValue(e,t)},te.prototype.getPaintProperty=function(e){return Ni(e,Yr)?this._transitionablePaint.getTransition(e.slice(0,-Yr.length)):this._transitionablePaint.getValue(e)},te.prototype.setPaintProperty=function(e,t,r){if(t!=null&&this.id,Ni(e,Yr))return this._transitionablePaint.setTransition(e.slice(0,-Yr.length),t||void 0),!1;var n=this._transitionablePaint._values[e],i=n.property.specification["property-type"]==="cross-faded-data-driven",a=n.value.isDataDriven(),o=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);var s=this._transitionablePaint._values[e].value;return s.isDataDriven()||a||i||this._handleOverridablePaintPropertyUpdate(e,o,s)},te.prototype._handleSpecialPaintPropertyUpdate=function(e){},te.prototype._handleOverridablePaintPropertyUpdate=function(e,t,r){return!1},te.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"},te.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},te.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},te.prototype.recalculate=function(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,t)},te.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),X.filterObject(e,function(t,r){return!(t===void 0||r==="layout"&&!Object.keys(t).length||r==="paint"&&!Object.keys(t).length)})},te.prototype._validate=function(e,t,r,n,i){return!0},te.prototype.is3D=function(){return!1},te.prototype.isTileClipped=function(){return!1},te.prototype.hasOffscreenPass=function(){return!1},te.prototype.resize=function(){},te.prototype.isStateDependent=function(){return!0};var Iu=8,Su={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},ku={"*":{type:"source"}},Mu=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Ou={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},zu={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},Ru={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},Pu={type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},Fu={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Cu={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Du={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Uu=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Bu={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Vu={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Lu={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Xu={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},qu={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ju={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Hu={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yu={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Qu={type:"array",value:"*"},Wu={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},Ku={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},Ju={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Zu={type:"array",value:"*",minimum:1},Gu={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},$u={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Nu=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],el={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},tl={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},rl={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},nl={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},il={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-show-background":{type:"boolean",default:!1,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},al={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ol={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},sl={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ul={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},E={$version:Iu,$root:Su,sources:ku,source:Mu,source_vector:Ou,source_raster:zu,source_raster_dem:Ru,source_geojson:Pu,source_video:Fu,source_image:Cu,layer:Du,layout:Uu,layout_background:Bu,layout_fill:Vu,layout_circle:Lu,layout_heatmap:Xu,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:qu,layout_symbol:ju,layout_raster:Hu,layout_hillshade:Yu,filter:Qu,filter_operator:Wu,geometry_type:Ku,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:Ju,expression:Zu,expression_name:Gu,light:$u,paint:Nu,paint_fill:el,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:tl,paint_circle:rl,paint_heatmap:nl,paint_symbol:il,paint_raster:al,paint_hillshade:ol,paint_background:sl,transition:ul,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}};function at(){}function ll(e,t,r){if(e.length>1){if(Un(e,t))return!0;for(var n=0;n<t.length;n++)if(Bn(t[n],e,r))return!0}for(var i=0;i<e.length;i++)if(Bn(e[i],t,r))return!0;return!1}function Un(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var n=e[r],i=e[r+1],a=0;a<t.length-1;a++)if(pl(n,i,t[a],t[a+1]))return!0;return!1}function pl(e,t,r,n){return X.isCounterClockwise(e,r,n)!==X.isCounterClockwise(t,r,n)&&X.isCounterClockwise(e,t,r)!==X.isCounterClockwise(e,t,n)}function Bn(e,t,r){var n=r*r;if(t.length===1)return e.distSqr(t[0])<n;for(var i=1;i<t.length;i++){var a=t[i-1],o=t[i];if(at.distToSegmentSquared(e,a,o)<n)return!0}return!1}function ea(e,t){for(var r,n,i,a=!1,o=0;o<e.length;o++)for(var s=0,u=(r=e[o]).length-1;s<r.length;u=s++)n=r[s],i=r[u],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(a=!a);return a}function Sr(e,t){for(var r=!1,n=0,i=e.length-1;n<e.length;i=n++){var a=e[n],o=e[i];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(r=!r)}return r}at.polygonIntersectsPolygon=function(e,t){for(var r=0;r<e.length;r++)if(Sr(t,e[r]))return!0;for(var n=0;n<t.length;n++)if(Sr(e,t[n]))return!0;return!!Un(e,t)},at.polygonIntersectsBufferedPoint=function(e,t,r){return!!Sr(e,t)||!!Bn(t,e,r)},at.polygonIntersectsMultiPolygon=function(e,t){if(e.length===1)return ea(t,e[0]);for(var r=0;r<t.length;r++)for(var n=t[r],i=0;i<n.length;i++)if(Sr(e,n[i]))return!0;for(var a=0;a<e.length;a++)if(ea(t,e[a]))return!0;for(var o=0;o<t.length;o++)if(Un(e,t[o]))return!0;return!1},at.polygonIntersectsBufferedMultiLine=function(e,t,r){for(var n=0;n<t.length;n++){var i=t[n];if(e.length>=3){for(var a=0;a<i.length;a++)if(Sr(e,i[a]))return!0}if(ll(e,i,r))return!0}return!1},at.distToSegmentSquared=function(e,t,r){var n=t.distSqr(r);if(n===0)return e.distSqr(t);var i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return i<0?e.distSqr(t):i>1?e.distSqr(r):e.distSqr(r.sub(t)._mult(i)._add(t))};var cl=new Et({"circle-sort-key":new M(E.layout_circle["circle-sort-key"])}),fl=new Et({"circle-radius":new M(E.paint_circle["circle-radius"]),"circle-color":new M(E.paint_circle["circle-color"]),"circle-blur":new M(E.paint_circle["circle-blur"]),"circle-opacity":new M(E.paint_circle["circle-opacity"]),"circle-translate":new P(E.paint_circle["circle-translate"]),"circle-translate-anchor":new P(E.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new P(E.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new P(E.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new M(E.paint_circle["circle-stroke-width"]),"circle-stroke-color":new M(E.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new M(E.paint_circle["circle-stroke-opacity"])}),hl={paint:fl,layout:cl},dl=function(e){function t(r){e.call(this,r,hl)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(r){return new Je(r)},t.prototype.queryRadius=function(r){var n=r;return Ee.getMaximumPaintValue("circle-radius",this,n)+Ee.getMaximumPaintValue("circle-stroke-width",this,n)+Ee.translateDistance(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,n,i,a,o,s,u,p,c){p=ml();for(var f=Ee.translate(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),0,u),h=this.paint.get("circle-radius").evaluate(n,i)+this.paint.get("circle-stroke-width").evaluate(n,i),d=this.paint.get("circle-pitch-alignment")==="map",v=d?f:yl(f,p),g=d?h*u:h,x=0,b=a;x<b.length;x+=1)for(var _=0,S=b[x];_<S.length;_+=1){var A=S[_],O=d?A:ta(A,p),L=g;if(ra([],[A.x,A.y,0,1],p),this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"||this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment"),c=ne.defined(c)?c:10,at.polygonIntersectsBufferedPoint(v,O,L*c))return!0}return!1},t}(te);function ta(e,t){var r=ra([],[e.x,e.y,0,1],t);return new nt(r[0],r[1])}function yl(e,t){return e.map(function(r){return ta(r,t)})}function ml(){var e=new Float32Array(16);return e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ra(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e}var na=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.possiblyEvaluate=function(r,n,i){if(r.value===void 0)return new Ce(this,{kind:"constant",value:void 0},n);if(r.expression.kind==="constant"){var a=r.expression.evaluate(n,null,{},i),o=r.property.specification.type==="resolvedImage"&&typeof a!="string"?a.name:a,s=this._calculate(o,o,o,n);return new Ce(this,{kind:"constant",value:s},n)}if(r.expression.kind==="camera"){var u=this._calculate(r.expression.evaluate({zoom:n.zoom-1}),r.expression.evaluate({zoom:n.zoom}),r.expression.evaluate({zoom:n.zoom+1}),n);return new Ce(this,{kind:"constant",value:u},n)}return new Ce(this,r.expression,n)},t.prototype.evaluate=function(r,n,i,a,o){if(r.kind==="source"){var s=r.evaluate(n,i,a,o);return this._calculate(s,s,s,n)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(n.zoom)-1},i,a),r.evaluate({zoom:Math.floor(n.zoom)},i,a),r.evaluate({zoom:Math.floor(n.zoom)+1},i,a),n):r.value},t.prototype._calculate=function(r,n,i,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:r,to:n}:{from:i,to:n}},t.prototype.interpolate=function(r){return r},t}(M);k.register("DataDrivenProperty",M);var vl=new Et({"fill-sort-key":new M(E.layout_fill["fill-sort-key"])}),gl=new Et({"fill-antialias":new P(E.paint_fill["fill-antialias"]),"fill-opacity":new M(E.paint_fill["fill-opacity"]),"fill-color":new M(E.paint_fill["fill-color"]),"fill-outline-color":new M(E.paint_fill["fill-outline-color"]),"fill-translate":new P(E.paint_fill["fill-translate"]),"fill-translate-anchor":new P(E.paint_fill["fill-translate-anchor"]),"fill-pattern":new na(E.paint_fill["fill-pattern"])}),xl={paint:gl,layout:vl},bl=function(e){function t(r){e.call(this,r,xl)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.recalculate=function(r,n){e.prototype.recalculate.call(this,r,n);var i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Be(r)},t.prototype.queryRadius=function(){return Ee.translateDistance(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,n,i,a,o,s,u){var p=Ee.translate(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),0,u);return at.polygonIntersectsMultiPolygon(p,a)},t.prototype.isTileClipped=function(){return!0},t}(te),kr=function(e){this.specification=e};kr.prototype.possiblyEvaluate=function(e,t,r){if(e.value!==void 0){if(e.expression.kind==="constant"){var n=e.expression.evaluate(t,null,{},r);return this._calculate(n,n,n,t)}return this._calculate(e.expression.evaluate(new EvaluationParameters(Math.floor(t.zoom-1),t)),e.expression.evaluate(new EvaluationParameters(Math.floor(t.zoom),t)),e.expression.evaluate(new EvaluationParameters(Math.floor(t.zoom+1),t)),t)}},kr.prototype._calculate=function(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},kr.prototype.interpolate=function(e){return e},k.register("CrossFadedProperty",kr);var Qr=function(e){this.specification=e};Qr.prototype.possiblyEvaluate=function(e,t,r){return!!e.expression.evaluate(t,null,{},r)},Qr.prototype.interpolate=function(){return!1},k.register("ColorRampProperty",Qr);var _l=new Et({"line-cap":new P(E.layout_line["line-cap"]),"line-join":new M(E.layout_line["line-join"]),"line-miter-limit":new P(E.layout_line["line-miter-limit"]),"line-round-limit":new P(E.layout_line["line-round-limit"]),"line-sort-key":new M(E.layout_line["line-sort-key"])}),wl=new Et({"line-opacity":new M(E.paint_line["line-opacity"]),"line-color":new M(E.paint_line["line-color"]),"line-translate":new P(E.paint_line["line-translate"]),"line-translate-anchor":new P(E.paint_line["line-translate-anchor"]),"line-width":new M(E.paint_line["line-width"]),"line-gap-width":new M(E.paint_line["line-gap-width"]),"line-offset":new M(E.paint_line["line-offset"]),"line-blur":new M(E.paint_line["line-blur"]),"line-dasharray":new kr(E.paint_line["line-dasharray"]),"line-pattern":new na(E.paint_line["line-pattern"]),"line-gradient":new Qr(E.paint_line["line-gradient"])}),ia={paint:wl,layout:_l},El=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.possiblyEvaluate=function(r,n){return n=new Se(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),e.prototype.possiblyEvaluate.call(this,r,n)},t.prototype.evaluate=function(r,n,i,a){return n=extend({},n,{zoom:Math.floor(n.zoom)}),e.prototype.evaluate.call(this,r,n,i,a)},t}(M),aa=new El(ia.paint.properties["line-width"].specification);aa.useIntegerZoom=!0;var Tl=function(e){function t(n){e.call(this,n,ia)}function r(n,i){return i>0?i+2*n:n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(n){n==="line-gradient"&&this._updateGradient()},t.prototype._updateGradient=function(){var n=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=renderColorRamp(n,"lineProgress"),this.gradientTexture=null},t.prototype.recalculate=function(n,i){e.prototype.recalculate.call(this,n,i),this.paint._values["line-floorwidth"]=aa.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)},t.prototype.createBucket=function(n){return new pe(n)},t.prototype.queryRadius=function(n){var i=n,a=r(Ee.getMaximumPaintValue("line-width",this,i),Ee.getMaximumPaintValue("line-gap-width",this,i)),o=Ee.getMaximumPaintValue("line-offset",this,i);return a/2+Math.abs(o)+Ee.translateDistance(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(n,i,a,o,s,u,p){var c=Ee.translate(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),0,p),f=r(this.paint.get("line-width").evaluate(i,a),this.paint.get("line-gap-width").evaluate(i,a)),h=p/2*(f=Math.max(f,5)),d=this.paint.get("line-offset").evaluate(i,a);return d&&(o=function(v,g){for(var x=[],b=new nt(0,0),_=0;_<v.length;_++){for(var S=v[_],A=[],O=0;O<S.length;O++){var L=S[O-1],F=S[O],B=S[O+1],W=O===0?b:F.sub(L)._unit()._perp(),H=O===S.length-1?b:B.sub(F)._unit()._perp(),G=W._add(H)._unit(),oe=G.x*H.x+G.y*H.y;G._mult(1/oe),A.push(G._mult(g)._add(F))}x.push(A)}return x}(o,d*p)),at.polygonIntersectsBufferedMultiLine(c,o,h)},t.prototype.isTileClipped=function(){return!0},t}(te);function ze(){}function Al(e){var t={},r={},n=[],i=0;function a(b){n.push(e[b]),i++}function o(b,_,S){var A=r[b];return delete r[b],r[_]=A,n[A].geometry[0].pop(),n[A].geometry[0]=n[A].geometry[0].concat(S[0]),A}function s(b,_,S){var A=t[_];return delete t[_],t[b]=A,n[A].geometry[0].shift(),n[A].geometry[0]=S[0].concat(n[A].geometry[0]),A}function u(b,_,S){var A=S?_[0][_[0].length-1]:_[0][0];return b+":"+A.x+":"+A.y}for(var p=0;p<e.length;p++){var c=e[p],f=c.geometry,h=c.text?c.text.toString():null;if(h){var d=u(h,f),v=u(h,f,!0);if(d in r&&v in t&&r[d]!==t[v]){var g=s(d,v,f),x=o(d,v,n[g].geometry);delete t[d],delete r[v],r[u(h,n[x].geometry,!0)]=x,n[g].geometry=null}else d in r?o(d,v,f):v in t?s(d,v,f):(a(p),t[d]=i-1,r[v]=i-1)}else a(p)}return n.filter(function(b){return b.geometry})}ze.symbolLayoutAttributes=ve([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ze.dynamicLayoutAttributes=ve([{name:"a_projected_pos",components:3,type:"Float32"}],4),ze.placementOpacityAttributes=ve([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ze.collisionVertexAttributes=ve([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ze.collisionBox=ve([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),ze.collisionBoxLayout=ve([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ze.collisionCircleLayout=ve([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ze.placement=ve([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ze.symbolInstance=ve([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"}]),ze.glyphOffset=ve([{type:"Float32",name:"offsetX"}]),ze.lineVertex=ve([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var At=function(){};function Il(e){for(var t=0,r=e;t<r.length;t+=1)if(r[t].positionedGlyphs.length!==0)return!1;return!0}At.WritingMode={horizontal:1,vertical:2,horizontalOnly:3};var Sl=57344,kl=63743,nr=function(){this.scale=1,this.fontStack="",this.imageName=null};nr.forText=function(e,t){var r=new nr;return r.scale=e||1,r.fontStack=t,r},nr.forImage=function(e){var t=new nr;return t.imageName=e,t};var fe=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ml(e,t){for(var r=[],n=e.text,i=0,a=0,o=t;a<o.length;a+=1){var s=o[a];r.push(e.substring(i,s)),i=s}return i<n.length&&r.push(e.substring(i,n.length)),r}fe.fromFeature=function(e,t){for(var r=new fe,n=0;n<e.sections.length;n++){var i=e.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,t)}return r},fe.prototype.length=function(){return this.text.length},fe.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},fe.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},fe.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},fe.prototype.verticalizePunctuation=function(){},fe.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&It[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,n=this.text.length-1;n>=0&&n>=e&&It[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},fe.prototype.substring=function(e,t){var r=new fe;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},fe.prototype.toString=function(){return this.text},fe.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},fe.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(nr.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,n=0;n<e.text.length;++n)this.sectionIndex.push(r)},fe.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r&&(this.text+=String.fromCharCode(r),this.sections.push(nr.forImage(t)),this.sectionIndex.push(this.sections.length-1))}},fe.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=kl?null:++this.imageSectionID:(this.imageSectionID=Sl,this.imageSectionID)},At.shapeText=function(e,t,r,n,i,a,o,s,u,p,c,f,h,d,v,g){var x=fe.fromFeature(e,i);f===At.WritingMode.vertical&&x.verticalizePunctuation(),Ml(x,void 0);var b=[],_={positionedLines:b,text:x.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:f,iconsInText:!1,verticalizable:!1};return!Il(b)&&_};var It={};function Ol(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}It[9]=!0,It[10]=!0,It[11]=!0,It[12]=!0,It[13]=!0,It[32]=!0,At.shapeIcon=function(e,t,r){var n=Ol(r),i=n.horizontalAlign,a=n.verticalAlign,o=t[0],s=t[1],u=o-e.displaySize[0]*i,p=u+e.displaySize[0],c=s-e.displaySize[1]*a;return{image:e,top:c,bottom:c+e.displaySize[1],left:u,right:p}},At.fitIconToText=function(e,t,r,n,i,a){var o,s=e.image;if(s.content){var u=s.content,p=s.pixelRatio||1;o=[u[0]/p,u[1]/p,s.displaySize[0]-u[2]/p,s.displaySize[1]-u[3]/p]}var c,f,h,d,v=t.left*a,g=t.right*a;r==="width"||r==="both"?(d=i[0]+v-n[3],f=i[0]+g+n[1]):f=(d=i[0]+(v+g-s.displaySize[0])/2)+s.displaySize[0];var x=t.top*a,b=t.bottom*a;return r==="height"||r==="both"?(c=i[1]+x-n[0],h=i[1]+b+n[2]):h=(c=i[1]+(x+b-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:c,right:f,bottom:h,left:d,collisionPadding:o}};var Wr=128;function zl(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Se(e+1))};if(r.kind==="source")return{kind:"source"};for(var n=r.zoomStops,i=r.interpolationType,a=0;a<n.length&&n[a]<=e;)a++;for(var o=a=Math.max(0,a-1);o<n.length&&n[o]<e+1;)o++;o=Math.min(n.length-1,o);var s=n[a],u=n[o];return r.kind==="composite"?{kind:"composite",minZoom:s,maxZoom:u,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:u,minSize:r.evaluate(new Se(s)),maxSize:r.evaluate(new Se(u)),interpolationType:i}}function Rl(e,t,r){var n=t.uSize,i=t.uSizeT,a=r.lowerSize,o=r.upperSize;return e.kind==="source"?a/Wr:e.kind==="composite"?number(a/Wr,o/Wr,i):n}function Pl(e,t){var r=0,n=0;return e.kind==="constant"?n=e.layoutSize:e.kind!=="source"&&(e.interpolationType,e.minZoom,e.maxZoom,e.kind==="camera"?n=number(e.minSize,e.maxSize,0):r=0),{uSizeT:r,uSize:n}}var oa=Object.freeze({__proto__:null,getSizeData:zl,evaluateSizeForFeature:Rl,evaluateSizeForZoom:Pl,SIZE_PACK_FACTOR:Wr});function Fl(e,t,r){var n=t.layout.get("text-transform").evaluate(r,{});return n==="uppercase"?e=e.toLocaleUpperCase():n==="lowercase"&&(e=e.toLocaleLowerCase()),e}function Cl(e,t,r){return e.sections.forEach(function(n){n.text=Fl(n.text,t,r)}),e}var V={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}},Mr=function(){};function Dl(e){return!V.Arabic(e)&&!V["Arabic Supplement"](e)&&!V["Arabic Extended-A"](e)&&!V["Arabic Presentation Forms-A"](e)&&!V["Arabic Presentation Forms-B"](e)}function Ul(e){return e===746||e===747||!(e<4352)&&(!!V["Bopomofo Extended"](e)||!!V.Bopomofo(e)||!(!V["CJK Compatibility Forms"](e)||e>=65097&&e<=65103)||!!V["CJK Compatibility Ideographs"](e)||!!V["CJK Compatibility"](e)||!!V["CJK Radicals Supplement"](e)||!!V["CJK Strokes"](e)||!(!V["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||!!V["CJK Unified Ideographs Extension A"](e)||!!V["CJK Unified Ideographs"](e)||!!V["Enclosed CJK Letters and Months"](e)||!!V["Hangul Compatibility Jamo"](e)||!!V["Hangul Jamo Extended-A"](e)||!!V["Hangul Jamo Extended-B"](e)||!!V["Hangul Jamo"](e)||!!V["Hangul Syllables"](e)||!!V.Hiragana(e)||!!V["Ideographic Description Characters"](e)||!!V.Kanbun(e)||!!V["Kangxi Radicals"](e)||!!V["Katakana Phonetic Extensions"](e)||!(!V.Katakana(e)||e===12540)||!(!V["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!V["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||!!V["Unified Canadian Aboriginal Syllabics"](e)||!!V["Unified Canadian Aboriginal Syllabics Extended"](e)||!!V["Vertical Forms"](e)||!!V["Yijing Hexagram Symbols"](e)||!!V["Yi Syllables"](e)||!!V["Yi Radicals"](e))}function Bl(e){return e>=1424&&e<=2303||V["Arabic Presentation Forms-A"](e)||V["Arabic Presentation Forms-B"](e)}Mr.allowsVerticalWritingMode=function(e){for(var t=0,r=e;t<r.length;t+=1)if(Ul(r[t].charCodeAt(0)))return!0;return!1},Mr.allowsLetterSpacing=function(e){for(var t=0,r=e;t<r.length;t+=1)if(!Dl(r[t].charCodeAt(0)))return!1;return!0},Mr.stringContainsRTLText=function(e){for(var t=0,r=e;t<r.length;t+=1)if(Bl(r[t].charCodeAt(0)))return!0;return!1};var Vl=["Unknown","Point","LineString","Polygon"],Ll=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kr(e,t,r,n,i,a,o,s,u,p,c,f,h){var d=s?Math.min(MAX_PACKED_SIZE,Math.round(s[0])):0,v=s?Math.min(MAX_PACKED_SIZE,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),a,o,(d<<1)+(u?1:0),v,16*p,16*c,256*f,256*h)}function sa(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Xl(e){for(var t=0,r=e.sections;t<r.length;t+=1){var n=r[t];if(Mr.stringContainsRTLText(n.text))return!0}return!1}var Jr=function(e){this.layoutVertexArray=new StructArrayLayout4i4ui4i24,this.indexArray=new Kt,this.programConfigurations=e,this.segments=new xe,this.dynamicLayoutVertexArray=new StructArrayLayout3f12,this.opacityVertexArray=new StructArrayLayout1ul4,this.placedSymbolArray=new PlacedSymbolArray};Jr.prototype.upload=function(e,t,r,n){r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ze.symbolLayoutAttributes.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ze.dynamicLayoutAttributes.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ll,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e)},Jr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Jr.prototype.clear=function(){},k.register("SymbolBuffers",Jr);var Vn=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new xe,this.collisionVertexArray=new StructArrayLayout2ub2f12};Vn.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,collisionVertexAttributes.members,!0)},Vn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},k.register("CollisionBuffers",Vn);var Q=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(o){return o.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasPaintOverrides=!1,this.hasRTLText=!1;var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=oa.getSizeData(this.zoom,t["text-size"]),this.iconSizeData=oa.getSizeData(this.zoom,t["icon-size"]);var r=this.layers[0].layout,n=r.get("symbol-sort-key"),i=r.get("symbol-z-order");this.sortFeaturesByKey=i!=="viewport-y"&&n.constantOr(1)!==void 0;var a=i==="viewport-y"||i==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=a&&(r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")),r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(function(o){return At.WritingMode[o]})),this.stateDependentLayerIds=this.layers.filter(function(o){return o.isStateDependent()}).map(function(o){return o.id}),this.sourceID=e.sourceID};Q.prototype.createArrays=function(){},Q.prototype.calculateGlyphDependencies=function(e,t,r,n,i){for(var a=0;a<e.length;a++)t[e.charCodeAt(a)]=!0},Q.prototype.populate=function(e,t){var r=this.layers[0],n=r.layout,i=n.get("text-font"),a=n.get("text-field"),o=n.get("icon-image"),s=(a.value.kind!=="constant"||a.value.value instanceof ue&&!a.value.value.isEmpty()||a.value.value.toString().length>0)&&(i.value.kind!=="constant"||i.value.value.length>0),u=(o.value.kind!=="constant"||!!o.value.value)&&Object.keys(o.parameters).length>0,p=n.get("symbol-sort-key");if(this.features=[],s||u){for(var c=t.iconDependencies,f=t.glyphDependencies,h=t.availableImages,d=new Se(this.zoom),v=0,g=e;v<g.length;v+=1){var x=g[v],b=x.feature,_=x.index,S=x.sourceLayerIndex;if(r._featureFilter(d,b)){var A=void 0;if(s){var O=r.getValueAndResolveTokens("text-field",b,h),L=ue.factory(O);Xl(L)&&(this.hasRTLText=!0),(!this.hasRTLText||getRTLTextPluginStatus()==="unavailable"||this.hasRTLText&&plugin.isParsed())&&(A=Cl(L,r,b))}var F=void 0;if(u){var B=r.getValueAndResolveTokens("icon-image",b,h);F=B instanceof Ie?B:Ie.fromString(B)}if(A||F){var W=this.sortFeaturesByKey?p.evaluate(b,{}):void 0,H={text:A,icon:F,index:_,sourceLayerIndex:S,geometry:cr(b),properties:b.properties,type:Vl[b.type],sortKey:W};if(b.id!==void 0&&(H.id=b.id),this.features.push(H),F&&(c[F.name]=!0),A){var G=i.evaluate(b,{}).join(","),oe=n.get("text-rotation-alignment")==="map"&&n.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(At.WritingMode.vertical)>=0;for(var he=0,D=A.sections;he<D.length;he+=1){var ye=D[he];if(ye.image)c[ye.image.name]=!0;else{var me=Mr.allowsVerticalWritingMode(A.toString()),Ze=ye.fontStack||G,ot=f[Ze]=f[Ze]||{};this.calculateGlyphDependencies(ye.text,ot,oe,this.allowVerticalPlacement,me)}}}}}}n.get("symbol-placement")==="line"&&(this.features=Al(this.features)),this.sortFeaturesByKey&&this.features.sort(function(se,Ve){return se.sortKey-Ve.sortKey})}},Q.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},Q.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Q.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Q.prototype.upload=function(e){},Q.prototype.destroy=function(){},Q.prototype.clear=function(){},Q.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var n=e.dist(t[e.segment+1]),i=e.dist(t[e.segment]),a={},o=e.segment+1;o<t.length;o++)a[o]={x:t[o].x,y:t[o].y,tileUnitDistanceFromAnchor:n},o<t.length-1&&(n+=t[o+1].dist(t[o]));for(var s=e.segment||0;s>=0;s--)a[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=t[s-1].dist(t[s]));for(var u=0;u<t.length;u++){var p=a[u];this.lineVertexArray.emplaceBack(p.x,p.y,p.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Q.prototype.addSymbols=function(e,t,r,n,i,a,o,s,u,p,c){var f=this,h=e.indexArray,d=e.layoutVertexArray,v=e.dynamicLayoutVertexArray,g=e.segments.prepareSegment(4*t.length,e.layoutVertexArray,e.indexArray,a.sortKey),x=this.glyphOffsetArray.length,b=g.vertexLength,_=this.allowVerticalPlacement&&o===At.WritingMode.vertical?Math.PI/2:0,S=function(D){var ye=D.tl,me=D.tr,Ze=D.bl,ot=D.br,se=D.tex,Ve=D.pixelOffsetTL,Re=D.pixelOffsetBR,Ge=D.minFontScaleX,$e=D.minFontScaleY,Ye=g.vertexLength,st=D.glyphOffset[1];Kr(d,s.x,s.y,ye.x,st+ye.y,se.x,se.y,r,D.isSDF,Ve.x,Ve.y,Ge,$e),Kr(d,s.x,s.y,me.x,st+me.y,se.x+se.w,se.y,r,D.isSDF,Re.x,Ve.y,Ge,$e),Kr(d,s.x,s.y,Ze.x,st+Ze.y,se.x,se.y+se.h,r,D.isSDF,Ve.x,Re.y,Ge,$e),Kr(d,s.x,s.y,ot.x,st+ot.y,se.x+se.w,se.y+se.h,r,D.isSDF,Re.x,Re.y,Ge,$e),sa(v,s,_),h.emplaceBack(Ye,Ye+1,Ye+2),h.emplaceBack(Ye+1,Ye+2,Ye+3),g.vertexLength+=4,g.primitiveLength+=2,f.glyphOffsetArray.emplaceBack(D.glyphOffset[0])};if(a.text&&a.text.sections){var A=a.text.sections;if(this.hasPaintOverrides){for(var O,L=function(D,ye){O===void 0||O===D&&!ye||e.programConfigurations.populatePaintArrays(e.layoutVertexArray.length,a,a.index,{},A[O]),O=D},F=0,B=t;F<B.length;F+=1){var W=B[F];L(W.sectionIndex,!1),S(W)}L(O,!0)}else{for(var H=0,G=t;H<G.length;H+=1)S(G[H]);e.programConfigurations.populatePaintArrays(e.layoutVertexArray.length,a,a.index,{},A[0])}}else{for(var oe=0,he=t;oe<he.length;oe+=1)S(he[oe]);e.programConfigurations.populatePaintArrays(e.layoutVertexArray.length,a,a.index,{})}e.placedSymbolArray.emplaceBack(s.x,s.y,x,this.glyphOffsetArray.length-x,b,u,p,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],o,0,!1,0,c)},Q.prototype._addCollisionDebugVertex=function(e,t,r,n,i,a){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,i,Math.round(a.x),Math.round(a.y))},Q.prototype.addCollisionDebugVertices=function(e,t,r,n,i,a,o,s){var u=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),p=u.vertexLength,c=i.layoutVertexArray,f=i.collisionVertexArray,h=o.anchorX,d=o.anchorY;if(this._addCollisionDebugVertex(c,f,a,h,d,new pointGeometry(e,t)),this._addCollisionDebugVertex(c,f,a,h,d,new pointGeometry(r,t)),this._addCollisionDebugVertex(c,f,a,h,d,new pointGeometry(r,n)),this._addCollisionDebugVertex(c,f,a,h,d,new pointGeometry(e,n)),u.vertexLength+=4,s){var v=i.indexArray;v.emplaceBack(p,p+1,p+2),v.emplaceBack(p,p+2,p+3),u.primitiveLength+=2}else{var g=i.indexArray;g.emplaceBack(p,p+1),g.emplaceBack(p+1,p+2),g.emplaceBack(p+2,p+3),g.emplaceBack(p+3,p),u.primitiveLength+=4}},Q.prototype.addDebugCollisionBoxes=function(e,t,r,n){for(var i=e;i<t;i++){var a=this.collisionBoxArray.get(i),o=a.x1,s=a.y1,u=a.x2,p=a.y2,c=a.radius>0;this.addCollisionDebugVertices(o,s,u,p,c?n?this.textCollisionCircle:this.iconCollisionCircle:n?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,r,c)}},Q.prototype.generateCollisionDebugBuffers=function(){for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Q.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,n,i,a,o,s,u){for(var p={},c=t;c<r;c++){var f=e.get(c);if(f.radius===0){p.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},p.textFeatureIndex=f.featureIndex;break}p.textCircles||(p.textCircles=[],p.textFeatureIndex=f.featureIndex),p.textCircles.push(f.anchorPointX,f.anchorPointY,f.radius,f.signedDistanceFromAnchor,1)}for(var h=n;h<i;h++){var d=e.get(h);if(d.radius===0){p.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},p.verticalTextFeatureIndex=d.featureIndex;break}}for(var v=a;v<o;v++){var g=e.get(v);if(g.radius===0){p.iconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},p.iconFeatureIndex=g.featureIndex;break}}for(var x=s;x<u;x++){var b=e.get(x);if(b.radius===0){p.verticalIconBox={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,anchorPointX:b.anchorPointX,anchorPointY:b.anchorPointY},p.verticalIconFeatureIndex=b.featureIndex;break}}return p},Q.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},Q.prototype.hasTextData=function(){return this.text.segments.get().length>0},Q.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Q.prototype.hasTextCollisionBoxData=function(){return this.textCollisionBox.segments.get().length>0},Q.prototype.hasIconCollisionBoxData=function(){return this.iconCollisionBox.segments.get().length>0},Q.prototype.hasTextCollisionCircleData=function(){return this.textCollisionCircle.segments.get().length>0},Q.prototype.hasIconCollisionCircleData=function(){return this.iconCollisionCircle.segments.get().length>0},Q.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs,i=r.vertexStartIndex;i<n;i+=4)e.indexArray.emplaceBack(i,i+1,i+2),e.indexArray.emplaceBack(i+1,i+2,i+3)},Q.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),n=[],i=[],a=[],o=0;o<this.symbolInstances.length;++o){a.push(o);var s=this.symbolInstances.get(o);n.push(0|Math.round(t*s.anchorX+r*s.anchorY)),i.push(s.featureIndex)}return a.sort(function(u,p){return n[u]-n[p]||i[p]-i[u]}),a},Q.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,n=this.symbolInstanceIndexes;r<n.length;r+=1){var i=n[r],a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach(function(o,s,u){o>=0&&u.indexOf(o)===s&&t.addIndicesForPlacedSymbol(t.text,o)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},k.register("SymbolBucket",Q,{omit:["layers","collisionBoxArray","compareText"]}),Q.MAX_GLYPHS=65535,Q.addDynamicAttributes=sa;var ql={kind:"color"},jl={kind:"formatted"},Hl=new Et({"symbol-placement":new P(E.layout_symbol["symbol-placement"]),"symbol-spacing":new P(E.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new P(E.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new M(E.layout_symbol["symbol-sort-key"]),"symbol-z-order":new P(E.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new P(E.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new P(E.layout_symbol["icon-ignore-placement"]),"icon-optional":new P(E.layout_symbol["icon-optional"]),"icon-rotation-alignment":new P(E.layout_symbol["icon-rotation-alignment"]),"icon-size":new M(E.layout_symbol["icon-size"]),"icon-text-fit":new P(E.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new P(E.layout_symbol["icon-text-fit-padding"]),"icon-image":new M(E.layout_symbol["icon-image"]),"icon-rotate":new M(E.layout_symbol["icon-rotate"]),"icon-padding":new P(E.layout_symbol["icon-padding"]),"icon-keep-upright":new P(E.layout_symbol["icon-keep-upright"]),"icon-offset":new M(E.layout_symbol["icon-offset"]),"icon-anchor":new M(E.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new P(E.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new P(E.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new P(E.layout_symbol["text-rotation-alignment"]),"text-field":new M(E.layout_symbol["text-field"]),"text-font":new M(E.layout_symbol["text-font"]),"text-size":new M(E.layout_symbol["text-size"]),"text-max-width":new M(E.layout_symbol["text-max-width"]),"text-line-height":new P(E.layout_symbol["text-line-height"]),"text-letter-spacing":new M(E.layout_symbol["text-letter-spacing"]),"text-justify":new M(E.layout_symbol["text-justify"]),"text-radial-offset":new M(E.layout_symbol["text-radial-offset"]),"text-variable-anchor":new P(E.layout_symbol["text-variable-anchor"]),"text-anchor":new M(E.layout_symbol["text-anchor"]),"text-max-angle":new P(E.layout_symbol["text-max-angle"]),"text-writing-mode":new P(E.layout_symbol["text-writing-mode"]),"text-rotate":new M(E.layout_symbol["text-rotate"]),"text-padding":new P(E.layout_symbol["text-padding"]),"text-keep-upright":new P(E.layout_symbol["text-keep-upright"]),"text-transform":new M(E.layout_symbol["text-transform"]),"text-offset":new M(E.layout_symbol["text-offset"]),"text-allow-overlap":new P(E.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new P(E.layout_symbol["text-ignore-placement"]),"text-optional":new P(E.layout_symbol["text-optional"])}),Yl=new Et({"icon-opacity":new M(E.paint_symbol["icon-opacity"]),"icon-color":new M(E.paint_symbol["icon-color"]),"icon-halo-color":new M(E.paint_symbol["icon-halo-color"]),"icon-halo-width":new M(E.paint_symbol["icon-halo-width"]),"icon-halo-blur":new M(E.paint_symbol["icon-halo-blur"]),"icon-translate":new P(E.paint_symbol["icon-translate"]),"icon-translate-anchor":new P(E.paint_symbol["icon-translate-anchor"]),"text-opacity":new M(E.paint_symbol["text-opacity"]),"text-color":new M(E.paint_symbol["text-color"],{runtimeType:ql,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new M(E.paint_symbol["text-halo-color"]),"text-halo-width":new M(E.paint_symbol["text-halo-width"]),"text-halo-blur":new M(E.paint_symbol["text-halo-blur"]),"text-show-background":new M(E.paint_symbol["text-show-background"]),"text-translate":new P(E.paint_symbol["text-translate"]),"text-translate-anchor":new P(E.paint_symbol["text-translate-anchor"])}),Zr={paint:Yl,layout:Hl},Ql=function(e){function t(r){e.call(this,r,Zr)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.recalculate=function(r,n){if(e.prototype.recalculate.call(this,r,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var i=this.layout.get("text-writing-mode");if(i){for(var a=[],o=0,s=i;o<s.length;o+=1){var u=s[o];a.indexOf(u)<0&&a.push(u)}this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,n,i){var a=this.layout.get(r).evaluate(n,{},i),o=this._unevaluatedLayout._values[r];return o.isDataDriven()||jt.isExpression(o.value)||!a?a:X.resolveTokens(n.properties,a)},t.prototype.createBucket=function(r){return new Q(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,n=Zr.paint.overridableProperties;r<n.length;r+=1){var i=n[r];if(t.hasPaintOverride(this.layout,i)){var a=this.paint.get(i);new FormatSectionOverride(a),a.value.kind==="constant"||a.value.kind,this.paint._values[i]=new PossiblyEvaluatedPropertyValue(a.property,null,a.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,n,i){return!(!this.layout||n.isDataDriven()||i.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,n){var i=r.get("text-field"),a=Zr.paint.properties[n],o=!1,s=function(c){for(var f=0,h=c;f<h.length;f+=1){var d=h[f];if(a.overrides&&a.overrides.hasOverride(d))return void(o=!0)}};if(i.value.kind==="constant"&&i.value.value instanceof ue)s(i.value.value.sections);else if(i.value.kind==="source"){var u=function(c){if(!o)if(c instanceof Ne&&J.typeOf(c.value)===jl){var f=c.value;s(f.sections)}else c instanceof lt?s(c.sections):c.eachChild(u)},p=i.value;p._styleExpression&&u(p._styleExpression.expression)}return o},t.hasPaintOverrides=function(r){for(var n=0,i=Zr.paint.overridableProperties;n<i.length;n+=1){var a=i[n];if(t.hasPaintOverride(r,a))return!0}return!1},t}(te),ua={circle:dl,fill:bl,line:Tl,symbol:Ql};function Wl(e){return ua[e.type]?new ua[e.type](e):null}var Ln=function(e){this.keyCache={},e&&this.replace(e)};function Kl(e){var t=[];for(var r in e)t.push(e[r]);return t}function Jl(e,t){var r=e.pbfData,n=e.layers,i=e.imageMap,a=k.deserialize(e.serializeObj).featureIndex,o=e.tileID.z;ne.defined(a)||((a=new it(e.tileID)).bucketLayerIDs=[]);var s={};try{var u=new Ln(n);s=Gl(Zl(r),u,i,a,o,e.indexData),s=k.serialize(s,t)}catch{}return s.pickId=e.pickId,s}function Zl(e){if(ne.defined(e))return new Fi(new jn.Pbf(e))}function Gl(e,t,r,n,i,a){var o=new Rr(Object.keys(e.layers).sort()),s={},u={featureIndex:n,iconDependencies:{},patternDependencies:{},glyphDependencies:{}};for(var p in t.familiesBySource){var c=t.familiesBySource[p];for(var f in c){var h=e.layers[f];if(h){for(var d=o.encode(f),v=[],g=0;g<h.length;g++){var x=h.feature(g);v.push({feature:x,index:g,sourceLayerIndex:d,sourceLayerId:f})}for(var b=0,_=c[f];b<_.length;b+=1){var S=_[b],A=S[0];if(A.visibility!=="none"){$l(S,0,null);var O=s[A.id]=A.createBucket({index:n.bucketLayerIDs.length,layers:S,sourceLayerIndex:d});ne.defined(a)&&ne.defined(a[A.id])&&(u.indexData=a[A.id]),O.populate(v,u),n.bucketLayerIDs.push(S.map(function(B){return B.id}))}}}}}var L=null;for(var F in s)(O=s[F]).hasPattern&&(O instanceof pe||O instanceof Be)&&(L==null&&(L=new or({},r)),O.addFeatures(u,L.patternPositions));return{buckets:s,imageAtlas:L,featureIndex:n}}function $l(e,t,r){for(var n=new Se(t),i=0,a=e;i<a.length;i+=1)a[i].recalculate(n,r)}Ln.prototype.replace=function(e){this._layerConfigs={},this._layers={},this.update(e,[])},Ln.prototype.update=function(e,t){for(var r=this,n=0,i=e;n<i.length;n+=1){var a=i[n];this._layerConfigs[a.id]=a;var o=Wl(a);o!=null&&(this._layers[a.id]=o,o._featureFilter=tr.createFilter(o.filter),this.keyCache[a.id]&&delete this.keyCache[a.id])}for(var s=0,u=t;s<u.length;s+=1){var p=u[s];delete this.keyCache[p],delete this._layerConfigs[p],delete this._layers[p]}this.familiesBySource={};for(var c=0,f=Eu(Kl(this._layerConfigs),this.keyCache);c<f.length;c+=1){var h=f[c].map(function(_){return r._layers[_.id]}),d=h[0];if(d!=null&&d.visibility!=="none"){var v=d.source||"",g=this.familiesBySource[v];g||(g=this.familiesBySource[v]={});var x=d.sourceLayer,b=g[x];b||(b=g[x]=[]),b.push(h)}}},k.register("FeatureIndex",it,{omit:["rawTileData","sourceLayerCoder"]});var Nl=ca(Jl);return Nl});
