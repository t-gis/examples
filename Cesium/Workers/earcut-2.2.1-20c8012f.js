/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.98
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */

define(["exports"],function(P){"use strict";function F(t,r,e){e=e||2;var i,x,u,n,f,o,l,g=r&&r.length,s=g?r[0]*e:t.length,a=K(t,0,s,e,!0),y=[];if(!a||a.next===a.prev)return y;if(g&&(a=function(w,m,c,d){var h,M,b,z=[];for(h=0,M=m.length;h<M;h++)(b=K(w,m[h]*d,h<M-1?m[h+1]*d:w.length,d,!1))===b.next&&(b.steiner=!0),z.push(X(b));for(z.sort(U),h=0;h<z.length;h++)V(z[h],c),c=Z(c,c.next);return c}(t,r,a,e)),t.length>80*e){i=u=t[0],x=n=t[1];for(var v=e;v<s;v+=e)(f=t[v])<i&&(i=f),(o=t[v+1])<x&&(x=o),f>u&&(u=f),o>n&&(n=o);l=(l=Math.max(u-i,n-x))!==0?1/l:0}return j(a,y,e,i,x,l),y}function K(t,r,e,i,x){var u,n;if(x===I(t,r,e,i)>0)for(u=r;u<e;u+=i)n=O(u,t[u],t[u+1],n);else for(u=e-i;u>=r;u-=i)n=O(u,t[u],t[u+1],n);return n&&B(n,n.next)&&(A(n),n=n.next),n}function Z(t,r){if(!t)return t;r||(r=t);var e,i=t;do if(e=!1,i.steiner||!B(i,i.next)&&p(i.prev,i,i.next)!==0)i=i.next;else{if(A(i),(i=r=i.prev)===i.next)break;e=!0}while(e||i!==r);return r}function j(t,r,e,i,x,u,n){if(t){!n&&u&&function(g,s,a,y){var v=g;do v.z===null&&(v.z=G(v.x,v.y,s,a,y)),v.prevZ=v.prev,v.nextZ=v.next,v=v.next;while(v!==g);v.prevZ.nextZ=null,v.prevZ=null,function(w){var m,c,d,h,M,b,z,E,J=1;do{for(c=w,w=null,M=null,b=0;c;){for(b++,d=c,z=0,m=0;m<J&&(z++,d=d.nextZ);m++);for(E=J;z>0||E>0&&d;)z!==0&&(E===0||!d||c.z<=d.z)?(h=c,c=c.nextZ,z--):(h=d,d=d.nextZ,E--),M?M.nextZ=h:w=h,h.prevZ=M,M=h;c=d}M.nextZ=null,J*=2}while(b>1)}(v)}(t,i,x,u);for(var f,o,l=t;t.prev!==t.next;)if(f=t.prev,o=t.next,u?R(t,i,x,u):Q(t))r.push(f.i/e),r.push(t.i/e),r.push(o.i/e),A(t),t=o.next,l=o.next;else if((t=o)===l){n?n===1?j(t=S(Z(t),r,e),r,e,i,x,u,2):n===2&&T(t,r,e,i,x,u):j(Z(t),r,e,i,x,u,1);break}}}function Q(t){var r=t.prev,e=t,i=t.next;if(p(r,e,i)>=0)return!1;for(var x=t.next.next;x!==t.prev;){if(k(r.x,r.y,e.x,e.y,i.x,i.y,x.x,x.y)&&p(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function R(t,r,e,i){var x=t.prev,u=t,n=t.next;if(p(x,u,n)>=0)return!1;for(var f=x.x<u.x?x.x<n.x?x.x:n.x:u.x<n.x?u.x:n.x,o=x.y<u.y?x.y<n.y?x.y:n.y:u.y<n.y?u.y:n.y,l=x.x>u.x?x.x>n.x?x.x:n.x:u.x>n.x?u.x:n.x,g=x.y>u.y?x.y>n.y?x.y:n.y:u.y>n.y?u.y:n.y,s=G(f,o,r,e,i),a=G(l,g,r,e,i),y=t.prevZ,v=t.nextZ;y&&y.z>=s&&v&&v.z<=a;){if(y!==t.prev&&y!==t.next&&k(x.x,x.y,u.x,u.y,n.x,n.y,y.x,y.y)&&p(y.prev,y,y.next)>=0||(y=y.prevZ,v!==t.prev&&v!==t.next&&k(x.x,x.y,u.x,u.y,n.x,n.y,v.x,v.y)&&p(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;y&&y.z>=s;){if(y!==t.prev&&y!==t.next&&k(x.x,x.y,u.x,u.y,n.x,n.y,y.x,y.y)&&p(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;v&&v.z<=a;){if(v!==t.prev&&v!==t.next&&k(x.x,x.y,u.x,u.y,n.x,n.y,v.x,v.y)&&p(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function S(t,r,e){var i=t;do{var x=i.prev,u=i.next.next;!B(x,u)&&L(x,i,i.next,u)&&q(x,u)&&q(u,x)&&(r.push(x.i/e),r.push(i.i/e),r.push(u.i/e),A(i),A(i.next),i=t=u),i=i.next}while(i!==t);return Z(i)}function T(t,r,e,i,x,u){var n=t;do{for(var f=n.next.next;f!==n.prev;){if(n.i!==f.i&&Y(n,f)){var o=N(n,f);return n=Z(n,n.next),o=Z(o,o.next),j(n,r,e,i,x,u),void j(o,r,e,i,x,u)}f=f.next}n=n.next}while(n!==t)}function U(t,r){return t.x-r.x}function V(t,r){if(r=function(i,x){var u,n=x,f=i.x,o=i.y,l=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var g=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(g<=f&&g>l){if(l=g,g===f){if(o===n.y)return n;if(o===n.next.y)return n.next}u=n.x<n.next.x?n:n.next}}n=n.next}while(n!==x);if(!u)return null;if(f===l)return u;var s,a=u,y=u.x,v=u.y,w=1/0;n=u;do f>=n.x&&n.x>=y&&f!==n.x&&k(o<v?f:l,o,y,v,o<v?l:f,o,n.x,n.y)&&(s=Math.abs(o-n.y)/(f-n.x),q(n,i)&&(s<w||s===w&&(n.x>u.x||n.x===u.x&&W(u,n)))&&(u=n,w=s)),n=n.next;while(n!==a);return u}(t,r),r){var e=N(r,t);Z(e,e.next)}}function W(t,r){return p(t.prev,t,r.prev)<0&&p(r.next,t,t.next)<0}function G(t,r,e,i,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-e)*x)|t<<8))|t<<4))|t<<2))|t<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-i)*x)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function X(t){var r=t,e=t;do(r.x<e.x||r.x===e.x&&r.y<e.y)&&(e=r),r=r.next;while(r!==t);return e}function k(t,r,e,i,x,u,n,f){return(x-n)*(r-f)-(t-n)*(u-f)>=0&&(t-n)*(i-f)-(e-n)*(r-f)>=0&&(e-n)*(u-f)-(x-n)*(i-f)>=0}function Y(t,r){return t.next.i!==r.i&&t.prev.i!==r.i&&!function(e,i){var x=e;do{if(x.i!==e.i&&x.next.i!==e.i&&x.i!==i.i&&x.next.i!==i.i&&L(x,x.next,e,i))return!0;x=x.next}while(x!==e);return!1}(t,r)&&(q(t,r)&&q(r,t)&&function(e,i){var x=e,u=!1,n=(e.x+i.x)/2,f=(e.y+i.y)/2;do x.y>f!=x.next.y>f&&x.next.y!==x.y&&n<(x.next.x-x.x)*(f-x.y)/(x.next.y-x.y)+x.x&&(u=!u),x=x.next;while(x!==e);return u}(t,r)&&(p(t.prev,t,r.prev)||p(t,r.prev,r))||B(t,r)&&p(t.prev,t,t.next)>0&&p(r.prev,r,r.next)>0)}function p(t,r,e){return(r.y-t.y)*(e.x-r.x)-(r.x-t.x)*(e.y-r.y)}function B(t,r){return t.x===r.x&&t.y===r.y}function L(t,r,e,i){var x=D(p(t,r,e)),u=D(p(t,r,i)),n=D(p(e,i,t)),f=D(p(e,i,r));return x!==u&&n!==f||!(x!==0||!C(t,e,r))||!(u!==0||!C(t,i,r))||!(n!==0||!C(e,t,i))||!(f!==0||!C(e,r,i))}function C(t,r,e){return r.x<=Math.max(t.x,e.x)&&r.x>=Math.min(t.x,e.x)&&r.y<=Math.max(t.y,e.y)&&r.y>=Math.min(t.y,e.y)}function D(t){return t>0?1:t<0?-1:0}function q(t,r){return p(t.prev,t,t.next)<0?p(t,r,t.next)>=0&&p(t,t.prev,r)>=0:p(t,r,t.prev)<0||p(t,t.next,r)<0}function N(t,r){var e=new H(t.i,t.x,t.y),i=new H(r.i,r.x,r.y),x=t.next,u=r.prev;return t.next=r,r.prev=t,e.next=x,x.prev=e,i.next=e,e.prev=i,u.next=i,i.prev=u,i}function O(t,r,e,i){var x=new H(t,r,e);return i?(x.next=i.next,x.prev=i,i.next.prev=x,i.next=x):(x.prev=x,x.next=x),x}function A(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function H(t,r,e){this.i=t,this.x=r,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,r,e,i){for(var x=0,u=r,n=e-i;u<e;u+=i)x+=(t[n]-t[u])*(t[u+1]+t[n+1]),n=u;return x}F.deviation=function(t,r,e,i){var x=r&&r.length,u=x?r[0]*e:t.length,n=Math.abs(I(t,0,u,e));if(x)for(var f=0,o=r.length;f<o;f++){var l=r[f]*e,g=f<o-1?r[f+1]*e:t.length;n-=Math.abs(I(t,l,g,e))}var s=0;for(f=0;f<i.length;f+=3){var a=i[f]*e,y=i[f+1]*e,v=i[f+2]*e;s+=Math.abs((t[a]-t[v])*(t[y+1]-t[a+1])-(t[a]-t[y])*(t[v+1]-t[a+1]))}return n===0&&s===0?0:Math.abs((s-n)/n)},F.flatten=function(t){for(var r=t[0][0].length,e={vertices:[],holes:[],dimensions:r},i=0,x=0;x<t.length;x++){for(var u=0;u<t[x].length;u++)for(var n=0;n<r;n++)e.vertices.push(t[x][u][n]);x>0&&(i+=t[x-1].length,e.holes.push(i))}return e},P.earcut=F});
