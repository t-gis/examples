/**
 *  ██████████   ████████  ██  ████████
 * ░░░░░██░░░   ██░░░░░░██░██ ██░░░░░░ 
 *     ░██     ██      ░░ ░██░██       
 *     ░██    ░██         ░██░█████████
 *     ░██    ░██    █████░██░░░░░░░░██
 *     ░██    ░░██  ░░░░██░██       ░██
 *     ░██     ░░████████ ░██ ████████ 
 *     ░░       ░░░░░░░░  ░░ ░░░░░░░░  
 * name: tgis-2d
 * version: v0.0.4
 * description: tgis map2d
 * author: tgis
 * time: 2022年11月24日 17:02:23
 */
var Map2d=function(J,je,at,An,ai,Ln,Mn,vr,In,Tn,oi,_n,kn,Fn,Rn,On,Nn,Dn,Gn,Bn,zn,Un,qn,Vn,Wn,Hn,Jn,Zn,Kn,jn,Qn,Yn,Xn,$n,es,ts){"use strict";var Sl=Object.defineProperty;var Cl=(J,je,at)=>je in J?Sl(J,je,{enumerable:!0,configurable:!0,writable:!0,value:at}):J[je]=at;var _=(J,je,at)=>(Cl(J,typeof je!="symbol"?je+"":je,at),at);const de=n=>n&&typeof n=="object"&&"default"in n?n:{default:n};function it(n){if(n&&n.__esModule)return n;const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const t in n)if(t!=="default"){const r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:()=>n[t]})}}return e.default=n,Object.freeze(e)}function rs(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const h=Object.getOwnPropertyDescriptor(r,i);h&&Object.defineProperty(n,i,h.get?h:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}const li=de(je),yr=it(at),mr=de(An),is=it(ai),ui=de(Ln),hi=de(Mn),ot=it(vr),wr=de(In),ns=de(Tn),ci=it(oi),ss=de(_n),Kt=de(kn),as=it(Fn),os=it(Rn),di=de(On),ct=de(Nn),ls=de(Dn),It=it(Gn),us=de(Bn),hs=de(zn),cs=de(Un),ds=de(qn),fs=de(Vn),ps=de(Wn),fi=de(Hn),gs=de(Jn),jt=de(Zn),pi=de(Kn),xr=de(jn),gi=de(Qn),Sr=de(Yn),vi=de(Xn),yi=it($n),vs=de(es),ys=de(ts);function ms(n){const e=turf.featureCollection(n.map(i=>turf.point([i.lng,i.lat]))),t=turf.envelope(e),r=t&&t.bbox;return t&&t.bbox?r.chunk(2):r}const ws=Object.freeze(Object.defineProperty({__proto__:null,computeRectangleFromPositionArray:ms},Symbol.toStringTag,{value:"Module"})),xs=function(){li.default.prototype.destroy=function(){let n=this.getElement();n.parentElement.removeChild(n),n=null}}(),mi={withAlpha:function(n,e){const[t,r,i]=ol.color.asArray(n);return ol.color.asString([t,r,i,e])}},Ss=Object.freeze(Object.defineProperty({__proto__:null,OlExtend:xs,color:mi},Symbol.toStringTag,{value:"Module"})),Qe={POINT:0,ANGLE:1,POLYLINE:2,POLYGON:3,RECTANGLE:4,SQUARE:5,CIRCLE:6};class Qt{constructor(){_(this,"events",new wi)}on(e,t){this.events.add(e,t)}un(e,t){this.events.remove(e,t)}fire(e,t){this.events.getByEventType(e).forEach(r=>{var i;return(i=r.callback)==null?void 0:i.call(r,t)})}clear(){this.events.removeAll()}}class lt extends Qt{constructor(t){super();_(this,"viewer");_(this,"layer");_(this,"type");_(this,"tipPopup");_(this,"resultPopup");_(this,"_result",0);_(this,"unit","km");_(this,"tempListeners",[]);_(this,"tempPopups",[]);_(this,"geometry");_(this,"drawStart",t=>{this.fire("start",{target:this}),t.feature.getGeometry().on("change",this.drawChange),this.onStart(t)});_(this,"drawEnd",t=>{const r=t.feature.getGeometry();this.geometry=r,this.fire("end",{target:this}),r.un("change",this.drawChange),this.onEnd(t),this.resultPopup&&this.resultPopup.setPosition(null)});_(this,"drawChange",t=>{this.fire("change",{target:this}),this.onChange(t)});this.viewer=t==null?void 0:t.viewer,this.layer=t==null?void 0:t.layer,this.init()}set tipText(t){this.tipPopup&&(this.tipPopup.getElement().innerText=t),this._tipText=t}get tipText(){return this._tipText}set result(t){this._result=t,this.resultPopup&&(this.resultPopup.getElement().innerText=this.getResultText())}get result(){return this._result}getResultText(){return`${this._result.toFixed(6)} ${this.unit}`}get source(){return this.layer.getSource()}init(){this.createStyle({id:"tgis-measure-tip-popup",text:'.tgis-measure-tip-popup,.tgis-measure-result-popup{pointer-events:none;font-size:12px;font-weight:300;color:white;background:rgba(0,0,0,0.4);border-radius:4px;padding:4px 8px}.tgis-measure-result-popup{position:absolute;pointer-events:auto;white-space:nowrap;transform:translate(-50%,-100%)}.tgis-measure-result-popup::before{border-top:6px solid rgba(0,0,0,0.5);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.tgis-measure-result-popup.static{background:rgba(255,99,71,0.5);color:black;border:1px solid white}.tgis-measure-result-popup.static::before{border-top:6px solid rgba(255,99,71,0.5)}'}),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236",this.result=0}createPopup(t){var h,c;const r=document.createElement((h=t==null?void 0:t.tagName)!=null?h:"div");r.className=t==null?void 0:t.className,r.innerText=t==null?void 0:t.innerText;const i=new ol.Overlay({element:r,offset:(c=t==null?void 0:t.offset)!=null?c:[15,0],positioning:t==null?void 0:t.positioning,stopEvent:!1});return this.tempPopups.push(i),i}initTipPopup(t){var i,h;this.tipPopup=this.createPopup({tagName:"div",className:"tgis-measure-tip-popup",innerText:this.tipText,offset:(i=t==null?void 0:t.offset)!=null?i:[15,0],positioning:(h=t==null?void 0:t.positioning)!=null?h:"center-left"}),this.viewer._addOverlay(this.tipPopup);let r=this.viewer.map.on("pointermove",c=>{this.tipPopup.setPosition(c.coordinate)});this.tempListeners.push(r)}initResultPopup(t){var r,i;this.resultPopup=this.createPopup({tagName:"div",className:"tgis-measure-result-popup",innerText:this.getResultText(),offset:(r=t==null?void 0:t.offset)!=null?r:[15,0],positioning:(i=t==null?void 0:t.positioning)!=null?i:"center-left"}),this.viewer._addOverlay(this.resultPopup)}start(){}end(){}destroy(){this.geometry=void 0,this.fire("destroy"),this.tempListeners.length&&(this.tempListeners.forEach(t=>ol.Observable.unByKey(t)),this.tempListeners=[]),this.tempPopups.length&&this.tempPopups.forEach(t=>this.viewer._removeOverlay(t))}initTooltip(){}createStyle(t){const{id:r,text:i}=t;let h=document.getElementById(r);h||(h=document.createElement("style"),h.setAttribute("id",r),h.textContent=i,document.head.appendChild(h))}onDrawEvent(){this.draw.on("drawstart",this.drawStart),this.draw.on("drawend",this.drawEnd)}unDrawEvent(){this.draw.un("drawstart",this.drawStart),this.draw.un("drawend",this.drawEnd)}getCoordinates(){var t;return(t=this.geometry)==null?void 0:t.getCoordinates()}}class ut{constructor(e){this.owner=e}getCoordinates(e){return e.getCoordinates()}getArea(e){return e.getArea()}getLength(e){return e.getLength()}}class Cs extends ut{constructor(...e){super(...e)}}class Es extends lt{constructor(t){super(t);_(this,"type","Point");_(this,"unit","\xB0");_(this,"attr",new Cs)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getCoordinates(t)}getResultText(){const t=this.result;return`${t[0].toFixed(7)}${this.unit}, ${t[1].toFixed(7)}${this.unit}`}onStart(){}onEnd(t){const r=t.feature.getGeometry();this.result=this.getResult(r);const i=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,-15],positioning:"bottom-center"});i.setPosition(r.getLastCoordinate()),this.viewer._addOverlay(i),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}getCoordinates(){let t;return this.geometry&&(t=this.attr.getCoordinates(this.geometry)),t}}class bs extends ut{constructor(...e){super(...e)}calculateAngle(e){const t=e[0],r=e[1],i=e[2],h=t[0]-r[0],c=t[1]-r[1],p=i[0]-r[0],g=i[1]-r[1],v=h*p+c*g,y=Math.sqrt(Math.pow(h,2)+Math.pow(c,2)),w=Math.sqrt(Math.pow(p,2)+Math.pow(g,2)),A=v/(y*w);return Math.acos(A)*180/Math.PI}getAngle(e){const t=e.getCoordinates();return t.length<3?0:this.calculateAngle(t.slice(0,3))}}class Ps extends lt{constructor(t){super(t);_(this,"type","LineString");_(this,"unit","\xB0");_(this,"attr",new bs)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){const r=this.attr.getAngle(t);return isNaN(r)?0:r}onStart(){}onEnd(t){const r=t.feature.getGeometry(),i=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,-8],positioning:"bottom-center"});i.setPosition(r.getCoordinates()[1]),this.viewer._addOverlay(i),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;if(r.getCoordinates().length>=4){this.draw.finishDrawing();return}this.resultPopup?this.resultPopup.setPosition(r.getCoordinates()[1]):this.initResultPopup({offset:[0,-8],positioning:"bottom-center"}),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u7EE7\u7EED\u7ED8\u5236"}}class As extends ut{constructor(...e){super(...e)}}class Ls extends lt{constructor(t){super(t);_(this,"type","LineString");_(this,"unit","km");_(this,"attr",new As)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getLength(t)}onStart(){}onEnd(t){const r=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,-8],positioning:"bottom-center"});r.setPosition(t.feature.getGeometry().getLastCoordinate()),this.viewer._addOverlay(r),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;this.resultPopup?this.resultPopup.setPosition(r.getLastCoordinate()):this.initResultPopup(),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u7EE7\u7EED\u7ED8\u5236"}}class Ms extends ut{constructor(...e){super(...e)}}class Is extends lt{constructor(t){super(t);_(this,"type","Polygon");_(this,"unit","km\xB2");_(this,"attr",new Ms)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getArea(t)}onStart(){}onEnd(t){const r=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,-15],positioning:"bottom-center"});r.setPosition(t.feature.getGeometry().getInteriorPoint().getCoordinates()),this.viewer._addOverlay(r),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;this.resultPopup?this.resultPopup.setPosition(r.getInteriorPoint().getCoordinates()):this.initResultPopup(),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u7EE7\u7EED\u7ED8\u5236"}}class Ts extends ut{constructor(...e){super(...e)}}class _s extends lt{constructor(t){super(t);_(this,"type","LineString");_(this,"unit","km\xB2");_(this,"attr",new Ts)}geometryFunction(t,r){r||(r=new ol.geom.Polygon([]));const i=t[0],h=t[1];return r.setCoordinates([[i,[i[0],h[1]],h,[h[0],i[1]],i]]),r}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type,geometryFunction:this.geometryFunction,maxPoints:2}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getArea(t)}onStart(){}onEnd(t){const r=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,0],positioning:"center-center"});r.setPosition(t.feature.getGeometry().getInteriorPoint().getCoordinates()),this.viewer._addOverlay(r),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;this.resultPopup?this.resultPopup.setPosition(r.getInteriorPoint().getCoordinates()):this.initResultPopup({offset:[0,0],positioning:"center-center"}),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u505C\u6B62\u7ED8\u5236"}}class ks extends ut{constructor(...e){super(...e)}}class Fs extends lt{constructor(t){super(t);_(this,"type","Circle");_(this,"unit","km\xB2");_(this,"attr",new ks)}geometryFunction(){return ol.interaction.Draw.createRegularPolygon(4)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type,geometryFunction:this.geometryFunction()}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getArea(t)}onStart(){}onEnd(t){const r=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,0],positioning:"center-center"});r.setPosition(t.feature.getGeometry().getInteriorPoint().getCoordinates()),this.viewer._addOverlay(r),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;this.resultPopup?this.resultPopup.setPosition(r.getInteriorPoint().getCoordinates()):this.initResultPopup({offset:[0,0],positioning:"center-center"}),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u505C\u6B62\u7ED8\u5236"}}class Rs extends ut{constructor(...e){super(...e)}getArea(e){return Math.pow(e.getRadius(),2)*Math.PI}}class Os extends lt{constructor(t){super(t);_(this,"type","Circle");_(this,"unit","km\xB2");_(this,"attr",new Rs)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getArea(t)}onStart(){}onEnd(t){const r=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,0],positioning:"center-center"});r.setPosition(t.feature.getGeometry().getCenter()),this.viewer._addOverlay(r),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;this.resultPopup?this.resultPopup.setPosition(r.getCenter()):this.initResultPopup({offset:[0,0],positioning:"center-center"}),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u505C\u6B62\u7ED8\u5236"}}class Ns{constructor(e,t){_(this,"handlers",{[Qe.POINT]:Es,[Qe.ANGLE]:Ps,[Qe.POLYLINE]:Ls,[Qe.POLYGON]:Is,[Qe.RECTANGLE]:_s,[Qe.SQUARE]:Fs,[Qe.CIRCLE]:Os});this.viewer=e,this.layer=new ol.layer.Vector,this.source=new ol.source.Vector,this.init(t)}addHandler(e,t){this.handlers[t]}getHandler(e){var t;return(t=this.handlers[e])!=null?t:this.handlers[Qe.POINT]}destroyEvent(){this.viewer.map.un("pointermove",this.onMousemove)}init(e){const{viewer:t,layer:r,source:i}=this;this.styleOptions=this.makeStyleOptions(e==null?void 0:e.style),this.style=this.makeStyle(this.styleOptions),r.setSource(i),r.setStyle(this.style),t._addLayer(r)}makeStyleOptions(e){var t,r,i,h,c;return{markerSize:(t=e==null?void 0:e.markerSize)!=null?t:6,markerColor:(r=e==null?void 0:e.markerColor)!=null?r:"#0099ff",stroke:(i=e==null?void 0:e.stroke)!=null?i:"tomato",strokeWidth:(h=e==null?void 0:e.strokeWidth)!=null?h:2,fill:(c=e==null?void 0:e.fill)!=null?c:"rgba(255, 255, 0, 0.3)"}}makeStroke(e){const{strokeWidth:t,stroke:r}=e;return new ol.style.Stroke({width:t,color:r})}makeFill(e){const{fill:t}=e;return new ol.style.Fill({color:t})}makeImage(e){const{markerSize:t}=e;return new ol.style.Circle({radius:t,fill:this.makeFill(e),stroke:this.makeStroke(e)})}makeStyle(e){return new ol.style.Style({stroke:this.makeStroke(e),fill:this.makeFill(e),image:this.makeImage(e)})}start(e){this.end(),e!=null&&e.style&&(this.styleOptions=this.makeStyleOptions(e),this.style=this.makeStyle(this.styleOptions),this.layer.setStyle(style));const t=this.getHandler(e==null?void 0:e.type);this.ctrl=new t({viewer:this.viewer,layer:this.layer}),this.ctrl.start()}end(){this.ctrl&&this.ctrl.end()}destroy(){this.layer&&(this.ctrl.destroy(),this.viewer._removeLayer(this.layer),this.ctrl=null,this.layer=null,this.source=null,this.styleOptions=null,this.style=null)}on(e,t){this.ctrl&&this.ctrl.on(e,t)}un(e,t){this.ctrl&&this.ctrl.un(e,t)}}const Tt={POINT:0,ANGLE:1,LENGTH:2,AREA:3};class Yt extends Qt{constructor(t){super();_(this,"viewer");_(this,"layer");_(this,"type");_(this,"tipPopup");_(this,"resultPopup");_(this,"_result",0);_(this,"unit","km");_(this,"tempListeners",[]);_(this,"tempPopups",[]);_(this,"geometry");_(this,"drawStart",t=>{this.fire("start",{target:this}),t.feature.getGeometry().on("change",this.drawChange),this.onStart(t)});_(this,"drawEnd",t=>{const r=t.feature.getGeometry();this.geometry=r,this.fire("end",{target:this}),r.un("change",this.drawChange),this.onEnd(t),this.resultPopup&&this.resultPopup.setPosition(null)});_(this,"drawChange",t=>{this.fire("change",{target:this}),this.onChange(t)});this.viewer=t==null?void 0:t.viewer,this.layer=t==null?void 0:t.layer,this.init()}set tipText(t){this.tipPopup&&(this.tipPopup.getElement().innerText=t),this._tipText=t}get tipText(){return this._tipText}set result(t){this._result=t,this.resultPopup&&(this.resultPopup.getElement().innerText=this.getResultText())}get result(){return this._result}getResultText(){return`${this._result.toFixed(6)} ${this.unit}`}get source(){return this.layer.getSource()}init(){this.createStyle({id:"tgis-measure-tip-popup",text:'.tgis-measure-tip-popup,.tgis-measure-result-popup{pointer-events:none;font-size:12px;font-weight:300;color:white;background:rgba(0,0,0,0.4);border-radius:4px;padding:4px 8px}.tgis-measure-result-popup{position:absolute;pointer-events:auto;white-space:nowrap;transform:translate(-50%,-100%)}.tgis-measure-result-popup::before{border-top:6px solid rgba(0,0,0,0.5);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.tgis-measure-result-popup.static{background:rgba(255,99,71,0.5);color:black;border:1px solid white}.tgis-measure-result-popup.static::before{border-top:6px solid rgba(255,99,71,0.5)}'}),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236",this.result=0}createPopup(t){var h,c;const r=document.createElement((h=t==null?void 0:t.tagName)!=null?h:"div");r.className=t==null?void 0:t.className,r.innerText=t==null?void 0:t.innerText;const i=new ol.Overlay({element:r,offset:(c=t==null?void 0:t.offset)!=null?c:[15,0],positioning:t==null?void 0:t.positioning,stopEvent:!1});return this.tempPopups.push(i),i}initTipPopup(t){var i,h;this.tipPopup=this.createPopup({tagName:"div",className:"tgis-measure-tip-popup",innerText:this.tipText,offset:(i=t==null?void 0:t.offset)!=null?i:[15,0],positioning:(h=t==null?void 0:t.positioning)!=null?h:"center-left"}),this.viewer._addOverlay(this.tipPopup);let r=this.viewer.map.on("pointermove",c=>{this.tipPopup.setPosition(c.coordinate)});this.tempListeners.push(r)}initResultPopup(t){var r,i;this.resultPopup=this.createPopup({tagName:"div",className:"tgis-measure-result-popup",innerText:this.getResultText(),offset:(r=t==null?void 0:t.offset)!=null?r:[15,0],positioning:(i=t==null?void 0:t.positioning)!=null?i:"center-left"}),this.viewer._addOverlay(this.resultPopup)}start(){}end(){}destroy(){this.geometry=void 0,this.fire("destroy"),this.tempListeners.length&&(this.tempListeners.forEach(t=>ol.Observable.unByKey(t)),this.tempListeners=[]),this.tempPopups.length&&this.tempPopups.forEach(t=>this.viewer._removeOverlay(t))}initTooltip(){}createStyle(t){const{id:r,text:i}=t;let h=document.getElementById(r);h||(h=document.createElement("style"),h.setAttribute("id",r),h.textContent=i,document.head.appendChild(h))}onDrawEvent(){this.draw.on("drawstart",this.drawStart),this.draw.on("drawend",this.drawEnd)}unDrawEvent(){this.draw.un("drawstart",this.drawStart),this.draw.un("drawend",this.drawEnd)}getCoordinates(){var t;return(t=this.geometry)==null?void 0:t.getCoordinates()}}class Xt{constructor(e){this.owner=e}getCoordinates(e){return e.getCoordinates()}getArea(e){return e.getArea()}getLength(e){return e.getLength()}}class Ds extends Xt{constructor(...e){super(...e)}}class Gs extends Yt{constructor(t){super(t);_(this,"type","Point");_(this,"unit","\xB0");_(this,"attr",new Ds)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getCoordinates(t)}getResultText(){const t=this.result;return`${t[0].toFixed(7)}${this.unit}, ${t[1].toFixed(7)}${this.unit}`}onStart(){}onEnd(t){const r=t.feature.getGeometry();this.result=this.getResult(r);const i=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,-15],positioning:"bottom-center"});i.setPosition(r.getLastCoordinate()),this.viewer._addOverlay(i),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}}class Bs extends Xt{constructor(...e){super(...e)}calculateAngle(e){const t=e[0],r=e[1],i=e[2],h=t[0]-r[0],c=t[1]-r[1],p=i[0]-r[0],g=i[1]-r[1],v=h*p+c*g,y=Math.sqrt(Math.pow(h,2)+Math.pow(c,2)),w=Math.sqrt(Math.pow(p,2)+Math.pow(g,2)),A=v/(y*w);return Math.acos(A)*180/Math.PI}getAngle(e){const t=e.getCoordinates();return t.length<3?0:this.calculateAngle(t.slice(0,3))}}class zs extends Yt{constructor(t){super(t);_(this,"type","LineString");_(this,"unit","\xB0");_(this,"attr",new Bs)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){const r=this.attr.getAngle(t);return isNaN(r)?0:r}onStart(){}onEnd(t){const r=t.feature.getGeometry(),i=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,-8],positioning:"bottom-center"});i.setPosition(r.getCoordinates()[1]),this.viewer._addOverlay(i),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;if(r.getCoordinates().length>=4){this.draw.finishDrawing();return}this.resultPopup?this.resultPopup.setPosition(r.getCoordinates()[1]):this.initResultPopup({offset:[0,-8],positioning:"bottom-center"}),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u7EE7\u7EED\u7ED8\u5236"}}class Us extends Xt{constructor(...e){super(...e)}}class qs extends Yt{constructor(t){super(t);_(this,"type","LineString");_(this,"unit","km");_(this,"attr",new Us)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getLength(t)}onStart(){}onEnd(t){const r=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,-8],positioning:"bottom-center"});r.setPosition(t.feature.getGeometry().getLastCoordinate()),this.viewer._addOverlay(r),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;this.resultPopup?this.resultPopup.setPosition(r.getLastCoordinate()):this.initResultPopup(),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u7EE7\u7EED\u7ED8\u5236"}}class Vs extends Xt{constructor(...e){super(...e)}}class Ws extends Yt{constructor(t){super(t);_(this,"type","Polygon");_(this,"unit","km\xB2");_(this,"attr",new Vs)}start(){const{map:t}=this.viewer;this.draw=new ol.interaction.Draw({source:this.source,type:this.type}),t.addInteraction(this.draw),this.onDrawEvent(),this.initTipPopup()}end(){if(this.draw){this.unDrawEvent();const{map:t}=this.viewer;t.removeInteraction(this.draw),this.draw=null}}getResult(t){return this.attr.getArea(t)}onStart(){}onEnd(t){const r=this.createPopup({tagName:"div",className:"tgis-measure-result-popup static",innerText:this.getResultText(),offset:[0,-15],positioning:"bottom-center"});r.setPosition(t.feature.getGeometry().getInteriorPoint().getCoordinates()),this.viewer._addOverlay(r),this.tipText="\u5355\u51FB\u5F00\u59CB\u7ED8\u5236"}onChange(t){const r=t.target;this.resultPopup?this.resultPopup.setPosition(r.getInteriorPoint().getCoordinates()):this.initResultPopup(),this.result=this.getResult(r),this.tipText="\u5355\u51FB\u4EE5\u7EE7\u7EED\u7ED8\u5236"}}class Hs{constructor(e,t){_(this,"handlers",{[Tt.POINT]:Gs,[Tt.ANGLE]:zs,[Tt.LENGTH]:qs,[Tt.AREA]:Ws});this.viewer=e,this.layer=new ol.layer.Vector,this.source=new ol.source.Vector,this.init(t)}addHandler(e,t){this.handlers[t]}getHandler(e){var t;return(t=this.handlers[e])!=null?t:this.handlers[DrawType.POINT]}destroyEvent(){this.viewer.map.un("pointermove",this.onMousemove)}init(e){const{viewer:t,layer:r,source:i}=this;this.styleOptions=this.makeStyleOptions(e==null?void 0:e.style),this.style=this.makeStyle(this.styleOptions),r.setSource(i),r.setStyle(this.style),t._addLayer(r)}makeStyleOptions(e){var t,r,i,h,c;return{markerSize:(t=e==null?void 0:e.markerSize)!=null?t:6,markerColor:(r=e==null?void 0:e.markerColor)!=null?r:"#0099ff",stroke:(i=e==null?void 0:e.stroke)!=null?i:"tomato",strokeWidth:(h=e==null?void 0:e.strokeWidth)!=null?h:2,fill:(c=e==null?void 0:e.fill)!=null?c:"rgba(255, 255, 0, 0.3)"}}makeStroke(e){const{strokeWidth:t,stroke:r}=e;return new ol.style.Stroke({width:t,color:r})}makeFill(e){const{fill:t}=e;return new ol.style.Fill({color:t})}makeImage(e){const{markerSize:t}=e;return new ol.style.Circle({radius:t,fill:this.makeFill(e),stroke:this.makeStroke(e)})}makeStyle(e){return new ol.style.Style({stroke:this.makeStroke(e),fill:this.makeFill(e),image:this.makeImage(e)})}start(e){this.end(),e!=null&&e.style&&(this.styleOptions=this.makeStyleOptions(e),this.style=this.makeStyle(this.styleOptions),this.layer.setStyle(style));const t=this.getHandler(e==null?void 0:e.type);this.ctrl=new t({viewer:this.viewer,layer:this.layer}),this.ctrl.start()}end(){this.ctrl&&this.ctrl.end()}destroy(){this.layer&&(this.ctrl.destroy(),this.viewer._removeLayer(this.layer),this.ctrl=null,this.layer=null,this.source=null,this.styleOptions=null,this.style=null)}on(e,t){this.ctrl&&this.ctrl.on(e,t)}un(e,t){this.ctrl&&this.ctrl.un(e,t)}}class $t{constructor(){this._array=[],this._hash={}}get length(){return this._array.length}get values(){return this._array}contains(e){return Se(this._hash[e])}set(e,t){const r=this._hash[e];t!==r&&(this.remove(e),this._hash[e]=t,this._array.push(t))}get(e){return this._hash[e]}remove(e){const t=this._hash[e],r=Se(t);if(r){const i=this._array;i.splice(i.indexOf(t),1),delete this._hash[e]}return r}removeAll(){const e=this._array;e.length&&(this._hash={},e.length=0)}}function Ye(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}function Se(n){return n!=null}class _t extends Error{constructor(e){this.name="DeveloperError",this.message=e;let t;try{throw new Error}catch(r){t=r.stack}this.stack=t}toString(){let e=`${this.name}: ${this.message}`;return Se(this.stack)&&(e+=`
${this.stack.toString()}`),e}static throwInstantiationError(){throw new _t("\u62BD\u8C61\u7C7B\u4E0D\u80FD\u88AB\u5B9E\u4F8B\u5316.")}}class dt{constructor(){new.target===dt&&_t.throwInstantiationError()}}class Js extends dt{constructor(t){t=t!=null?t:{};super();_(this,"code");_(this,"proj");this.code=t.code,this.proj=ol.proj.get(this.code)}get code(){return this.code}getProj(){return this.proj}}class ft{constructor(){_(this,"projection");_(this,"rectangle");new.target===ft&&DeveloperError.throwInstantiationError()}}class Zs extends ft{constructor(e){e=e!=null?e:{},super(),this.projection=e.projection}}class er{get id(){return this._id}constructor(e){this.callback=e,this._id=Ye()}static fromCallback(e){return new er(e)}}class wi{constructor(){_(this,"events",new Map)}add(e,t){const{events:r}=this;Se(r.get(e))||r.set(e,new $t);const i=er.fromCallback(t);return r.get(e).set(i.id,i),i}get(e,t){const r=this.events.get(e);if(!!Se(r))return r.values.find(i=>i.callback===t)}getByEventCallbackId(e,t){const r=this.events.get(e);if(!!Se(r))return r.values.find(i=>i.id===t)}getByEventType(e){const t=this.events.get(e);return t?t.values:[]}remove(e,t){const r=this.events.get(e);if(!Se(r))return;const i=this.get(e,t);return Se(i)?r.remove(i.id):this.removeAll(),i}removeAll(){this.events.forEach(e=>e.removeAll())}}class xi extends dt{constructor(){super();_(this,"code");_(this,"proj");this.code="EPSG:4326",this.proj=ol.proj.get(this.code)}get code(){return this.code}getProj(){return this.proj}}class Si extends ft{constructor(){super(),this.projection=new xi}}function Cr(){if(ol.util&&ol.util.VERSION)return ol.util.VERSION.split(".")[0];if(window&&window.ol){if(window.ol.util)return"6";if(window.ol.WebGLMap)return"5"}return"4"}class Te{constructor(e,t){_(this,"lng",0);_(this,"lat",0);this.lng=e,this.lat=t}static lerp(e,t,r){const i=Te.multiplyByScalar(t,r),h=Te.multiplyByScalar(e,1-r);return Te.add(i,h)}static multiplyByScalar(e,t){return new Te(e.lng*t,e.lat*t)}static divideByScalar(e,t){return new Te(e.lng/t,e.lat/t)}static add(e,t){return new Te(e.lng+t.lng,e.lat+t.lat)}static subtract(e,t){return new Te(e.lng-t.lng,e.lat-t.lat)}}class Ue{constructor(e){_(this,"url");_(this,"queryParameters");_(this,"headers");_(this,"responseType");this.setOptions(e)}setOptions(e){var t,r,i,h;!e||(this.url=(t=e.url)!=null?t:this.url,this.queryParameters=(r=e.queryParameters)!=null?r:this.queryParameters,this.headers=(i=e.headers)!=null?i:this.headers,this.responseType=(h=e.responseType)!=null?h:this.responseType)}makeRequest(e){const t=e.url,r=e.requestOptions,i=e.responseType;return fetch(t,r).then(h=>h[i!=null?i:"text"]())}makeQueryURL(e,t){const r=new URL(e);if(t){const i=new URLSearchParams().setObject(t);r.search=i.toString()}return r}fetch(e){this.setOptions(e);const t=this.makeQueryURL(this.url,this.queryParameters),i={method:"GET",headers:new Headers(this.headers)};return new Promise((h,c)=>{this.makeRequest({url:t,requestOptions:i,responseType:this.responseType}).then(p=>h(p)).catch(p=>c(p))})}fetchJson(e={}){return e.responseType="json",this.fetch(e)}post(e,t){this.setOptions(e);const r=this.makeQueryURL(this.url,this.queryParameters),h={method:"POST",headers:new Headers(this.headers),body:t};return new Promise((c,p)=>{this.makeRequest({url:r,requestOptions:h,responseType:this.responseType}).then(g=>c(g)).catch(g=>p(g))})}static fetch(e){return new Ue().fetch(e)}static fetchJson(e){return new Ue().fetch(e)}static fetchArrayBuffer(e){return new Ue().fetchJson(e)}static fetchFormData(e){return new Ue().fetch(e)}static fetchBlob(e){return new Ue().fetch(e)}static fetchText(e){return Ue.fetch(e)}static post(e){e=e!=null?e:{};const{data:t,...r}=e;return new Ue().post(r,t)}}const _e=Object.freeze({LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19,MOUSE_OVER:20,MOUSE_OUT:21});_e.LEFT_DOWN+"",_e.LEFT_UP+"",_e.LEFT_CLICK+"",_e.LEFT_DOUBLE_CLICK+"",_e.RIGHT_DOWN+"",_e.RIGHT_UP+"",_e.RIGHT_CLICK+"",_e.MIDDLE_DOWN+"",_e.MIDDLE_UP+"",_e.MOUSE_MOVE+"",_e.MOUSE_OVER+"",_e.MOUSE_OUT+"",_e.WHEEL+"";class Ks{constructor(e){_(this,"_inputEvents");_(this,"_canvas");this._canvas=e}setInputAction(e,t){}removeInputAction(e){}getInputAction(e){}}class Ci extends dt{constructor(){super();_(this,"code");_(this,"proj");this.code="EPSG:3857",this.proj=ol.proj.get(this.code)}get code(){return this.code}getProj(){return this.proj}}class js extends ft{constructor(){super(),this.projection=new Ci}}class tr{constructor(e){_(this,"billboard");_(this,"label");_(this,"point");_(this,"renderBuffer",100);_(this,"properties");_(this,"_show",!0);if(this.layer=new ol.layer.Vector({renderBuffer:e.renderBuffer||this.renderBuffer}),this.source=new ol.source.Vector,this._id=e.id||Ye(),(e==null?void 0:e.position)instanceof Te){const t=e.position;this._position=[t.lng,t.lat]}else this._position=e.position||[0,0];this.zIndex=e.zIndex||1,this.properties=e.properties,e.billboard&&(this.billboard=this.addGraphics(Ei,e.billboard)),e.label&&(this.label=this.addGraphics(bi,e.label)),e.point&&(this.point=this.addGraphics(Pi,e.point)),this.layer.setSource(this.source),this.layer.setZIndex(this.zIndex),this.layer.set("id",this.id)}get show(){return this._show}set show(e){this.layer.setVisible(e),this._show=e}get id(){return this._id}get position(){return this._position}set position(e){this.billboard&&this.billboard.geometry.setCoordinates(e),this.label&&this.label.geometry.setCoordinates(e),this.point&&this.point.geometry.setCoordinates(e),this._position=e}addGraphics(e,t){let r=t instanceof e?t:new e(t);return r.geometry.setCoordinates(this._position),r.owner=this,(t.show===void 0||t.show)&&this.source.addFeature(r.feature),r}displayGraphics(e,t){const r=e.feature;if(t){const i=this.source.getFeatureById(r.getId()||r.get("id"));Se(i)&&this.source.removeFeature(i),this.source.addFeature(r)}else this.source.removeFeature(r)}}class Er{constructor(e){this._id=Ye(),this._entities=new $t,this._owner=e}add(e){return e instanceof tr||(e=new tr(e)),this.contains(e)&&this.remove(e),this._entities.set(e.id,e),this._owner._addLayer(e.layer),e}contains(e){return this._entities.contains(e.id)}getById(e){return this._entities.get(e)}remove(e){return this._owner._removeLayer(e.layer),this._entities.remove(e.id)}removeById(e){const t=this._entities.get(e),r=Se(t);return r&&this.remove(t),r}removeAll(){this._entities.values.forEach(e=>{this._owner._removeLayer(e.layer)}),this._entities.removeAll()}}class rr{constructor(e){_(this,"owner");_(this,"geometry");_(this,"feature");_(this,"_eventHash",{});var t;this.owner=e.owner,this._show=(t=e.show)!=null?t:!0}set show(e){this.owner&&this.owner.displayGraphics(this,e),this._show=e}get show(){return this._show}_changed(){this.feature.changed()}on(e,t){if(this.feature){const{_eventHash:r}=this;r[e]||(r[e]=[]);const i=h=>t({...h,properties:this.owner.properties,target:this.owner});this.feature.on(e,i),r[e].push({id:Ye(),fn:t,eFn:i})}}un(e,t){if(this.feature){const{_eventHash:r}=this,h=r[e].find(c=>c.fn===t);h&&this.feature.un(e,h.eFn)}}getExtent(){return this.geometry?this.geometry.getExtent():this.geometry}}class Ei extends rr{constructor(e){super(e),this.geometry=new ol.geom.Point([]),this.feature=new ol.Feature({geometry:this.geometry}),this.image=e.image,this.width=e.width,this.height=e.height,this._scale=e.scale||1,this.opacity=e.opacity||1,this.pixelOffset=e.pixelOffset||[.5,.5],this.style=new ol.style.Style({image:new ol.style.Icon({src:this.image,opacity:this.opacity||1,anchor:this.pixelOffset||[.5,.5]})}),this.feature.setStyle(this.style),this.feature.setId(Ye());const t=new Image;t.src=this.image,t.onload=()=>{this.imageWidth=t.width,this.imageHeight=t.height,this.style.getImage().setScale(this.scale)}}set scale(e){let t=this.width?this.width/this.imageWidth:1,r=this.height?this.height/this.imageHeight:1;t*=e,r*=e;const i=Cr()>=6?[t,r]:t;this.style.getImage().setScale(i),this._changed(),this._scale=e}get scale(){let e=this.width?this.width/this.imageWidth:1,t=this.height?this.height/this.imageHeight:1;return e*=this._scale,t*=this._scale,Cr()>=6?[e,t]:e}set rotation(e){this.style.getImage().setRotation(e),this._changed()}get rotation(){var e;return(e=this.style.getImage().getRotation())!=null?e:0}}class bi extends rr{constructor(e){var t,r,i,h;super(e),this.font=e.font||"30px sans-serif",this.text=e.text,this._scale=(t=e.scale)!=null?t:1,this.rotation=(r=e.rotation)!=null?r:0,this.fillColor=e.fillColor||"#fff",this.outlineColor=e.outlineColor||"#000",this.outlineWidth=(i=e.outlineWidth)!=null?i:0,this.showBackground=e.showBackground||!1,this.backgroundColor=e.backgroundColor||"rgba(165, 165, 165, 0.8)",this.backgroundOutlineWidth=(h=e.backgroundOutlineWidth)!=null?h:0,this.backgroundOutlineColor=e.backgroundOutlineColor||"#000",this.backgroundPadding=e.backgroundPadding||[7,5,7,5],this.pixelOffset=e.pixelOffset||[0,0],this.geometry=new ol.geom.Point([]),this.feature=new ol.Feature({geometry:this.geometry}),this.styleOptions={text:new ol.style.Text({text:this.text,font:this.font,offsetX:this.pixelOffset[0],offsetY:this.pixelOffset[1],scale:this.scale,rotation:this.rotation,fill:new ol.style.Fill({color:this.fillColor}),backgroundFill:this.showBackground?new ol.style.Fill({color:this.backgroundColor}):void 0,backgroundStroke:this.backgroundOutlineWidth>0?new ol.style.Stroke({width:this.backgroundOutlineWidth,color:this.backgroundOutlineColor}):void 0,padding:this.backgroundPadding,stroke:this.outlineWidth>0?new ol.style.Stroke({width:this.outlineWidth,color:this.outlineColor}):void 0})},this.style=new ol.style.Style(this.styleOptions),this.feature.setStyle(this.style),this.feature.setId(Ye())}set scale(e){this.style.getText().setScale(e),this._scale=e}get scale(){return this._scale}}class Pi extends rr{constructor(e){super(e),this.pixelSize=typeof e.pixelSize=="number"?e.pixelSize:10,this.color=e.color||"#fff",this.outlineColor=e.outlineColor||"#000",this.outlineWidth=e.outlineWidth||0,this.geometry=new ol.geom.Point([]),this.feature=new ol.Feature({geometry:this.geometry}),this.styleOptions={image:new ol.style.Circle({radius:this.pixelSize,fill:new ol.style.Fill({color:this.color}),stroke:this.outlineWidth>0?new ol.style.Stroke({width:this.outlineWidth,color:this.outlineColor}):void 0})},this.style=new ol.style.Style(this.styleOptions),this.feature.setStyle(this.style),this.feature.setId(Ye())}set scale(e){this.style.getText().setScale(e),this._scale=e}get scale(){return this._scale}}class Ai extends Qt{constructor(t,r){var c,p,g,v,y,w,A;super();_(this,"positions");_(this,"speed");_(this,"fraction");_(this,"speed");_(this,"color");_(this,"opacity");_(this,"width");_(this,"autoSetView");_(this,"autoFollowView");_(this,"move",t=>{var r;if(this.fraction+=this.speed/this.distance,this.fraction>=1)this.stop();else{const i=this.geometry.getCoordinateAt(this.fraction);this._updateVectorContext(ol.render.getVectorContext(t),i),this.autoFollowView&&((r=this.camera)==null||r.flyTo({destination:new Te(i[0],i[1]),duration:300})),this.fire("move",{coordinate:i,target:this,type:"move"}),this.layer.getSource().changed()}});this.camera=t,this.positions=(c=r.positions)!=null?c:[],this.speed=(p=r.speed)!=null?p:100,this.fraction=0,this.color=(g=r.color)!=null?g:"tomato",this.width=(v=r.width)!=null?v:8,this.opacity=(y=r.opacity)!=null?y:1,this.autoSetView=(w=r.autoSetView)!=null?w:!0,this.autoFollowView=(A=r.autoFollowView)!=null?A:!0;const i=this.positions.map(E=>[E.lng,E.lat]);this.geometry=new ol.geom.LineString(i),this.distance=ol.sphere.getLength(this.geometry,{projection:"EPSG:4326"}),this.style=new ol.style.Style({stroke:new ol.style.Stroke({color:ol.color.withAlpha(this.color,this.opacity),width:this.width})}),this.feature=new ol.Feature({geometry:this.geometry}),this.feature.setStyle(this.style),this.source=new ol.source.Vector({features:[this.feature]}),this.layer=new ol.layer.Vector({source:this.source});const h=this.camera.owner;this.startMarker=r.startMarker&&(r.startMarker=h.entities.add(r.startMarker)),this.startMarker&&(this.startMarker.position=i[0]),this.moveMarker=r.moveMarker&&(r.moveMarker=h.entities.add(r.moveMarker)),this.moveMarker&&(this.moveMarker.position=i[0]),this.endMarker=r.endMarker&&(r.endMarker=h.entities.add(r.endMarker)),this.endMarker&&(this.endMarker.position=i[i.length-1]),this.camera.owner._addLayer(this.layer),this.autoSetView&&this.camera.fit(i)}_updateVectorContext(t,r){Se(this.moveMarker)?this.moveMarker.layer.getSource().getFeatures().forEach(i=>this._vectorContextDrawFeature(t,i.clone(),r)):(t.setStyle(new ol.style.Style({image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"black"}),stroke:new ol.style.Stroke({color:"white",width:2})})})),t.drawGeometry(new ol.geom.Point(r)))}_vectorContextDrawFeature(t,r,i){const h=r.getGeometry(),c=r.getStyle().clone();h.setCoordinates(i),t.drawFeature(r,c)}_updateMoveMarker({type:t}){if(!this.moveMarker)return;const r=this.geometry.getCoordinateAt(this.fraction>1?1:this.fraction);this.moveMarker.position=r;let i=1;switch(t){case"start":i=0;break;case"stop":i=1;break}this.camera.cancelAnimations(),this.moveMarker.layer.setOpacity(i)}start(){this.fraction>=1&&(this.fraction=0),this._updateMoveMarker({type:"start"});const t=this.geometry.getCoordinateAt(this.fraction);this.fire("start",{coordinate:t,target:this,type:"start"}),this.layer.on("postrender",this.move),this.layer.getSource().changed()}stop(){this._updateMoveMarker({type:"stop"});const t=this.geometry.getCoordinateAt(this.fraction);this.layer.un("postrender",this.move),this.fire("stop",{coordinate:t,target:this,type:"stop"})}destroy(){this.stop(),this.fire("destroy",{target:this,type:"destroy"}),this._clearMarker(),this._clearEvent(),this._clear()}on(...t){super.on(...t)}un(...t){super.un(...t)}_clearEvent(){super.clear()}_clearMarker(){const t=this.camera.owner;this.startMarker&&t.entities.remove(this.startMarker),this.moveMarker&&t.entities.remove(this.moveMarker),this.endMarker&&t.entities.remove(this.endMarker)}_clear(){this.fraction=0,this.camera.owner._removeLayer(this.layer)}}class qe{constructor(){new.target===qe&&_t.throwInstantiationError}static calculateResolutions({projection:e,minimumLevel:t=0,maximumLevel:r=24,tileWidth:i=256}={}){const h=e.getExtent(),c=ol.extent.getWidth(h)/i,p=new Array(r-t);for(var g=0;g<p.length;g++)p[g]=c/Math.pow(2,t+g);return p}}class Qs extends qe{constructor(e){super(),this.source=new ol.source.ImageArcGISRest(e),this.layer=new ol.layer.Image({source:this.source})}}class Ys extends qe{constructor(t){var r,i,h,c,p;t=t!=null?t:{};super();_(this,"url");_(this,"format","image/jpeg");_(this,"layer");_(this,"style","default");_(this,"tileMatrixSetID");_(this,"tileMatrixLabels");_(this,"tileWidth");_(this,"tileHeight");_(this,"tilingScheme");_(this,"projection");_(this,"minimumLevel",0);_(this,"maximumLevel");this.url=t.url,this.format=t.format,this.layer=t.layer,this.style=t.style,this.tileMatrixSetID=t.tileMatrixSetID,this.tileMatrixLabels=t.tileMatrixLabels,this.tileWidth=(r=t.tileWidth)!=null?r:256,this.tileHeight=(i=t.tileHeight)!=null?i:256,this.tilingScheme=(h=t.tilingScheme)!=null?h:GeographicTilingScheme(),this.minimumLevel=(c=t.minimumLevel)!=null?c:0,this.maximumLevel=(p=t.maximumLevel)!=null?p:21,this.resolutions=qe.calculateResolutions({projection:this.tilingScheme.projection.getProj(),zoomLevel:this.maximumLevel}),this.source=new ol.source.TileArcGISRest({url:this.url,format:this.format,layer:this.layer,projection:this.tilingScheme.projection.getProj(),tileGrid:new ol.tilegrid.WMTS({tileSize:[this.tileWidth,this.tileHeight],origin:[-180,90],resolutions:this.resolutions})}),this.layer=new ol.layer.Tile({source:this.source})}}class br{constructor(e){this._owner=e}get _view(){return this._owner.map.getView()}get owner(){return this._owner}computeViewRectangle(){return this._view.calculateExtent()}fit(e,t=[10,10,10,10]){const r=new ol.geom.Polygon([e]);this._view.fit(r,{padding:t})}flyTo(e){if(!Se(e))return e;const{destination:t,duration:r,complete:i}=e;this._view.animate({center:[t.lng||0,t.lat||0],duration:r},i||(()=>{}))}setView(e){if(!Se(e))return e;const{destination:t}=e;this._view.setCenter([t.lng||0,t.lat||0])}cancelAnimations(){this._view.cancelAnimations()}on(e,t){this._view.on(e,t)}un(e,t){this._view.un(e,t)}}class Li{constructor(e,t){_(this,"imageryProvider");this.imageryProvider=e}}class Pr{constructor(){_(this,"_layers",[])}setMap(e){return this.map=e,this}get length(){return this._layers.length}add(e,t){var r;this._layers.splice(t,0,e),(r=this.map)==null||r.addLayer(e.imageryProvider.layer)}addImageryProvider(e,t){const r=new Li(e);return this.add(r,t),r}remove(e,t){var i;const r=this._layers.indexOf(e);return r!==-1?(this._layers.splice(r,1),(i=this.map)==null||i.removeLayer(e.imageryProvider.layer),t&&(e=null),!0):!1}removeAll(){this._layers.forEach(e=>{var t;(t=this.map)==null||t.removeLayer(e.imageryProvider.layer)}),this._layers=[]}contains(e){return this.indexOf(e)!==-1}indexOf(e){return this._layers.indexOf(e)}get(e){return this._layers[e]}}class Mi{constructor(){this.imageryLayerCollection=new Pr}}class Xs{constructor(){this.globe=new Mi}get imageryLayers(){return this.globe.imageryLayerCollection}}var kt={startsWith:function(n,e){return n.indexOf(e)==0},contains:function(n,e){return n.indexOf(e)!=-1},trim:function(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(n){for(var e=n.split("-"),t=e[0],r=1,i=e.length;r<i;r++){var h=e[r];t+=h.charAt(0).toUpperCase()+h.substring(1)}return t},format:function(n,e,t){e||(e=window);var r=function(i,h){for(var c,p=h.split(/\.+/),g=0;g<p.length;g++)g==0&&(c=e),c=c[p[g]];return typeof c=="function"&&(c=t?c.apply(null,t):c()),typeof c>"u"?"undefined":c};return n.replace(kt.tokenRegEx,r)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(n){return kt.numberRegEx.test(n)},numericIf:function(n){return kt.isNumeric(n)?parseFloat(n):n}},Ar={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(n,e){var t=0;return e>0&&(t=parseFloat(n.toPrecision(e))),t},format:function(n,e,t,r){e=typeof e<"u"?e:0,t=typeof t<"u"?t:Ar.thousandsSeparator,r=typeof r<"u"?r:Ar.decimalSeparator,e!=null&&(n=parseFloat(n.toFixed(e)));var i=n.toString().split(".");i.length===1&&e==null&&(e=0);var h=i[0];if(t)for(var c=/(-?[0-9]+)([0-9]{3})/;c.test(h);)h=h.replace(c,"$1"+t+"$2");var p;if(e==0)p=h;else{var g=i.length>1?i[1]:"0";e!=null&&(g=g+new Array(e-g.length+1).join("0")),p=h+r+g}return p}};Number.prototype.limitSigDigs||(Number.prototype.limitSigDigs=function(n){return Ar.limitSigDigs(this,n)});var ir={bind:function(n,e){var t=Array.prototype.slice.apply(arguments,[2]);return function(){var r=t.concat(Array.prototype.slice.apply(arguments,[0]));return n.apply(e,r)}},bindAsEventListener:function(n,e){return function(t){return n.call(e,t||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}};class Ft{constructor(){this.CLASS_NAME="SuperMap.Geometry",this.id=O.createUniqueID(this.CLASS_NAME+"_"),this.parent=null,this.bounds=null,this.SRID=null}destroy(){this.id=null,this.bounds=null,this.SRID=null}clone(){return new Ft}setBounds(e){e&&(this.bounds=e.clone())}clearBounds(){this.bounds=null,this.parent&&this.parent.clearBounds()}extendBounds(e){var t=this.getBounds();t?this.bounds.extend(e):this.setBounds(e)}getBounds(){return this.bounds==null&&this.calculateBounds(),this.bounds}calculateBounds(){}getVertices(e){}getArea(){return 0}}const Ii=function(){var n="",e="",t="pc",r,i=navigator.userAgent.toLowerCase();return i.indexOf("msie")>-1||i.indexOf("trident")>-1&&i.indexOf("rv")>-1?(n="msie",r=i.match(/msie ([\d.]+)/)||i.match(/rv:([\d.]+)/)):i.indexOf("chrome")>-1?(n="chrome",r=i.match(/chrome\/([\d.]+)/)):i.indexOf("firefox")>-1?(n="firefox",r=i.match(/firefox\/([\d.]+)/)):i.indexOf("opera")>-1?(n="opera",r=i.match(/version\/([\d.]+)/)):i.indexOf("safari")>-1&&(n="safari",r=i.match(/version\/([\d.]+)/)),e=r?r[1]:"",i.indexOf("ipad")>-1||i.indexOf("ipod")>-1||i.indexOf("iphone")>-1?t="apple":i.indexOf("android")>-1&&(r=i.match(/version\/([\d.]+)/),e=r?r[1]:"",t="android"),{name:n,version:e,device:t}}(),$s=function(){var n=!0,e=Ii;return document.createElement("canvas").getContext?(e.name==="firefox"&&parseFloat(e.version)<5&&(n=!1),e.name==="safari"&&parseFloat(e.version)<4&&(n=!1),e.name==="opera"&&parseFloat(e.version)<10&&(n=!1),e.name==="msie"&&parseFloat(e.version)<9&&(n=!1)):n=!1,n}();(function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("webkit")===-1&&n.indexOf("gecko")!==-1})();const Ti=96,O={extend:function(n,e){if(n=n||{},e){for(var t in e){var r=e[t];r!==void 0&&(n[t]=r)}var i=typeof window.Event=="function"&&e instanceof window.Event;!i&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&(n.toString=e.toString)}return n},copy:function(n,e){n=n||{};var t;if(e)for(var r in n)t=e[r],typeof t<"u"&&(n[r]=t)},reset:function(n){n=n||{};for(var e in n)if(n.hasOwnProperty(e)){if(typeof n[e]=="object"&&n[e]instanceof Array){for(var t in n[e])n[e][t].destroy&&n[e][t].destroy();n[e].length=0}else typeof n[e]=="object"&&n[e]instanceof Object&&n[e].destroy&&n[e].destroy();n[e]=null}},getElement:function(){for(var n=[],e=0,t=arguments.length;e<t;e++){var r=arguments[e];if(typeof r=="string"&&(r=document.getElementById(r)),arguments.length===1)return r;n.push(r)}return n},isElement:function(n){return!!(n&&n.nodeType===1)},isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"},removeItem:function(n,e){for(var t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1);return n},indexOf:function(n,e){if(n==null)return-1;if(typeof n.indexOf=="function")return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t;return-1},modifyDOMElement:function(n,e,t,r,i,h,c,p){e&&(n.id=e),t&&(n.style.left=t.x+"px",n.style.top=t.y+"px"),r&&(n.style.width=r.w+"px",n.style.height=r.h+"px"),i&&(n.style.position=i),h&&(n.style.border=h),c&&(n.style.overflow=c),parseFloat(p)>=0&&parseFloat(p)<1?(n.style.filter="alpha(opacity="+p*100+")",n.style.opacity=p):parseFloat(p)===1&&(n.style.filter="",n.style.opacity="")},applyDefaults:function(n,e){n=n||{};var t=typeof window.Event=="function"&&e instanceof window.Event;for(var r in e)(n[r]===void 0||!t&&e.hasOwnProperty&&e.hasOwnProperty(r)&&!n.hasOwnProperty(r))&&(n[r]=e[r]);return!t&&e&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&!n.hasOwnProperty("toString")&&(n.toString=e.toString),n},getParameterString:function(n){var e=[];for(var t in n){var r=n[t];if(r!=null&&typeof r!="function"){var i;Array.isArray(r)||r.toString()==="[object Object]"?i=encodeURIComponent(JSON.stringify(r)):i=encodeURIComponent(r),e.push(encodeURIComponent(t)+"="+i)}}return e.join("&")},urlAppend:function(n,e){var t=n;if(e){e.indexOf("?")===0&&(e=e.substring(1));var r=(n+" ").split(/[?&]/);t+=r.pop()===" "?e:r.length?"&"+e:"?"+e}return t},urlPathAppend:function(n,e){let t=n;if(!e)return t;e.indexOf("/")===0&&(e=e.substring(1));const r=n.split("?");return r[0].indexOf("/",r[0].length-1)<0&&(r[0]+="/"),t=`${r[0]}${e}${r.length>1?`?${r[1]}`:""}`,t},DEFAULT_PRECISION:14,toFloat:function(n,e){return e==null&&(e=O.DEFAULT_PRECISION),typeof n!="number"&&(n=parseFloat(n)),e===0?n:parseFloat(n.toPrecision(e))},rad:function(n){return n*Math.PI/180},getParameters:function(n){n=n==null?window.location.href:n;var e="";if(kt.contains(n,"?")){var t=n.indexOf("?")+1,r=kt.contains(n,"#")?n.indexOf("#"):n.length;e=n.substring(t,r)}for(var i={},h=e.split(/[&;]/),c=0,p=h.length;c<p;++c){var g=h[c].split("=");if(g[0]){var v=g[0];try{v=decodeURIComponent(v)}catch{v=unescape(v)}var y=(g[1]||"").replace(/\+/g," ");try{y=decodeURIComponent(y)}catch{y=unescape(y)}y=y.split(","),y.length==1&&(y=y[0]),i[v]=y}}return i},lastSeqID:0,createUniqueID:function(n){return n==null&&(n="id_"),O.lastSeqID+=1,n+O.lastSeqID},normalizeScale:function(n){var e=n>1?1/n:n;return e},getResolutionFromScale:function(n,e){var t;if(n){e==null&&(e="degrees");var r=O.normalizeScale(n);t=1/(r*ie[e]*Ti)}return t},getScaleFromResolution:function(n,e){e==null&&(e="degrees");var t=n*ie[e]*Ti;return t},getBrowser:function(){return Ii},isSupportCanvas:$s,supportCanvas:function(){return O.isSupportCanvas},isInTheSameDomain:function(n){if(!n)return!0;var e=n.indexOf("//"),t=document.location.toString(),r=t.indexOf("//");if(e===-1)return!0;var i,h=i=n.substring(0,e),c=t.substring(r+2);r=c.indexOf("/");var p=c.indexOf(":"),g=c.substring(0,r),v=document.location.protocol;if(p!==-1||(g+=":"+(v.toLowerCase()==="http:"?80:443)),v.toLowerCase()!==h.toLowerCase())return!1;h=n.substring(e+2);var y=h.indexOf(":");e=h.indexOf("/");var w=h.substring(0,e),A;y!==-1?A=h.substring(0,y):(A=h.substring(0,e),w+=":"+(i.toLowerCase()==="http:"?80:443));var E=document.domain;return A===E&&w===g},calculateDpi:function(n,e,t,r,i){if(!(!n||!e||!t)){var h=1e4,c=n.getWidth(),p=n.getHeight(),g=e.w,v=e.h;i=i||6378137,r=r||"degrees";var y;if(r.toLowerCase()==="degree"||r.toLowerCase()==="degrees"||r.toLowerCase()==="dd"){let w=c/g,A=p/v,E=w>A?w:A;y=.0254*h/E/t/(Math.PI*2*i/360)/h}else{let w=c/g;y=.0254*h/w/t/h}return y}},toJSON:function(n){var e=n;if(e==null)return null;switch(e.constructor){case String:return e='"'+e.replace(/(["\\])/g,"\\$1")+'"',e=e.replace(/\n/g,"\\n"),e=e.replace(/\r/g,"\\r"),e=e.replace("<","&lt;"),e=e.replace(">","&gt;"),e=e.replace(/%/g,"%25"),e=e.replace(/&/g,"%26"),e;case Array:for(var t="",r=0,i=e.length;r<i;r++)t+=O.toJSON(e[r]),r!==e.length-1&&(t+=",");return"["+t+"]";case Number:return isFinite(e)?String(e):null;case Boolean:return String(e);case Date:var h=`{'__type':"System.DateTime",'Year':`+e.getFullYear()+",'Month':"+(e.getMonth()+1)+",'Day':"+e.getDate()+",'Hour':"+e.getHours()+",'Minute':"+e.getMinutes()+",'Second':"+e.getSeconds()+",'Millisecond':"+e.getMilliseconds()+",'TimezoneOffset':"+e.getTimezoneOffset()+"}";return h;default:if(e.toJSON!=null&&typeof e.toJSON=="function")return e.toJSON();if(typeof e=="object"){if(e.length){let p=[];for(let g=0,v=e.length;g<v;g++)p.push(O.toJSON(e[g]));return"["+p.join(",")+"]"}let c=[];for(let p in e)typeof e[p]!="function"&&p!=="CLASS_NAME"&&p!=="parent"&&c.push("'"+p+"':"+O.toJSON(e[p]));return c.length>0?"{"+c.join(",")+"}":"{}"}return e.toString()}},getResolutionFromScaleDpi:function(n,e,t,r){var i=null,h=1e4;return r=r||6378137,t=t||"",n>0&&e>0?(n=O.normalizeScale(n),t.toLowerCase()==="degree"||t.toLowerCase()==="degrees"||t.toLowerCase()==="dd"?(i=.0254*h/e/n/(Math.PI*2*r/360)/h,i):(i=.0254*h/e/n/h,i)):-1},getScaleFromResolutionDpi:function(n,e,t,r){var i=null,h=1e4;return r=r||6378137,t=t||"",n>0&&e>0?t.toLowerCase()==="degree"||t.toLowerCase()==="degrees"||t.toLowerCase()==="dd"?(i=.0254*h/e/n/(Math.PI*2*r/360)/h,i):(i=.0254*h/e/n/h,i):-1},transformResult:function(n){return n.responseText&&typeof n.responseText=="string"&&(n=JSON.parse(n.responseText)),n},copyAttributes:function(n,e){if(n=n||{},e)for(var t in e){var r=e[t];r!==void 0&&t!=="CLASS_NAME"&&typeof r!="function"&&(n[t]=r)}return n},copyAttributesWithClip:function(n,e,t){if(n=n||{},e)for(var r in e){var i=!1;if(t&&t.length){for(var h=0,c=t.length;h<c;h++)if(r===t[h]){i=!0;break}}if(i!==!0){var p=e[r];p!==void 0&&r!=="CLASS_NAME"&&typeof p!="function"&&(n[r]=p)}}return n},cloneObject:function(n){if(n===null||typeof n!="object")return n;if(n instanceof Date){let t=new Date;return t.setTime(n.getTime()),t}if(n instanceof Array)return n.slice(0);if(n instanceof Object){let t={};for(var e in n)n.hasOwnProperty(e)&&(t[e]=O.cloneObject(n[e]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")},lineIntersection:function(n,e,t,r){var i=null,h,c,p=(r.x-t.x)*(n.y-t.y)-(r.y-t.y)*(n.x-t.x),g=(e.x-n.x)*(n.y-t.y)-(e.y-n.y)*(n.x-t.x),v=(r.y-t.y)*(e.x-n.x)-(r.x-t.x)*(e.y-n.y);if(v!=0)h=p/v,c=g/v,h>=0&&c<=1&&h<=1&&c>=0?i=new Ft.Point(n.x+h*(e.x-n.x),n.y+h*(e.y-n.y)):i="No Intersection";else if(p==0&&g==0){var y=Math.max(n.y,e.y),w=Math.min(n.y,e.y),A=Math.max(n.x,e.x),E=Math.min(n.x,e.x);(t.y>=w&&t.y<=y||r.y>=w&&r.y<=y)&&t.x>=E&&t.x<=A||r.x>=E&&r.x<=A?i="Coincident":i="Parallel"}else i="Parallel";return i},getTextBounds:function(n,e,t){document.body.appendChild(t),t.style.width="auto",t.style.height="auto",n.fontSize&&(t.style.fontSize=n.fontSize),n.fontFamily&&(t.style.fontFamily=n.fontFamily),n.fontWeight&&(t.style.fontWeight=n.fontWeight),t.style.position="relative",t.style.visibility="hidden",t.style.display="inline-block",t.innerHTML=e;var r=t.clientWidth,i=t.clientHeight;return document.body.removeChild(t),{textWidth:r,textHeight:i}},convertPath:function(n,e){return e?n.replace(/\{([\w-\.]+)\}/g,(t,r)=>{var i;return e.hasOwnProperty(r)?i=ea(e[r]):i=t,encodeURIComponent(i)}):n}},ie={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};ie.in=ie.inches,ie.degrees=ie.dd,ie.nmi=1852*ie.m;const Q=.0254000508001016;O.extend(ie,{Inch:ie.inches,Meter:1/Q,Foot:.3048006096012192/Q,IFoot:.3048/Q,ClarkeFoot:.3047972651151/Q,SearsFoot:.30479947153867626/Q,GoldCoastFoot:.3047997101815088/Q,IInch:.0254/Q,MicroInch:254e-7/Q,Mil:254e-10/Q,Centimeter:.01/Q,Kilometer:1e3/Q,Yard:.9144018288036576/Q,SearsYard:.914398414616029/Q,IndianYard:.9143985307444408/Q,IndianYd37:.91439523/Q,IndianYd62:.9143988/Q,IndianYd75:.9143985/Q,IndianFoot:.30479951/Q,IndianFt37:.30479841/Q,IndianFt62:.3047996/Q,IndianFt75:.3047995/Q,Mile:1609.3472186944373/Q,IYard:.9144/Q,IMile:1609.344/Q,NautM:1852/Q,"Lat-66":110943.31648893273/Q,"Lat-83":110946.25736872235/Q,Decimeter:.1/Q,Millimeter:.001/Q,Dekameter:10/Q,Decameter:10/Q,Hectometer:100/Q,GermanMeter:1.0000135965/Q,CaGrid:.999738/Q,ClarkeChain:20.1166194976/Q,GunterChain:20.11684023368047/Q,BenoitChain:20.116782494375872/Q,SearsChain:20.11676512155/Q,ClarkeLink:.201166194976/Q,GunterLink:.2011684023368047/Q,BenoitLink:.20116782494375873/Q,SearsLink:.2011676512155/Q,Rod:5.02921005842012/Q,IntnlChain:20.1168/Q,IntnlLink:.201168/Q,Perch:5.02921005842012/Q,Pole:5.02921005842012/Q,Furlong:201.1684023368046/Q,Rood:3.778266898/Q,CapeFoot:.3047972615/Q,Brealey:375/Q,ModAmFt:.304812252984506/Q,Fathom:1.8288/Q,"NautM-UK":1853.184/Q,"50kilometers":5e4/Q,"150kilometers":15e4/Q}),O.extend(ie,{mm:ie.Meter/1e3,cm:ie.Meter/100,dm:ie.Meter*100,km:ie.Meter*1e3,kmi:ie.nmi,fath:ie.Fathom,ch:ie.IntnlChain,link:ie.IntnlLink,"us-in":ie.inches,"us-ft":ie.Foot,"us-yd":ie.Yard,"us-ch":ie.GunterChain,"us-mi":ie.Mile,"ind-yd":ie.IndianYd37,"ind-ft":ie.IndianFt37,"ind-ch":20.11669506/Q}),ie.degree=ie.dd,ie.meter=ie.m,ie.foot=ie.ft,ie.inch=ie.inches,ie.mile=ie.mi,ie.kilometer=ie.km,ie.yard=ie.yd;function ea(n){return n==null||n==null?"":n instanceof Date?n.toJSON():ta(n)?JSON.stringify(n):n.toString()}function ta(n){if(typeof n!="string"&&typeof n!="object")return!1;try{const e=n.toString();return e==="[object Object]"||e==="[object Array]"}catch{return!1}}var pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ra(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}(function(n,e){(function(t,r){r()})(pt,function(){function t(x){var N=this.constructor;return this.then(function(b){return N.resolve(x()).then(function(){return b})},function(b){return N.resolve(x()).then(function(){return N.reject(b)})})}function r(x){var N=this;return new N(function(b,R){if(!(x&&typeof x.length<"u"))return R(new TypeError(typeof x+" "+x+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var W=Array.prototype.slice.call(x);if(W.length===0)return b([]);var ee=W.length;function Y(re,le){if(le&&(typeof le=="object"||typeof le=="function")){var De=le.then;if(typeof De=="function"){De.call(le,function(Le){Y(re,Le)},function(Le){W[re]={status:"rejected",reason:Le},--ee===0&&b(W)});return}}W[re]={status:"fulfilled",value:le},--ee===0&&b(W)}for(var j=0;j<W.length;j++)Y(j,W[j])})}var i=setTimeout;function h(x){return Boolean(x&&typeof x.length<"u")}function c(){}function p(x,N){return function(){x.apply(N,arguments)}}function g(x){if(!(this instanceof g))throw new TypeError("Promises must be constructed via new");if(typeof x!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],k(x,this)}function v(x,N){for(;x._state===3;)x=x._value;if(x._state===0){x._deferreds.push(N);return}x._handled=!0,g._immediateFn(function(){var b=x._state===1?N.onFulfilled:N.onRejected;if(b===null){(x._state===1?y:w)(N.promise,x._value);return}var R;try{R=b(x._value)}catch(W){w(N.promise,W);return}y(N.promise,R)})}function y(x,N){try{if(N===x)throw new TypeError("A promise cannot be resolved with itself.");if(N&&(typeof N=="object"||typeof N=="function")){var b=N.then;if(N instanceof g){x._state=3,x._value=N,A(x);return}else if(typeof b=="function"){k(p(b,N),x);return}}x._state=1,x._value=N,A(x)}catch(R){w(x,R)}}function w(x,N){x._state=2,x._value=N,A(x)}function A(x){x._state===2&&x._deferreds.length===0&&g._immediateFn(function(){x._handled||g._unhandledRejectionFn(x._value)});for(var N=0,b=x._deferreds.length;N<b;N++)v(x,x._deferreds[N]);x._deferreds=null}function E(x,N,b){this.onFulfilled=typeof x=="function"?x:null,this.onRejected=typeof N=="function"?N:null,this.promise=b}function k(x,N){var b=!1;try{x(function(R){b||(b=!0,y(N,R))},function(R){b||(b=!0,w(N,R))})}catch(R){if(b)return;b=!0,w(N,R)}}g.prototype.catch=function(x){return this.then(null,x)},g.prototype.then=function(x,N){var b=new this.constructor(c);return v(this,new E(x,N,b)),b},g.prototype.finally=t,g.all=function(x){return new g(function(N,b){if(!h(x))return b(new TypeError("Promise.all accepts an array"));var R=Array.prototype.slice.call(x);if(R.length===0)return N([]);var W=R.length;function ee(j,re){try{if(re&&(typeof re=="object"||typeof re=="function")){var le=re.then;if(typeof le=="function"){le.call(re,function(De){ee(j,De)},b);return}}R[j]=re,--W===0&&N(R)}catch(De){b(De)}}for(var Y=0;Y<R.length;Y++)ee(Y,R[Y])})},g.allSettled=r,g.resolve=function(x){return x&&typeof x=="object"&&x.constructor===g?x:new g(function(N){N(x)})},g.reject=function(x){return new g(function(N,b){b(x)})},g.race=function(x){return new g(function(N,b){if(!h(x))return b(new TypeError("Promise.race accepts an array"));for(var R=0,W=x.length;R<W;R++)g.resolve(x[R]).then(N,b)})},g._immediateFn=typeof setImmediate=="function"&&function(x){setImmediate(x)}||function(x){i(x,0)},g._unhandledRejectionFn=function(N){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",N)};var z=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof pt<"u")return pt;throw new Error("unable to locate global object")}();typeof z.Promise!="function"?z.Promise=g:(z.Promise.prototype.finally||(z.Promise.prototype.finally=t),z.Promise.allSettled||(z.Promise.allSettled=r))})})();var ia={exports:{}};(function(n){(function(e){if(!e.__disableNativeFetch&&e.fetch)return;function t(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function r(b){return typeof b!="string"&&(b=String(b)),b}function i(b){this.map={},b instanceof i?b.forEach(function(R,W){this.append(W,R)},this):b&&Object.getOwnPropertyNames(b).forEach(function(R){this.append(R,b[R])},this)}i.prototype.append=function(b,R){b=t(b),R=r(R);var W=this.map[b];W||(W=[],this.map[b]=W),W.push(R)},i.prototype.delete=function(b){delete this.map[t(b)]},i.prototype.get=function(b){var R=this.map[t(b)];return R?R[0]:null},i.prototype.getAll=function(b){return this.map[t(b)]||[]},i.prototype.has=function(b){return this.map.hasOwnProperty(t(b))},i.prototype.set=function(b,R){this.map[t(b)]=[r(R)]},i.prototype.forEach=function(b,R){Object.getOwnPropertyNames(this.map).forEach(function(W){this.map[W].forEach(function(ee){b.call(R,ee,W,this)},this)},this)};function h(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function c(b){return new Promise(function(R,W){b.onload=function(){R(b.result)},b.onerror=function(){W(b.error)}})}function p(b){var R=new FileReader;return R.readAsArrayBuffer(b),c(R)}function g(b,R){var W=new FileReader,ee=R.headers.map["content-type"]?R.headers.map["content-type"].toString():"",Y=/charset\=[0-9a-zA-Z\-\_]*;?/,j=b.type.match(Y)||ee.match(Y),re=[b];return j&&re.push(j[0].replace(/^charset\=/,"").replace(/;$/,"")),W.readAsText.apply(W,re),c(W)}var v={blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};function y(){return this.bodyUsed=!1,this._initBody=function(b,R){if(this._bodyInit=b,typeof b=="string")this._bodyText=b;else if(v.blob&&Blob.prototype.isPrototypeOf(b))this._bodyBlob=b,this._options=R;else if(v.formData&&FormData.prototype.isPrototypeOf(b))this._bodyFormData=b;else if(!b)this._bodyText="";else if(!(v.arrayBuffer&&ArrayBuffer.prototype.isPrototypeOf(b)))throw new Error("unsupported BodyInit type")},v.blob?(this.blob=function(){var b=h(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(p)},this.text=function(){var b=h(this);if(b)return b;if(this._bodyBlob)return g(this._bodyBlob,this._options);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var b=h(this);return b||Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(k)}),this.json=function(){return this.text().then(JSON.parse)},this}var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function A(b){var R=b.toUpperCase();return w.indexOf(R)>-1?R:b}function E(b,R){R=R||{};var W=R.body;if(E.prototype.isPrototypeOf(b)){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,R.headers||(this.headers=new i(b.headers)),this.method=b.method,this.mode=b.mode,W||(W=b._bodyInit,b.bodyUsed=!0)}else this.url=b;if(this.credentials=R.credentials||this.credentials||"omit",(R.headers||!this.headers)&&(this.headers=new i(R.headers)),this.method=A(R.method||this.method||"GET"),this.mode=R.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&W)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(W,R)}E.prototype.clone=function(){return new E(this)};function k(b){var R=new FormData;return b.trim().split("&").forEach(function(W){if(W){var ee=W.split("="),Y=ee.shift().replace(/\+/g," "),j=ee.join("=").replace(/\+/g," ");R.append(decodeURIComponent(Y),decodeURIComponent(j))}}),R}function z(b){var R=new i,W=b.getAllResponseHeaders().trim().split(`
`);return W.forEach(function(ee){var Y=ee.trim().split(":"),j=Y.shift().trim(),re=Y.join(":").trim();R.append(j,re)}),R}y.call(E.prototype);function x(b,R){R||(R={}),this._initBody(b,R),this.type="default",this.status=R.status,this.ok=this.status>=200&&this.status<300,this.statusText=R.statusText,this.headers=R.headers instanceof i?R.headers:new i(R.headers),this.url=R.url||""}y.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},x.error=function(){var b=new x(null,{status:0,statusText:""});return b.type="error",b};var N=[301,302,303,307,308];x.redirect=function(b,R){if(N.indexOf(R)===-1)throw new RangeError("Invalid status code");return new x(null,{status:R,headers:{location:b}})},e.Headers=i,e.Request=E,e.Response=x,e.fetch=function(b,R){return new Promise(function(W,ee){var Y;E.prototype.isPrototypeOf(b)&&!R?Y=b:Y=new E(b,R);var j=new XMLHttpRequest;function re(){if("responseURL"in j)return j.responseURL;if(/^X-Request-URL:/m.test(j.getAllResponseHeaders()))return j.getResponseHeader("X-Request-URL")}var le=!1;function De(){if(j.readyState===4){var Le=j.status===1223?204:j.status;if(Le<100||Le>599){if(le)return;le=!0,ee(new TypeError("Network request failed"));return}var At={status:Le,statusText:j.statusText,headers:z(j),url:re()},Hr="response"in j?j.response:j.responseText;le||(le=!0,W(new x(Hr,At)))}}j.onreadystatechange=De,j.onload=De,j.onerror=function(){le||(le=!0,ee(new TypeError("Network request failed")))},j.open(Y.method,Y.url,!0);try{Y.credentials==="include"&&("withCredentials"in j?j.withCredentials=!0:console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning"))}catch(Le){console&&console.warn&&console.warn("set withCredentials error:"+Le)}"responseType"in j&&v.blob&&(j.responseType="blob"),Y.headers.forEach(function(Le,At){j.setRequestHeader(At,Le)}),j.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})},e.fetch.polyfill=!0,n.exports&&(n.exports=e.fetch)})(typeof self<"u"?self:pt)})(ia);var Lr={exports:{}};(function(n,e){(function(t,r){r(e,n)})(pt,function(t,r){var i={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function h(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function c(v){try{delete window[v]}catch{window[v]=void 0}}function p(v){var y=document.getElementById(v);y&&document.getElementsByTagName("head")[0].removeChild(y)}function g(v){var y=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],w=v,A=y.timeout||i.timeout,E=y.jsonpCallback||i.jsonpCallback,k=void 0;return new Promise(function(z,x){var N=y.jsonpCallbackFunction||h(),b=E+"_"+N;window[N]=function(W){z({ok:!0,json:function(){return Promise.resolve(W)}}),k&&clearTimeout(k),p(b),c(N)},w+=w.indexOf("?")===-1?"?":"&";var R=document.createElement("script");R.setAttribute("src",""+w+E+"="+N),y.charset&&R.setAttribute("charset",y.charset),R.id=b,document.getElementsByTagName("head")[0].appendChild(R),k=setTimeout(function(){x(new Error("JSONP request to "+v+" timed out")),c(N),p(b),window[N]=function(){c(N)}},A),R.onerror=function(){x(new Error("JSONP request to "+v+" failed")),c(N),p(b),k&&clearTimeout(k)}})}r.exports=g})})(Lr,Lr.exports);const _i=Lr.exports;let ki=window.fetch;var nr={limitLength:1500,queryKeys:[],queryValues:[],supermap_callbacks:{},addQueryStrings:function(n){var e=this;for(var t in n){e.queryKeys.push(t),typeof n[t]!="string"&&(n[t]=O.toJSON(n[t]));var r=encodeURIComponent(n[t]);e.queryValues.push(r)}},issue:function(n){for(var e=this,t=e.getUid(),r=n.url,i=[],h=new Promise(function(E){e.supermap_callbacks[t]=function(k){delete e.supermap_callbacks[t],E(k)}}),c=r,p=0,g=e.queryKeys?e.queryKeys.length:0,v=0;v<g;v++)if(c.length+e.queryKeys[v].length+2>=e.limitLength){if(p==0)return!1;i.push(c),c=r,p=0,v--}else if(c.length+e.queryKeys[v].length+2+e.queryValues[v].length>e.limitLength)for(var y=e.queryValues[v];y.length>0;){var w=e.limitLength-c.length-e.queryKeys[v].length-2;c.indexOf("?")>-1?c+="&":c+="?";var A=y.substring(0,w);A.substring(w-1,w)==="%"?(w-=1,A=y.substring(0,w)):A.substring(w-2,w-1)==="%"&&(w-=2,A=y.substring(0,w)),c+=e.queryKeys[v]+"="+A,y=y.substring(w),A.length>0&&(i.push(c),c=r,p=0)}else p++,c.indexOf("?")>-1?c+="&":c+="?",c+=e.queryKeys[v]+"="+e.queryValues[v];return i.push(c),e.send(i,"RequestJSONPPromise.supermap_callbacks["+t+"]",n&&n.proxy),h},getUid:function(){var n=new Date().getTime(),e=Math.floor(Math.random()*1e17);return n*1e3+e},send:function(n,e,t){var r=n.length;if(r>0)for(var i=new Date().getTime(),h=0;h<r;h++){var c=n[h];c.indexOf("?")>-1?c+="&":c+="?",c+="sectionCount="+r,c+="&sectionIndex="+h,c+="&jsonpUserID="+i,t&&(c=decodeURIComponent(c),c=t+encodeURIComponent(c)),_i(c,{jsonpCallbackFunction:e,timeout:3e4})}},GET:function(n){var e=this;return e.queryKeys.length=0,e.queryValues.length=0,e.addQueryStrings(n.params),e.issue(n)},POST:function(n){var e=this;return e.queryKeys.length=0,e.queryValues.length=0,e.addQueryStrings({requestEntity:n.data}),e.issue(n)},PUT:function(n){var e=this;return e.queryKeys.length=0,e.queryValues.length=0,e.addQueryStrings({requestEntity:n.data}),e.issue(n)},DELETE:function(n){var e=this;return e.queryKeys.length=0,e.queryValues.length=0,e.addQueryStrings({requestEntity:n.data}),e.issue(n)}},na=function(){return window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest},Fi=function(){return 45e3},nt={commit:function(n,e,t,r){switch(n=n&&n.toUpperCase(),n){case"GET":return this.get(e,t,r);case"POST":return this.post(e,t,r);case"PUT":return this.put(e,t,r);case"DELETE":return this.delete(e,t,r);default:return this.get(e,t,r)}},supportDirectRequest:function(n,e){return O.isInTheSameDomain(n)?!0:e.crossOrigin!=null?e.crossOrigin:na()||e.proxy},get:function(n,e,t){t=t||{};var r="GET";if(n=O.urlAppend(n,this._getParameterString(e||{})),n=this._processUrl(n,t),!this.supportDirectRequest(n,t)){n=n.replace(".json",".jsonp");var i={url:n,data:e};return nr.GET(i)}return this.urlIsLong(n)?this._postSimulatie(r,n.substring(0,n.indexOf("?")),O.getParameters(n),t):this._fetch(n,e,t,r)},delete:function(n,e,t){t=t||{};var r="DELETE";if(n=O.urlAppend(n,this._getParameterString(e||{})),n=this._processUrl(n,t),!this.supportDirectRequest(n,t)){n=n.replace(".json",".jsonp");var i={url:n+="&_method=DELETE",data:e};return nr.DELETE(i)}return this.urlIsLong(n)?this._postSimulatie(r,n.substring(0,n.indexOf("?")),O.getParameters(n),t):this._fetch(n,e,t,r)},post:function(n,e,t){if(t=t||{},!this.supportDirectRequest(n,t)){n=n.replace(".json",".jsonp");var r={url:n+="&_method=POST",data:e};return nr.POST(r)}return this._fetch(this._processUrl(n,t),e,t,"POST")},put:function(n,e,t){if(t=t||{},n=this._processUrl(n,t),!this.supportDirectRequest(n,t)){n=n.replace(".json",".jsonp");var r={url:n+="&_method=PUT",data:e};return nr.PUT(r)}return this._fetch(n,e,t,"PUT")},urlIsLong:function(n){for(var e=0,t=null,r=0,i=n.length;r<i;r++)t=n.charCodeAt(r),t<127?e++:128<=t&&t<=2047?e+=2:2048<=t&&t<=65535&&(e+=3);return!(e<2e3)},_postSimulatie:function(n,e,t,r){var i=e.indexOf("?")>-1?"&":"?";return e+=i+"_method="+n,typeof t!="string"&&(t=JSON.stringify(t)),this.post(e,t,r)},_processUrl:function(n,e){if(this._isMVTRequest(n))return n;if(n.indexOf(".json")===-1&&!e.withoutFormatSuffix)if(n.indexOf("?")<0)n+=".json";else{var t=n.split("?");t.length===2&&(n=t[0]+".json?"+t[1])}return e&&e.proxy&&(typeof e.proxy=="function"?n=e.proxy(n):(n=decodeURIComponent(n),n=e.proxy+encodeURIComponent(n))),n},_fetch:function(n,e,t,r){return t=t||{},t.headers=t.headers||{},!t.headers["Content-Type"]&&!FormData.prototype.isPrototypeOf(e)&&(t.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),t.timeout?this._timeout(t.timeout,ki(n,{method:r,headers:t.headers,body:r==="PUT"||r==="POST"?e:void 0,credentials:this._getWithCredentials(t),mode:"cors",timeout:Fi()}).then(function(i){return i})):ki(n,{method:r,body:r==="PUT"||r==="POST"?e:void 0,headers:t.headers,credentials:this._getWithCredentials(t),mode:"cors",timeout:Fi()}).then(function(i){return i})},_getWithCredentials:function(n){return n.withCredentials===!0?"include":n.withCredentials===!1?"omit":"same-origin"},_fetchJsonp:function(n,e){return e=e||{},_i(n,{method:"GET",timeout:e.timeout}).then(function(t){return t})},_timeout:function(n,e){return new Promise(function(t,r){setTimeout(function(){r(new Error("timeout"))},n),e.then(t,r)})},_getParameterString:function(n){var e=[];for(var t in n){var r=n[t];if(r!=null&&typeof r!="function"){var i;Array.isArray(r)||r.toString()==="[object Object]"?i=encodeURIComponent(JSON.stringify(r)):i=encodeURIComponent(r),e.push(encodeURIComponent(t)+"="+i)}}return e.join("&")},_isMVTRequest:function(n){return n.indexOf(".mvt")>-1||n.indexOf(".pbf")>-1}};class Mr{constructor(e,t){this.value=e||"",this.name=t||"token",this.CLASS_NAME="SuperMap.Credential"}getUrlParameters(){return this.name+"="+this.value}getValue(){return this.value}destroy(){this.value=null,this.name=null}}Mr.CREDENTIAL=null;class Je{static generateToken(e,t){var r=this.servers[e];if(!!r)return nt.post(r.tokenServiceUrl,JSON.stringify(t.toJSON())).then(function(i){return i.text()})}static registerServers(e){this.servers=this.servers||{},O.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var r=e[t];this.servers[r.server]=r}}static registerToken(e,t){if(this.tokens=this.tokens||{},!(!e||!t)){var r=this._getTokenStorageKey(e);this.tokens[r]=t}}static registerKey(e,t){if(this.keys=this.keys||{},!(!e||e.length<1||!t)){e=O.isArray(e)?e:[e];for(var r=0;r<e.length;r++){var i=this._getUrlRestString(e[0])||e[0];this.keys[i]=t}}}static getServerInfo(e){return this.servers=this.servers||{},this.servers[e]}static getToken(e){if(!!e){this.tokens=this.tokens||{};var t=this._getTokenStorageKey(e);return this.tokens[t]}}static getKey(e){this.keys=this.keys||{};var t=this._getUrlRestString(e)||e;return this.keys[t]}static loginiServer(e,t,r,i){e=O.urlPathAppend(e,"services/security/login");var h={username:t&&t.toString(),password:r&&r.toString(),rememberme:i};h=JSON.stringify(h);var c={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}};return nt.post(e,h,c).then(function(p){return p.json()})}static logoutiServer(e){e=O.urlPathAppend(e,"services/security/logout");var t={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withoutFormatSuffix:!0};return nt.get(e,"",t).then(function(){return!0}).catch(function(){return!1})}static loginOnline(e,t){var r=Je.SSO+"/login?service="+e;this._open(r,t)}static loginiPortal(e,t,r){e=O.urlPathAppend(e,"web/login");var i={username:t&&t.toString(),password:r&&r.toString()};i=JSON.stringify(i);var h={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0};return nt.post(e,i,h).then(function(c){return c.json()})}static logoutiPortal(e){e=O.urlPathAppend(e,"services/security/logout");var t={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0,withoutFormatSuffix:!0};return nt.get(e,"",t).then(function(){return!0}).catch(function(){return!1})}static loginManager(e,t,r){if(!O.isInTheSameDomain(e)){var i=r?r.isNewTab:!0;this._open(e,i);return}var h=O.urlPathAppend(e,"icloud/security/tokens"),c=t||{},p={username:c.userName&&c.userName.toString(),password:c.password&&c.password.toString()};p=JSON.stringify(p);var g={headers:{Accept:"*/*","Content-Type":"application/json"}},v=this;return nt.post(h,p,g).then(function(y){y.text().then(function(w){return v.imanagerToken=w,w})})}static destroyAllCredentials(){this.keys=null,this.tokens=null,this.servers=null}static destroyToken(e){if(!!e){var t=this._getTokenStorageKey(e);this.tokens=this.tokens||{},this.tokens[t]&&delete this.tokens[t]}}static destroyKey(e){if(!!e){this.keys=this.keys||{};var t=this._getUrlRestString(e)||e;this.keys[t]&&delete this.keys[t]}}static appendCredential(e){var t=e,r=this.getToken(e),i=r?new Mr(r,"token"):null;return i||(r=this.getKey(e),i=r?new Mr(r,"key"):null),i&&(t=O.urlAppend(t,i.getUrlParameters())),t}static _open(e,t){t=t!=null?t:!0;var r=window.screen.availWidth/2-this.INNER_WINDOW_WIDTH/2,i=window.screen.availHeight/2-this.INNER_WINDOW_HEIGHT/2,h="height="+this.INNER_WINDOW_HEIGHT+", width="+this.INNER_WINDOW_WIDTH+",top="+i+", left="+r+",toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no";t?window.open(e,"login"):window.open(e,"login",h)}static _getTokenStorageKey(e){var t=/(.*?):\/\/([^\/]+)/i,r=e.match(t);return r?r[0]:e}static _getUrlRestString(e){if(!e)return e;var t=/(http|https):\/\/(.*\/rest)/i,r=e.match(t);return r?r[0]:e}}Je.INNER_WINDOW_WIDTH=600,Je.INNER_WINDOW_HEIGHT=600,Je.SSO="https://sso.supermap.com",Je.ONLINE="https://www.supermapol.com";var Ir={GEOJSON:"GEOJSON",ISERVER:"ISERVER"},ke={LINE:"LINE",LINEM:"LINEM",POINT:"POINT",REGION:"REGION",POINTEPS:"POINTEPS",LINEEPS:"LINEEPS",REGIONEPS:"REGIONEPS",ELLIPSE:"ELLIPSE",CIRCLE:"CIRCLE",TEXT:"TEXT",RECTANGLE:"RECTANGLE",UNKNOWN:"UNKNOWN",GEOCOMPOUND:"GEOCOMPOUND"},Ri={CONTAIN:"CONTAIN",CROSS:"CROSS",DISJOINT:"DISJOINT",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",NONE:"NONE",OVERLAP:"OVERLAP",TOUCH:"TOUCH",WITHIN:"WITHIN"},Ve={METER:"METER",KILOMETER:"KILOMETER",MILE:"MILE",YARD:"YARD",DEGREE:"DEGREE",MILLIMETER:"MILLIMETER",CENTIMETER:"CENTIMETER",INCH:"INCH",DECIMETER:"DECIMETER",FOOT:"FOOT",SECOND:"SECOND",MINUTE:"MINUTE",RADIAN:"RADIAN"},sr={ADD:"add",UPDATE:"update",DELETE:"delete"};class Tr{constructor(e,t){this.w=e?parseFloat(e):0,this.h=e?parseFloat(t):0,this.CLASS_NAME="SuperMap.Size"}toString(){return"w="+this.w+",h="+this.h}clone(){return new Tr(this.w,this.h)}equals(e){var t=!1;return e!=null&&(t=this.w===e.w&&this.h===e.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(e.w)&&isNaN(e.h)),t}destroy(){this.w=null,this.h=null}}class gt{constructor(e,t,r){this.x=e?parseFloat(e):0,this.y=t?parseFloat(t):0,this.mode=r,this.CLASS_NAME="SuperMap.Pixel"}toString(){return"x="+this.x+",y="+this.y}clone(){return new gt(this.x,this.y,this.mode)}equals(e){var t=!1;return e!=null&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}add(e,t){if(e==null||t==null)throw new TypeError("Pixel.add cannot receive null values");return new gt(this.x+e,this.y+t)}offset(e){var t=this.clone();return e&&(t=this.add(e.x,e.y)),t}destroy(){this.x=null,this.y=null,this.mode=null}}gt.Mode={LeftTop:"lefttop",RightTop:"righttop",RightBottom:"rightbottom",LeftBottom:"leftbottom"};class vt{constructor(e,t){O.isArray(e)&&(t=e[1],e=e[0]),this.lon=e?O.toFloat(e):0,this.lat=t?O.toFloat(t):0,this.CLASS_NAME="SuperMap.LonLat"}toString(){return"lon="+this.lon+",lat="+this.lat}toShortString(){return this.lon+","+this.lat}clone(){return new vt(this.lon,this.lat)}add(e,t){if(e==null||t==null)throw new TypeError("LonLat.add cannot receive null values");return new vt(this.lon+O.toFloat(e),this.lat+O.toFloat(t))}equals(e){var t=!1;return e!=null&&(t=this.lon===e.lon&&this.lat===e.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(e.lon)&&isNaN(e.lat)),t}wrapDateLine(e){var t=this.clone();if(e){for(;t.lon<e.left;)t.lon+=e.getWidth();for(;t.lon>e.right;)t.lon-=e.getWidth()}return t}destroy(){this.lon=null,this.lat=null}static fromString(e){var t=e.split(",");return new vt(t[0],t[1])}static fromArray(e){var t=O.isArray(e),r=t&&e[0],i=t&&e[1];return new vt(r,i)}}class Fe{constructor(e,t,r,i){O.isArray(e)&&(i=e[3],r=e[2],t=e[1],e=e[0]),this.left=e!=null?O.toFloat(e):this.left,this.bottom=t!=null?O.toFloat(t):this.bottom,this.right=r!=null?O.toFloat(r):this.right,this.top=i!=null?O.toFloat(i):this.top,this.centerLonLat=null,this.CLASS_NAME="SuperMap.Bounds"}clone(){return new Fe(this.left,this.bottom,this.right,this.top)}equals(e){var t=!1;return e!=null&&(t=this.left===e.left&&this.right===e.right&&this.top===e.top&&this.bottom===e.bottom),t}toString(){return[this.left,this.bottom,this.right,this.top].join(",")}toArray(e){return e===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]}toBBOX(e,t){e==null&&(e=6);var r=Math.pow(10,e),i=Math.round(this.left*r)/r,h=Math.round(this.bottom*r)/r,c=Math.round(this.right*r)/r,p=Math.round(this.top*r)/r;return t===!0?h+","+i+","+p+","+c:i+","+h+","+c+","+p}getWidth(){return this.right-this.left}getHeight(){return this.top-this.bottom}getSize(){return new Tr(this.getWidth(),this.getHeight())}getCenterPixel(){return new gt((this.left+this.right)/2,(this.bottom+this.top)/2)}getCenterLonLat(){return this.centerLonLat||(this.centerLonLat=new vt((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat}scale(e,t){e=e||1,t==null&&(t=this.getCenterLonLat());var r,i;t.CLASS_NAME==="SuperMap.LonLat"?(r=t.lon,i=t.lat):(r=t.x,i=t.y);var h=(this.left-r)*e+r,c=(this.bottom-i)*e+i,p=(this.right-r)*e+r,g=(this.top-i)*e+i;return new Fe(h,c,p,g)}add(e,t){if(e==null||t==null)throw new TypeError("Bounds.add cannot receive null values");return new Fe(this.left+e,this.bottom+t,this.right+e,this.top+t)}extend(e){var t=null;if(e){switch(e.CLASS_NAME){case"SuperMap.LonLat":t=new Fe(e.lon,e.lat,e.lon,e.lat);break;case"SuperMap.Geometry.Point":t=new Fe(e.x,e.y,e.x,e.y);break;case"SuperMap.Bounds":t=e;break}t&&(this.centerLonLat=null,(this.left==null||t.left<this.left)&&(this.left=t.left),(this.bottom==null||t.bottom<this.bottom)&&(this.bottom=t.bottom),(this.right==null||t.right>this.right)&&(this.right=t.right),(this.top==null||t.top>this.top)&&(this.top=t.top))}}containsLonLat(e,t){typeof t=="boolean"&&(t={inclusive:t}),t=t||{};var r=this.contains(e.lon,e.lat,t.inclusive),i=t.worldBounds;if(i&&!r){var h=i.getWidth(),c=(i.left+i.right)/2,p=Math.round((e.lon-c)/h);r=this.containsLonLat({lon:e.lon-p*h,lat:e.lat},{inclusive:t.inclusive})}return r}containsPixel(e,t){return this.contains(e.x,e.y,t)}contains(e,t,r){if(r==null&&(r=!0),e==null||t==null)return!1;var i=!1;return r?i=e>=this.left&&e<=this.right&&t>=this.bottom&&t<=this.top:i=e>this.left&&e<this.right&&t>this.bottom&&t<this.top,i}intersectsBounds(e,t){if(typeof t=="boolean"&&(t={inclusive:t}),t=t||{},t.worldBounds){var r=this.wrapDateLine(t.worldBounds);e=e.wrapDateLine(t.worldBounds)}else r=this;t.inclusive==null&&(t.inclusive=!0);var i=!1,h=r.left===e.right||r.right===e.left||r.top===e.bottom||r.bottom===e.top;if(t.inclusive||!h){var c=e.bottom>=r.bottom&&e.bottom<=r.top||r.bottom>=e.bottom&&r.bottom<=e.top,p=e.top>=r.bottom&&e.top<=r.top||r.top>e.bottom&&r.top<e.top,g=e.left>=r.left&&e.left<=r.right||r.left>=e.left&&r.left<=e.right,v=e.right>=r.left&&e.right<=r.right||r.right>=e.left&&r.right<=e.right;i=(c||p)&&(g||v)}if(t.worldBounds&&!i){var y=t.worldBounds,w=y.getWidth(),A=!y.containsBounds(r),E=!y.containsBounds(e);A&&!E?(e=e.add(-w,0),i=r.intersectsBounds(e,{inclusive:t.inclusive})):E&&!A&&(r=r.add(-w,0),i=e.intersectsBounds(r,{inclusive:t.inclusive}))}return i}containsBounds(e,t,r){t==null&&(t=!1),r==null&&(r=!0);var i=this.contains(e.left,e.bottom,r),h=this.contains(e.right,e.bottom,r),c=this.contains(e.left,e.top,r),p=this.contains(e.right,e.top,r);return t?i||h||c||p:i&&h&&c&&p}determineQuadrant(e){var t="",r=this.getCenterLonLat();return t+=e.lat<r.lat?"b":"t",t+=e.lon<r.lon?"l":"r",t}wrapDateLine(e,t){t=t||{};var r=t.leftTolerance||0,i=t.rightTolerance||0,h=this.clone();if(e){for(var c=e.getWidth();h.left<e.left&&h.right-i<=e.left;)h=h.add(c,0);for(;h.left+r>=e.right&&h.right>e.right;)h=h.add(-c,0);var p=h.left+r;p<e.right&&p>e.left&&h.right-i>e.right&&(h=h.add(-c,0))}return h}toServerJSONObject(){var e={rightTop:{x:this.right,y:this.top},leftBottom:{x:this.left,y:this.bottom},left:this.left,right:this.right,top:this.top,bottom:this.bottom};return e}destroy(){this.left=null,this.right=null,this.top=null,this.bottom=null,this.centerLonLat=null}static fromString(e,t){var r=e.split(",");return Fe.fromArray(r,t)}static fromArray(e,t){return t===!0?new Fe(e[1],e[0],e[3],e[2]):new Fe(e[0],e[1],e[2],e[3])}static fromSize(e){return new Fe(0,e.h,e.w,0)}static oppositeQuadrant(e){var t="";return t+=e.charAt(0)==="t"?"b":"t",t+=e.charAt(1)==="l"?"r":"l",t}}class ue extends Ft{constructor(e,t,r,i){super(e,t,r,i),this.x=parseFloat(e),this.y=parseFloat(t),this.tag=i||i==0?parseFloat(i):null,this.type=r||"Point",this.CLASS_NAME="SuperMap.Geometry.Point",this.geometryType="Point"}clone(e){return e==null&&(e=new ue(this.x,this.y)),O.applyDefaults(e,this),e}calculateBounds(){this.bounds=new Fe(this.x,this.y,this.x,this.y)}equals(e){var t=!1;return e!=null&&(t=this.x===e.x&&this.y===e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t}move(e,t){this.x=this.x+e,this.y=this.y+t,this.clearBounds()}toShortString(){return this.x+", "+this.y}destroy(){this.x=null,this.y=null,this.tag=null,super.destroy()}getVertices(){return[this]}}class Xe extends Ft{constructor(e){super(),this.components=[],this.componentTypes=null,e!=null&&this.addComponents(e),this.CLASS_NAME="SuperMap.Geometry.Collection",this.geometryType="Collection"}destroy(){this.components.length=0,this.components=null,super.destroy()}clone(){for(var e=new Xe,t=0,r=this.components.length;t<r;t++)e.addComponent(this.components[t].clone());return O.applyDefaults(e,this),e}getComponentsString(){for(var e=[],t=0,r=this.components.length;t<r;t++)e.push(this.components[t].toShortString());return e.join(",")}calculateBounds(){this.bounds=null;var e=new Fe,t=this.components;if(t)for(var r=0,i=t.length;r<i;r++)e.extend(t[r].getBounds());e.left!=null&&e.bottom!=null&&e.right!=null&&e.top!=null&&this.setBounds(e)}addComponents(e){O.isArray(e)||(e=[e]);for(var t=0,r=e.length;t<r;t++)this.addComponent(e[t])}addComponent(e,t){var r=!1;if(e&&(this.componentTypes==null||O.indexOf(this.componentTypes,e.CLASS_NAME)>-1)){if(t!=null&&t<this.components.length){var i=this.components.slice(0,t),h=this.components.slice(t,this.components.length);i.push(e),this.components=i.concat(h)}else this.components.push(e);e.parent=this,this.clearBounds(),r=!0}return r}removeComponents(e){var t=!1;O.isArray(e)||(e=[e]);for(var r=e.length-1;r>=0;--r)t=this.removeComponent(e[r])||t;return t}removeComponent(e){return O.removeItem(this.components,e),this.clearBounds(),!0}getArea(){for(var e=0,t=0,r=this.components.length;t<r;t++)e+=this.components[t].getArea();return e}equals(e){var t=!0;if(!e||!e.CLASS_NAME||this.CLASS_NAME!==e.CLASS_NAME)t=!1;else if(!O.isArray(e.components)||e.components.length!==this.components.length)t=!1;else for(var r=0,i=this.components.length;r<i;++r)if(!this.components[r].equals(e.components[r])){t=!1;break}return t}getVertices(e){for(var t=[],r=0,i=this.components.length;r<i;++r)Array.prototype.push.apply(t,this.components[r].getVertices(e));return t}}class ar extends Xe{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.Point"],this.CLASS_NAME="SuperMap.Geometry.MultiPoint",this.geometryType="MultiPoint"}addPoint(e,t){this.addComponent(e,t)}removePoint(e){this.removeComponent(e)}}class sa extends ar{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.Point","SuperMap.PointWithMeasure"],this.CLASS_NAME="SuperMap.Geometry.Curve",this.geometryType="Curve"}}class Ee extends sa{constructor(e){super(e),this.CLASS_NAME="SuperMap.Geometry.LineString",this.geometryType="LineString"}removeComponent(e){var t=this.components&&this.components.length>2;return t&&super.removeComponent.apply(this,arguments),t}getSortedSegments(){for(var e=this.components.length-1,t=new Array(e),r,i,h=0;h<e;++h)r=this.components[h],i=this.components[h+1],r.x<i.x?t[h]={x1:r.x,y1:r.y,x2:i.x,y2:i.y}:t[h]={x1:i.x,y1:i.y,x2:r.x,y2:r.y};function c(p,g){return p.x1-g.x1}return t.sort(c)}getVertices(e){var t;return e===!0?t=[this.components[0],this.components[this.components.length-1]]:e===!1?t=this.components.slice(1,this.components.length-1):t=this.components.slice(),t}static calculateCircle(e){if(e.length<3)return e;var t={},r=e[0],i=e[1],h=e[2],c=0,p=0,g=!0,v=0,y=0,w=0,A=72,E=[],k=(h.y-r.y)/(h.x-r.x),z=h.y-k*h.x;if(h.x!=r.x&&h.y!=r.y&&i.y==k*i.x+z||h.x==r.x&&i.x==r.x||h.y==r.y&&i.y==r.y||h.x==r.x&&h.y==r.y||h.x==i.x&&h.y==i.y||r.x==i.x&&r.y==i.y)E.push(r),E.push(i),E.push(h);else{var x=(i.x*i.x+i.y*i.y-(r.x*r.x+r.y*r.y))*(2*(h.y-r.y))-(h.x*h.x+h.y*h.y-(r.x*r.x+r.y*r.y))*(2*(i.y-r.y)),N=2*(i.x-r.x)*(h.x*h.x+h.y*h.y-(r.x*r.x+r.y*r.y))-2*(h.x-r.x)*(i.x*i.x+i.y*i.y-(r.x*r.x+r.y*r.y)),b=4*((i.x-r.x)*(h.y-r.y)-(h.x-r.x)*(i.y-r.y));t.x=x/b,t.y=N/b,c=Math.sqrt((r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y));var R=(r.x-h.x)*(r.x-h.x)+(r.y-h.y)*(r.y-h.y),W=(2*c*c-R)/(2*c*c);W=W>=1?1:W,W=W<=-1?-1:W,w=Math.acos(W)*180/Math.PI,h.x==r.x?w=t.x>r.x&&i.x>r.x||t.x<r.x&&i.x<r.x?360-w:w:w=t.y>k*t.x+z&&i.y>k*i.x+z||t.y<k*t.x+z&&i.y<k*i.x+z?360-w:w,p=w/72,h.y!=r.y?h.x==r.x?h.y>r.y?i.x<r.x&&(g=!1):i.x>r.x&&(g=!1):h.x<r.x?i.y<k*i.x+z&&(g=!1):i.y>k*i.x+z&&(g=!1):h.x>r.x?i.y>r.y&&(g=!1):i.y<r.y&&(g=!1);var ee=(r.y-t.y)/(r.x-t.x),Y=ee>=0?Math.atan(ee)*180/Math.PI:Math.abs(Math.atan(ee)*180/Math.PI)+90,j=Math.abs(t.y);r.y==j&&j==h.y&&r.x<h.x&&(Y=Y+180);var re=r.y-t.y;E.push(r);for(var le=1;le<A;le++){v=p*le,y=Y,g?re>=0?ee>=0?y=y+v:y=180-(y-90)+v:ee>0?y=y-180+v:y=90-y+v:re>=0?ee>=0?y=y-v:y=180-(y-90)-v:ee>=0?y=y-180-v:y=90-y-v,y=y*Math.PI/180;var De=t.x+c*Math.cos(y),Le=t.y+c*Math.sin(y);E.push(new ue(De,Le))}E.push(h)}return E}static createLineEPS(e){var t=[],r=e.length;if(r<2)return e;for(var i=0;i<r;){var h=e[i].type;if(h=="LTypeArc"){var c=Ee.createLineArc(t,i,r,e);t=c[0],i=c[1]}else t.push(e[i]),i++}return t}static createLineArc(e,t,r,i){if(t==0){let p=Ee.addPointEPS(i,t,r,"LTypeArc");Array.prototype.push.apply(e,p[0]),t=p[1]+1}else if(t==r-1){var h=[i[t-1],i[t]],c=Ee.calculateCircle(h);Array.prototype.push.apply(e,c),t++}else{let p=Ee.addPointEPS(i,t,r,"LTypeArc");e.pop(),Array.prototype.push.apply(e,p[0]),t=p[1]+1}return[e,t]}static addPointEPS(e,t,r,i){var h=[],c=t+1;t==0?Array.prototype.push.apply(h,[e[t],e[t+1]]):t==r-1?Array.prototype.push.apply(h,[e[t-1],e[t]]):Array.prototype.push.apply(h,[e[t-1],e[t],e[t+1]]);var p;return i=="LTypeCurve"?p=Ee.calculatePointsFBZN(h):i=="LTypeArc"&&(p=Ee.calculateCircle(h)),[p,c]}}class Ze extends Ee{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.Point"],this.CLASS_NAME="SuperMap.Geometry.LinearRing",this.geometryType="LinearRing"}addComponent(e,t){var r=!1,i=this.components.pop();(t!=null||!e.equals(i))&&(r=super.addComponent.apply(this,arguments));var h=this.components[0];return super.addComponent.apply(this,[h]),r}removeComponent(e){var t=this.components&&this.components.length>3;if(t){this.components.pop(),super.removeComponent.apply(this,arguments);var r=this.components[0];super.addComponent.apply(this,[r])}return t}getArea(){var e=0;if(this.components&&this.components.length>2){for(var t=0,r=0,i=this.components.length;r<i-1;r++){var h=this.components[r],c=this.components[r+1];t+=(h.x+c.x)*(c.y-h.y)}e=-t/2}return e}getVertices(e){return e===!0?[]:this.components.slice(0,this.components.length-1)}}class or extends Xe{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.LineString"],this.CLASS_NAME="SuperMap.Geometry.MultiLineString",this.geometryType="MultiLineString"}}class $e extends Xe{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.LinearRing"],this.CLASS_NAME="SuperMap.Geometry.Polygon",this.geometryType="Polygon"}getArea(){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getArea());for(var t=1,r=this.components.length;t<r;t++)e-=Math.abs(this.components[t].getArea())}return e}}class yt extends Xe{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.Polygon"],this.CLASS_NAME="SuperMap.Geometry.MultiPolygon",this.geometryType="MultiPolygon"}}class st{constructor(e,t,r){this.red=!e&&e!=0?255:e,this.green=t||0,this.blue=r||0,this.CLASS_NAME="SuperMap.ServerColor"}destroy(){var e=this;e.red=null,e.green=null,e.blue=null}static fromJson(e){if(!!e){var t=new st,r=255;e.red!==null&&(r=Number(e.red)),t.red=r;var i=0;e.green!==null&&(i=Number(e.green)),t.green=i;var h=0;return e.blue!==null&&(h=Number(e.blue)),t.blue=h,t}}}class _r{constructor(e){this.fillBackColor=new st(255,255,255),this.fillBackOpaque=!1,this.fillForeColor=new st(255,0,0),this.fillGradientMode=null,this.fillGradientAngle=0,this.fillGradientOffsetRatioX=0,this.fillGradientOffsetRatioY=0,this.fillOpaqueRate=100,this.fillSymbolID=0,this.lineColor=new st(0,0,0),this.lineSymbolID=0,this.lineWidth=1,this.markerAngle=0,this.markerSize=1,this.markerSymbolID=-1,e&&O.extend(this,e),this.CLASS_NAME="SuperMap.ServerStyle"}destroy(){var e=this;e.fillBackColor&&(e.fillBackColor.destroy(),e.fillBackColor=null),e.fillBackOpaque=null,e.fillForeColor&&(e.fillForeColor.destroy(),e.fillForeColor=null),e.fillGradientMode=null,e.fillGradientAngle=null,e.fillGradientOffsetRatioX=null,e.fillGradientOffsetRatioY=null,e.fillOpaqueRate=null,e.fillSymbolID=null,e.lineColor&&(e.lineColor.destroy(),e.lineColor=null),e.lineSymbolID=null,e.lineWidth=null,e.markerAngle=null,e.markerSize=null,e.markerSymbolID=null}toServerJSONObject(){var e={};return e=O.copyAttributes(e,this),e}static fromJson(e){if(!!e)return new _r({fillBackColor:st.fromJson(e.fillBackColor),fillBackOpaque:e.fillBackOpaque,fillForeColor:st.fromJson(e.fillForeColor),fillGradientMode:e.fillGradientMode,fillGradientAngle:e.fillGradientAngle,fillGradientOffsetRatioX:e.fillGradientOffsetRatioX,fillGradientOffsetRatioY:e.fillGradientOffsetRatioY,fillOpaqueRate:e.fillOpaqueRate,fillSymbolID:e.fillSymbolID,lineColor:st.fromJson(e.lineColor),lineSymbolID:e.lineSymbolID,lineWidth:e.lineWidth,markerAngle:e.markerAngle,markerSize:e.markerSize,markerSymbolID:e.markerSymbolID})}}class kr extends ue{constructor(e){super(e),this.measure=null,e&&O.extend(this,e),this.CLASS_NAME="SuperMap.PointWithMeasure"}equals(e){var t=!1;if(e!=null){var r=this.x===e.x&&this.y===e.y&&this.measure===e.measure,i=isNaN(this.x)&&isNaN(this.y)&&isNaN(this.measure),h=isNaN(e.x)&&isNaN(e.y)&&isNaN(e.measure);t=r||i&&h}return t}toJson(){var e="{";return this.measure!=null&&this.measure!=null&&(e+='"measure":'+this.measure+","),e+='"x":'+this.x+",",e+='"y":'+this.y,e+="}",e}destroy(){var e=this;e.measure=null,e.x=null,e.y=null}static fromJson(e){if(!!e)return new kr({x:e.x,y:e.y,measure:e.measure})}}class Fr extends Xe{constructor(e,t){super(e,t),this.id=null,this.center=null,this.style=null,this.length=null,this.maxM=null,this.minM=null,this.parts=null,this.points=null,this.type=null,this.componentTypes=["SuperMap.Geometry.LinearRing","SuperMap.Geometry.LineString"],t&&O.extend(this,t),this.CLASS_NAME="SuperMap.Route",this.geometryType="LINEM"}toJson(){var e="{";if(this.id!=null&&this.id!=null&&(e+='"id":'+this.id+","),this.center!=null&&this.center!=null&&(e+='"center":'+this.center+","),this.style!=null&&this.style!=null&&(e+='"style":'+this.style+","),this.length!=null&&this.length!=null&&(e+='"length":'+this.length+","),this.maxM!=null&&this.maxM!=null&&(e+='"maxM":'+this.maxM+","),this.minM!=null&&this.minM!=null&&(e+='"minM":'+this.minM+","),this.type!=null&&this.type!=null&&(e+='"type":"'+this.type+'",'),this.parts!=null&&this.parts!=null){e+='"parts":['+this.parts[0];for(var t=1;t<this.parts.length;t++)e+=","+this.parts[t];e+="],"}if(this.components!=null&&this.components.length>0){e+='"points":[';for(var r=0,i=this.components.length;r<i;r++)for(var h=0,c=this.components[r].components.length;h<c;h++)e+=this.components[r].components[h].toJson()+",";e=e.replace(/,$/g,""),e+="]"}return e=e.replace(/,$/g,""),e+="}",e}destroy(){var e=this;e.id=null,e.center=null,e.style=null,e.length=null,e.maxM=null,e.minM=null,e.type=null,e.parts=null,e.components.length=0,e.components=null,e.componentTypes=null}static fromJson(e){if(!!e){var t=e.parts||[],r=e.points||[],i=t.length,h=[];if(i>0)for(var c=0,p=0,g=[];c<i;c++){for(var v=0;v<t[c];v++)g.push(kr.fromJson(r[p+v]));p+=t[c],g[0].equals(g[t[c]-1])?h.push(new Ze(g)):h.push(new Ee(g)),g=[]}else return null;return new Fr(h,{id:e.id,center:e.center,style:e.style,length:e.length,maxM:e.maxM,minM:e.minM,type:e.type,parts:e.parts})}}}class Be{constructor(e){this.id=0,this.style=null,this.parts=null,this.points=null,this.type=null,this.prjCoordSys=null,e&&O.extend(this,e),this.CLASS_NAME="SuperMap.ServerGeometry"}destroy(){var e=this;e.id=null,e.style=null,e.parts=null,e.partTopo=null,e.points=null,e.type=null,e.prjCoordSys=null}toGeometry(){var e=this,t=e.type;switch(t.toUpperCase()){case ke.POINT:return e.toGeoPoint();case ke.LINE:return e.toGeoLine();case ke.LINEM:return e.toGeoLinem();case ke.REGION:return e.toGeoRegion();case ke.POINTEPS:return e.toGeoPoint();case ke.LINEEPS:return e.toGeoLineEPS();case ke.REGIONEPS:return e.toGeoRegionEPS();case ke.GEOCOMPOUND:return e.transformGeoCompound()}}toGeoPoint(){var e=this,t=e.parts||[],r=e.points||[],i=t.length;if(i>0){if(i===1)return new ue(r[0].x,r[0].y);var h=[];for(let c=0;c<i;c++)h.push(new ue(r[c].x,r[c].y));return new ar(h)}else return null}toGeoLine(){var e=this,t=e.parts||[],r=e.points||[],i=t.length;if(i>0)if(i===1){let h=[];for(let c=0;c<t[0];c++)h.push(new ue(r[c].x,r[c].y));return h[0].equals(h[t[0]-1])?new Ze(h):new Ee(h)}else{let h=[];for(let c=0;c<i;c++){let p=[];for(let g=0;g<t[c];g++)p.push(new ue(r[g].x,r[g].y));h.push(new Ee(p)),r.splice(0,t[c])}return new or(h)}else return null}toGeoLineEPS(){var e=this,t=e.parts||[],r=e.points||[],i,h,c,p,g,v=t.length;if(v>0)if(v===1){for(i=0,c=[];i<t[0];i++)c.push(new ue(r[i].x,r[i].y,r[i].type));return c[0].equals(c[t[0]-1])?(g=Ee.createLineEPS(c),new Ze(g)):(g=Ee.createLineEPS(c),new Ee(g))}else{for(i=0,p=[];i<v;i++){for(h=0,c=[];h<t[i];h++)c.push(new ue(r[h].x,r[h].y));g=Ee.createLineEPS(c),p.push(new Ee(g)),r.splice(0,t[i])}return new or(p)}else return null}toGeoLinem(){var e=this;return Fr.fromJson(e)}toGeoRegion(){var e=this,t=e.parts||[],r=e.partTopo||[],i=e.points||[],h=t.length;if(h<=0)return null;var c=[],p=[];if(h==1){for(let x=0;x<i.length;x++)p.push(new ue(i[x].x,i[x].y));return c.push(new $e([new Ze(p)])),new yt(c)}var g=[],v=[],y=[],w=[],A=[];for(let x=0,N=0;x<h;x++){for(let b=0;b<t[x];b++)p.push(new ue(i[N+b].x,i[N+b].y));N+=t[x];var E=new $e([new Ze(p)]);p=[],y.push(E),r.length===0&&w.push(E.getBounds()),A.push(1),v.push(E.getArea())}if(r.length===0){Be.bubbleSort(v,y,r,w);var k=[];for(let x=1;x<y.length;x++)for(let N=x-1;N>=0;N--)if(k[x]=-1,w[N].containsBounds(w[x])){A[x]=A[N]*-1,A[x]<0&&(k[x]=N);break}for(let x=0;x<y.length;x++)A[x]>0?c.push(y[x]):(c[k[x]].components=c[k[x]].components.concat(y[x].components),c.push(""))}else{c=new Array;for(let x=0;x<y.length;x++)if(r[x]&&r[x]==-1?g=g.concat(y[x].components):(g.length>0&&c.length>0&&(c[c.length-1].components=c[c.length-1].components.concat(g),g=[]),c.push(y[x])),x==h-1){var z=c.length;if(z)c[z-1].components=c[z-1].components.concat(g);else for(let N=0,b=g.length;N<b;N++)c.push(new $e(g))}}return new yt(c)}toGeoRegionEPS(){var e=this,t=e.parts||[],r=e.partTopo||[],i=e.points||[],h=t.length;if(h<=0)return null;var c=[],p=[],g;if(h==1){for(var v=0;v<i.length;v++)p.push(new ue(i[v].x,i[v].y));return g=Ee.createLineEPS(p),c.push(new $e([new Ze(g)])),new yt(c)}var y=[],w=[],A=[],E=[],k=[];for(let b=0,R=0;b<h;b++){for(let W=0;W<t[b];W++)p.push(new ue(i[R+W].x,i[R+W].y));R+=t[b],g=Ee.createLineEPS(p);var z=new $e([new Ze(g)]);p=[],A.push(z),r.length===0&&E.push(z.getBounds()),k.push(1),w.push(z.getArea())}if(r.length===0){Be.bubbleSort(w,A,r,E);var x=[];for(let b=1;b<A.length;b++)for(let R=b-1;R>=0;R--)if(x[b]=-1,E[R].containsBounds(E[b])){k[b]=k[R]*-1,k[b]<0&&(x[b]=R);break}for(let b=0;b<A.length;b++)k[b]>0?c.push(A[b]):(c[x[b]].components=c[x[b]].components.concat(A[b].components),c.push(""))}else{c=new Array;for(let b=0;b<A.length;b++)if(r[b]&&r[b]==-1?y=y.concat(A[b].components):(y.length>0&&c.length>0&&(c[c.length-1].components=c[c.length-1].components.concat(y),y=[]),c.push(A[b])),b==h-1){var N=c.length;if(N)c[N-1].components=c[N-1].components.concat(y);else for(let R=0,W=y.length;R<W;R++)c.push(new $e(y))}}return new yt(c)}transformGeoCompound(){const e=this,t=e.geoParts||[],r=t.length;if(r<=0)return null;const i=[];for(let h=0;h<r;h++){const c=t[h];i.push(new Be(c).toGeometry())}return new Xe(i)}static fromJson(e){if(!!e)return new Be({id:e.id,style:_r.fromJson(e.style),parts:e.parts,partTopo:e.partTopo,points:e.points,center:e.center,length:e.length,maxM:e.maxM,minM:e.minM,type:e.type})}static fromGeometry(e){if(!!e){var t=0,r=[],i=[],h=null,c=e.components,p=e.CLASS_NAME,g={epsgCode:e.SRID};if(isNaN(e.id)||(t=e.id),p!="SuperMap.Geometry.LinearRing"&&p!="SuperMap.Geometry.LineString"&&(e instanceof ar||e instanceof or)){let v=c.length;for(let y=0;y<v;y++){const w=c[y].getVertices();let A=w.length;r.push(A);for(let E=0;E<A;E++)i.push(new ue(w[E].x,w[E].y))}h=p=="SuperMap.Geometry.MultiPoint"?ke.POINT:ke.LINE}else if(e instanceof yt){let v=c.length;for(let y=0;y<v;y++){let w=c[y],A=w.components,E=A.length;for(let k=0;k<E;k++){const z=A[k].getVertices(),x=z.length+1;r.push(x);for(let N=0;N<x-1;N++)i.push(new ue(z[N].x,z[N].y));i.push(new ue(z[0].x,z[0].y))}}h=ke.REGION}else if(e instanceof $e){let v=c.length;for(let y=0;y<v;y++){const w=c[y].getVertices();let A=w.length+1;r.push(A);for(let E=0;E<A-1;E++)i.push(new ue(w[E].x,w[E].y));i.push(new ue(w[0].x,w[0].y))}h=ke.REGION}else{const v=e.getVertices();let y=v.length;for(let w=0;w<y;w++)i.push(new ue(v[w].x,v[w].y));e instanceof Ze&&(i.push(new ue(v[0].x,v[0].y)),y++),r.push(y),h=e instanceof ue?ke.POINT:ke.LINE}return new Be({id:t,style:null,parts:r,points:i,type:h,prjCoordSys:g})}}static IsClockWise(e){var t=e.length;if(t<3)return 0;var r=e[0].y*(e[t-1].x-e[1].x);e.push(e[0]);for(var i=1;i<t;i++)r+=e[i].y*(e[i-1].x-e[i+1].x);return r*.5}static bubbleSort(e,t,r,i){for(var h=0;h<e.length;h++)for(var c=0;c<e.length;c++)if(e[h]>e[c]){var p=e[c];e[c]=e[h],e[h]=p;var g=t[c];if(t[c]=t[h],t[h]=g,r&&r.length>0){var v=r[c];r[c]=r[h],r[h]=v}if(i&&i.length>0){var y=i[c];i[c]=i[h],i[h]=y}}}}class aa{constructor(e,t,r){this.CLASS_NAME="SuperMap.Feature",this.layer=e,this.id=O.createUniqueID(this.CLASS_NAME+"_"),this.lonlat=t,this.data=r!=null?r:{}}destroy(){this.id=null,this.lonlat=null,this.data=null}}const We={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};class Rt extends aa{constructor(e,t,r){super(null,null,t),this.fid=null,this.geometry=e||null,this.attributes={},t&&(this.attributes=O.extend(this.attributes,t)),this.bounds=null,this.state=null,this.style=r||null,this.url=null,this.lonlat=null,this.CLASS_NAME="SuperMap.Feature.Vector",Rt.style={default:{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"default",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},delete:{display:"none"}}}destroy(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,super.destroy()}clone(){return new Rt(this.geometry?this.geometry.clone():null,this.attributes,this.style)}toState(e){if(e===We.UPDATE)switch(this.state){case We.UNKNOWN:case We.DELETE:this.state=e;break}else if(e===We.INSERT)switch(this.state){case We.UNKNOWN:break;default:this.state=e;break}else if(e===We.DELETE)switch(this.state){case We.INSERT:break;case We.DELETE:break;case We.UNKNOWN:case We.UPDATE:this.state=e;break}else e===We.UNKNOWN&&(this.state=e)}}class oa{constructor(e){this.data=null,this.keepData=!1,O.extend(this,e),this.options=e,this.CLASS_NAME="SuperMap.Format"}destroy(){}read(e){}write(e){}}class Oi extends oa{constructor(e){super(e),this.indent="    ",this.space=" ",this.newline=`
`,this.level=0,this.pretty=!1,this.nativeJSON=function(){return!!(window.JSON&&typeof JSON.parse=="function"&&typeof JSON.stringify=="function")}(),this.CLASS_NAME="SuperMap.Format.JSON",this.serialize={object:function(t){if(t==null)return"null";if(t.constructor===Date)return this.serialize.date.apply(this,[t]);if(t.constructor===Array)return this.serialize.array.apply(this,[t]);var r=["{"];this.level+=1;var i,h,c,p=!1;for(i in t)t.hasOwnProperty(i)&&(h=this.write.apply(this,[i,this.pretty]),c=this.write.apply(this,[t[i],this.pretty]),h!=null&&c!=null&&(p&&r.push(","),r.push(this.writeNewline(),this.writeIndent(),h,":",this.writeSpace(),c),p=!0));return this.level-=1,r.push(this.writeNewline(),this.writeIndent(),"}"),r.join("")},array:function(t){var r,i=["["];this.level+=1;for(var h=0,c=t.length;h<c;++h)r=this.write.apply(this,[t[h],this.pretty]),r!=null&&(h>0&&i.push(","),i.push(this.writeNewline(),this.writeIndent(),r));return this.level-=1,i.push(this.writeNewline(),this.writeIndent(),"]"),i.join("")},string:function(t){var r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(t)?'"'+t.replace(/([\x00-\x1f\\"])/g,function(i,h){var c=r[h];return c||(c=h.charCodeAt(),"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16))})+'"':'"'+t+'"'},number:function(t){return isFinite(t)?String(t):"null"},boolean:function(t){return String(t)},date:function(t){function r(i){return i<10?"0"+i:i}return'"'+t.getFullYear()+"-"+r(t.getMonth()+1)+"-"+r(t.getDate())+"T"+r(t.getHours())+":"+r(t.getMinutes())+":"+r(t.getSeconds())+'"'}}}read(e,t){var r;if(this.nativeJSON)try{r=JSON.parse(e,t)}catch{return{data:e}}return this.keepData&&(this.data=r),r}write(e,t){this.pretty=!!t;var r=null,i=typeof e;if(this.serialize[i])try{r=!this.pretty&&this.nativeJSON?JSON.stringify(e):this.serialize[i].apply(this,[e])}catch{}return r}writeIndent(){var e=[];if(this.pretty)for(var t=0;t<this.level;++t)e.push(this.indent);return e.join("")}writeNewline(){return this.pretty?this.newline:""}writeSpace(){return this.pretty?this.space:""}}class Rr extends Oi{constructor(e){super(e),this.ignoreExtraDims=!0,this.CLASS_NAME="SuperMap.Format.GeoJSON",this.parseCoords={point:function(t){if(this.ignoreExtraDims===!1&&t.length!=2)throw"Only 2D points are supported: "+t;return new ue(t[0],t[1])},multipoint:function(t){for(var r=[],i=null,h=0,c=t.length;h<c;++h){try{i=this.parseCoords.point.apply(this,[t[h]])}catch(p){throw p}r.push(i)}return new ar(r)},linestring:function(t){for(var r=[],i=null,h=0,c=t.length;h<c;++h){try{i=this.parseCoords.point.apply(this,[t[h]])}catch(p){throw p}r.push(i)}return new Ee(r)},multilinestring:function(t){for(var r=[],i=null,h=0,c=t.length;h<c;++h){try{i=this.parseCoords.linestring.apply(this,[t[h]])}catch(p){throw p}r.push(i)}return new or(r)},polygon:function(t){for(var r=[],i,h,c=0,p=t.length;c<p;++c){try{h=this.parseCoords.linestring.apply(this,[t[c]])}catch(g){throw g}i=new Ze(h.components),r.push(i)}return new $e(r)},multipolygon:function(t){for(var r=[],i=null,h=0,c=t.length;h<c;++h){try{i=this.parseCoords.polygon.apply(this,[t[h]])}catch(p){throw p}r.push(i)}return new yt(r)},box:function(t){if(t.length!=2)throw"GeoJSON box coordinates must have 2 elements";return new $e([new Ze([new ue(t[0][0],t[0][1]),new ue(t[1][0],t[0][1]),new ue(t[1][0],t[1][1]),new ue(t[0][0],t[1][1]),new ue(t[0][0],t[0][1])])])}},this.extract={feature:function(t){var r=this.extract.geometry.apply(this,[t.geometry]),i={type:"Feature",properties:this.createAttributes(t),geometry:r};return t.geometry&&t.geometry.type==="TEXT"&&(i.properties.texts=t.geometry.texts,i.properties.textStyle=t.geometry.textStyle),t.fid&&(i.id=t.fid),t.ID&&(i.id=t.ID),i},geometry:function(t){if(t==null)return null;!t.parts&&t.points&&(t.parts=[t.points.length]);var r=t.hasOwnProperty("geometryType")?t:new Be(t).toGeometry()||t,i=r.geometryType||r.type,h;i==="LinearRing"&&(i="LineString"),i==="LINEM"&&(i="MultiLineString"),h=this.extract[i.toLowerCase()].apply(this,[r]),i=i==="TEXT"?"Point":i;var c;return i==="Collection"?c={type:"GeometryCollection",geometries:h}:c={type:i,coordinates:h},c},point:function(t){var r=[t.x,t.y];for(var i in t)i!=="x"&&i!=="y"&&t[i]!==null&&!isNaN(t[i])&&r.push(t[i]);return r},text:function(t){return[t.points[0].x,t.points[0].y]},multipoint:function(t){for(var r=[],i=0,h=t.components.length;i<h;++i)r.push(this.extract.point.apply(this,[t.components[i]]));return r},linestring:function(t){for(var r=[],i=0,h=t.components.length;i<h;++i)r.push(this.extract.point.apply(this,[t.components[i]]));return r},multilinestring:function(t){for(var r=[],i=0,h=t.components.length;i<h;++i)r.push(this.extract.linestring.apply(this,[t.components[i]]));return r},polygon:function(t){for(var r=[],i=0,h=t.components.length;i<h;++i)r.push(this.extract.linestring.apply(this,[t.components[i]]));return r},multipolygon:function(t){for(var r=[],i=0,h=t.components.length;i<h;++i)r.push(this.extract.polygon.apply(this,[t.components[i]]));return r},collection:function(t){for(var r=t.components.length,i=new Array(r),h=0;h<r;++h)i[h]=this.extract.geometry.apply(this,[t.components[h]]);return i}}}read(e,t,r){t=t||"FeatureCollection";var i=null,h=null;if(typeof e=="string"?h=super.read(e,r):h=e,h){if(typeof h.type=="string"){if(this.isValidType(h,t))switch(t){case"Geometry":try{i=this.parseGeometry(h)}catch{}break;case"Feature":try{i=this.parseFeature(h),i.type="Feature"}catch{}break;case"FeatureCollection":switch(i=[],h.type){case"Feature":try{i.push(this.parseFeature(h))}catch{i=null}break;case"FeatureCollection":for(var c=0,p=h.features.length;c<p;++c)try{i.push(this.parseFeature(h.features[c]))}catch{i=null}break;default:try{var g=this.parseGeometry(h);i.push(new Rt(g))}catch{i=null}}break}}}return i}write(e,t){return super.write(this.toGeoJSON(e),t)}fromGeoJSON(e,t,r){let i=this.read(e,t,r);return O.isArray(i)?i.map(h=>this._toiSevrerFeature(h)):this._toiSevrerFeature(i)}toGeoJSON(e){var t={type:null};if(O.isArray(e)){t.type="FeatureCollection";var r=e.length;t.features=new Array(r);for(var i=0;i<r;++i){var h=e[i];if(c(h)){let p={};p.geometry=h,t.features[i]=this.extract.feature.apply(this,[p])}else t.features[i]=this.extract.feature.apply(this,[h])}}else if(c(e)){let p={};p.geometry=e,t=this.extract.feature.apply(this,[p])}else t=this.extract.feature.apply(this,[e]);function c(p){return p.hasOwnProperty("parts")&&p.hasOwnProperty("points")||p.hasOwnProperty("geoParts")}return t}isValidType(e,t){var r=!1;switch(t){case"Geometry":O.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],e.type)==-1||(r=!0);break;case"FeatureCollection":r=!0;break;default:e.type==t&&(r=!0)}return r}parseFeature(e){var t,r,i,h;i=e.properties?e.properties:{},h=e.geometry&&e.geometry.bbox||e.bbox;try{r=this.parseGeometry(e.geometry)}catch(c){throw c}return t=new Rt(r,i),h&&(t.bounds=Fe.fromArray(h)),e.id&&(t.geometry.id=e.id,t.fid=e.id),t}parseGeometry(e){if(e==null)return null;var t;if(e.type=="GeometryCollection"){if(!O.isArray(e.geometries))throw"GeometryCollection must have geometries array: "+e;for(var r=e.geometries.length,i=new Array(r),h=0;h<r;++h)i[h]=this.parseGeometry.apply(this,[e.geometries[h]]);t=new Xe(i)}else{if(!O.isArray(e.coordinates))throw"Geometry must have coordinates array: "+e;if(!this.parseCoords[e.type.toLowerCase()])throw"Unsupported geometry type: "+e.type;try{t=this.parseCoords[e.type.toLowerCase()].apply(this,[e.coordinates])}catch(c){throw c}}return t}createCRSObject(e){var t=e.layer.projection.toString(),r={};if(t.match(/epsg:/i)){var i=parseInt(t.substring(t.indexOf(":")+1));i==4326?r={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:r={type:"name",properties:{name:"EPSG:"+i}}}return r}_toiSevrerFeature(e){const t=e.attributes,r=[],i=[];for(var h in t)r.push(h),i.push(t[h]);const c={fieldNames:r,fieldValues:i,geometry:Be.fromGeometry(e.geometry)};return c.geometry.id=e.fid,c}createAttributes(e){if(!e)return null;var t={};h(e,t);var r=["fieldNames","fieldValues","geometry","stringID","ID"];for(var i in e)r.indexOf(i)>-1||(t[i]=e[i]);function h(c,p){if(!!(c.hasOwnProperty("fieldNames")&&c.hasOwnProperty("fieldValues"))){var g=c.fieldNames,v=c.fieldValues;for(var y in g)p[g[y]]=v[y]}}return t}}var lr=function(n){var e=6378137,t;if(n===Ve.METER)t=1;else if(n===Ve.DEGREE)t=Math.PI*2*e/360;else if(n===Ve.KILOMETER)t=.001;else if(n===Ve.INCH)t=1/.025399999918;else if(n===Ve.FOOT)t=.3048;else return t;return t};function la(n,e,t,r,i=22){var h=[];if(n&&n.length>0)for(let c=0;c<n.length;c++)h.push(ha(n[c],t,r));else{const c=Math.abs(e.left-e.right)/256;for(let p=0;p<i;p++)h.push(c/Math.pow(2,p))}return h.sort(function(c,p){return p-c})}function ua(n,e){let t=0,r;for(let i=0;i<e.length;i++)i===0&&(r=Math.abs(n-e[i])),r>Math.abs(n-e[i])&&(r=Math.abs(n-e[i]),t=i);return t}function ha(n,e,t){const r=39.37007874015748,i=lr(t);return 1/(n*e*r*i)}const Ce={getOlVersion(){if(yr&&yr.VERSION)return yr.VERSION.split(".")[0];if(window&&window.ol){if(window.ol.util)return"6";if(window.ol.WebGLMap)return"5"}return"4"},toGeoJSON(n){return n?new Rr().toGeoJSON(n):null},toSuperMapGeometry(n){return!n||!n.type?null:new Rr().read(n,"FeatureCollection")[0].geometry},resolutionToScale(n,e,t){const r=39.37007874015748,i=lr(t);return 1/(n*e*r*i)},toSuperMapBounds(n){return new Fe(n[0],n[1],n[2],n[3])},toProcessingParam(n){if(n.length<1)return"";const e={},t=[];for(let r=0;r<n.length;r++){const i={x:n[r][0],y:n[r][1]};t.push(i)}return t.push(t[0]),e.type="REGION",e.points=t,e},scaleToResolution(n,e,t){const r=39.37007874015748,i=lr(t);return 1/(n*e*r*i)},getMeterPerMapUnit:lr,isArray:ca,Csv2GeoJSON(n,e){e=e||{titles:["lon","lat"],latitudeTitle:"lat",longitudeTitle:"lon",fieldSeparator:",",lineSeparator:`
`,deleteDoubleQuotes:!0,firstLineTitles:!1};const r=[];if(typeof n=="string"){let c=e.titles;if(e.firstLineTitles){if(n=n.split(e.lineSeparator),n.length<2)return;c=n[0],n.splice(0,1),n=n.join(e.lineSeparator),c=c.trim().split(e.fieldSeparator);for(let p=0;p<c.length;p++)c[p]=i(c[p]);e.titles=c}for(let p=0;p<c.length;p++){let g=c[p].toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"_");(g===""||g==="_")&&(g=`prop-${p}`),r[p]=g}n=h(n)}return n;function i(c){return e.deleteDoubleQuotes&&(c=c.trim().replace(/^"/,"").replace(/"$/,"")),c}function h(c){const p={};p.type="FeatureCollection",p.features=[];const g=e.titles;c=c.split(e.lineSeparator);for(let v=0;v<c.length;v++){const y=c[v].trim().split(e.fieldSeparator),w=parseFloat(y[g.indexOf(e.longitudeTitle)]),A=parseFloat(y[g.indexOf(e.latitudeTitle)]),E=w<180&&w>-180&&A<90&&A>-90;if(!(y.length===g.length&&E))continue;const k={};k.type="Feature",k.geometry={},k.properties={},k.geometry.type="Point",k.geometry.coordinates=[w,A];for(let z=0;z<g.length;z++)g[z]!==e.latitudeTitle&&g[z]!==e.longitudeTitle&&(k.properties[r[z]]=i(y[z]));p.features.push(k)}return p}},createCanvasContext2D(n,e){const t=document.createElement("CANVAS");return n&&(t.width=n),e&&(t.height=e),t.getContext("2d")},supportWebGL2(){const n=document.createElement("canvas");return Boolean(n&&n.getContext("webgl2"))},isString:Ni,isObject(n){return Object.prototype.toString.call(n)==="[object Object]"},trim(n=""){return n.replace(/(^\s*)|(\s*$)/g,"")},newGuid(n){let e=n||32,t="";for(let r=1;r<e;r++){let i=Math.floor(Math.random()*16).toString(16);t+=i}return t},isNumber(n){if(n==="")return!1;let e=Number(n);return e===0?!0:!isNaN(e)},isMatchAdministrativeName:Gi,getHighestMatchAdministration(n,e){let t=n.filter(h=>Gi(h.properties.Name,e)),r=0,i=null;return t.forEach(h=>{let c=0;Array.from(new Set(h.properties.Name.split(""))).forEach(p=>{e.includes(p)&&c++}),c>r&&(r=c,i=h)}),i},setMask(n,e){if(!e||!((e instanceof wr.default?e.getGeometry():e)instanceof mr.default)&&["MultiPolygon","Polygon"].indexOf(e.getType())<0)return;const r=e instanceof wr.default?e:new wr.default(e),i=new vr.Style({fill:new vr.Fill({color:"black"})}),h=new hi.default({source:new ui.default({features:[r],wrapX:!1})}),c=function(g){const v=ai.getVectorContext(g);g.context.globalCompositeOperation="destination-in",h.getSource().forEachFeature(function(y){v.drawFeature(y,i),g.context.globalCompositeOperation="source-over"})},p=Array.isArray(n)?n:[n];Di(p),p.forEach(g=>{g.classNameBak_=g.className_,g.className_=`ol_mask_layer_${g.ol_uid}`,g.clipRender=c,g.extentBak_=g.getExtent(),g.setExtent(h.getSource().getExtent()),g.on("postrender",c),g.changed()})},unsetMask:Di,getZoomByResolution(n,e){return ua(n,e)},scalesToResolutions(n,e,t,r,i,h){return la(n,e,t,r,i)},getProjection(n,e){let t=oi.get(`EPSG:${n.epsgCode}`);return n.type=="PCS_NON_EARTH"&&(t=new ns.default({extent:e,units:"m",code:"0"})),t||console.error(`The projection of EPSG:${n.epsgCode} is missing, please register the projection of EPSG:${n.epsgCode} first, refer to the documentation: https://iclient.supermap.io/web/introduction/leafletDevelop.html#multiProjection`),t}};function Ni(n){return typeof n=="string"&&n.constructor===String}function ca(n){return Object.prototype.toString.call(n)==="[object Array]"}function Di(n){const e=Array.isArray(n)?n:[n];for(let t=0;t<e.length;t++){const r=e[t];!r.clipRender||(r.un("postrender",r.clipRender),r.className_=r.classNameBak_,r.setExtent(r.extentBak),delete r.classNameBak_,delete r.clipRender,delete r.extentBak_,r.changed())}}function Gi(n,e){if(Ni(e)){let t=n.substr(0,2);return t==="\u5F20\u5BB6"&&(t=n.substr(0,3)),!!e.match(new RegExp(t))}return!1}class mt extends ss.default{constructor(e){e=e||{},e.attributions=e.attributions||"Map Data <span>\xA9 <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>\xA9 <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>",e.format=e.format?e.format:"png",super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,logo:Ce.getOlVersion()==="4"?e.logo:null,opaque:e.opaque,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:e.state,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:p,wrapX:e.wrapX!==void 0?e.wrapX:!1,cacheEnabled:e.cacheEnabled,layersID:e.layersID}),e.tileProxy&&(this.tileProxy=e.tileProxy),this.options=e,this._url=e.url,this.tileSetsIndex=-1,this.tempIndex=-1,this.dpi=this.options.dpi||96;var t=this,r=O.urlPathAppend(e.url,"tileImage."+e.format);function i(){var g=this,v={};return v.redirect=e.redirect!==void 0?e.redirect:!1,v.transparent=e.transparent!==void 0?e.transparent:!0,v.cacheEnabled=e.cacheEnabled!==!1,g.cacheEnabled=v.cacheEnabled,v._cache=v.cacheEnabled,this.origin&&(v.origin=JSON.stringify({x:this.origin[0],y:this.origin[1]})),e.prjCoordSys&&(v.prjCoordSys=JSON.stringify(e.prjCoordSys)),e.layersID&&(v.layersID=e.layersID.toString()),e.clipRegion instanceof mr.default&&(e.clipRegionEnabled=!0,e.clipRegion=Ce.toSuperMapGeometry(new Kt.default().writeGeometryObject(e.clipRegion)),e.clipRegion=O.toJSON(Be.fromGeometry(e.clipRegion)),v.clipRegionEnabled=e.clipRegionEnabled,v.clipRegion=JSON.stringify(e.clipRegion)),e.overlapDisplayed?v.overlapDisplayed=!0:(v.overlapDisplayed=!1,e.overlapDisplayedOptions&&(v.overlapDisplayedOptions=g.overlapDisplayedOptions.toString())),v.cacheEnabled&&e.tileversion&&(v.tileversion=e.tileversion.toString()),e.rasterfunction&&(v.rasterfunction=JSON.stringify(e.rasterfunction)),v}function h(){return this._paramsChanged&&(this._layerUrl=c.call(this),this._paramsChanged=!1),this._layerUrl||c.call(this)}function c(){return this.requestParams=this.requestParams||i.call(this),this._layerUrl=O.urlAppend(r,O.getParameterString(this.requestParams)),this._layerUrl=Je.appendCredential(this._layerUrl),this._layerUrl}function p(g,v,y){t.tileGrid||(e.extent?(t.tileGrid=mt.createTileGrid(e.extent),t.resolutions&&(t.tileGrid.resolutions=t.resolutions)):(y.getCode()==="EPSG:3857"&&(t.tileGrid=mt.createTileGrid([-200375083427892e-7,-200375083427892e-7,200375083427892e-7,200375083427892e-7]),t.extent=[-200375083427892e-7,-200375083427892e-7,200375083427892e-7,200375083427892e-7]),y.getCode()==="EPSG:4326"&&(t.tileGrid=mt.createTileGrid([-180,-90,180,90]),t.extent=[-180,-90,180,90]))),t.origin=t.tileGrid.getOrigin(0);var w=g[0],A=g[1],E=["4","5"].indexOf(Ce.getOlVersion())>-1?-g[2]-1:g[2],k=t.tileGrid.getResolution(w),z=t.dpi||96,x=y.getUnits()||Ve.DEGREE;(x==="degrees"||x==="degree")&&(x=Ve.DEGREE),(x==="m"||x==="meter")&&(x=Ve.METER);var N=Ce.resolutionToScale(k,z,x),b=as.toSize(t.tileGrid.getTileSize(w,t.tmpSize)),R=h.call(t),W=R+encodeURI("&x="+A+"&y="+E+"&width="+b[0]+"&height="+b[1]+"&scale="+N);return t.tileProxy&&(W=t.tileProxy+encodeURIComponent(W)),t.cacheEnabled||(W+="&_t="+new Date().getTime()),W}}setTileSetsInfo(e){this.tileSets=e,Ce.isArray(this.tileSets)&&(this.tileSets=e[0]),this.tileSets&&(this.dispatchEvent({type:"tilesetsinfoloaded",value:{tileVersions:this.tileSets.tileVersions}}),this.changeTilesVersion())}lastTilesVersion(){this.tempIndex=this.tileSetsIndex-1,this.changeTilesVersion()}nextTilesVersion(){this.tempIndex=this.tileSetsIndex+1,this.changeTilesVersion()}changeTilesVersion(){var e=this;if(e.tileSets!=null&&!(e.tempIndex===e.tileSetsIndex||this.tempIndex<0)){var t=e.tileSets.tileVersions;if(t&&e.tempIndex<t.length&&e.tempIndex>=0){var r=t[e.tempIndex].name,i=e.mergeTileVersionParam(r);i&&(e.tileSetsIndex=e.tempIndex,e.dispatchEvent({type:"tileversionschanged",value:{tileVersion:t[e.tempIndex]}}))}}}updateCurrentTileSetsIndex(e){this.tempIndex=e}mergeTileVersionParam(e){return e?(this.requestParams.tileversion=e,this._paramsChanged=!0,this.refresh(),!0):!1}static optionsFromMapJSON(e,t){var r={};r.url=e,r.crossOrigin="anonymous";var i=[t.bounds.left,t.bounds.bottom,t.bounds.right,t.bounds.top];const{visibleScales:h,bounds:c,dpi:p,coordUnit:g}=t;var v=Ce.scalesToResolutions(h,c,p,g);return r.tileGrid=new di.default({extent:i,resolutions:v}),r}static createTileGrid(e,t,r,i,h){var c=os.createXYZ({extent:e,maxZoom:t,minZoom:r,tileSize:i});return new di.default({extent:e,minZoom:r,origin:h,resolutions:c.getResolutions(),tileSize:c.getTileSize()})}}class da extends qe{constructor(e){super(),this.source=new mt(e),this.layer=new ol.layer.Tile({source:this.source})}}class fa extends qe{constructor(e){super(),e=e||{},this.source=new ol.source.XYZ(e),this.layer=new ol.layer.Tile({source:this.source})}}class pa{constructor(e){_(this,"style",{markerSize:6,markerColor:"tomato",stroke:"green",strokeWidth:2,fill:"rgba(255,255,255,0.5)"});_(this,"styles",{Point:{image:this._makeImage()},LineString:{stroke:this._makeStroke()},MultiLineString:{stroke:this._makeStroke()},MultiPoint:{image:this._makeImage()},MultiPolygon:{stroke:this._makeStroke(),fill:this._makeFill()},Polygon:{stroke:this._makeStroke(),fill:this._makeFill()},GeometryCollection:{stroke:this._makeStroke(),fill:this._makeFill(),image:this._makeImage()},Circle:{stroke:this._makeStroke(),fill:this._makeFill()}});e=e!=null?e:{},this.url=e.url,this.layerName=e.layerName,this.setStyle(e),this.createLayer(),this.requestFeatures()}_makeStroke(){const{strokeWidth:e,stroke:t}=this.style;return new ol.style.Stroke({width:e,color:t})}_makeFill(){const{fill:e}=this.style;return new ol.style.Fill({color:e})}_makeImage(){const{markerSize:e}=this.style;return new ol.style.Circle({radius:e,fill:this._makeFill(),stroke:this._makeStroke()})}setStyle(e){!e||(e.markerSize&&(this.style.markerSize=e.markerSize),e.markerColor&&(this.style.markerColor=e.markerColor),e.stroke&&(this.style.stroke=e.stroke),e.strokeWidth&&(this.style.strokeWidth=e.strokeWidth),e.fill&&(this.style.fill=e.fill))}createLayer(){this.layer=new ol.layer.Vector({style:e=>new ol.style.Style(this.styles[e.getGeometry().getType()])})}requestFeatures(){let e=this.url;e instanceof Ue||(e=new Ue({url:this.url,queryParameters:{outputFormat:"application/json",request:"GetFeature",service:"WFS",typeName:this.layerName}})),e.fetchJson().then(t=>{console.log("res:",t),this.source=new ol.source.Vector({features:new ol.format.GeoJSON().readFeatures(t)}),this.layer.setSource(this.source)}).catch(t=>{this.fire("error",t)})}}class ga extends qe{constructor(t){var r,i,h,c,p;t=t!=null?t:{};super(t);_(this,"url");_(this,"format","image/jpeg");_(this,"layer");_(this,"style","default");_(this,"tileMatrixSetID");_(this,"tileMatrixLabels");_(this,"tileWidth");_(this,"tileHeight");_(this,"tilingScheme");_(this,"projection");_(this,"minimumLevel",0);_(this,"maximumLevel");this.url=t.url,this.format=t.format,this.layer=t.layer,this.style=t.style,this.tileMatrixSetID=t.tileMatrixSetID,this.tileMatrixLabels=t.tileMatrixLabels,this.tileWidth=(r=t.tileWidth)!=null?r:256,this.tileHeight=(i=t.tileHeight)!=null?i:256,this.tilingScheme=(h=t.tilingScheme)!=null?h:new Si,this.minimumLevel=(c=t.minimumLevel)!=null?c:0,this.maximumLevel=(p=t.maximumLevel)!=null?p:24,this.resolutions=qe.calculateResolutions({projection:this.tilingScheme.projection.getProj(),minimumLevel:this.minimumLevel,maximumLevel:this.maximumLevel}),this.source=new ol.source.WMTS({url:this.url,format:this.format,layer:this.layer,style:this.style,matrixSet:this.tileMatrixSetID,projection:this.tilingScheme.projection.getProj(),tileGrid:new ol.tilegrid.WMTS({tileSize:[this.tileWidth,this.tileHeight],origin:[-180,90],resolutions:this.resolutions,matrixIds:this.tileMatrixLabels})}),this.layer=new ol.layer.Tile({source:this.source})}}class Or{constructor(e){this.init(e)}init(e){var v,y;const{id:t,html:r,position:i,offset:h}=e,c=document.createElement("div");c.className+="tgis-2d-popup-wrapper",typeof r=="string"?c.insertAdjacentHTML("beforeend",`${r}`):r instanceof HTMLElement&&c.appendChild(r);const p=new li.default({element:c,position:i?[(v=i.lng)!=null?v:0,(y=i.lat)!=null?y:0]:void 0,offset:h,autoPan:{animation:{duration:250}}}),g=t||`tgis-2d-popup-${Ye()}`;c.id=g,this.overlay=p}destroy(){this.overlay.destroy()}get position(){const[e,t]=this.overlay.getPosition();return new Te(e,t)}set position(e){const{lng:t,lat:r}=e;this.overlay.setPosition([t,r])}get offset(){return this.overlay.getOffset()}set offset(e){this.overlay.setOffset(e)}}class Bi{constructor(e){_(this,"protocol","http");_(this,"host","10.223.178.107");_(this,"port");_(this,"url");_(this,"apiPath");var t,r,i;this.protocol=(t=e==null?void 0:e.protocol)!=null?t:this.protocol,this.host=(r=e==null?void 0:e.host)!=null?r:this.host,this.port=(i=e==null?void 0:e.port)!=null?i:this.port,this.makeUrl()}makeUrl(){return this.url=`${this.protocol}://${this.host}${this.port?":"+this.port:""}`,this.url}}class He extends Bi{constructor(e){super(e)}queryPOIByRegion(e){const t=`${this.url}/api/t-gis/gw/COMMON/POI/ByRegion`,{geom:r,pageNo:i=1,pageSize:h=10}=e;return new Promise((c,p)=>{fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({geom:r,page:i,limit:h})}).then(g=>g.json()).then(g=>{var A;let{code:v,msg:y,data:w}=g;c({code:v,message:y,data:w?{pageNo:w==null?void 0:w.pageNo,pageSize:w==null?void 0:w.pageSize,total:w==null?void 0:w.total,list:(A=w==null?void 0:w.list)==null?void 0:A.map(E=>({id:E.entityId,name:E.name,typeName:E.nameLarge,typeCode:E.codeLarge,viceTypeName:E.nameMedium,viceTypeCode:E.codeMedium,subTypeName:E.nameSmall,subTypeCode:E.codeSmall,geometry:E.location}))}:null})}).catch(g=>p(g))})}static queryPOIByRegion(e,t){return new He(t).queryPOIByRegion(e)}queryPOITypesByRegion(e){const t=`${this.url}/api/t-gis/gw/COMMON/poiSearch/types`,{geom:r,pageNo:i=1,pageSize:h=10}=e;return new Promise((c,p)=>{fetch(t,{method:"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify({geom:r,page:i,limit:h})}).then(g=>g.json()).then(g=>{let{code:v,msg:y,data:w}=g;c({code:v,message:y,data:w})}).catch(g=>p(g))})}static queryPOITypesByRegion(e,t){return new He(t).queryPOITypesByRegion(e)}queryPOITypesAndNumByRegion(e){const t=`${this.url}/api/t-gis/gw/COMMON/poiSearch/stat`,{geom:r,pageNo:i=1,pageSize:h=10}=e;return new Promise((c,p)=>{fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({geom:r,page:i,limit:h})}).then(g=>g.json()).then(g=>{var A,E,k;let{code:v,msg:y,data:w}=g;c({code:v,message:y,data:w?{list:(E=(A=w==null?void 0:w.quantity)==null?void 0:A.stat)==null?void 0:E.map(z=>({name:z.label,num:z.num})),total:(k=w==null?void 0:w.quantity)==null?void 0:k.sum}:null})}).catch(g=>p(g))})}static queryPOITypesAndNumByRegion(e,t){return new He(t).queryPOITypesAndNumByRegion(e)}queryPOIListByRegion(e){const t=`${this.url}/api/t-gis/gw/COMMON/POI/ByRegion`,{geom:r,pageNo:i=1,pageSize:h=10}=e;return new Promise((c,p)=>{fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({geom:r,page:i,limit:h})}).then(g=>g.json()).then(g=>{var A;let{code:v,msg:y,data:w}=g;c({code:v,message:y,data:w?{pageNo:w==null?void 0:w.pageNo,pageSize:w==null?void 0:w.pageSize,total:w==null?void 0:w.total,list:(A=w==null?void 0:w.list)==null?void 0:A.map(E=>({id:E.entityId,name:E.name,typeName:E.nameLarge,typeCode:E.codeLarge,viceTypeName:E.nameMedium,viceTypeCode:E.codeMedium,subTypeName:E.nameSmall,subTypeCode:E.codeSmall,geometry:E.location}))}:null})}).catch(g=>p(g))})}static queryPOIListByRegion(e,t){return new He(t).queryPOIListByRegion(e)}regeo(e){const{lng:t,lat:r,pageNo:i=1,pageSize:h=10,...c}=e!=null?e:{},p=new URLSearchParams({pageNum:i,pageSize:h,...c}).toString(),g=`${this.url}/api/t-gis/gw/COMMON/query/InvAddrMatch/${t}/${r}?${p}`;return new Promise((v,y)=>{fetch(g).then(w=>w.json()).then(w=>{const{result:A,status:E}=w;v({code:E==="ok"?200:-1,message:E==="ok"?"\u8BF7\u6C42\u6210\u529F":"\u8BF7\u6C42\u5931\u8D25",data:A})}).catch(w=>y(w))})}static regeo(e,t){return new He(t).regeo(e)}geo(e){const{address:t}=e,r=new URLSearchParams({query:encodeURIComponent(t),region:440300,ak:"ebf48ecaa1fd436fa3d40c4600aa051f"}),i=`${this.url}/api/t-gis/gw/COMMON/addrMatch?${r.toString()}`;return new Promise((h,c)=>{fetch(i).then(p=>p.json()).then(p=>{const{status:g,message:v,total:y,result:w}=p;h({code:g===0?200:-1,message:v,data:{list:w==null?void 0:w.map(A=>({id:A.std_addr_id,address:A.address,name:A.name,shortName:A.key_prefix,nickName:A.alias,code:A.adcode,...A.location})),total:y}})}).catch(p=>c(p))})}static geo(e,t){return new He(t).geo(e)}search(e){const{address:t,pageNo:r=1,pageSize:i=10}=e,h=new URLSearchParams({keyword:t,pageNum:r,pageSize:i}),c=`${this.url}/api/t-gis/gw/COMMON/search/prev?${h.toString()}`;return new Promise((p,g)=>{fetch(c).then(v=>v.json()).then(v=>{const{code:y,msg:w,data:A}=v;p({code:y,message:w,data:A==null?void 0:A.map(E=>({id:E.entityId,name:E.name,address:E.address,typeName:E.type,geometry:E.geo}))})}).catch(v=>g(v))})}static search(e,t){return new He(t).search(e)}}class Ot extends Bi{constructor(e){var t;super({...e}),this.apiPath=(t=e==null?void 0:e.apiPath)!=null?t:"/api/t-gis/tdta"}geo(e){const t=new URLSearchParams;t.append("ds",`{"keyWord":"${e==null?void 0:e.address}"}`),t.append("tk",e==null?void 0:e.tk);const r=this.url+this.apiPath+`/geocoder?${t.toString()}`;return new Promise((i,h)=>{fetch(r).then(c=>c.json()).then(c=>{const{location:{keyWord:p,level:g,lon:v,lat:y}}=c;i({address:p,typeName:g,lng:v,lat:y})}).catch(c=>h(c))})}regeo(e){const t=new URLSearchParams;t.append("postStr",`{'lon':${e==null?void 0:e.lng},'lat':${e==null?void 0:e.lat},'ver':1}`),t.append("type","geocode"),t.append("tk",e==null?void 0:e.tk);const r=this.url+this.apiPath+`/geocoder?${t.toString()}`;return new Promise((i,h)=>{fetch(r).then(c=>c.json()).then(c=>{const{formatted_address:p,addressComponent:{address:g,address_distince:v,address_position:y,nation:w,province:A,city:E,county:k,road:z,poi:x}}=c.result;i({fullAddress:p,address:g,distince:v,direction:y,country:w,province:A,city:E,district:k,street:z,name:x})}).catch(c=>h(c))})}static geo(e,t){return new Ot(t).geo(e)}static regeo(e,t){return new Ot(t).regeo(e)}}const va=Object.freeze(Object.defineProperty({__proto__:null,TGisService:He,TianDiService:Ot},Symbol.toStringTag,{value:"Module"}));function q(){this._entities=new Er(this),this._camera=new br(this)}q.prototype._addLayer=function(n){return this.map.addLayer(n)},q.prototype._removeLayer=function(n){return this.map.removeLayer(n)},q.prototype._getLayerById=function(n){return this.map.getLayers().getArray().find(e=>e.get("id")===n)},q.prototype._removeLayerById=function(n){const e=this._getLayerById(n),t=Se(e);return t&&this._removeLayer(e),t},q.prototype.updateSize=function(){this.map.updateSize()},Object.defineProperties(q.prototype,{entities:{get(){return this._entities}},camera:{get(){return this._camera}}}),q.prototype.createMap=function(n){var p;n.render==null&&(n.render=!1,n.renderbeg=null,n.rndrender=null),this.id=n.id,this.legends=[],this.MorepopupList=[];const e=(p=ol.control.defaults.defaults)!=null?p:ol.control.defaults;var t=new ol.Map({target:n.id,layers:[...n.layers||[]],view:new ol.View({center:n.center,zoom:n.zoom,projection:"EPSG:4326",extent:[-180,-90,180,90],minZoom:1,maxZoom:22}),controls:e(n.controls)});this.map=t,this.popup=null,this.x_PI=52.35987755982988,this.PI=3.141592653589793,this.a=6378245,this.ee=.006693421622965943;var r=new ol.control.MousePosition({coordinateFormat:new ol.coordinate.createStringXY(2),projection:"EPSG:4326",target:document.getElementById("coordinate")});t.addControl(r),t.on("pointermove",function(g){var v=t.getEventPixel(g.originalEvent),y=t.hasFeatureAtPixel(v);t.getTargetElement().style.cursor=y?"pointer":""});var i=this;if(this.changzooms=function(){try{var g=t.getLayers();g.forEach(b=>{var R=b,W=R.getSource();if(W&&W.getFeatures){var ee=W.getFeatures();if(ee.length>0)for(var Y=0;Y<ee.length;Y++){var j=ee[Y],re=j.getStyle();if(re&&re instanceof ol.style.Style){var le=re.getImage();le instanceof ol.style.Icon}}}})}catch(b){console.log(b)}if(i.noclusterLayers.length>0)for(var v=0;v<i.noclusterLayers.length;v++){var y=i.noclusterLayers[v],w=y.getSource(),A=w.getFeatures(),E=1;if(A.length>0){var k=A[0],z=k.get("option");z.clusterstyle&&z.clusterstyle.cancelzoom&&(E=z.clusterstyle.cancelzoom)}var x=i.getCurrentZoomLevel();if(x<=E){y.set("cancelcluster",!1);var N=y.get("clustersource");y.setSource(N),i.noclusterLayers.splice(v,1),v--}}},t.getView().on("change:resolution",this.changzooms),n.render){if(n.renderbeg!=null)var h=t.on("precompose",function(g){n.renderbeg(),t.un(h.type,h.listener)});if(n.renderbeg!=null)var c=t.on("postrender",function(g){n.rndrender(),t.un(c.type,c.listener)})}this.wmtsobj={},this.noclusterLayers=[],this.legendCollection={},this.event_map={},ya(t)};function ya(n){let e=[];n.on("pointermove",t=>{n.hasFeatureAtPixel(t.pixel)?n.forEachFeatureAtPixel(t.pixel,r=>{e.findIndex(i=>i.get("id")===r.get("id"))<0&&(e.push(r),r.dispatchEvent({type:"mouseover",event:t}))}):e.length>0&&(e.forEach(r=>r.dispatchEvent({type:"mouseout",event:t})),e=[])}),n.on("click",t=>{n.hasFeatureAtPixel(t.pixel)&&n.forEachFeatureAtPixel(t.pixel,r=>{r&&r.dispatchEvent({type:"click",event:t})})})}q.prototype.setViewport=function(n){const e=this.map.getView(),t=ol.extent.boundingExtent(n);e.fit(t,this.map.getSize())},q.prototype.singleclick=function(){var n;return this.map.on("singleclick",function(e){console.log(e.coordinate),n=e.coordinate}),n},q.prototype.setMapCenter=function(n){this.map.getView().animate({center:n.center,zoom:9,duration:1e3})},q.prototype.gpsPositioning=function(n){this.map.getView().animate({center:n.center,zoom:15,duration:1e3})},q.prototype.addLayer2=function(n){var e;if(n.url.indexOf("iserver")!=-1)if(n.type=="WMTS"||n.type=="wmts"){for(var t=new Array(17),r=new Array(17),i=0;i<17;++i)t[i]=156543.033928041/Math.pow(2,i),r[i]=i;e=new ol.source.WMTS({url:n.url,layer:n.layer,matrixSet:n.matrixSet,format:n.format,tileGrid:new ol.tilegrid.WMTS({origin:[-20037508342787e-6,20037508342787e-6],extent:[-20037508342787e-6,-20037508342787e-6,20037508342787e-6,20037508342787e-6],tileSize:[256,256],origin:[-180,90],resolutions:t,matrixIds:r}),style:"default"})}else n.type=="WFS"||n.type=="wfs";else{var h=["EPSG:4490:0","EPSG:4490:1","EPSG:4490:2","EPSG:4490:3","EPSG:4490:4","EPSG:4490:5","EPSG:4490:6","EPSG:4490:7","EPSG:4490:8","EPSG:4490:9","EPSG:4490:10"],t=[.001373291015625,.0006866455078125,.0003433227539063,.0001716613769531,858306884766e-16,429153442383e-16,214576721191e-16,107288360596e-16,53644180298e-16,26822090149e-16,13411045074e-16];if(n.projection!=null)var c=new ol.proj.Projection(n.projection);if(n.type=="WMTS"||n.type=="wmts")e=new ol.source.WMTS({url:n.url,layer:n.layer,matrixSet:n.projection.code,format:n.format,projection:c,tileGrid:new ol.tilegrid.WMTS({tileSize:[256,256],origin:[-180,90],resolutions:t,matrixIds:h}),style:"",wrapX:!0,tileLoadFunction:function(y,w){var A=new XMLHttpRequest;A.responseType="blob",A.addEventListener("loadend",function(E){var k=this.response;k!==void 0?y.getImage().src=URL.createObjectURL(k):y.setState(ol.TileState.ERROR)}),A.addEventListener("error",function(){y.setState(ol.TileState.ERROR)}),A.open("get",w),A.setRequestHeader("szvsud-license-key","CVz440zV4BE7fCSznRZvnE6J/SCKlMDbCjGBRD9XtmwvQE2h+NK4qJI/0feODJfIrU/Cb6BQ2ZgMhkzEJUARAQ=="),A.send()}});else if(n.type=="WFS"||n.type=="wfs"){var p={service:"WFS",version:"1.0.0",request:"GetFeature",typeName:n.typename,outputFormat:"application/json"};return new Promise((y,w)=>{$.ajax({url:n.url,data:$.param(p),type:"GET",beforeSend:function(A){A.setRequestHeader("szvsud-license-key","CVz440zV4BE7fCSznRZvnE6J/SCKlMDbCjGBRD9XtmwvQE2h+NK4qJI/0feODJfIrU/Cb6BQ2ZgMhkzEJUARAQ==")},dataType:"json",success:function(A){y(A)},error:function(A){y(A)}})})}else(n.type=="MapServer"||n.type=="mapserver")&&(e=new ol.source.TileArcGISRest({url:n.url,layer:n.layer,projection:c,tileGrid:new ol.tilegrid.TileGrid({tileSize:[256,256],origin:[-180,90],resolutions:t}),wrapX:!0,tileLoadFunction:function(y,w){var A=new XMLHttpRequest;A.responseType="blob",A.addEventListener("loadend",function(E){var k=this.response;k!==void 0?y.getImage().src=URL.createObjectURL(k):y.setState(ol.TileState.ERROR)}),A.addEventListener("error",function(){y.setState(ol.TileState.ERROR)}),A.open("get",w),A.setRequestHeader("szvsud-license-key","CVz440zV4BE7fCSznRZvnE6J/SCKlMDbCjGBRD9XtmwvQE2h+NK4qJI/0feODJfIrU/Cb6BQ2ZgMhkzEJUARAQ=="),A.send()}}))}var g=new ol.layer.Tile({name:n.layer==null?n.name:n.layer,source:e});if(this.map!=null){this.map.addLayer(g);let v=new ol.View({projection:c,center:n.center,zoom:n.zoom});this.map.setView(v),this.map.on("precompose",function(y){y.context}.bind(this))}else console.log("======\u5730\u56FE\u672A\u521D\u59CB\u5316!======")},q.prototype.setlayerVisible=function(n){this.map.getLayers().getArray().forEach(function(t){if(n.name==t.get("name")){t.setVisible(n.bol);return}})},q.prototype.flyLineGraph=function(n){new MoveLine(this.map,n)},q.prototype.addlineLayer=function(n){for(var e=new Array(17),t=new Array(17),r=0;r<17;++r)e[r]=156543.033928041/Math.pow(2,r),t[r]=r;for(var i=ol.proj.get("EPSG:4326"),h=new Array(18),c=i.getExtent(),p=new Array(17),g=ol.extent.getWidth(c)/256,r=1;r<18;++r)h[r]=g/Math.pow(2,r),p[r]=r;var v=new ol.source.WMTS({url:"http://172.17.203.2:8090/iserver/services/map-TGIS/wmts100",layer:"LINK_MARS",matrixSet:"Custom_LINK_MARS",format:"image/png",tileGrid:new ol.tilegrid.WMTS({origin:[22.837045517368217,113.75014580129057],resolutions:h,matrixIds:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]}),style:"default",projection:i,wrapX:!0}),y=new ol.layer.Tile({source:v});this.map.addLayer(y)},q.prototype.zoomIn=function(){var n=this.map.getView(),e=n.getZoom();n.setZoom(e+1)},q.prototype.zoomOut=function(){var n=this.map.getView(),e=n.getZoom();n.setZoom(e-1)},q.prototype.setZoomLevel=function(n){var e=this.map.getView();n.duration?e.animate({center:n.center,zoom:n.zoom,duration:n.duration*1e3}):(e.setCenter(n.center),e.setZoom(n.zoom))},q.prototype.getCurrentZoomLevel=function(){var n=this.map.getView(),e=n.getZoom();return e},q.prototype.getmapcenter=function(){var n=this.map.getView(),e=n.getCenter();return e},q.prototype.rectification=function(n){let e=JSON.stringify({pointList:n.pointList,speed:n.speed,error:n.error});$.ajax({url:"http://139.9.191.233:8080/api/web/rectificationBatchMatch",type:"post",dataType:"json",timeout:5e6,contentType:"application/json",data:e,success:function(t){if(t.message=="\u8BF7\u6C42\u6210\u529F"){let i=[];for(var r=0;r<t.data.length;r++){const h=[],c=t.data[r].split(",");h.push(parseFloat(c[0]),parseFloat(c[1])),i.push(h)}t.message}},error:function(t){t.message,t.data}})},q.prototype.createdynamicline=function(n){var e=this,t=new ol.style.Style({stroke:new ol.style.Stroke({color:n.color,width:n.width})});const r=new ol.geom.LineString(n.pointList);var i=new ol.Feature({geometry:r,finished:!1});window.setTimeout(function(){i.set("start",new Date().getTime()),h.addFeature(i)},1500);var h=new ol.source.Vector({wrapX:!1}),c=new ol.layer.Vector({className:n.layername,source:h,style:function(w){return w.get("finished")?t:null}});this.map.addLayer(c);var p=.1;let g=w=>{let A=w.vectorContext;w.frameState,A.setStyle(t);let E=h.getFeatures();if(E.length>0){let k=E[0];if(!k.get("finished")){let z=k.getGeometry().getCoordinates();p=p+.1;let x=p;x>=z.length&&k.set("finished",!0);let N=Math.min(x,z.length),b=new ol.geom.LineString(z.slice(0,N));A.drawGeometry(b),e.map.render()}}};this.map.on("postcompose",g);var v=ol.extent.boundingExtent(n.pointList),y=ol.extent.getCenter(v);this.map.getView().animate({center:y,zoom:9,duration:1e3})},q.prototype.removedynamicline=function(n){let e=this.map.getLayers().getArray();for(var t=0;t<e.length;t++)e[t].get("className")==n.layername&&this.map.removeLayer(e[t])};var wt=null;let ur=[];var xt=null,Nr,St;q.prototype.addPlotting=function(n){let e=this;this.map.removeInteraction(wt),this.map.removeInteraction(Nr),ma(n,e)},q.prototype.addVector=function(){St=new ol.source.Vector({wrapX:!1});let n=new ol.layer.Vector({className:"layer1",source:St});this.map.addLayer(n),ur.push(n)};function ma(n,e){n.layername;const t=n.circleradius||5,r=n.circlercolor||"#ffcc33",i=n.strokecolor||"#ffcc33",h=n.strokewidth||2,c=n.fillcolor||"rgba(255, 255, 255, 0.2)";n.type=="Box"?wt=new ol.interaction.Draw({source:St,type:"Circle",freehand:!1,geometryFunction:ol.interaction.Draw.createBox(),style:new ol.style.Style({image:new ol.style.Circle({radius:t,fill:new ol.style.Fill({color:r})}),stroke:new ol.style.Stroke({color:i,width:h}),fill:new ol.style.Fill({color:c})})}):wt=new ol.interaction.Draw({source:St,type:n.type,style:new ol.style.Style({image:new ol.style.Circle({radius:t,fill:new ol.style.Fill({color:r})}),stroke:new ol.style.Stroke({color:i,width:h}),fill:new ol.style.Fill({color:c})})}),wt!=null&&e.map.addInteraction(wt),Nr=new ol.interaction.Snap({source:St}),e.map.addInteraction(Nr)}q.prototype.closePlotting=function(){this.map.removeInteraction(wt)},q.prototype.removePlotting=function(){for(var n=0;n<ur.length;n++){const e=ur[n];this.map.removeLayer(e)}ur=[]},q.prototype.revampPlotting=function(){xt==null&&(xt=new ol.interaction.Modify({source:St}),this.map.addInteraction(xt))},q.prototype.removerevampPlotting=function(){xt!=null&&(this.map.removeInteraction(xt),xt=null)},q.prototype.selctFeatures=function(){let n;return this.map.getLayers().forEach(function(t){const i=t.getSource().getFeatures();n=new ol.format.GeoJSON().writeFeatures(i)}),n},q.prototype.electronicFenceGetList=function(n){var e=void 0;if(n){let i=function(h){const c=JSON.parse(h);c.code==0?e=c:console.log("\u63A5\u53E3\u5F02\u5E38\uFF1A"+c)};const t="http://192.168.3.136:6060/api/web/electronicfence/getList?current="+n.current+"&size="+n.size,r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==4&&r.status==200&&i(r.responseText)},r.open("post",t,!1),r.send()}return e},q.prototype.electronicFenceSave=function(n){var e=void 0;if(n){let h=function(c){const p=JSON.parse(c);p.code==0?e=p:console.log("\u63A5\u53E3\u5F02\u5E38\uFF1A"+p)};const t="http://192.168.3.136:6060/api/web/electronicfence/save";let r=new FormData;const i=new XMLHttpRequest;r.append("createBy",n.createBy),r.append("id",n.id),r.append("ip",n.ip),r.append("name",n.name),r.append("vector",n.vector),i.onreadystatechange=function(){i.readyState==4&&i.status==200&&h(i.responseText)},i.open("post",t,!1),i.send(r)}return e;var e},q.prototype.electronicFenceUpdate=function(n){var e=void 0;if(n){let h=function(c){const p=JSON.parse(c);p.code==0?e=p:console.log("\u63A5\u53E3\u5F02\u5E38\uFF1A"+p)};const t="http://192.168.3.136:6060/api/web/electronicfence/update";let r=new FormData;const i=new XMLHttpRequest;r.append("createBy",n.createBy),r.append("id",n.id),r.append("ip",n.ip),r.append("name",n.name),r.append("vector",n.vector),i.onreadystatechange=function(){i.readyState==4&&i.status==200&&h(i.responseText)},i.open("post",t,!1),i.withCredentials=!0,i.send(r)}return e},q.prototype.electronicFenceDeleteId=function(n){var e=void 0;if(n){let i=function(h){const c=JSON.parse(h);c.code==0?e=c:console.log("\u63A5\u53E3\u5F02\u5E38\uFF1A"+c)};const t="http://192.168.3.136:6060/api/web/electronicfence/delete?ids="+n,r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==4&&r.status==200&&i(r.responseText)},r.open("post",t,!1),r.send()}return e},q.prototype.addMarker=function(n){var e=this,t=new ol.Feature({type:"icon",geometry:new ol.geom.Point(n.lnglat),id:n.id,name:n.id,delimitval:n.delimitval});n.pixelOffset&&n.pixelOffset.length&&(n.pixelOffset=n.pixelOffset.map(w=>w*-1));var r;if(n.image==null)r={image:new ol.style.Circle({radius:n.radius,fill:new ol.style.Fill({color:n.color})})};else{var i={src:n.image,scale:n.scale*e.getCurrentZoomLevel()/22,anchor:n.pixelOffset,anchorXUnits:"pixels",anchorYUnits:"pixels"};r={image:new ol.style.Icon(i)},i.newscale=n.scale,t.set("iconstyle",i)}var h=new ol.style.Style(r);t.setStyle(h);var c=turf.multiPoint([n.lnglat]),p=void 0;if(n.bufferobj&&c&&n.bufferobj.bufferradius){var g={bufferradius:n.bufferobj.bufferradius,geometry:c,fillcolor:n.bufferobj.fillcolor,fillalpha:n.bufferobj.fillalpha,linecolor:n.bufferobj.linecolor,linewidth:n.bufferobj.linewidth,id:n.id,zIndex:n.zIndex-1};p=this.bufferpolygon(g)}var v=[];p&&v.push(p),v.push(t);var y=new ol.layer.Vector({id:n.id,source:new ol.source.Vector({id:n.id,name:n.id,features:v}),zIndex:n.zIndex});return y.set("customTags",{type:"marker"}),this.map.addLayer(y),y},q.prototype.removeMarker=function(n){if(n instanceof ol.layer.Vector)return this.map.removeLayer(n);this.map.getLayers().getArray().forEach(t=>{const r=t.get("id"),i=t.get("customTags");r===n.id&&i&&i.type==="marker"&&this.map.removeLayer(t)})},q.prototype.getLayerById=function(n){return this.map.getLayers().getArray().find(e=>e.get("id")===n)},q.prototype.removeLayer=function(n){return this.map.removeLayer(n)},q.prototype.removeLayerById=function(n){const e=this.getLayerById(n),t=Se(e);return t&&this.removeLayer(e),t},q.prototype.addbatchMarkers=function(n){for(var e=n.markers,t=[],r=0;r<e.length;r++){var i=e[r].name,h=e[r].position,c=e[r].image,p=e[r].scale,g=e[r].radius||2,v=e[r].color||"#FF0000";if(e[r].clusterstyle){if(e[r].clusterstyle.cluster){var y={position:e[r].position,layerGroupid:n.layerGroupid,zIndex:n.zIndex,name:e[r].name,image:e[r].image,scale:e[r].scale,clusterstyle:e[r].clusterstyle};return this.legendCollection[n.layerGroupid]=n,this.addclusterMarker(y)}return}for(var w=0;w<h.length;w++){var A=h[w].id,E=h[w].bufferobj,k=new ol.Feature({id:A,type:"Marker",layername:n.layerGroupid,geometry:new ol.geom.Point(h[w].lnglat),delimitval:h[w].delimitval,typename:i}),z;if(c==null)z={image:new ol.style.Circle({radius:g,fill:new ol.style.Fill({color:v})})};else{var x={src:c,scale:p};z={image:new ol.style.Icon(x)},x.newscale=p,k.set("iconstyle",x)}var N=new ol.style.Style(z);k.setStyle(N);var b=turf.multiPoint([h[w].lnglat]);if(E&&b){E.geometry=b,E.id=A;var R=this.bufferpolygon(E);t.push(R)}t.push(k)}}var W=new ol.layer.Vector({id:n.layerGroupid,source:new ol.source.Vector({features:t}),zIndex:n.zIndex||1,renderBuffer:n.renderBuffer||5e3});return this.map.addLayer(W),this.legendCollection[n.layerGroupid]=n,W},q.prototype.updataMark=function(n){for(var e=0;e<n.length;e++){var t=n[e];if(t.id){var r=this.getlayerbyid(t.id);if(r){var i=this.setimagestyle(t);r.setStyle(i),t.zIndex&&r.setZIndex(t.zIndex)}}else if(t.layerGroupid){var h=this.getlayerbyid(t.layerGroupid);if(h){for(var c=t.featureids,p=0;p<c.length;p++)for(var g=c[p],v=g.id,y=this.getfeaturebyid(h,v),w=0;w<y.length;w++){var i=this.setimagestyle(g,y[w]);y[w].setStyle(i)}t.zIndex&&h.setZIndex(t.zIndex)}}}},q.prototype.setimagestyle=function(n,e){var t=n.image,r=n.scale,i=n.radius||2,h=n.color||"#FF0000",c=void 0,p=n.clusterstyle;if(t==null)c={image:new ol.style.Circle({radius:i,fill:new ol.style.Fill({color:h})})};else{var g=r*this.getCurrentZoomLevel()/22;p&&(g=r);var v={src:t,scale:g};c={image:new ol.style.Icon(v)},e&&(v.newscale=r,e.set("iconstyle",v))}var y=new ol.style.Style(c);return y},q.prototype.addclusterMarker=function(n){for(var e=[],t=n.position,r=0;r<t.length;r++){var i=t[r],h=i.id;i.bufferobj;var c=new ol.Feature({id:h,type:"Marker",layername:n.layerGroupid,geometry:new ol.geom.Point(i.lnglat),delimitval:i.delimitval,option:{clusterstyle:n.clusterstyle,image:n.image,layerGroupid:n.layerGroupid,name:n.name,scale:n.scale},typename:i.name}),p=this.setimagestyle(n,c);c.setStyle(p),turf.multiPoint([i.lnglat]),e.push(c)}const g=new ol.source.Vector({features:e}),v=new ol.source.Cluster({distance:parseInt(n.clusterstyle.distance||20),minDistance:parseInt(0),source:g,option:{name:"\u8BD5\u8BD5"}}),y={};var w=this,A=n.clusterstyle.bordercolor||"#FFF",E=A.colorRgb(n.clusterstyle.borderalpha||1),k=n.clusterstyle.fillcolor||"#00CCFF",z=k.colorRgb(n.clusterstyle.fillalpha||1);const x=new ol.layer.Vector({zIndex:n.zIndex||1,id:n.layerGroupid,source:v,cluster:!0,hsource:g,clustersource:v,style:function(N){const b=N.get("features")?N.get("features").length:0;let R=y[b];var W=N.get("features")?N.get("features")[0]:void 0;if(!W)return R;var ee=W.get("option"),Y=w.getCurrentZoomLevel(),j=w.getlayerbyid(ee.layerGroupid),re=j.get("cancelcluster");if(Y>ee.clusterstyle.cancelzoom){if(!re){j.set("cancelcluster",!0);var le=j.get("hsource");j.setSource(le),w.noclusterLayers.push(j)}}else b==1&&!R&&(R=w.setimagestyle(ee),y[b]=R),!R&&b!=1&&(R=new ol.style.Style({image:new ol.style.Circle({radius:ee.clusterstyle.radius||5,stroke:new ol.style.Stroke({color:E,width:ee.clusterstyle.borderwidth||1}),fill:new ol.style.Fill({color:z})}),text:new ol.style.Text({text:b.toString(),fill:new ol.style.Fill({color:ee.clusterstyle.textcolor||"#FFFFFF"}),font:ee.clusterstyle.textfont||""})}),y[b]=R);return R}});return this.map.addLayer(x),x},q.prototype.addhtmlpoint=function(n){for(var e=0;e<n.length;e++){var t=n[e],r=this.createDiv(t),i=new ol.Overlay({id:t.id,position:t.lnglat,positioning:"bottom-center",offset:t.offset,element:r,stopEvent:!1,autoPan:t.autoPan||!0,autoPanAnimation:{duration:250}});this.map.addOverlay(i)}},q.prototype.deletehtmlpointbyid=function(n){var e=this.map.getOverlayById(n);return e?(this.map.removeOverlay(e),!0):!1},q.prototype.addtextmark=function(n){for(var e=n.markers,t=[],r=0;r<e.length;r++){var i=e[r],h=new ol.Feature({geometry:new ol.geom.Point(i.lnglat),id:i.id,type:"text",name:"\u6587\u5B57\u6807\u6CE8",delimitval:i.delimitval,typename:i.name}),c=new ol.style.Stroke;i.textside&&(c=new ol.style.Stroke({color:i.textside.color.colorRgb(i.textside.alpha),width:i.textside.width}));var p=new ol.style.Stroke;i.backgroundside&&(p=new ol.style.Stroke({color:i.backgroundside.color.colorRgb(i.backgroundside.alpha),width:i.backgroundside.width}));var g="#FFFFFF".colorRgb(0);i.background&&(i.background.alpha||(i.background.alpha=0),i.background.color||(i.background.color="#FFFFFF"),g=i.background.color.colorRgb(i.background.alpha));var v=i.offset||[0,0],y=new ol.style.Style({text:new ol.style.Text({textAlign:"center",textBaseline:"middle",font:i.textfont||"",text:i.textname,fill:new ol.style.Fill({color:i.textcolor}),offsetX:v[0],offsetY:v[1],stroke:c,padding:i.padding||[0,0,0,0],scale:i.scale||1,backgroundFill:new ol.style.Fill({color:g}),backgroundStroke:p})});h.setStyle(y),t.push(h)}if(t.length>0){var w=new ol.layer.Vector({id:n.layerGroupid,source:new ol.source.Vector({id:n.layerGroupid,features:t}),zIndex:n.zIndex||1});this.map.addLayer(w),this.legendCollection[i.layerGroupid]=i}},q.prototype.showLayer=function(n,e){for(var t=0;t<n.length;t++){var r=n[t],i=this.getlayerbyid(r.layerGroupid),h=void 0;if(i&&r.featureids){var c=i.get("shadowinfo");if(c){for(var p=0;p<r.featureids.length;p++){var g=r.featureids[p],v=this.getlayerbyid(r.layerGroupid+g);v&&v.setVisible(e)}continue}r.featureids.length>0&&(h=this.getfeaturebyid(i,r.featureids))}if(i&&h)for(var y=0;y<h.length;y++){var w=i.get("cluster");if(!w)if(e){var A=h[y],E=A.get("originalstyle");A.setStyle(E)}else{var A=h[y],E=A.getStyle();A.set("originalstyle",E),A.setStyle(this.settransparentStyle())}}else if(i){var c=i.get("shadowinfo");if(c){this.showpolygonlayer(r.layerGroupid,e);continue}i.setVisible(e)}}var k=Ui(this.map,r);k.forEach(z=>{z.setVisible(e)})},q.prototype.showpolygonlayer=function(n,e){for(var t=this.map.getLayers(),r=0;r<t.getLength();r++){var i=t.item(r),h=i.get("id");h&&h.includes(n)&&i.setVisible(e)}},q.prototype.settransparentStyle=function(){var n=new ol.style.Style({fill:new ol.style.Fill({color:[0,0,0,0]}),stroke:new ol.style.Stroke({color:[0,0,0,0],width:.1}),text:new ol.style.Text({font:"1px Verdana,sans-serif",text:"",fill:new ol.style.Fill({color:[0,0,0,0]}),backgroundFill:new ol.style.Fill({color:[0,0,0,0]}),backgroundStroke:new ol.style.Stroke({color:[0,0,0,0],width:.1})})});return n},q.prototype.deletelayerFeature=function(n){for(var e=0;e<n.length;e++){var t=n[e],r=this.getlayerbyid(t.layerGroupid),i=void 0,h=void 0;if(r&&t.featureids){var c=r.get("shadowinfo");if(c){for(var p=0;p<t.featureids.length;p++){var g=t.featureids[p],v=this.getlayerbyid(t.layerGroupid+g);v&&(v.getSource().clear(),this.map.removeLayer(v))}continue}t.featureids.length>0&&(i=this.getfeaturebyid(r,t.featureids))}if(r&&i)for(var y=0;y<i.length;y++){var w=r.get("cluster"),h=r.get("source");if(w){var A=r.getSource();if(A){var E=A.getSource();E.removeFeature(i[y])}}else h.removeFeature(i[y])}else if(r){var c=r.get("shadowinfo");if(c){this.deltepolygonlayerbyid(t.layerGroupid);continue}r.getSource().clear(),this.map.removeLayer(r)}}},q.prototype.deltepolygonlayerbyid=function(n){var e=this.getlayerbyid(n);e&&(e.getSource().clear(),this.map.removeLayer(e),this.deltepolygonlayerbyid(n))},q.prototype.getlayerbyid=function(n){var e=void 0;if(n)for(var t=this.map.getLayers(),r=0;r<t.getLength();r++){var i=t.item(r),h=i.get("id");h&&h.includes(n)&&(e=i)}return e},q.prototype.getfeaturebyid=function(n,e){var t=n.get("cluster"),r=n.get("source"),i=n.get("id"),h=r.getFeatures(),c=[];if(t){if(e.length>0)for(var p=0;p<h.length;p++){var g=h[p],v=g.values_;if(v){var y=v.features;if(y)for(var w=0;w<y.length;w++)for(var A=y[w],E=A.get("id"),k=A.get("type"),z=0;z<e.length;z++){var x=e[z];x==E&&c.push(A),x+"bu!ffer"==E&&c.push(A),k=="polygon"&&E.includes(i)&&E.includes(x)&&c.push(A),!E&&g.option&&g.option.nameid==x&&c.push(A)}}}}else if(e.length>0)for(var p=0;p<h.length;p++)for(var g=h[p],E=g.get("id"),k=g.get("type"),z=0;z<e.length;z++){var x=e[z];x==E&&c.push(g),x+"bu!ffer"==E&&c.push(g),k=="polygon"&&E.includes(i)&&E.includes(x)&&c.push(g),!E&&g.option&&g.option.nameid==x&&c.push(g)}return c},String.prototype.colorRgb=function(n){var e=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,t=this.toLowerCase();if(t&&e.test(t)){if(t.length===4){for(var r="#",i=1;i<4;i+=1)r+=t.slice(i,i+1).concat(t.slice(i,i+1));t=r}for(var h=[],i=1;i<7;i+=2)h.push(parseInt("0x"+t.slice(i,i+2)));return h.push(n),h}else return t},q.prototype.removeTextmark=function(n){var e=this.getlayerbyid(n.id);e&&this.map.removeLayer(e)},q.prototype.deletetextmark=function(n){var e=this.map.getOverlayById(n);return e?(this.map.removeOverlay(e),!0):!1},q.prototype.createDiv=function(n){var e=document.createElement("div");return e.className=n.divclass,e.innerHTML=n.divHTMLinfo,e.setAttribute("id",n.id),e},q.prototype.updateLayerzindex=function(n){for(var e=0;e<n.length;e++){var t=n[e];if(t.layerGroupid){var r=this.getlayerbyid(t.layerGroupid);r?r.setZIndex(t.zIndex):console.log("\u65E0\u8BE5\u56FE\u5C42")}}},q.prototype.searchAdress=function(n){(!n.r||n.r==" ")&&(n.r=500),n.x&&n.y&&n.type&&n.url&&new Promise(function(e,t){const r=""+n.url+"/"+n.x+"/"+n.y+"?r="+n.r+"&type="+n.type,i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState==4&&i.status==200&&h(i.responseText)},i.open("GET",r,!0),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("szvsud-license-key","CVz440zV4BE7fCSznRZvnE6J/SCKlMDbCjGBRD9XtmwvQE2h+NK4qJI/0feODJfIrU/Cb6BQ2ZgMhkzEJUARAQ=="),i.withCredentials=!0,i.send();function h(c){const p=JSON.parse(c);if(p.status==="ok"){console.log("\u5730\u5740\u641C\u7D22\u7ED3\u679C\uFF1A"+c);for(let g of p.result)g.setStyle(new ol.style.Style({fill:new ol.style.Fill({color:"yellow"}),text:new ol.style.Text({font:"13px Microsoft YaHei",text:g.full_name,fill:new ol.style.Fill({color:"#666"})})}))}}})},q.prototype.trackLigature=function(n,e){for(var t=n.lines,r=[],i=0;i<t.length;i++)for(var h=t[i],c=h.lnglats,p=0;p<c.length;p++){var g=c[p],v=g.id,y=g.linelnglat;if(g.startcurve){var w=turf.lineString(y),A=turf.bezierSpline(w);y=A.geometry.coordinates}var E=new ol.Feature({id:v,type:"line",name:g.name,layername:n.layerGroupid,geometry:new ol.geom.LineString(y),delimitval:g.delimitval,typename:g.name,parentsname:h.name});E.setStyle(new ol.style.Style({stroke:new ol.style.Stroke({color:h.color,width:h.width||2})})),r.push(E);var k=turf.multiLineString([y]),z=void 0;if(g.bufferobj&&k&&g.bufferobj.bufferradius){var x={bufferradius:g.bufferobj.bufferradius,geometry:k,fillcolor:g.bufferobj.fillcolor,fillalpha:g.bufferobj.fillalpha,linecolor:g.bufferobj.linecolor,linewidth:g.bufferobj.linewidth,id:v};z=this.bufferpolygon(x)}z&&r.push(z)}var N=new ol.source.Vector({features:r}),b=new ol.layer.Vector({id:n.layerGroupid,source:N,zIndex:n.zIndex||1});this.map.addLayer(b),this.legendCollection[n.layerGroupid]=n},q.prototype.addlines=function(n,e){for(var t=n.lines,r=[],i=0;i<t.length;i++)for(var h=t[i],c=h.lnglats,p=0;p<c.length;p++){var g=c[p],v=g.id,y=g.linelnglat;if(g.startcurve){var w=turf.lineString(y),A=turf.bezierSpline(w);y=A.geometry.coordinates}var E=new ol.Feature({id:v,type:"line",name:g.name,layername:n.layerGroupid,geometry:new ol.geom.LineString(y),delimitval:g.delimitval,typename:g.name,parentsname:h.name});if(E.setStyle(new ol.style.Style({stroke:new ol.style.Stroke({color:h.color,width:h.width||2})})),g.Linedot!=null){var w=turf.lineString(y),k=turf.length(w,{units:"meters"});const Y=k*(g.Linedot/100),j=new ol.format.GeoJSON;for(let re=0;re<k;re++){var z=turf.along(w,re,{units:"meters",id:v});const le=j.readFeature(z);le.option={nameid:v},r.push(le),re+=Y}}r.push(E);var x=turf.multiLineString([y]),N=void 0;if(g.bufferobj&&x&&g.bufferobj.bufferradius){var b={bufferradius:g.bufferobj.bufferradius,geometry:x,fillcolor:g.bufferobj.fillcolor,fillalpha:g.bufferobj.fillalpha,linecolor:g.bufferobj.linecolor,linewidth:g.bufferobj.linewidth,id:v};N=this.bufferpolygon(b)}N&&r.push(N)}var R=new ol.source.Vector({features:r}),W=new ol.layer.Vector({id:n.layerGroupid,source:R,zIndex:n.zIndex||1});return this.map.addLayer(W),this.legendCollection[n.layerGroupid]=n,W},q.prototype.updataline=function(n){var e=this.getlayerbyid(n.layerGroupid);if(e){n.zIndex&&e.setZIndex(n.zIndex);for(var t=n.lines,r=0;r<t.length;r++)for(var i=t[r],h=this.getfeaturebyid(e,i.id),c=0;c<h.length;c++){var p=h[c],g=p.option,v=p.get("type");!g&&v=="line"&&p.setStyle(new ol.style.Style({stroke:new ol.style.Stroke({color:i.color,width:i.width})}))}}},q.prototype.addpolygon=function(n){for(var e=n.polygons,t=0;t<e.length;t++){var r=e[t],i=n.layerGroupid+r.id,h=new ol.Feature({id:r.id,type:"polygon",name:r.name,layername:n.layerGroupid,geometry:new ol.geom.Polygon([r.lnglats]),delimitval:r.delimitval,typename:r.name});h.setStyle(new ol.style.Style({fill:new ol.style.Fill({color:r.fillcolor.colorRgb(r.fillalpha||1)}),stroke:new ol.style.Stroke({color:r.color,width:r.width})}));var c=[];r.lnglats.push(r.lnglats[0]);var p=turf.polygon([r.lnglats]),g=void 0;if(r.bufferobj&&p&&r.bufferobj.bufferradius){var v={bufferradius:r.bufferobj.bufferradius,geometry:p,fillcolor:r.bufferobj.fillcolor,fillalpha:r.bufferobj.fillalpha,linecolor:r.bufferobj.linecolor,linewidth:r.bufferobj.linewidth,id:i};g=this.bufferpolygon(v)}g&&c.push(g),c.push(h);var y=new ol.source.Vector({features:c}),w=new ol.layer.Vector({id:i,name:r.name,color:r.color,type:"polygon",source:y,shadowinfo:r.shadowinfo||!0,zIndex:n.zIndex,fillcolor:r.fillcolor});r.shadowinfo&&(w.on("precompose",A=>{if(A.target.values_.shadowinfo){var E=A.target.values_.shadowinfo;A.context.shadowBlur=E.blur,A.context.shadowColor=E.color,A.context.shadowOffsetX=E.offset[0],A.context.shadowOffsetY=E.offset[1]}}),w.on("postcompose",A=>{A.context.shadowBlur=0,A.context.shadowColor="black"})),this.map.addLayer(w)}this.legendCollection[n.layerGroupid]=n},q.prototype.updatapolygon=function(n){for(var e=n.layerGroupid==null?"":n.layerGroupid,t=n.updatestyle,r=0;r<t.length;r++){var i=Ui(this.map,[e+t[r].id]);if(i&&i.length!=0){n.zIndex&&i[0].setZIndex(n.zIndex);var h=i[0].getSource();if(h instanceof ol.source.Vector){var c=h.getFeatures();c[0].setStyle(new ol.style.Style({fill:new ol.style.Fill({color:t[r].fillcolor.colorRgb(t[r].fillalpha||1)}),stroke:new ol.style.Stroke({color:t[r].color,width:t[r].width})}));var p=i[0];t[r].shadowinfo&&(p.values_.shadowinfo&&t[r].shadowinfo&&(p.on("precompose",g=>{if(g.target.values_.shadowinfo){var v=g.target.values_.shadowinfo;g.context.shadowBlur=v.blur,g.context.shadowColor=v.color,g.context.shadowOffsetX=v.offset[0],g.context.shadowOffsetY=v.offset[1]}}),p.on("postcompose",g=>{g.context.shadowBlur=0,g.context.shadowColor="black"})),p.values_.shadowinfo=t[r].shadowinfo)}}}},q.prototype.bufferpolygon=function(n){var e=void 0;!n.linecolor||n.linecolor==""?e="#FFFFFF".colorRgb(0):e=n.linecolor.colorRgb(n.linealpha||1);var t=n.geometry,r={fill:new ol.style.Fill({color:n.fillcolor.colorRgb(n.fillalpha||1)}),stroke:new ol.style.Stroke({color:e,width:n.linewidth||0}),zIndex:-1},i=n.bufferradius/1e3,h=turf.buffer(t,i,{units:"kilometers"}),c=new ol.format.GeoJSON,p=c.readFeature(h),g=new ol.style.Style(r);return p.setStyle(g),p.set("id",n.id+"bu!ffer"),p},q.prototype.topologyanalyze=function(n){if(n.polygons){var e=n.polygons[0],t=n.polygons[n.polygons.length-1];e[0]==t[0]&&e[1]==t[1]||n.polygons.push(e)}if(n.polygons1){var e=n.polygons1[0],t=n.polygons1[n.polygons1.length-1];e[0]==t[0]&&e[1]==t[1]||n.polygons1.push(e)}var r=[],i="";for(let W in n)i+=W;var h=void 0,c=void 0,p=!1,g=!1,v=!1,y=!1,w=!1;if(i.includes("points")&&i.includes("lines"))v=!0,h=turf.point(n.points),c=turf.lineString(n.lines);else if(i.includes("points")&&i.includes("polygons"))g=!0,h=turf.point(n.points),c=turf.polygon([n.polygons]);else if(i.includes("lines")&&i.includes("polygons"))y=!0,h=turf.lineString(n.lines),c=turf.polygon([n.polygons]);else if(i.includes("points")&&i.includes("points1"))p=!0,w=!0,h=turf.point(n.points),c=turf.point(n.points);else if(i.includes("lines")&&i.includes("lines1"))p=!0,h=turf.lineString(n.lines),c=turf.lineString(n.lines1);else if(i.includes("polygons")&&i.includes("polygons1")){p=!0;let W=new ol.geom.Polygon([n.polygons]),ee=new ol.geom.Polygon([n.polygons1]),Y=n.polygons.some(re=>ee.containsXY(re[0],re[1])),j=n.polygons1.some(re=>W.containsXY(re[0],re[1]));var A=[["\u76F8\u79BB","polygons\u5305\u542Bpolygons1"],["polygons1\u5305\u542Bpolygons","\u76F8\u4EA4"]][+Y][+j];return A}if(h&&c){if(p&&!w){var E=turf.booleanOverlap(c,h);E&&r.push("\u91CD\u53E0")}var k=turf.booleanContains(c,h);k&&r.push("\u5305\u542B");var z=turf.booleanIntersects(c,h);if(z){var x=!0,N=r.includes("\u5305\u542B");g&&(x=!1),y&&N&&(x=!1),x&&r.push("\u76F8\u4EA4")}var b=turf.booleanDisjoint(c,h);if(b&&r.push("\u76F8\u79BB"),v){var R=turf.booleanPointOnLine(h,c);R&&r.push("\u70B9\u5728\u7EBF\u4E0A")}}return r.join()},q.prototype.registerpopup=function(n){this.popup=null,this.popup=new ol.Overlay({element:n.element,autoPan:n.autoPan,positioning:"bottom-center",stopEvent:!1,autoPanAnimation:{duration:250}}),this.map.addOverlay(this.popup),this.popup==null&&console.log("\u6CE8\u518C\u5F39\u7A97\u4E8B\u4EF6\u5931\u8D25!")},q.prototype.addpopup=function(n){if(this.popup!=null){wa(n),this.popup.setPosition(void 0),this.popup.getPosition()==null&&(this.popup.setPosition(n.lnglat),this.popup.setOffset(n.offset||[0,0]));var e=document.getElementById("popup-closer"),t=this.popup,r=this;e.onclick=function(){return t.setPosition(void 0),e.blur(),r.repopup=!0,!1}}else console.log("\u672A\u6CE8\u518C\u5F39\u7A97\u4E8B\u4EF6!")},q.prototype.registerMorepopup=function(n){var e=document.getElementById(n.mapid),t=document.createElement("div");t.className=n.className,t.id=n.popupid,t.style.display="none",t.innerHTML=n.popupHTML,e.appendChild(t),t.style.display="initial";var r=document.getElementById(n.popupid),i=new ol.Overlay({id:"overlay"+n.popupid,element:r,offset:n.offset,autoPan:n.autoPan,positioning:"bottom-center",stopEvent:!1,autoPanAnimation:{duration:250}});i.setPosition(n.lnglat),this.map.addOverlay(i)},q.prototype.addPopup=function(n){const{id:e,html:t,position:r,offset:i}=n,h=document.createElement("div");h.className+="tgis-2d-popup-wrap",typeof t=="string"?h.insertAdjacentHTML("beforeend",`${t}`):t instanceof HTMLElement&&h.appendChild(t);const c=new ol.Overlay({element:h,position:r,offset:i,autoPan:{animation:{duration:250}}}),p=e||`tgis-2d-popup-${ol.getUid(popup)}`;return h.id=p,this.map.addOverlay(c),c},q.prototype.deletepopupbyid=function(n){var e=this.map.getOverlayById("overlay"+n);return e?(this.map.removeOverlay(e),this.repopup=!0,!0):!1},q.prototype.addEvtClick=function(n,e){var t=this.map,r=this;if(n==="mouseover"){const i=function(c){let p=t.getEventPixel(c),g=t.getFeaturesAtPixel(p),v=t.getCoordinateFromPixel(p);e({handler:{type:n,listener:i},data:g&&g.length?g[g.length-1].getProperties():void 0,coordinate:v})};t.getTargetElement().addEventListener("mouseover",i,!1)}else{let i=t.on(n,function(h){if(t.hasFeatureAtPixel(h.pixel)){var c=t.getFeaturesAtPixel(h.pixel);if(c)if(r.repopup)setTimeout(function(){r.repopup=!1},100);else{var p=c[0]?c[0].getProperties():void 0,g=p&&p.features!=null?p.features[p.features.length-1].getProperties():p;e({handler:i,data:g,coordinate:g.geometry.flatCoordinates})}}})}console.log("\u4E8B\u4EF6\u6CE8\u518C\u6210\u529F!")},q.prototype.removeEvtClick=function(n){!n||(n.type==="mouseover"?this.map.getTargetElement().removeEventListener(n.type,n.listener,!1):this.map.un(n.type,n.listener),console.log("\u4E8B\u4EF6\u79FB\u9664\u6210\u529F!"))},q.prototype.addzoomEvent=function(n){this.removezoomEvent();var e=this.map.getView(),t=this;this.zoomchange=e.on("change",function(){var r=e.getZoom();t.nowzoom!=r&&(t.nowzoom=r,n(t.nowzoom))})},q.prototype.removezoomEvent=function(n){if(this.zoomchange){var e=this.map.getView();e.un(this.zoomchange.type,this.zoomchange.listener)}},q.prototype.CreateHeatmap=function(n){var e=void 0;n.gradient&&n.gradient.length>0&&(e=n.gradient);let t=new ol.layer.Heatmap({id:n.id,source:new ol.source.Vector({wrapX:!1}),blur:parseInt(n.blur,10),radius:parseInt(n.radius,10),zIndex:999,gradient:e});for(var r=n.data,i=n.max,h=[],c=0;c<r.length;c++){var p=[parseFloat(r[c].lng),parseFloat(r[c].lat)],g=new ol.Feature({geometry:new ol.geom.Point(p),weight:parseFloat(r[c].count)/parseFloat(i),typename:p.name||""});h.push(g)}t.getSource().addFeatures(h),t.getSource().on("addfeature",function(v){var y=v.feature.get("name"),w=parseFloat(y.substr(2));v.feature.set("weight",w-5)}),this.map.addLayer(t)},q.prototype.searchPon=function(n){n.address&&n.pageNum&&n.pageSize&&n.url&&new Promise(function(e,t){const r="http://10.223.178.107/api/t-gis/gw/COMMON/addrMatch",i=new XMLHttpRequest,h={address:n.address||"",pageNum:n.pageNum||1,pageSize:n.pageSize||10};i.onreadystatechange=function(){i.readyState==4&&i.status==200&&c(i.responseText)},i.open("POST",r,!0),i.setRequestHeader("szvsud-license-key","CVz440zV4BE7fCSznRZvnE6J/SCKlMDbCjGBRD9XtmwvQE2h+NK4qJI/0feODJfIrU/Cb6BQ2ZgMhkzEJUARAQ=="),i.setRequestHeader("Content-Type","application/json"),i.withCredentials=!0,i.send(JSON.stringify(h)),i.send();function c(p){const g=JSON.parse(p);g.scuuess&&g.code==200?console.log("\u70B9\u4F4D\u641C\u7D22\u7ED3\u679C\uFF1A"+p):console.log("\u70B9\u4F4D\u641C\u7D22\u63A5\u53E3\u5F02\u5E38\uFF1A"+p)}})},q.prototype.removeHeatmap=function(n){var e=this.getlayerbyid(n.id);e&&this.map.removeLayer(e)},q.prototype.addControl=function(n){return this.map.addControl(n)},q.prototype.querywfsTosupermap=function(n){var e="",t=void 0;if(n.idVague&&(n.literalval="*"+n.literalval+"*"),n.url.includes("iserver")?t=`<wfs:GetFeature xmlns:wfs="http://www.opengis.net/wfs" service="WFS" version="1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"><wfs:Query typeName="${n.typeName}" xmlns:World="http://www.supermap.com/World"><ogc:Filter xmlns:ogc="http://www.opengis.net/ogc"> <ogc:PropertyIsLike  wildCard="*" singleChar="#" escapeChar="!" xmlns:ogc="http://www.opengis.net/ogc"> <ogc:PropertyName>${n.Fieldname}</ogc:PropertyName><ogc:Literal>${n.literalval}</ogc:Literal></ogc:PropertyIsLike></ogc:Filter></wfs:Query></wfs:GetFeature>`:e="\u975EIserver\u53D1\u5E03\u670D\u52A1",t){let r=function(i){var h=new ol.format.GML2,c=h.readFeatures(i);if(c.length>0)e=new ol.format.GeoJSON().writeFeaturesObject(c);else{var p=$(i).find("ServiceExceptionReport"),g=$(p).text();e=g}};$.ajax({url:n.url,type:"POST",data:t,async:!1,success:r,error:function(i){i.status==0?console.log("\u62A5\u9519\u539F\u56E0\uFF1A"+i.statusText):console.log(i.status+"\uFF1B\u62A5\u9519\u539F\u56E0\uFF1A"+i.responseText)}})}return e},q.prototype.geojsonGeometry=function(n){var e=n.geojsonobj;const t=new ol.source.Vector({id:n.id,name:n.name,features:new ol.format.GeoJSON().readFeatures(e)}),r=this.setgeometrystyle(n,e),i=new ol.layer.Vector({id:n.id,source:t,zIndex:n.zIndex||1,style:r});return this.map.addLayer(i),i},q.prototype.setgeometrystyle=function(n,e){var t=new ol.format.GeoJSON().readFeatures(e),r=t[0].getGeometry().getType(),i=void 0,h=void 0;if(n.image==null)h={image:new ol.style.Circle({radius:n.radius||2,fill:new ol.style.Fill({color:n.color})})};else{var c={offset:n.offset||[0,0],src:n.image,scale:n.scale};h={image:new ol.style.Icon(c)}}switch(r){case"MultiPoint":i=new ol.style.Style(h);break;case"MultiLineString":i=new ol.style.Style({stroke:new ol.style.Stroke({color:n.color,width:n.width||2})});break;case"Polygon":i=new ol.style.Style({fill:new ol.style.Fill({color:n.fillcolor.colorRgb(n.fillalpha||1)}),stroke:new ol.style.Stroke({color:n.color,width:n.width})});break;case"GeometryCollection":i=new ol.style.Style({stroke:new ol.style.Stroke({color:n.color,width:n.width||2}),fill:new ol.style.Fill({color:n.fillcolor.colorRgb(n.fillalpha||1)}),image:new ol.style.Circle({radius:n.radius||2,fill:null,stroke:new Stroke({color:n.linecolor||"magenta"})})});break;case"Circle":i=new ol.style.Style({stroke:new ol.style.Stroke({color:n.color,width:n.width||2}),fill:new ol.style.Fill({color:n.fillcolor.colorRgb(n.fillalpha||1)})});break}return i};var hr={};function zi(n){for(var e in n){var t=n[e];e!="geometry"&&e!="source"&&(t instanceof Object?hr=zi(t):hr[e]=t)}return hr}q.prototype.getpolygonbyid=function(n){for(var e=[],t=this.map.getLayers(),r=0;r<t.getLength();r++){var i=t.item(r),h=i.get("id");h&&h.includes(n)&&e.push(i)}return e},q.prototype.getobjLayersbyid=function(n){var e={},t=this.getlayerbyid(n);if(t){var r=t.getSource();if(r){var i=void 0,h=t.get("type");h=="polygon"?i=this.getpolygonbyid(n,this):i=r.getFeatures();for(var c=0;c<i.length;c++){var p=i[c],g=p.get("type"),v=p.values_;hr={};var y=zi(v);switch(g){case"Marker":var z=p.getStyle(),w=void 0,A=void 0,E=z.getImage();if(E.iconImage_)A=E.getSrc();else{var k=E.getFill();w=k.getColor()}e[y.typename]={imgurl:A,name:y.typename,Fcolor:w,type:y.type};break;case"text":break;case"line":var z=p.getStyle(),x=z.getStroke(),N=x.getColor();e[y.parentsname]={name:y.parentsname,Fcolor:N,type:y.type};break;case"polygon":e[y.name]={name:y.name,Fcolor:y.fillcolor,type:y.type};break}}}}return e},q.prototype.createlegend=function(n){var e;n.location!=null?e=$("<div id='legend"+n.layerGroupid+"' style='bottom: "+(n.location.top+1)+"%;left: "+(n.location.Left+1)+"%;'>"):e=$("<div id='legend"+n.layerGroupid+"' style='bottom:1%;left: 1%;'>"),e.attr("class","info legend");var t=this.getobjLayersbyid(n.layerGroupid),r="width: 20px;float: left;margin-right: 8px;opacity: 0.7;",i=[];for(var h in t)t[h].type=="Marker"?t[h].imgurl?(newlegendi=r+"height: 20px;background-image: url("+t[h].imgurl+");background-size: 100% 100%;background-repeat: no-repeat;",i.push('<div><i style="'+newlegendi+'"></i><samp>'+t[h].name+"</samp></div>")):(newlegendi=r+"height: 20px;background:"+t[h].Fcolor+";border-radius:15px",i.push('<div><i style="'+newlegendi+'"></i><samp>'+t[h].name+"</samp></div>")):t[h].type=="line"?(newlegendi=r+"height: 5px;background:"+t[h].Fcolor+";margin-top: 5px;",i.push('<div><i style="'+newlegendi+'"></i><samp>'+t[h].name+"</samp></div>")):t[h].type=="polygon"&&(newlegendi=r+"height:18px;background:"+t[h].Fcolor+";",i.push('<div><i style="'+newlegendi+'"></i><samp>'+t[h].name+"</samp></div>"));e.append(i),$("body").append(e),this.legends.push("legend"+n.layerGroupid)},q.prototype.removelegend=function(n){if(this.legends.length>0){for(var e="",t=0;t<this.legends.length;t++)this.legends[t].search(n)!=-1&&(e=this.legends[t]);e!=""?$("#"+e).remove():console.log("\u4E0D\u5B58\u5728\u6B64\u56FE\u4F8B!")}},q.prototype.dataconversionbytype=function(n){if(n.wktdata){var e=new ol.format.WKT,t=e.readFeature(n.wktdata),r=this.createConvertor(n.contype),i=r.writeFeatureObject(t);return i.option=n.option,i}},q.prototype.createConvertor=function(n){var e=null;switch(n){case"GML":e=new ol.format.GML;break;case"KML":e=new ol.format.KML;break;case"GEOJSON":e=new ol.format.GeoJSON;break}return e},q.prototype.destroy=function(n){if(this.map!=null){var e=document.getElementById(n);e.innerHTML="",this.map=null}},q.prototype.bd09togcj02=function(n){var e=Number(n[0]),t=Number(n[1]),r=this.x_PI,i=e-.0065,h=t-.006,c=Math.sqrt(i*i+h*h)-2e-5*Math.sin(h*r),p=Math.atan2(h,i)-3e-6*Math.cos(i*r),g=c*Math.cos(p),v=c*Math.sin(p);return[g,v]},q.prototype.gcj02tobd09=function(n){var e=Number(n[0]),t=Number(n[1]),r=Math.sqrt(e*e+t*t)+2e-5*Math.sin(t*this.x_PI),i=Math.atan2(t,e)+3e-6*Math.cos(e*this.x_PI),h=r*Math.cos(i)+.0065,c=r*Math.sin(i)+.006;return[h,c]},q.prototype.wgs84togcj02=function(n){var e=Number(n[0]),t=Number(n[1]);if(this.out_of_china(e,t))return[e,t];var r=this.transformlat(e-105,t-35),i=this.transformlng(e-105,t-35),h=t/180*this.PI,c=Math.sin(h);c=1-this.ee*c*c;var p=Math.sqrt(c);r=r*180/(this.a*(1-this.ee)/(c*p)*this.PI),i=i*180/(this.a/p*Math.cos(h)*this.PI);var g=t+r,v=e+i;return[v,g]},q.prototype.gcj02towgs84=function(n){var e=Number(n[0]),t=Number(n[1]);if(this.out_of_china(e,t))return[e,t];var r=this.transformlat(e-105,t-35),i=this.transformlng(e-105,t-35),h=t/180*this.PI,c=Math.sin(h);c=1-this.ee*c*c;var p=Math.sqrt(c);r=r*180/(this.a*(1-this.ee)/(c*p)*this.PI),i=i*180/(this.a/p*Math.cos(h)*this.PI);var g=t+r,v=e+i;return[e*2-v,t*2-g]},q.prototype.bd02towgs84=function(n){var e=this.bd09togcj02(n),t=this.gcj02towgs84(e);return t},q.prototype.wgs84tobd02=function(n){var e=this.wgs84togcj02(n),t=this.gcj02tobd09(e);return t},q.prototype.ETocoordinate=function(n){var e=n.type,t=n.lonlats,r=new Array;switch(e){case"BTG":for(var i=0;i<t.length;i++){var h=t[i],c=this.bd09togcj02(h);r.push(c)}return r;case"GTB":for(var i=0;i<t.length;i++){var h=t[i],c=this.gcj02tobd09(h);r.push(c)}return r;case"WTG":for(var i=0;i<t.length;i++){var h=t[i],c=this.wgs84togcj02(h);r.push(c)}return r;case"GTW":for(var i=0;i<t.length;i++){var h=t[i],c=this.gcj02towgs84(h);r.push(c)}return r;case"BTW":for(var i=0;i<t.length;i++){var h=t[i],c=this.bd02towgs84(h);r.push(c)}return r;case"WTB":for(var i=0;i<t.length;i++){var h=t[i],c=this.wgs84tobd02(h);r.push(c)}return r;case"WTC":for(var p="",i=0;i<t.length;i++){var h=t[i];p+=h[0]+",",i==t.length-1?p+=h[1].toString():p+=h[1]+":"}return p!=""&&$.ajax({type:"POST",url:"http://192.168.3.184:8080/api/web/getxy",data:"str="+p,async:!1,success:function(g){for(var v=0;v<g.length;v++){var y=g[v],w=y.split(","),A=[];A.push(Number(Number(w[0]).toFixed(6))),A.push(Number(Number(w[1]).toFixed(6))),r.push(A)}},error:function(g){console.log("\u9519\u8BEF\u63D0\u793A\uFF1A"+g.status)}}),r;case"CTW":for(var p="",i=0;i<t.length;i++){var h=t[i];p+=h[0]+",",i==t.length-1?p+=h[1].toString():p+=h[1]+":"}return p!=""&&$.ajax({type:"POST",url:"http://192.168.3.184:8080/api/web/wgstocgs",data:"cm=114&str="+p,async:!1,success:function(g){for(var v=0;v<g.length;v++){var y=g[v],w=y.split(","),A=[];A.push(Number(Number(w[0]).toFixed(6))),A.push(Number(Number(w[1]).toFixed(6))),r.push(A)}},error:function(g){console.log("\u9519\u8BEF\u63D0\u793A\uFF1A"+g.status)}}),r;default:return t}},q.prototype.transformlat=function(n,e){var t=-100+2*n+3*e+.2*e*e+.1*n*e+.2*Math.sqrt(Math.abs(n));return t+=(20*Math.sin(6*n*this.PI)+20*Math.sin(2*n*this.PI))*2/3,t+=(20*Math.sin(e*this.PI)+40*Math.sin(e/3*this.PI))*2/3,t+=(160*Math.sin(e/12*this.PI)+320*Math.sin(e*this.PI/30))*2/3,t},q.prototype.transformlng=function(n,e){var t=300+n+2*e+.1*n*n+.1*n*e+.1*Math.sqrt(Math.abs(n));return t+=(20*Math.sin(6*n*this.PI)+20*Math.sin(2*n*this.PI))*2/3,t+=(20*Math.sin(n*this.PI)+40*Math.sin(n/3*this.PI))*2/3,t+=(150*Math.sin(n/12*this.PI)+300*Math.sin(n/30*this.PI))*2/3,t},q.prototype.out_of_china=function(n,e){return n<72.004||n>137.8347||e<.8293||e>55.8271||!1};function Ui(n,e){for(var t=n.getLayers(),r=new Array,i=0;i<t.getLength();i++){var h=t.item(i),c=h.get("id");if(c)for(var p=0;p<e.length;p++)c.includes(e[p])&&r.push(h)}return r}function wa(n){var e=n.container;e.innerHTML="";var t=document.createElement("div");t.className=n.className,t.innerHTML=n.content,e.appendChild(t)}q.Mapv=window.mapv||{},q.prototype.createMapvIns=function(n,e){const{map:t}=this,{Mapv:r}=q;return new r.OpenlayersLayer(t,n,e||{draw:"simple"})},q.prototype.createMapvLayer=function(n,e){const{Mapv:t}=q,r=new t.DataSet(n);return this.createMapvIns(r,e)};class xa{constructor(){this.dataSources=new $t,this.layer=new hi.default}add(e){this.dataSources.add(e)}setMap(e){return this.map=e,this}}class Sa{constructor(e,t){_(this,"_map");_(this,"_view");_(this,"_entities");_(this,"_camera");_(this,"imageryLayers");_(this,"dataSources");_(this,"_addLayer",function(e){return this.map.addLayer(e)});_(this,"_removeLayer",function(e){return this.map.removeLayer(e)});_(this,"_getLayerById",function(e){return this.map.getLayers().getArray().find(t=>t.get("id")===e)});_(this,"_removeLayerById",function(e){const t=this._getLayerById(e),r=Map2D.defined(t);return r&&this._removeLayer(t),r});_(this,"_addOverlay",function(e){return this.map.addOverlay(e)});_(this,"_removeOverlay",function(e){return this.map.removeOverlay(e)});var c,p,g;const{imageryProvider:r,mapCenter:i,mapProjection:h}=t||{};if(e instanceof ct.default)this._map=e,this._view=e.getView();else{const v=(c=It.defaults.defaults)!=null?c:It.defaults,y=(p=t==null?void 0:t.controls)!=null?p:[],w=h?h.epsg:"EPSG:4326",A=i!=null?i:[104.912777,34.730746];this._map=new ct.default({target:e,controls:v({zoom:Se(y.find(E=>E instanceof It.Zoom)),rotate:Se(y.find(E=>E instanceof It.Rotate)),attribution:Se(y.find(E=>E instanceof It.Attribution))}).extend(y)}),this._view=new ls.default({center:A,zoom:(g=A[2])!=null?g:11,projection:w})}this._map.setView(this._view),this._entities=new Er(this),this._camera=new br(this),this.imageryLayers=new Pr().setMap(this._map),this.dataSources=new xa().setMap(this._map),Se(r)&&(r instanceof qe?this.imageryLayers.addImageryProvider(r):this._map.addLayer(r)),this.addVectorEventListener(this._map)}addVectorEventListener(e){let t=[];e.on("pointermove",r=>{e.hasFeatureAtPixel(r.pixel)?e.forEachFeatureAtPixel(r.pixel,i=>{t.findIndex(h=>h.get("id")===i.get("id"))<0&&(t.push(i),i.dispatchEvent({type:"mouseover",event:r}))}):t.length>0&&(t.forEach(i=>i.dispatchEvent({type:"mouseout",event:r})),t=[])}),e.on("click",r=>{e.hasFeatureAtPixel(r.pixel)&&e.forEachFeatureAtPixel(r.pixel,i=>{i&&i.dispatchEvent({type:"click",event:r})})})}get map(){return this._map}get canvas(){return this._map.getTargetElement().querySelectorAll(".ol-layer canvas")}get entities(){return this._entities}get camera(){return this._camera}get scene(){return this._cesiumWidget.scene}flyTo(e,t){this.camera.flyTo({destination:new Te(e.position[0],e.position[1]),duration:1e3})}addPopup(e){let t=e;return e instanceof Or||(t=new Or(t)),this._addOverlay(t.overlay),t}removePopup(e){e.destroy(),this._removeOverlay(e.overlay)}}class Dr extends us.default{constructor(t){const r=document.createElement("div"),{target:i}=t||{};super({element:r,target:i});_(this,"element");_(this,"style");this.element=r}get map(){return this.getMap()}get view(){return this.map.getView()}createStyle(t){const{id:r,text:i}=t;let h=document.getElementById(r);h||(h=document.createElement("style"),h.setAttribute("id",r),h.textContent=i,document.head.appendChild(h))}createElement(t,r={},i){const h=document.createElement(t);return Object.keys(r).forEach(c=>h[c]=r[c]),i&&i.appendChild(h),h}}const Ct="data:image/png;base64,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";class Ca extends Dr{constructor(t){super(t);_(this,"style",{id:"translate-control-style",text:`.translate-control{position:absolute;left:8px;top:8px;width:52px;height:52px;background:url(${Ct}) 0 -140px no-repeat}.translate-left-btn,.translate-right-btn,.translate-bottom-btn,.translate-top-btn{position:absolute;cursor:pointer;background:url(${Ct}) no-repeat}.translate-left-btn,.translate-right-btn{width:12px;height:18px;top:17px}.translate-left-btn{left:8px}.translate-left-btn:hover{background-position:-52px -110px}.translate-right-btn{left:32px}.translate-right-btn:hover{background-position:-61px -110px}.translate-bottom-btn,.translate-top-btn{width:18px;height:12px;left:17px}.translate-top-btn{top:8px}.translate-top-btn:hover{background-position:-70px -112px}.translate-bottom-btn{top:31px}.translate-bottom-btn:hover{background-position:-84px -110px}`});const{element:r}=this;r.className="translate-control ol-unselectable map-control",this.createElement("div",{className:"translate-left-btn",onclick:()=>this.translate(-1,0)},r),this.createElement("div",{className:"translate-right-btn",onclick:()=>this.translate(1,0)},r),this.createElement("div",{className:"translate-bottom-btn",onclick:()=>this.translate(0,1)},r),this.createElement("div",{className:"translate-top-btn",onclick:()=>this.translate(0,-1)},r),this.createStyle(this.style)}translate(t,r){const{map:i,view:h}=this,c=h.getCenter(),p=i.getPixelFromCoordinate(c),g=p[0]+t*400,v=p[1]+r*400;h.animate({center:i.getCoordinateFromPixel([g,v]),duration:1e3,zoom:h.getZoom()})}}const qi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAECAYAAAB7oZQmAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAABVSURBVBiV3c2xDYNAEADBORBIxDThcv6LoCW38d+NqyBGAlnnzHIFBJ58tYERM5bW2l5K8av3rta64sCZmW+IiG/n+dpNwRxMwZWcyfZYcQxu8D+TD8P0FRFl40xpAAAAAElFTkSuQmCC";class Ea extends Dr{constructor(t){super(t);_(this,"style",{id:"zoom-slider-control-style",text:`.zoom-slider-control{position:absolute;left:22px;top:60px}.zoom-slider-inc_btn{width:24px;height:21px;background:url(${Ct}) no-repeat;background-position:0 -217px;cursor:pointer}.zoom-slider-inc_btn:hover{background-position:0 -194px}.zoom-slider-progress{width:12px;height:147px;position:relative;left:6px;background-position:0 0;background:url(${qi});cursor:pointer}.zoom-slider-progress:hover .zoom-slider-labels{display:block}.zoom-slider-labels{display:none;width:20px;height:100%;position:absolute}.zoom-slider-label-street,.zoom-slider-label-city,.zoom-slider-label-province,.zoom-slider-label-country{width:39px;height:31px;position:absolute;left:20px;background:url(${Ct}) no-repeat}.zoom-slider-label-street{top:0;background-position:-87px -140px}.zoom-slider-label-city{top:54px;background-position:-87px -171px}.zoom-slider-label-province{top:92px;background-position:-87px -203px}.zoom-slider-label-country{top:129px;background-position:-87px -235px}.zoom-slider-cursor{position:absolute;width:24px;height:20px;top:0;left:-6px;background:url(${Ct}) no-repeat;background-position:-127px -164px;cursor:pointer;z-index:10}.zoom-slider-cursor:hover{background-position:-127px -141px}.zoom-slider-mask{width:12px;height:0;position:absolute;background-position:-14px 0!important;background:url(${qi});cursor:pointer}.zoom-slider-dec_btn{width:24px;height:21px;background:url(${Ct}) no-repeat;background-position:-26px -224px;cursor:pointer}.zoom-slider-dec_btn:hover{background-position:-26px -195px}`});_(this,"calculateZoomAndHeight",(t,r)=>{let i=t-r.top;i<=0&&(i=0),i+10>=r.height&&(i=r.height);const h=(r.height-i)/(r.height/15);return{height:i,zoom:h}});_(this,"calculateHeightByZoom",(t,r)=>{t=parseInt(t),t<=1&&(t=1),t>=22&&(t=22);let i=r.height-r.height/15*t;return i<=0&&(i=0),i});const{element:r}=this;r.className="zoom-slider-control ol-unselectable map-control",this.createElement("div",{className:"zoom-slider-inc_btn",onmousedown:()=>{const E=c.getBoundingClientRect();p(E.top-10)}},r);const i=this.createElement("div",{className:"zoom-slider-progress",onmousedown:E=>p(E.clientY)},r),h=this.createElement("div",{className:"zoom-slider-mask"},i),c=this.createElement("div",{className:"zoom-slider-cursor"},i);this.createElement("div",{className:"zoom-slider-dec_btn",onmousedown:()=>{const E=c.getBoundingClientRect();p(E.top+10)}},r);const p=E=>{const k=i.getBoundingClientRect(),{zoom:z,height:x}=this.calculateZoomAndHeight(E,k);c.style.top=`${x===k.height?x-10:x}px`,h.style.height=`${x}px`,this.zoom(z)},g=E=>{E.stopPropagation(),E.preventDefault(),p(E.target.getBoundingClientRect().top+8)},v=this.createElement("div",{className:"zoom-slider-labels"},i);this.createElement("div",{className:"zoom-slider-label-street",onmousedown:g},v),this.createElement("div",{className:"zoom-slider-label-city",onmousedown:g},v),this.createElement("div",{className:"zoom-slider-label-province",onmousedown:g},v),this.createElement("div",{className:"zoom-slider-label-country",onmousedown:g},v);const y=()=>{const E=this.view.getZoom(),k=this.calculateHeightByZoom(E,i.getBoundingClientRect());c.style.top=`${k&&k+10}px`,h.style.height=`${k+10}px`};let w=!1,A=0;document.body.addEventListener("click",E=>E.target===c&&(w=!0)),document.body.addEventListener("mousemove",E=>w&&p(E.clientY)),document.body.addEventListener("mouseup",()=>w=!1),document.body.addEventListener("wheel",()=>{const E=parseInt(this.view.getZoom());E!==A&&(y(),A=E)}),setTimeout(()=>{(()=>{A=this.view.getZoom(),y()})()}),this.createStyle(this.style)}zoom(t){this.view.animate({zoom:t})}}class ba extends hs.default{constructor(e){super(e)}}class Pa extends cs.default{constructor(e){super(e)}}var we={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(n){return n.target||n.srcElement},isSingleTouch:function(n){return n.touches&&n.touches.length===1},isMultiTouch:function(n){return n.touches&&n.touches.length>1},isLeftClick:function(n){return n.which&&n.which===1||n.button&&n.button===1},isRightClick:function(n){return n.which&&n.which===3||n.button&&n.button===2},stop:function(n,e){e||(n.preventDefault?n.preventDefault():n.returnValue=!1),n.stopPropagation?n.stopPropagation():n.cancelBubble=!0},findElement:function(n,e){for(var t=we.element(n);t.parentNode&&(!t.tagName||t.tagName.toUpperCase()!=e.toUpperCase());)t=t.parentNode;return t},observe:function(n,e,t,r){var i=O.getElement(n);if(r=r||!1,e==="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.attachEvent)&&(e="keydown"),this.observers||(this.observers={}),!i._eventCacheID){var h="eventCacheID_";i.id&&(h=i.id+"_"+h),i._eventCacheID=O.createUniqueID(h)}var c=i._eventCacheID;this.observers[c]||(this.observers[c]=[]),this.observers[c].push({element:i,name:e,observer:t,useCapture:r}),i.addEventListener?e==="mousewheel"?i.addEventListener(e,t,{useCapture:r,passive:!1}):i.addEventListener(e,t,r):i.attachEvent&&i.attachEvent("on"+e,t)},stopObservingElement:function(n){var e=O.getElement(n),t=e._eventCacheID;this._removeElementObservers(we.observers[t])},_removeElementObservers:function(n){if(n)for(var e=n.length-1;e>=0;e--){var t=n[e],r=new Array(t.element,t.name,t.observer,t.useCapture);we.stopObserving.apply(this,r)}},stopObserving:function(n,e,t,r){r=r||!1;var i=O.getElement(n),h=i._eventCacheID;e==="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.detachEvent)&&(e="keydown");var c=!1,p=we.observers[h];if(p)for(var g=0;!c&&g<p.length;){var v=p[g];if(v.name===e&&v.observer===t&&v.useCapture===r){p.splice(g,1),p.length==0&&delete we.observers[h],c=!0;break}g++}return c&&(i.removeEventListener?i.removeEventListener(e,t,r):i&&i.detachEvent&&i.detachEvent("on"+e,t)),c},unloadCache:function(){if(we&&we.observers){for(var n in we.observers){var e=we.observers[n];we._removeElementObservers.apply(this,[e])}we.observers=!1}},CLASS_NAME:"SuperMap.Event"};we.observe(window,"resize",we.unloadCache,!1);class Nt{constructor(e,t,r,i,h){if(this.BROWSER_EVENTS=["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown","MSPointerDown","MSPointerUp","pointerdown","pointerup","MSGestureStart","MSGestureChange","MSGestureEnd","contextmenu"],this.listeners={},this.object=e,this.element=null,this.eventTypes=[],this.eventHandler=null,this.fallThrough=i,this.includeXY=!1,this.extensions={},this.extensionCount={},this.clearMouseListener=null,O.extend(this,h),r!=null)for(var c=0,p=r.length;c<p;c++)this.addEventType(r[c]);t!=null&&this.attachToElement(t),this.CLASS_NAME="SuperMap.Events"}destroy(){for(var e in this.extensions)typeof this.extensions[e]!="boolean"&&this.extensions[e].destroy();this.extensions=null,this.element&&(we.stopObservingElement(this.element),this.element.hasScrollEvent&&we.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.eventTypes=null,this.fallThrough=null,this.eventHandler=null}addEventType(e){this.listeners[e]||(this.eventTypes.push(e),this.listeners[e]=[])}attachToElement(e){this.element?we.stopObservingElement(this.element):(this.eventHandler=ir.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=ir.bind(this.clearMouseCache,this)),this.element=e;for(var t=0,r=this.BROWSER_EVENTS.length;t<r;t++){var i=this.BROWSER_EVENTS[t];this.addEventType(i),we.observe(e,i,this.eventHandler)}we.observe(e,"dragstart",we.stop)}on(e){for(var t in e)t!=="scope"&&e.hasOwnProperty(t)&&this.register(t,e.scope,e[t])}register(e,t,r,i){if(e in Nt&&!this.extensions[e]&&(this.extensions[e]=new Nt[e](this)),r!=null&&O.indexOf(this.eventTypes,e)!==-1){t==null&&(t=this.object);var h=this.listeners[e];h||(h=[],this.listeners[e]=h,this.extensionCount[e]=0);var c={obj:t,func:r};i?(h.splice(this.extensionCount[e],0,c),typeof i=="object"&&i.extension&&this.extensionCount[e]++):h.push(c)}}registerPriority(e,t,r){this.register(e,t,r,!0)}un(e){for(var t in e)t!=="scope"&&e.hasOwnProperty(t)&&this.unregister(t,e.scope,e[t])}unregister(e,t,r){t==null&&(t=this.object);var i=this.listeners[e];if(i!=null){for(var h=0,c=i.length;h<c;h++)if(i[h].obj===t&&i[h].func===r){i.splice(h,1);break}}}remove(e){this.listeners[e]!=null&&(this.listeners[e]=[])}triggerEvent(e,t){var r=this.listeners[e];if(!(!r||r.length==0)){t==null&&(t={}),t.object=this.object,t.element=this.element,t.type||(t.type=e),r=r.slice();for(var i,h=0,c=r.length;h<c;h++){var p=r[h];if(i=p.func.apply(p.obj,[t]),i!=null&&i===!1)break}return this.fallThrough||we.stop(t,!0),i}}handleBrowserEvent(e){var t=e.type,r=this.listeners[t];if(!(!r||r.length==0)){var i=e.touches;if(i&&i[0]){for(var h=0,c=0,p=i.length,g,v=0;v<p;++v)g=i[v],h+=g.clientX,c+=g.clientY;e.clientX=h/p,e.clientY=c/p}this.includeXY&&(e.xy=this.getMousePosition(e)),this.triggerEvent(t,e)}}clearMouseCache(){this.element.scrolls=null,this.element.lefttop=null;var e=document.body;e&&!((e.scrollTop!=0||e.scrollLeft!=0)&&navigator.userAgent.match(/iPhone/i))&&(this.element.offsets=null)}getMousePosition(e){if(this.includeXY?this.element.hasScrollEvent||(we.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache(),!this.element.scrolls){var t=O.getViewportElement();this.element.scrolls=[t.scrollLeft,t.scrollTop]}return this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=O.pagePosition(this.element)),new gt(e.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],e.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])}}Nt.prototype.BROWSER_EVENTS=["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown","MSPointerDown","MSPointerUp","pointerdown","pointerup","MSGestureStart","MSGestureChange","MSGestureEnd","contextmenu"];class Et{constructor(e,t){let r=this;this.EVENT_TYPES=["processCompleted","processFailed"],this.events=null,this.eventListeners=null,this.url=null,this.urls=null,this.proxy=null,this.index=null,this.length=null,this.options=null,this.totalTimes=null,this.POLLING_TIMES=3,this._processSuccess=null,this._processFailed=null,this.isInTheSameDomain=null,this.withCredentials=!1,O.isArray(e)?(r.urls=e,r.length=e.length,r.totalTimes=r.length,r.length===1?r.url=e[0]:(r.index=parseInt(Math.random()*r.length),r.url=e[r.index])):(r.totalTimes=1,r.url=e),O.isArray(e)&&!r.isServiceSupportPolling()&&(r.url=e[0],r.totalTimes=1),t=t||{},this.crossOrigin=t.crossOrigin,this.headers=t.headers,O.extend(this,t),r.isInTheSameDomain=O.isInTheSameDomain(r.url),r.events=new Nt(r,null,r.EVENT_TYPES,!0),r.eventListeners instanceof Object&&r.events.on(r.eventListeners),this.CLASS_NAME="SuperMap.CommonServiceBase"}destroy(){let e=this;O.isArray(e.urls)&&(e.urls=null,e.index=null,e.length=null,e.totalTimes=null),e.url=null,e.options=null,e._processSuccess=null,e._processFailed=null,e.isInTheSameDomain=null,e.EVENT_TYPES=null,e.events&&(e.events.destroy(),e.events=null),e.eventListeners&&(e.eventListeners=null)}request(e){let t=this;e.url=e.url||t.url,e.proxy=e.proxy||t.proxy,e.withCredentials=e.withCredentials!=null?e.withCredentials:t.withCredentials,e.crossOrigin=e.crossOrigin!=null?e.crossOrigin:t.crossOrigin,e.headers=e.headers||t.headers,e.isInTheSameDomain=t.isInTheSameDomain,e.withoutFormatSuffix=e.scope.withoutFormatSuffix||!1,e.url=Je.appendCredential(e.url),t.calculatePollingTimes(),t._processSuccess=e.success,t._processFailed=e.failure,e.scope=t,e.success=t.getUrlCompleted,e.failure=t.getUrlFailed,t.options=e,t._commit(t.options)}getUrlCompleted(e){this._processSuccess(e)}getUrlFailed(e){let t=this;t.totalTimes>0?(t.totalTimes--,t.ajaxPolling()):t._processFailed(e)}ajaxPolling(){let e=this,t=e.options.url,r=/^http:\/\/([a-z]{9}|(\d+\.){3}\d+):\d{0,4}/;e.index=parseInt(Math.random()*e.length),e.url=e.urls[e.index],t=t.replace(r,r.exec(e.url)[0]),e.options.url=t,e.options.isInTheSameDomain=O.isInTheSameDomain(t),e._commit(e.options)}calculatePollingTimes(){let e=this;e.times?e.totalTimes>e.POLLING_TIMES?e.times>e.POLLING_TIMES?e.totalTimes=e.POLLING_TIMES:e.totalTimes=e.times:e.times<e.totalTimes&&(e.totalTimes=e.times):e.totalTimes>e.POLLING_TIMES&&(e.totalTimes=e.POLLING_TIMES),e.totalTimes--}isServiceSupportPolling(){let e=this;return!(e.CLASS_NAME==="SuperMap.REST.ThemeService"||e.CLASS_NAME==="SuperMap.REST.EditFeaturesService")}serviceProcessCompleted(e){e=O.transformResult(e),this.events.triggerEvent("processCompleted",{result:e})}serviceProcessFailed(e){e=O.transformResult(e);let t=e.error||e;this.events.triggerEvent("processFailed",{error:t})}_commit(e){if(e.method==="POST"||e.method==="PUT"||e.method==="PATCH")if(e.params&&(e.url=O.urlAppend(e.url,O.getParameterString(e.params||{}))),typeof e.data=="object")try{e.params=O.toJSON(e.data)}catch{console.log("\u4E0D\u662Fjson\u5BF9\u8C61")}else e.params=e.data;nt.commit(e.method,e.url,e.params,{headers:e.headers,withoutFormatSuffix:e.withoutFormatSuffix,withCredentials:e.withCredentials,crossOrigin:e.crossOrigin,timeout:e.async?0:null,proxy:e.proxy}).then(function(t){return t.text?t.text():t.json?t.json():t}).then(function(t){let r=t;return typeof t=="string"&&(r=new Oi().read(t)),(!r||r.error||r.code>=300&&r.code!==304)&&(r&&r.error?r={error:r.error}:r={error:r}),r}).catch(function(t){return{error:t}}).then(t=>{if(t.error){var r=e.scope?ir.bind(e.failure,e.scope):e.failure;r(t)}else{t.succeed=t.succeed==null?!0:t.succeed;var i=e.scope?ir.bind(e.success,e.scope):e.success;i(t)}})}}class Gr{constructor(e){this.dataSourceName=null,this.dataSetName=null,this.features=null,this.editType=sr.ADD,this.IDs=null,this.returnContent=!1,this.isUseBatch=!1,O.extend(this,e),this.CLASS_NAME="SuperMap.EditFeaturesParameters"}destroy(){var e=this;e.dataSourceName=null,e.dataSetName=null,e.features=null,e.editType=null,e.IDs=null,e.returnContent=null}static toJsonParameters(e){var t,r,i,h=e.editType;if(h===sr.DELETE){if(e.IDs===null)return;i={ids:e.IDs}}else if(i=[],e.features){r=e.features.length;for(var c=0;c<r;c++)t=e.features[c],t.geometry=Be.fromGeometry(t.geometry),i.push(t)}return O.toJSON(i)}}class Aa extends Et{constructor(e,t){super(e,t),this.returnContent=!1,this.isUseBatch=!1,t&&O.extend(this,t),this.url=O.urlPathAppend(this.url,"features"),this.CLASS_NAME="SuperMap.EditFeaturesService"}destroy(){super.destroy();var e=this;e.returnContent=null,e.isUseBatch=null,e.fromIndex=null,e.toIndex=null}processAsync(e){if(e instanceof Gr){var t=this,r="POST",i="",h=e.editType,c=null;if(t.returnContent=e.returnContent,t.isUseBatch=e.isUseBatch,c=Gr.toJsonParameters(e),h===sr.DELETE){i=O.toJSON(e.IDs),c=i;var p=O.urlAppend(t.url,O.getParameterString({ids:i}));nt.urlIsLong(p)?(t.url=O.urlAppend(t.url,O.getParameterString({_method:"DELETE"})),r="POST"):(t.url=p,r="DELETE")}else h===sr.UPDATE?r="PUT":(t.isUseBatch&&(t.url=O.urlAppend(t.url,`isUseBatch=${t.isUseBatch}`),t.returnContent=!1),t.returnContent&&(t.url=O.urlAppend(t.url,"returnContent=true"),r="POST"));t.request({method:r,data:c,scope:t,success:t.serviceProcessCompleted,failure:t.serviceProcessFailed})}}}class cr{constructor(e){this.attributeFilter=null,this.name=null,this.joinItems=null,this.linkItems=null,this.ids=null,this.orderBy=null,this.groupBy=null,this.fields=null,e&&O.extend(this,e),this.CLASS_NAME="SuperMap.FilterParameter"}destroy(){var e=this;if(e.attributeFilter=null,e.name=null,e.joinItems){for(let t=0,r=e.joinItems,i=r.length;t<i;t++)r[t].destroy();e.joinItems=null}if(e.linkItems){for(let t=0,r=e.linkItems,i=r.length;t<i;t++)r[t].destroy();e.linkItems=null}e.ids=null,e.orderBy=null,e.groupBy=null,e.fields=null}}class Dt{constructor(e){this.datasetNames=null,this.targetEpsgCode=null,this.targetPrj=null,this.returnContent=!0,this.fromIndex=0,this.toIndex=19,this.returnCountOnly=!1,this.maxFeatures=null,this.hasGeometry=!0,this.aggregations=null,O.extend(this,e),this.CLASS_NAME="SuperMap.GetFeaturesParametersBase"}destroy(){var e=this;e.datasetNames=null,e.returnContent=null,e.fromIndex=null,e.toIndex=null,e.hasGeometry=null,e.maxFeatures=null,e.targetEpsgCode=null,e.targetPrj=null,e.aggregation&&(e.aggregation=null)}}class bt extends Dt{constructor(e){super(e),this.getFeatureMode=bt.getFeatureMode.BOUNDS,this.bounds=null,this.fields=null,this.attributeFilter=null,this.spatialQueryMode=Ri.CONTAIN,O.extend(this,e),this.CLASS_NAME="SuperMap.GetFeaturesByBoundsParameters"}destroy(){super.destroy();var e=this;if(e.bounds&&(e.bounds.destroy(),e.bounds=null),e.fields){for(;e.fields.length>0;)e.fields.pop();e.fields=null}e.attributeFilter=null,e.spatialQueryMode=null,e.getFeatureMode=null}static toJsonParameters(e){var t,r,i;return r={leftBottom:{x:e.bounds.left,y:e.bounds.bottom},rightTop:{x:e.bounds.right,y:e.bounds.top}},i={datasetNames:e.datasetNames,getFeatureMode:bt.getFeatureMode.BOUNDS,bounds:r,spatialQueryMode:e.spatialQueryMode},e.fields&&(t=new cr,t.name=e.datasetNames,t.fields=e.fields,i.queryParameter=t),e.attributeFilter&&(i.attributeFilter=e.attributeFilter,i.getFeatureMode=bt.getFeatureMode.BOUNDS_ATTRIBUTEFILTER),e.maxFeatures&&!isNaN(e.maxFeatures)&&(i.maxFeatures=e.maxFeatures),typeof e.hasGeometry=="boolean"&&(i.hasGeometry=e.hasGeometry),e.targetEpsgCode&&(i.targetEpsgCode=e.targetEpsgCode),!e.targetEpsgCode&&e.targetPrj&&(i.targetPrj=e.targetPrj),e.aggregations&&(i.aggregations=e.aggregations),O.toJSON(i)}}bt.getFeatureMode={BOUNDS:"BOUNDS",BOUNDS_ATTRIBUTEFILTER:"BOUNDS_ATTRIBUTEFILTER"};class Gt extends Et{constructor(e,t){super(e,t),t=t||{},this.returnContent=!0,this.fromIndex=0,this.toIndex=19,this.hasGeometry=!0,this.maxFeatures=null,this.format=Ir.GEOJSON,O.extend(this,t),this.url=O.urlPathAppend(this.url,"featureResults"),this.CLASS_NAME="SuperMap.GetFeaturesServiceBase"}destroy(){super.destroy();var e=this;e.returnContent=null,e.fromIndex=null,e.toIndex=null,e.maxFeatures=null,e.format=null,e.hasGeometry=null}processAsync(e){if(!!e){var t=this,r=null,i=!0;t.returnContent=e.returnContent,t.fromIndex=e.fromIndex,t.toIndex=e.toIndex,t.maxFeatures=e.maxFeatures,t.hasGeometry=e.hasGeometry,t.returnContent&&(t.url=O.urlAppend(t.url,"returnContent="+t.returnContent),i=!1);var h=t.fromIndex!=null&&t.toIndex!=null&&!isNaN(t.fromIndex)&&!isNaN(t.toIndex);h&&t.fromIndex>=0&&t.toIndex>=0&&!i&&(t.url=O.urlAppend(t.url,`fromIndex=${t.fromIndex}&toIndex=${t.toIndex}`)),e.returnCountOnly&&(t.url=O.urlAppend(t.url,"&returnCountOnly="+e.returnContent)),r=t.getJsonParameters(e),t.request({method:"POST",data:r,scope:t,success:t.serviceProcessCompleted,failure:t.serviceProcessFailed})}}serviceProcessCompleted(e){var t=this;if(e=O.transformResult(e),t.format===Ir.GEOJSON&&e.features){var r=new Rr;e.features=r.toGeoJSON(e.features)}t.events.triggerEvent("processCompleted",{result:e})}}class La extends Gt{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.GetFeaturesByBoundsService"}destroy(){super.destroy()}getJsonParameters(e){return bt.toJsonParameters(e)}}class Vi extends Dt{constructor(e){super(e),this.bufferDistance=null,this.attributeFilter=null,this.geometry=null,this.fields=null,O.extend(this,e),this.CLASS_NAME="SuperMap.GetFeaturesByBufferParameters"}destroy(){super.destroy();var e=this;if(e.bufferDistance=null,e.attributeFilter=null,e.fields){for(;e.fields.length>0;)e.fields.pop();e.fields=null}e.geometry&&(e.geometry.destroy(),e.geometry=null)}static toJsonParameters(e){var t,r,i;return i=Be.fromGeometry(e.geometry),r={datasetNames:e.datasetNames,getFeatureMode:"BUFFER",bufferDistance:e.bufferDistance,geometry:i},e.fields&&(t=new cr,t.name=e.datasetNames,t.fields=e.fields,r.queryParameter=t),e.attributeFilter&&(r.attributeFilter=e.attributeFilter,r.getFeatureMode="BUFFER_ATTRIBUTEFILTER"),e.maxFeatures&&!isNaN(e.maxFeatures)&&(r.maxFeatures=e.maxFeatures),typeof e.hasGeometry=="boolean"&&(r.hasGeometry=e.hasGeometry),e.targetEpsgCode&&(r.targetEpsgCode=e.targetEpsgCode),!e.targetEpsgCode&&e.targetPrj&&(r.targetPrj=e.targetPrj),O.toJSON(r)}}class Ma extends Gt{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.GetFeaturesByBufferService"}destroy(){super.destroy()}getJsonParameters(e){if(e instanceof Vi)return Vi.toJsonParameters(e)}}class Ia extends Dt{constructor(e){super(e),this.getFeatureMode="SPATIAL",this.geometry=null,this.fields=null,this.attributeFilter=null,this.spatialQueryMode=Ri.CONTAIN,O.extend(this,e),this.CLASS_NAME="SuperMap.GetFeaturesByGeometryParameters"}destroy(){super.destroy();var e=this;if(e.geometry&&(e.geometry.destroy(),e.geometry=null),e.fields){for(;e.fields.length>0;)e.fields.pop();e.fields=null}e.attributeFilter=null,e.spatialQueryMode=null,e.getFeatureMode=null}static toJsonParameters(e){var t,r,i;return r=Be.fromGeometry(e.geometry),i={datasetNames:e.datasetNames,getFeatureMode:"SPATIAL",geometry:r,spatialQueryMode:e.spatialQueryMode},e.fields&&(t=new cr,t.name=e.datasetNames,t.fields=e.fields,i.queryParameter=t),e.attributeFilter&&(i.attributeFilter=e.attributeFilter,i.getFeatureMode="SPATIAL_ATTRIBUTEFILTER"),e.maxFeatures&&!isNaN(e.maxFeatures)&&(i.maxFeatures=e.maxFeatures),typeof e.hasGeometry=="boolean"&&(i.hasGeometry=e.hasGeometry),e.targetEpsgCode&&(i.targetEpsgCode=e.targetEpsgCode),!e.targetEpsgCode&&e.targetPrj&&(i.targetPrj=e.targetPrj),e.aggregations&&(i.aggregations=e.aggregations),O.toJSON(i)}}class Ta extends Gt{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.GetFeaturesByGeometryService"}destroy(){super.destroy()}getJsonParameters(e){return Ia.toJsonParameters(e)}}class _a extends Dt{constructor(e){super(e),this.getFeatureMode="ID",this.IDs=null,this.fields=null,O.extend(this,e),this.CLASS_NAME="SuperMap.GetFeaturesByIDsParameters"}destroy(){super.destroy();var e=this;if(e.IDs=null,e.getFeatureMode=null,e.fields){for(;e.fields.length>0;)e.fields.pop();e.fields=null}}static toJsonParameters(e){var t,r;return t={datasetNames:e.datasetNames,getFeatureMode:"ID",ids:e.IDs},e.fields&&(r=new cr,r.name=e.datasetNames,r.fields=e.fields,t.queryParameter=r),e.targetEpsgCode&&(t.targetEpsgCode=e.targetEpsgCode),typeof e.hasGeometry=="boolean"&&(t.hasGeometry=e.hasGeometry),!e.targetEpsgCode&&e.targetPrj&&(t.targetPrj=e.targetPrj),e.aggregations&&(t.aggregations=e.aggregations),O.toJSON(t)}}class ka extends Gt{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.GetFeaturesByIDsService"}destroy(){super.destroy()}getJsonParameters(e){return _a.toJsonParameters(e)}}class Wi extends Dt{constructor(e){super(e),this.getFeatureMode="SQL",this.queryParameter=null,O.extend(this,e),this.CLASS_NAME="SuperMap.GetFeaturesBySQLParameters"}destroy(){super.destroy();var e=this;e.getFeatureMode=null,e.queryParameter&&(e.queryParameter.destroy(),e.queryParameter=null)}static toJsonParameters(e){var t={datasetNames:e.datasetNames,getFeatureMode:"SQL",queryParameter:e.queryParameter};return e.maxFeatures&&!isNaN(e.maxFeatures)&&(t.maxFeatures=e.maxFeatures),typeof e.hasGeometry=="boolean"&&(t.hasGeometry=e.hasGeometry),e.aggregations&&(t.aggregations=e.aggregations),e.targetEpsgCode&&(t.targetEpsgCode=e.targetEpsgCode),!e.targetEpsgCode&&e.targetPrj&&(t.targetPrj=e.targetPrj),e.aggregations&&(t.aggregations=e.aggregations),O.toJSON(t)}}class Fa extends Gt{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.GetFeaturesBySQLService"}destroy(){super.destroy()}getJsonParameters(e){return Wi.toJsonParameters(e)}}class Hi extends Et{constructor(e,t){super(e,t),this.projection=null,this.CLASS_NAME="SuperMap.MapService",t&&O.extend(this,t);var r=this;if(r.projection){var i=r.projection.split(":");i instanceof Array&&(i.length===2&&(r.url=O.urlAppend(r.url,`prjCoordSys=${encodeURIComponent(`{"epsgCode":"${i[1]}"}`)}`)),i.length===1&&(r.url=O.urlAppend(r.url,`prjCoordSys=${encodeURIComponent(`{"epsgCode":"${i[0]}"}`)}`)))}}destroy(){super.destroy();var e=this;e.events&&(e.events.un(e.eventListeners),e.events.listeners=null,e.events.destroy(),e.events=null,e.eventListeners=null)}processAsync(){var e=this;e.request({method:"GET",scope:e,success:e.serviceProcessCompleted,failure:e.serviceProcessFailed})}serviceProcessCompleted(e){var t=this;e=O.transformResult(e);var r=e.code>=200&&e.code<300||e.code==0||e.code===304,i=e.code&&r;!e.code||i?t.events&&t.events.triggerEvent("processCompleted",{result:e}):t.events.triggerEvent("processFailed",{error:e})}}(function(){const n=function(e,t,r,i,h,c){e instanceof ds.default?e.getLayers().forEach(function(p){n(p,t,r,i,h,c)}):e.getSource()._forEachFeatureAtCoordinate&&e.getSource()._forEachFeatureAtCoordinate(t,r,p=>{i(p,e)},h,c)};ct.default.prototype.forEachFeatureAtPixelDefault=ct.default.prototype.forEachFeatureAtPixel,ct.default.prototype.forEachFeatureAtPixel=ct.default.prototype.Tc=function(e,t,r,i){const h=r&&r.layerFilter?r.layerFilter:()=>!0,c=this.getLayers().getArray(),p=this.getView().getResolution(),g=this.getCoordinateFromPixel(e);for(let v=0;v<c.length;v++){const y=c[v];y.getVisible()&&h.call(null,y)&&n(y,g,p,t,e,i)}return this.forEachFeatureAtPixelDefault(e,t,r)}})();class Br extends fs.default{constructor(e,t){super(e,t),this.options=t||{},this.url=e,this.dispatchEvent({type:"initialized",value:this})}}class Ra extends Et{constructor(e,t){t=t||{},t.EVENT_TYPES=["broadcastSocketConnected","broadcastSocketClosed","broadcastSocketError","broadcastFailed","broadcastSucceeded","subscribeSocketConnected","subscribeSocketClosed","subscribeSocketError","messageSucceeded","setFilterParamSucceeded"],super(e,t),this.geometry=null,this.prjCoordSys=null,this.excludeField=null,O.extend(this,t),this.CLASS_NAME="SuperMap.DataFlowService"}initBroadcast(){var e=this;return this.broadcastWebSocket=this._connect(O.urlPathAppend(e.url,"broadcast")),this.broadcastWebSocket.onopen=function(t){e.broadcastWebSocket.isOpen=!0,t.eventType="broadcastSocketConnected",e.events.triggerEvent("broadcastSocketConnected",t)},this.broadcastWebSocket.onclose=function(t){e.broadcastWebSocket&&(e.broadcastWebSocket.isOpen=!1),t.eventType="broadcastSocketClosed",e.events.triggerEvent("broadcastSocketClosed",t)},this.broadcastWebSocket.onerror=function(t){t.eventType="broadcastSocketError",e.events.triggerEvent("broadcastSocketError",t)},this}broadcast(e){if(!this.broadcastWebSocket||!this.broadcastWebSocket.isOpen){this.events.triggerEvent("broadcastFailed");return}this.broadcastWebSocket.send(JSON.stringify(e)),this.events.triggerEvent("broadcastSucceeded")}initSubscribe(){var e=this;return this.subscribeWebSocket=this._connect(O.urlPathAppend(e.url,"subscribe")),this.subscribeWebSocket.onopen=function(t){e.subscribeWebSocket.send(e._getFilterParams()),t.eventType="subscribeSocketConnected",e.events.triggerEvent("subscribeSocketConnected",t)},this.subscribeWebSocket.onclose=function(t){t.eventType="subscribeWebSocketClosed",e.events.triggerEvent("subscribeWebSocketClosed",t)},this.subscribeWebSocket.onerror=function(t){t.eventType="subscribeSocketError",e.events.triggerEvent("subscribeSocketError",t)},this.subscribeWebSocket.onmessage=function(t){e._onMessage(t)},this}setExcludeField(e){return this.excludeField=e,this.subscribeWebSocket.send(this._getFilterParams()),this}setGeometry(e){return this.geometry=e,this.subscribeWebSocket.send(this._getFilterParams()),this}unSubscribe(){!this.subscribeWebSocket||(this.subscribeWebSocket.close(),this.subscribeWebSocket=null)}unBroadcast(){!this.broadcastWebSocket||(this.broadcastWebSocket.close(),this.broadcastWebSocket=null)}destroy(){Et.prototype.destroy.apply(this,arguments);var e=this;e.geometry=null,e.prjCoordSys=null,e.excludeField=null,this.unBroadcast(),this.unSubscribe()}_getFilterParams(){var e={filterParam:{prjCoordSys:this.prjCoordSys,excludeField:this.excludeField,geometry:this.geometry}};return O.toJSON(e)}_onMessage(e){if(e.data&&e.data.indexOf("filterParam")>=0){var t=JSON.parse(e.data);e.filterParam=t,e.eventType="setFilterParamSucceeded",this.events.triggerEvent("setFilterParamSucceeded",e);return}var r=JSON.parse(e.data);e.featureResult=r,e.eventType="messageSucceeded",this.events.triggerEvent("messageSucceeded",e)}_connect(e){if(e=Je.appendCredential(e),"WebSocket"in window)return new WebSocket(e);if("MozWebSocket"in window){var t=window.MozWebSocket;return new t(e)}else return console.log("no WebSocket"),null}}class Oa extends Br{constructor(e,t){t=t||{},t.projection&&(t.prjCoordSys=t.projection),super(e,t),this.dataFlow=new Ra(e,t),this.dataFlow.events.on({broadcastSocketConnected:this._defaultEvent,broadcastSocketError:this._defaultEvent,broadcastFailed:this._defaultEvent,broadcastSucceeded:this._defaultEvent,subscribeSocketConnected:this._defaultEvent,subscribeSocketError:this._defaultEvent,messageSucceeded:this._defaultEvent,setFilterParamSucceeded:this._defaultEvent,scope:this})}initBroadcast(){return this.dataFlow.initBroadcast(),this}broadcast(e){this.dataFlow.broadcast(e)}initSubscribe(){return this.dataFlow.initSubscribe(),this}setExcludeField(e){return this.dataFlow.setExcludeField(e),this.options.excludeField=e,this}setGeometry(e){return this.dataFlow.setGeometry(e),this.options.geometry=e,this}unSubscribe(){this.dataFlow.unSubscribe()}unBroadcast(){this.dataFlow.unBroadcast()}_defaultEvent(e){this.dispatchEvent({type:e.eventType||e.type,value:e})}}class Na extends ui.default{constructor(e){var t=e||{};super(t),this.idField=t.idField||"id",this.dataService=new Oa(t.ws,{geometry:t.geometry,prjCoordSys:t.prjCoordSys,excludeField:t.excludeField}).initSubscribe();var r=this;r.dataService.on("subscribeSocketConnected",function(i){r.dispatchEvent({type:"subscribeSucceeded",value:i})}),r.dataService.on("messageSucceeded",function(i){r._onMessageSuccessed(i)}),r.dataService.on("setFilterParamSucceeded",function(i){r.dispatchEvent({type:"setFilterParamSucceeded",value:i})}),this.featureCache={}}setExcludeField(e){return this.dataService.setExcludeField(e),this.excludeField=e,this}setGeometry(e){return this.dataService.setGeometry(e),this.geometry=e,this}_onMessageSuccessed(e){var t=new Kt.default().readFeature(e.value.featureResult),r=t.get(this.idField);r!==void 0&&this.featureCache[r]?(this.featureCache[r].setGeometry(t.getGeometry()),this.featureCache[r].setProperties(t.getProperties()),this.changed()):(this.addFeature(t),this.featureCache[r]=t),this.dispatchEvent({type:"dataupdated",value:{source:this,data:t}})}}class Da{constructor(e){this.options=e||{},this.enableMassClear=this.options.enableMassClear,this._map=e.map,this.paneName=this.options.paneName||"mapPane",this.context=this.options.context||"2d",this.zIndex=this.options.zIndex||2,this.mixBlendMode=this.options.mixBlendMode||null,this.width=e.width,this.height=e.height,this.initialize()}initialize(){var e=this.canvas=document.createElement("canvas");e.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";user-select:none;",e.style.mixBlendMode=this.mixBlendMode,e.className="mapvClass";var t=typeof window>"u"?{}:window,r=this.devicePixelRatio=t.devicePixelRatio||1;e.width=parseInt(this.width)*r,e.height=parseInt(this.height)*r,this.context==="2d"&&e.getContext(this.context).scale(r,r),e.style.width=this.width+"px",e.style.height=this.height+"px",this.context==="webgl"&&this.canvas.getContext(this.context).viewport(0,0,e.width,e.height)}draw(){this.options.update&&this.options.update.call(this)}resize(e,t){var r=typeof window>"u"?{}:window,i=this.devicePixelRatio=r.devicePixelRatio||1;this.canvas.width=e*i,this.canvas.height=t*i,this.context==="2d"&&this.canvas.getContext("2d").scale(i,i),this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.context==="webgl"&&this.canvas.getContext(this.context).viewport(0,0,this.canvas.width,this.canvas.height)}getContainer(){return this.canvas}setZIndex(e){this.canvas.style.zIndex=e}getZIndex(){return this.zIndex}}var Pt={exports:{}};(function(n,e){(function(t,r){r(e)})(pt,function(t){var r="2.0.62",i=function(u){u&&u.clearRect&&u.clearRect(0,0,u.canvas.width,u.canvas.height)},h=function(u){var s=window.devicePixelRatio||1;u.canvas.width=u.canvas.width*s,u.canvas.height=u.canvas.height*s,u.canvas.style.width=u.canvas.width/s+"px",u.canvas.style.height=u.canvas.height/s+"px",u.scale(s,s)};function c(){this._subscribers={}}c.prototype.on=function(u,s){var o=this._subscribers[u];o||(o=[],this._subscribers[u]=o),o.push({callback:s})},c.prototype.off=function(u,s){var o=this._subscribers[u];if(o)for(var a=0;a<o.length;a++)o[a].callback==s&&(o.splice(a,1),a--)},c.prototype._trigger=function(u,s,o){if(u=="*")throw new Error("Cannot trigger event *");var a=[];u in this._subscribers&&(a=a.concat(this._subscribers[u])),"*"in this._subscribers&&(a=a.concat(this._subscribers["*"]));for(var l=0,d=a.length;l<d;l++){var f=a[l];f.callback&&f.callback(u,s,o||null)}};var p={municipalities:[{n:"\u5317\u4EAC",g:"116.395645,39.929986|12"},{n:"\u4E0A\u6D77",g:"121.487899,31.249162|12"},{n:"\u5929\u6D25",g:"117.210813,39.14393|12"},{n:"\u91CD\u5E86",g:"106.530635,29.544606|12"}],provinces:[{n:"\u5B89\u5FBD",g:"117.216005,31.859252|8",cities:[{n:"\u5408\u80A5",g:"117.282699,31.866942|12"},{n:"\u5B89\u5E86",g:"117.058739,30.537898|13"},{n:"\u868C\u57E0",g:"117.35708,32.929499|13"},{n:"\u4EB3\u5DDE",g:"115.787928,33.871211|13"},{n:"\u5DE2\u6E56",g:"117.88049,31.608733|13"},{n:"\u6C60\u5DDE",g:"117.494477,30.660019|14"},{n:"\u6EC1\u5DDE",g:"118.32457,32.317351|13"},{n:"\u961C\u9633",g:"115.820932,32.901211|13"},{n:"\u6DEE\u5317",g:"116.791447,33.960023|13"},{n:"\u6DEE\u5357",g:"117.018639,32.642812|13"},{n:"\u9EC4\u5C71",g:"118.29357,29.734435|13"},{n:"\u516D\u5B89",g:"116.505253,31.755558|13"},{n:"\u9A6C\u978D\u5C71",g:"118.515882,31.688528|13"},{n:"\u5BBF\u5DDE",g:"116.988692,33.636772|13"},{n:"\u94DC\u9675",g:"117.819429,30.94093|14"},{n:"\u829C\u6E56",g:"118.384108,31.36602|12"},{n:"\u5BA3\u57CE",g:"118.752096,30.951642|13"}]},{n:"\u798F\u5EFA",g:"117.984943,26.050118|8",cities:[{n:"\u798F\u5DDE",g:"119.330221,26.047125|12"},{n:"\u9F99\u5CA9",g:"117.017997,25.078685|13"},{n:"\u5357\u5E73",g:"118.181883,26.643626|13"},{n:"\u5B81\u5FB7",g:"119.542082,26.656527|14"},{n:"\u8386\u7530",g:"119.077731,25.44845|13"},{n:"\u6CC9\u5DDE",g:"118.600362,24.901652|12"},{n:"\u4E09\u660E",g:"117.642194,26.270835|14"},{n:"\u53A6\u95E8",g:"118.103886,24.489231|12"},{n:"\u6F33\u5DDE",g:"117.676205,24.517065|12"}]},{n:"\u7518\u8083",g:"102.457625,38.103267|6",cities:[{n:"\u5170\u5DDE",g:"103.823305,36.064226|12"},{n:"\u767D\u94F6",g:"104.171241,36.546682|13"},{n:"\u5B9A\u897F",g:"104.626638,35.586056|13"},{n:"\u7518\u5357\u5DDE",g:"102.917442,34.992211|14"},{n:"\u5609\u5CEA\u5173",g:"98.281635,39.802397|13"},{n:"\u91D1\u660C",g:"102.208126,38.516072|13"},{n:"\u9152\u6CC9",g:"98.508415,39.741474|13"},{n:"\u4E34\u590F\u5DDE",g:"103.215249,35.598514|13"},{n:"\u9647\u5357",g:"104.934573,33.39448|14"},{n:"\u5E73\u51C9",g:"106.688911,35.55011|13"},{n:"\u5E86\u9633",g:"107.644227,35.726801|13"},{n:"\u5929\u6C34",g:"105.736932,34.584319|13"},{n:"\u6B66\u5A01",g:"102.640147,37.933172|13"},{n:"\u5F20\u6396",g:"100.459892,38.93932|13"}]},{n:"\u5E7F\u4E1C",g:"113.394818,23.408004|8",cities:[{n:"\u5E7F\u5DDE",g:"113.30765,23.120049|12"},{n:"\u6F6E\u5DDE",g:"116.630076,23.661812|13"},{n:"\u4E1C\u839E",g:"113.763434,23.043024|12"},{n:"\u4F5B\u5C71",g:"113.134026,23.035095|13"},{n:"\u6CB3\u6E90",g:"114.713721,23.757251|12"},{n:"\u60E0\u5DDE",g:"114.410658,23.11354|12"},{n:"\u6C5F\u95E8",g:"113.078125,22.575117|13"},{n:"\u63ED\u9633",g:"116.379501,23.547999|13"},{n:"\u8302\u540D",g:"110.931245,21.668226|13"},{n:"\u6885\u5DDE",g:"116.126403,24.304571|13"},{n:"\u6E05\u8FDC",g:"113.040773,23.698469|13"},{n:"\u6C55\u5934",g:"116.72865,23.383908|13"},{n:"\u6C55\u5C3E",g:"115.372924,22.778731|14"},{n:"\u97F6\u5173",g:"113.594461,24.80296|13"},{n:"\u6DF1\u5733",g:"114.025974,22.546054|12"},{n:"\u9633\u6C5F",g:"111.97701,21.871517|14"},{n:"\u4E91\u6D6E",g:"112.050946,22.937976|13"},{n:"\u6E5B\u6C5F",g:"110.365067,21.257463|13"},{n:"\u8087\u5E86",g:"112.479653,23.078663|13"},{n:"\u4E2D\u5C71",g:"113.42206,22.545178|12"},{n:"\u73E0\u6D77",g:"113.562447,22.256915|13"}]},{n:"\u5E7F\u897F",g:"108.924274,23.552255|7",cities:[{n:"\u5357\u5B81",g:"108.297234,22.806493|12"},{n:"\u767E\u8272",g:"106.631821,23.901512|13"},{n:"\u5317\u6D77",g:"109.122628,21.472718|13"},{n:"\u5D07\u5DE6",g:"107.357322,22.415455|14"},{n:"\u9632\u57CE\u6E2F",g:"108.351791,21.617398|15"},{n:"\u6842\u6797",g:"110.26092,25.262901|12"},{n:"\u8D35\u6E2F",g:"109.613708,23.103373|13"},{n:"\u6CB3\u6C60",g:"108.069948,24.699521|14"},{n:"\u8D3A\u5DDE",g:"111.552594,24.411054|14"},{n:"\u6765\u5BBE",g:"109.231817,23.741166|14"},{n:"\u67F3\u5DDE",g:"109.422402,24.329053|12"},{n:"\u94A6\u5DDE",g:"108.638798,21.97335|13"},{n:"\u68A7\u5DDE",g:"111.305472,23.485395|13"},{n:"\u7389\u6797",g:"110.151676,22.643974|14"}]},{n:"\u8D35\u5DDE",g:"106.734996,26.902826|8",cities:[{n:"\u8D35\u9633",g:"106.709177,26.629907|12"},{n:"\u5B89\u987A",g:"105.92827,26.228595|13"},{n:"\u6BD5\u8282\u5730\u533A",g:"105.300492,27.302612|14"},{n:"\u516D\u76D8\u6C34",g:"104.852087,26.591866|13"},{n:"\u94DC\u4EC1\u5730\u533A",g:"109.196161,27.726271|14"},{n:"\u9075\u4E49",g:"106.93126,27.699961|13"},{n:"\u9ED4\u897F\u5357\u5DDE",g:"104.900558,25.095148|11"},{n:"\u9ED4\u4E1C\u5357\u5DDE",g:"107.985353,26.583992|11"},{n:"\u9ED4\u5357\u5DDE",g:"107.523205,26.264536|11"}]},{n:"\u6D77\u5357",g:"109.733755,19.180501|9",cities:[{n:"\u6D77\u53E3",g:"110.330802,20.022071|13"},{n:"\u767D\u6C99",g:"109.358586,19.216056|12"},{n:"\u4FDD\u4EAD",g:"109.656113,18.597592|12"},{n:"\u660C\u6C5F",g:"109.0113,19.222483|12"},{n:"\u510B\u5DDE",g:"109.413973,19.571153|13"},{n:"\u6F84\u8FC8",g:"109.996736,19.693135|13"},{n:"\u4E1C\u65B9",g:"108.85101,18.998161|13"},{n:"\u5B9A\u5B89",g:"110.32009,19.490991|13"},{n:"\u743C\u6D77",g:"110.414359,19.21483|13"},{n:"\u743C\u4E2D",g:"109.861849,19.039771|12"},{n:"\u4E50\u4E1C",g:"109.062698,18.658614|12"},{n:"\u4E34\u9AD8",g:"109.724101,19.805922|13"},{n:"\u9675\u6C34",g:"109.948661,18.575985|12"},{n:"\u4E09\u4E9A",g:"109.522771,18.257776|12"},{n:"\u5C6F\u660C",g:"110.063364,19.347749|13"},{n:"\u4E07\u5B81",g:"110.292505,18.839886|13"},{n:"\u6587\u660C",g:"110.780909,19.750947|13"},{n:"\u4E94\u6307\u5C71",g:"109.51775,18.831306|13"}]},{n:"\u6CB3\u5317",g:"115.661434,38.61384|7",cities:[{n:"\u77F3\u5BB6\u5E84",g:"114.522082,38.048958|12"},{n:"\u4FDD\u5B9A",g:"115.49481,38.886565|13"},{n:"\u6CA7\u5DDE",g:"116.863806,38.297615|13"},{n:"\u627F\u5FB7",g:"117.933822,40.992521|14"},{n:"\u90AF\u90F8",g:"114.482694,36.609308|13"},{n:"\u8861\u6C34",g:"115.686229,37.746929|13"},{n:"\u5ECA\u574A",g:"116.703602,39.518611|13"},{n:"\u79E6\u7687\u5C9B",g:"119.604368,39.945462|12"},{n:"\u5510\u5C71",g:"118.183451,39.650531|13"},{n:"\u90A2\u53F0",g:"114.520487,37.069531|13"},{n:"\u5F20\u5BB6\u53E3",g:"114.893782,40.811188|13"}]},{n:"\u6CB3\u5357",g:"113.486804,34.157184|7",cities:[{n:"\u90D1\u5DDE",g:"113.649644,34.75661|12"},{n:"\u5B89\u9633",g:"114.351807,36.110267|12"},{n:"\u9E64\u58C1",g:"114.29777,35.755426|13"},{n:"\u7126\u4F5C",g:"113.211836,35.234608|13"},{n:"\u5F00\u5C01",g:"114.351642,34.801854|13"},{n:"\u6D1B\u9633",g:"112.447525,34.657368|12"},{n:"\u6F2F\u6CB3",g:"114.046061,33.576279|13"},{n:"\u5357\u9633",g:"112.542842,33.01142|13"},{n:"\u5E73\u9876\u5C71",g:"113.300849,33.745301|13"},{n:"\u6FEE\u9633",g:"115.026627,35.753298|12"},{n:"\u4E09\u95E8\u5CE1",g:"111.181262,34.78332|13"},{n:"\u5546\u4E18",g:"115.641886,34.438589|13"},{n:"\u65B0\u4E61",g:"113.91269,35.307258|13"},{n:"\u4FE1\u9633",g:"114.085491,32.128582|13"},{n:"\u8BB8\u660C",g:"113.835312,34.02674|13"},{n:"\u5468\u53E3",g:"114.654102,33.623741|13"},{n:"\u9A7B\u9A6C\u5E97",g:"114.049154,32.983158|13"}]},{n:"\u9ED1\u9F99\u6C5F",g:"128.047414,47.356592|6",cities:[{n:"\u54C8\u5C14\u6EE8",g:"126.657717,45.773225|12"},{n:"\u5927\u5E86",g:"125.02184,46.596709|12"},{n:"\u5927\u5174\u5B89\u5CAD\u5730\u533A",g:"124.196104,51.991789|10"},{n:"\u9E64\u5C97",g:"130.292472,47.338666|13"},{n:"\u9ED1\u6CB3",g:"127.50083,50.25069|14"},{n:"\u9E21\u897F",g:"130.941767,45.32154|13"},{n:"\u4F73\u6728\u65AF",g:"130.284735,46.81378|12"},{n:"\u7261\u4E39\u6C5F",g:"129.608035,44.588521|13"},{n:"\u4E03\u53F0\u6CB3",g:"131.019048,45.775005|14"},{n:"\u9F50\u9F50\u54C8\u5C14",g:"123.987289,47.3477|13"},{n:"\u53CC\u9E2D\u5C71",g:"131.171402,46.655102|13"},{n:"\u7EE5\u5316",g:"126.989095,46.646064|13"},{n:"\u4F0A\u6625",g:"128.910766,47.734685|14"}]},{n:"\u6E56\u5317",g:"112.410562,31.209316|8",cities:[{n:"\u6B66\u6C49",g:"114.3162,30.581084|12"},{n:"\u9102\u5DDE",g:"114.895594,30.384439|14"},{n:"\u6069\u65BD",g:"109.517433,30.308978|14"},{n:"\u9EC4\u5188",g:"114.906618,30.446109|14"},{n:"\u9EC4\u77F3",g:"115.050683,30.216127|13"},{n:"\u8346\u95E8",g:"112.21733,31.042611|13"},{n:"\u8346\u5DDE",g:"112.241866,30.332591|12"},{n:"\u6F5C\u6C5F",g:"112.768768,30.343116|13"},{n:"\u795E\u519C\u67B6\u6797\u533A",g:"110.487231,31.595768|13"},{n:"\u5341\u5830",g:"110.801229,32.636994|13"},{n:"\u968F\u5DDE",g:"113.379358,31.717858|13"},{n:"\u5929\u95E8",g:"113.12623,30.649047|13"},{n:"\u4ED9\u6843",g:"113.387448,30.293966|13"},{n:"\u54B8\u5B81",g:"114.300061,29.880657|13"},{n:"\u8944\u9633",g:"112.176326,32.094934|12"},{n:"\u5B5D\u611F",g:"113.935734,30.927955|13"},{n:"\u5B9C\u660C",g:"111.310981,30.732758|13"}]},{n:"\u6E56\u5357",g:"111.720664,27.695864|7",cities:[{n:"\u957F\u6C99",g:"112.979353,28.213478|12"},{n:"\u5E38\u5FB7",g:"111.653718,29.012149|12"},{n:"\u90F4\u5DDE",g:"113.037704,25.782264|13"},{n:"\u8861\u9633",g:"112.583819,26.898164|13"},{n:"\u6000\u5316",g:"109.986959,27.557483|13"},{n:"\u5A04\u5E95",g:"111.996396,27.741073|13"},{n:"\u90B5\u9633",g:"111.461525,27.236811|13"},{n:"\u6E58\u6F6D",g:"112.935556,27.835095|13"},{n:"\u6E58\u897F\u5DDE",g:"109.745746,28.317951|14"},{n:"\u76CA\u9633",g:"112.366547,28.588088|13"},{n:"\u6C38\u5DDE",g:"111.614648,26.435972|13"},{n:"\u5CB3\u9633",g:"113.146196,29.378007|13"},{n:"\u5F20\u5BB6\u754C",g:"110.48162,29.124889|13"},{n:"\u682A\u6D32",g:"113.131695,27.827433|13"}]},{n:"\u6C5F\u82CF",g:"119.368489,33.013797|8",cities:[{n:"\u5357\u4EAC",g:"118.778074,32.057236|12"},{n:"\u5E38\u5DDE",g:"119.981861,31.771397|12"},{n:"\u6DEE\u5B89",g:"119.030186,33.606513|12"},{n:"\u8FDE\u4E91\u6E2F",g:"119.173872,34.601549|12"},{n:"\u5357\u901A",g:"120.873801,32.014665|12"},{n:"\u82CF\u5DDE",g:"120.619907,31.317987|12"},{n:"\u5BBF\u8FC1",g:"118.296893,33.95205|13"},{n:"\u6CF0\u5DDE",g:"119.919606,32.476053|13"},{n:"\u65E0\u9521",g:"120.305456,31.570037|12"},{n:"\u5F90\u5DDE",g:"117.188107,34.271553|12"},{n:"\u76D0\u57CE",g:"120.148872,33.379862|12"},{n:"\u626C\u5DDE",g:"119.427778,32.408505|13"},{n:"\u9547\u6C5F",g:"119.455835,32.204409|13"}]},{n:"\u6C5F\u897F",g:"115.676082,27.757258|7",cities:[{n:"\u5357\u660C",g:"115.893528,28.689578|12"},{n:"\u629A\u5DDE",g:"116.360919,27.954545|13"},{n:"\u8D63\u5DDE",g:"114.935909,25.845296|13"},{n:"\u5409\u5B89",g:"114.992039,27.113848|13"},{n:"\u666F\u5FB7\u9547",g:"117.186523,29.303563|12"},{n:"\u4E5D\u6C5F",g:"115.999848,29.71964|13"},{n:"\u840D\u4E61",g:"113.859917,27.639544|13"},{n:"\u4E0A\u9976",g:"117.955464,28.457623|13"},{n:"\u65B0\u4F59",g:"114.947117,27.822322|13"},{n:"\u5B9C\u6625",g:"114.400039,27.81113|13"},{n:"\u9E70\u6F6D",g:"117.03545,28.24131|13"}]},{n:"\u5409\u6797",g:"126.262876,43.678846|7",cities:[{n:"\u957F\u6625",g:"125.313642,43.898338|12"},{n:"\u767D\u57CE",g:"122.840777,45.621086|13"},{n:"\u767D\u5C71",g:"126.435798,41.945859|13"},{n:"\u5409\u6797",g:"126.564544,43.871988|12"},{n:"\u8FBD\u6E90",g:"125.133686,42.923303|13"},{n:"\u56DB\u5E73",g:"124.391382,43.175525|12"},{n:"\u677E\u539F",g:"124.832995,45.136049|13"},{n:"\u901A\u5316",g:"125.94265,41.736397|13"},{n:"\u5EF6\u8FB9",g:"129.485902,42.896414|13"}]},{n:"\u8FBD\u5B81",g:"122.753592,41.6216|8",cities:[{n:"\u6C88\u9633",g:"123.432791,41.808645|12"},{n:"\u978D\u5C71",g:"123.007763,41.118744|13"},{n:"\u672C\u6EAA",g:"123.778062,41.325838|12"},{n:"\u671D\u9633",g:"120.446163,41.571828|13"},{n:"\u5927\u8FDE",g:"121.593478,38.94871|12"},{n:"\u4E39\u4E1C",g:"124.338543,40.129023|12"},{n:"\u629A\u987A",g:"123.92982,41.877304|12"},{n:"\u961C\u65B0",g:"121.660822,42.01925|14"},{n:"\u846B\u82A6\u5C9B",g:"120.860758,40.74303|13"},{n:"\u9526\u5DDE",g:"121.147749,41.130879|13"},{n:"\u8FBD\u9633",g:"123.172451,41.273339|14"},{n:"\u76D8\u9526",g:"122.073228,41.141248|13"},{n:"\u94C1\u5CAD",g:"123.85485,42.299757|13"},{n:"\u8425\u53E3",g:"122.233391,40.668651|13"}]},{n:"\u5185\u8499\u53E4",g:"114.415868,43.468238|5",cities:[{n:"\u547C\u548C\u6D69\u7279",g:"111.660351,40.828319|12"},{n:"\u963F\u62C9\u5584\u76DF",g:"105.695683,38.843075|14"},{n:"\u5305\u5934",g:"109.846239,40.647119|12"},{n:"\u5DF4\u5F66\u6DD6\u5C14",g:"107.423807,40.76918|12"},{n:"\u8D64\u5CF0",g:"118.930761,42.297112|12"},{n:"\u9102\u5C14\u591A\u65AF",g:"109.993706,39.81649|12"},{n:"\u547C\u4F26\u8D1D\u5C14",g:"119.760822,49.201636|12"},{n:"\u901A\u8FBD",g:"122.260363,43.633756|12"},{n:"\u4E4C\u6D77",g:"106.831999,39.683177|13"},{n:"\u4E4C\u5170\u5BDF\u5E03",g:"113.112846,41.022363|12"},{n:"\u9521\u6797\u90ED\u52D2\u76DF",g:"116.02734,43.939705|11"},{n:"\u5174\u5B89\u76DF",g:"122.048167,46.083757|11"}]},{n:"\u5B81\u590F",g:"106.155481,37.321323|8",cities:[{n:"\u94F6\u5DDD",g:"106.206479,38.502621|12"},{n:"\u56FA\u539F",g:"106.285268,36.021523|13"},{n:"\u77F3\u5634\u5C71",g:"106.379337,39.020223|13"},{n:"\u5434\u5FE0",g:"106.208254,37.993561|14"},{n:"\u4E2D\u536B",g:"105.196754,37.521124|14"}]},{n:"\u9752\u6D77",g:"96.202544,35.499761|7",cities:[{n:"\u897F\u5B81",g:"101.767921,36.640739|12"},{n:"\u679C\u6D1B\u5DDE",g:"100.223723,34.480485|11"},{n:"\u6D77\u4E1C\u5730\u533A",g:"102.085207,36.51761|11"},{n:"\u6D77\u5317\u5DDE",g:"100.879802,36.960654|11"},{n:"\u6D77\u5357\u5DDE",g:"100.624066,36.284364|11"},{n:"\u6D77\u897F\u5DDE",g:"97.342625,37.373799|11"},{n:"\u9EC4\u5357\u5DDE",g:"102.0076,35.522852|11"},{n:"\u7389\u6811\u5DDE",g:"97.013316,33.00624|14"}]},{n:"\u5C71\u4E1C",g:"118.527663,36.09929|8",cities:[{n:"\u6D4E\u5357",g:"117.024967,36.682785|12"},{n:"\u6EE8\u5DDE",g:"117.968292,37.405314|12"},{n:"\u4E1C\u8425",g:"118.583926,37.487121|12"},{n:"\u5FB7\u5DDE",g:"116.328161,37.460826|12"},{n:"\u83CF\u6CFD",g:"115.46336,35.26244|13"},{n:"\u6D4E\u5B81",g:"116.600798,35.402122|13"},{n:"\u83B1\u829C",g:"117.684667,36.233654|13"},{n:"\u804A\u57CE",g:"115.986869,36.455829|12"},{n:"\u4E34\u6C82",g:"118.340768,35.072409|12"},{n:"\u9752\u5C9B",g:"120.384428,36.105215|12"},{n:"\u65E5\u7167",g:"119.50718,35.420225|12"},{n:"\u6CF0\u5B89",g:"117.089415,36.188078|13"},{n:"\u5A01\u6D77",g:"122.093958,37.528787|13"},{n:"\u6F4D\u574A",g:"119.142634,36.716115|12"},{n:"\u70DF\u53F0",g:"121.309555,37.536562|12"},{n:"\u67A3\u5E84",g:"117.279305,34.807883|13"},{n:"\u6DC4\u535A",g:"118.059134,36.804685|12"}]},{n:"\u5C71\u897F",g:"112.515496,37.866566|7",cities:[{n:"\u592A\u539F",g:"112.550864,37.890277|12"},{n:"\u957F\u6CBB",g:"113.120292,36.201664|12"},{n:"\u5927\u540C",g:"113.290509,40.113744|12"},{n:"\u664B\u57CE",g:"112.867333,35.499834|13"},{n:"\u664B\u4E2D",g:"112.738514,37.693362|13"},{n:"\u4E34\u6C7E",g:"111.538788,36.099745|13"},{n:"\u5415\u6881",g:"111.143157,37.527316|14"},{n:"\u6714\u5DDE",g:"112.479928,39.337672|13"},{n:"\u5FFB\u5DDE",g:"112.727939,38.461031|12"},{n:"\u9633\u6CC9",g:"113.569238,37.869529|13"},{n:"\u8FD0\u57CE",g:"111.006854,35.038859|13"}]},{n:"\u9655\u897F",g:"109.503789,35.860026|7",cities:[{n:"\u897F\u5B89",g:"108.953098,34.2778|12"},{n:"\u5B89\u5EB7",g:"109.038045,32.70437|13"},{n:"\u5B9D\u9E21",g:"107.170645,34.364081|12"},{n:"\u6C49\u4E2D",g:"107.045478,33.081569|13"},{n:"\u5546\u6D1B",g:"109.934208,33.873907|13"},{n:"\u94DC\u5DDD",g:"108.968067,34.908368|13"},{n:"\u6E2D\u5357",g:"109.483933,34.502358|13"},{n:"\u54B8\u9633",g:"108.707509,34.345373|13"},{n:"\u5EF6\u5B89",g:"109.50051,36.60332|13"},{n:"\u6986\u6797",g:"109.745926,38.279439|12"}]},{n:"\u56DB\u5DDD",g:"102.89916,30.367481|7",cities:[{n:"\u6210\u90FD",g:"104.067923,30.679943|12"},{n:"\u963F\u575D\u5DDE",g:"102.228565,31.905763|15"},{n:"\u5DF4\u4E2D",g:"106.757916,31.869189|14"},{n:"\u8FBE\u5DDE",g:"107.494973,31.214199|14"},{n:"\u5FB7\u9633",g:"104.402398,31.13114|13"},{n:"\u7518\u5B5C\u5DDE",g:"101.969232,30.055144|15"},{n:"\u5E7F\u5B89",g:"106.63572,30.463984|13"},{n:"\u5E7F\u5143",g:"105.819687,32.44104|13"},{n:"\u4E50\u5C71",g:"103.760824,29.600958|13"},{n:"\u51C9\u5C71\u5DDE",g:"102.259591,27.892393|14"},{n:"\u6CF8\u5DDE",g:"105.44397,28.89593|14"},{n:"\u5357\u5145",g:"106.105554,30.800965|13"},{n:"\u7709\u5C71",g:"103.84143,30.061115|13"},{n:"\u7EF5\u9633",g:"104.705519,31.504701|12"},{n:"\u5185\u6C5F",g:"105.073056,29.599462|13"},{n:"\u6500\u679D\u82B1",g:"101.722423,26.587571|14"},{n:"\u9042\u5B81",g:"105.564888,30.557491|12"},{n:"\u96C5\u5B89",g:"103.009356,29.999716|13"},{n:"\u5B9C\u5BBE",g:"104.633019,28.769675|13"},{n:"\u8D44\u9633",g:"104.63593,30.132191|13"},{n:"\u81EA\u8D21",g:"104.776071,29.359157|13"}]},{n:"\u897F\u85CF",g:"89.137982,31.367315|6",cities:[{n:"\u62C9\u8428",g:"91.111891,29.662557|13"},{n:"\u963F\u91CC\u5730\u533A",g:"81.107669,30.404557|11"},{n:"\u660C\u90FD\u5730\u533A",g:"97.185582,31.140576|15"},{n:"\u6797\u829D\u5730\u533A",g:"94.349985,29.666941|11"},{n:"\u90A3\u66F2\u5730\u533A",g:"92.067018,31.48068|14"},{n:"\u65E5\u5580\u5219\u5730\u533A",g:"88.891486,29.269023|14"},{n:"\u5C71\u5357\u5730\u533A",g:"91.750644,29.229027|11"}]},{n:"\u65B0\u7586",g:"85.614899,42.127001|6",cities:[{n:"\u4E4C\u9C81\u6728\u9F50",g:"87.564988,43.84038|12"},{n:"\u963F\u62C9\u5C14",g:"81.291737,40.61568|13"},{n:"\u963F\u514B\u82CF\u5730\u533A",g:"80.269846,41.171731|12"},{n:"\u963F\u52D2\u6CF0\u5730\u533A",g:"88.137915,47.839744|13"},{n:"\u5DF4\u97F3\u90ED\u695E",g:"86.121688,41.771362|12"},{n:"\u535A\u5C14\u5854\u62C9\u5DDE",g:"82.052436,44.913651|11"},{n:"\u660C\u5409\u5DDE",g:"87.296038,44.007058|13"},{n:"\u54C8\u5BC6\u5730\u533A",g:"93.528355,42.858596|13"},{n:"\u548C\u7530\u5730\u533A",g:"79.930239,37.116774|13"},{n:"\u5580\u4EC0\u5730\u533A",g:"75.992973,39.470627|12"},{n:"\u514B\u62C9\u739B\u4F9D",g:"84.88118,45.594331|13"},{n:"\u514B\u5B5C\u52D2\u82CF\u5DDE",g:"76.137564,39.750346|11"},{n:"\u77F3\u6CB3\u5B50",g:"86.041865,44.308259|13"},{n:"\u5854\u57CE\u5730\u533A",g:"82.974881,46.758684|12"},{n:"\u56FE\u6728\u8212\u514B",g:"79.198155,39.889223|13"},{n:"\u5410\u9C81\u756A\u5730\u533A",g:"89.181595,42.96047|13"},{n:"\u4E94\u5BB6\u6E20",g:"87.565449,44.368899|13"},{n:"\u4F0A\u7281\u5DDE",g:"81.297854,43.922248|11"}]},{n:"\u4E91\u5357",g:"101.592952,24.864213|7",cities:[{n:"\u6606\u660E",g:"102.714601,25.049153|12"},{n:"\u4FDD\u5C71",g:"99.177996,25.120489|13"},{n:"\u695A\u96C4\u5DDE",g:"101.529382,25.066356|13"},{n:"\u5927\u7406\u5DDE",g:"100.223675,25.5969|14"},{n:"\u5FB7\u5B8F\u5DDE",g:"98.589434,24.44124|14"},{n:"\u8FEA\u5E86\u5DDE",g:"99.713682,27.831029|14"},{n:"\u7EA2\u6CB3\u5DDE",g:"103.384065,23.367718|11"},{n:"\u4E3D\u6C5F",g:"100.229628,26.875351|13"},{n:"\u4E34\u6CA7",g:"100.092613,23.887806|14"},{n:"\u6012\u6C5F\u5DDE",g:"98.859932,25.860677|14"},{n:"\u666E\u6D31",g:"100.980058,22.788778|14"},{n:"\u66F2\u9756",g:"103.782539,25.520758|12"},{n:"\u662D\u901A",g:"103.725021,27.340633|13"},{n:"\u6587\u5C71",g:"104.089112,23.401781|14"},{n:"\u897F\u53CC\u7248\u7EB3",g:"100.803038,22.009433|13"},{n:"\u7389\u6EAA",g:"102.545068,24.370447|13"}]},{n:"\u6D59\u6C5F",g:"119.957202,29.159494|8",cities:[{n:"\u676D\u5DDE",g:"120.219375,30.259244|12"},{n:"\u6E56\u5DDE",g:"120.137243,30.877925|12"},{n:"\u5609\u5174",g:"120.760428,30.773992|13"},{n:"\u91D1\u534E",g:"119.652576,29.102899|12"},{n:"\u4E3D\u6C34",g:"119.929576,28.4563|13"},{n:"\u5B81\u6CE2",g:"121.579006,29.885259|12"},{n:"\u8862\u5DDE",g:"118.875842,28.95691|12"},{n:"\u7ECD\u5174",g:"120.592467,30.002365|13"},{n:"\u53F0\u5DDE",g:"121.440613,28.668283|13"},{n:"\u6E29\u5DDE",g:"120.690635,28.002838|12"},{n:"\u821F\u5C71",g:"122.169872,30.03601|13"}]}],other:[{n:"\u9999\u6E2F",g:"114.186124,22.293586|11"},{n:"\u6FB3\u95E8",g:"113.557519,22.204118|13"},{n:"\u53F0\u6E7E",g:"120.961454,23.80406|8"}]};function g(u){var s=u.split("|");return s[0]=s[0].split(","),{lng:parseFloat(s[0][0]),lat:parseFloat(s[0][1])}}var v={getProvinceNameByCityName:function(s){for(var o=p.provinces,a=0;a<o.length;a++)for(var l=o[a].n,d=o[a].cities,f=0;f<d.length;f++)if(d[f].n==s)return l;return null},getCenterByCityName:function(s){s=s.replace("\u5E02","");for(var o=0;o<p.municipalities.length;o++)if(p.municipalities[o].n==s)return g(p.municipalities[o].g);for(var o=0;o<p.other.length;o++)if(p.other[o].n==s)return g(p.other[o].g);for(var a=p.provinces,o=0;o<a.length;o++){if(a[o].n==s)return g(a[o].g);for(var l=a[o].cities,d=0;d<l.length;d++)if(l[d].n==s)return g(l[d].g)}return null}},y=function(u,s){if(!(u instanceof s))throw new TypeError("Cannot call a class as a function")},w=function(){function u(s,o){for(var a=0;a<o.length;a++){var l=o[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(s,l.key,l)}}return function(s,o,a){return o&&u(s.prototype,o),a&&u(s,a),s}}(),A=function u(s,o,a){s===null&&(s=Function.prototype);var l=Object.getOwnPropertyDescriptor(s,o);if(l===void 0){var d=Object.getPrototypeOf(s);return d===null?void 0:u(d,o,a)}else{if("value"in l)return l.value;var f=l.get;return f===void 0?void 0:f.call(a)}},E=function(u,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof s);u.prototype=Object.create(s&&s.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),s&&(Object.setPrototypeOf?Object.setPrototypeOf(u,s):u.__proto__=s)},k=function(u,s){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s&&(typeof s=="object"||typeof s=="function")?s:u},z=function(){function u(s,o){var a=[],l=!0,d=!1,f=void 0;try{for(var m=s[Symbol.iterator](),S;!(l=(S=m.next()).done)&&(a.push(S.value),!(o&&a.length===o));l=!0);}catch(C){d=!0,f=C}finally{try{!l&&m.return&&m.return()}finally{if(d)throw f}}return a}return function(s,o){if(Array.isArray(s))return s;if(Symbol.iterator in Object(s))return u(s,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function x(u,s){c.bind(this)(),this._options=s||{},this._data=[],u&&this.add(u)}x.prototype=Object.create(c.prototype),x.prototype.add=function(u,s){if(Array.isArray(u)){for(var o=0,a=u.length;o<a;o++)if(u[o]){if(u[o].time&&u[o].time.length==14&&u[o].time.substr(0,2)=="20"){var l=u[o].time;u[o].time=new Date(l.substr(0,4)+"-"+l.substr(4,2)+"-"+l.substr(6,2)+" "+l.substr(8,2)+":"+l.substr(10,2)+":"+l.substr(12,2)).getTime()}this._data.push(u[o])}}else if(u instanceof Object)this._data.push(u);else throw new Error("Unknown dataType");this._dataCache=JSON.parse(JSON.stringify(this._data))},x.prototype.reset=function(){this._data=JSON.parse(JSON.stringify(this._dataCache))},x.prototype.get=function(u){u=u||{};var s=this._data;if(u.filter){for(var o=[],a=0;a<s.length;a++)u.filter(s[a])&&o.push(s[a]);s=o}return u.transferCoordinate&&(s=this.transferCoordinate(s,u.transferCoordinate,u.fromColumn,u.toColumn)),s},x.prototype.set=function(u){this._set(u),this._trigger("change")},x.prototype._set=function(u){this.clear(),this.add(u)},x.prototype.clear=function(u){this._data=[]},x.prototype.remove=function(u){},x.prototype.update=function(u,s){for(var o=this._data,a=0;a<o.length;a++)if(s){var l=!0;for(var d in s)o[a][d]!=s[d]&&(l=!1);l&&u&&u(o[a])}else u&&u(o[a]);this._dataCache=JSON.parse(JSON.stringify(this._data)),this._trigger("change")},x.prototype.transferCoordinate=function(u,s,o,a){a=a||"_coordinates",o=o||"coordinates";for(var l=0;l<u.length;l++){var d=u[l].geometry,f=d[o];switch(d.type){case"Point":d[a]=s(f);break;case"LineString":for(var S=[],m=0;m<f.length;m++)S.push(s(f[m]));d[a]=S;break;case"MultiLineString":case"Polygon":var S=M(f);d[a]=S;break;case"MultiPolygon":for(var S=[],C=0;C<f.length;C++){var I=f[C],I=M(I);S.push(I)}d[a]=S;break}}function M(F){for(var T=[],G=0;G<F.length;G++){for(var B=F[G],V=[],H=0;H<B.length;H++)V.push(s(B[H]));T.push(V)}return T}return u},x.prototype.initGeometry=function(u){u?this._data.forEach(function(s){s.geometry=u(s)}):this._data.forEach(function(s){if(!s.geometry){if(s.lng&&s.lat)s.geometry={type:"Point",coordinates:[s.lng,s.lat]};else if(s.city){var o=v.getCenterByCityName(s.city);o&&(s.geometry={type:"Point",coordinates:[o.lng,o.lat]})}}})},x.prototype.getMax=function(u){var s=this._data;if(!(!s||s.length<=0)){for(var o=parseFloat(s[0][u]),a=1;a<s.length;a++){var l=parseFloat(s[a][u]);l>o&&(o=l)}return o}},x.prototype.getSum=function(u){var s=this._data;if(!(!s||s.length<=0)){for(var o=0,a=0;a<s.length;a++)s[a][u]&&(o+=parseFloat(s[a][u]));return o}},x.prototype.getMin=function(u){var s=this._data;if(!(!s||s.length<=0)){for(var o=parseFloat(s[0][u]),a=1;a<s.length;a++){var l=parseFloat(s[a][u]);l<o&&(o=l)}return o}},x.prototype.getUnique=function(u){var a=this._data;if(!(!a||a.length<=0)){for(var s={},o=1;o<a.length;o++)s[a[o][u]]=!0;var a=[];for(var l in s)a.push(l);return a}};function N(u,s,o){var a=60*o+30,l=Math.PI/180*a;return[u.x+s*Math.cos(l),u.y+s*Math.sin(l)]}function b(u,s,o,a){for(var l=0;l<6;l++){var d=N({x:s,y:o},a,l);u.lineTo(d[0],d[1])}}var R={drawDataSet:function(s,o,a){for(var l=o instanceof x?o.get():o,d=0,f=l.length;d<f;d++){var m=l[d];this.draw(s,m,a)}},draw:function(s,o,a){var l=o.geometry.type,d=o.geometry._coordinates||o.geometry.coordinates,f=o.symbol||a.symbol||"circle";switch(l){case"Point":var m=o._size||o.size||a._size||a.size||5;f==="circle"?(a.bigData==="Point"&&s.moveTo(d[0],d[1]),s.arc(d[0],d[1],m,0,Math.PI*2)):f==="rect"?s.rect(d[0]-m/2,d[1]-m/2,m,m):f==="honeycomb"&&b(s,d[0],d[1],m);break;case"LineString":this.drawLineString(s,d);break;case"MultiLineString":for(var S=0;S<d.length;S++){var C=d[S];this.drawLineString(s,C)}break;case"Polygon":this.drawPolygon(s,d);break;case"MultiPolygon":for(var S=0;S<d.length;S++){var I=d[S];if(this.drawPolygon(s,I),a.multiPolygonDraw){var M=a.multiPolygonDraw();if(M)return M}}break;default:console.error("type"+l+"is not support now!");break}},drawLineString:function(s,o){for(var a=0;a<o.length;a++){var l=o[a][0],d=o[a][1];a==0?s.moveTo(l,d):s.lineTo(l,d)}},drawPolygon:function(s,o){s.beginPath();for(var a=0;a<o.length;a++){var l=o[a];s.moveTo(l[0][0],l[0][1]);for(var d=1;d<l.length;d++)s.lineTo(l[d][0],l[d][1]);s.lineTo(l[0][0],l[0][1]),s.closePath()}}},W={draw:function(s,o,a){var l=o instanceof x?o.get():o;s.save();for(var d in a)s[d]=a[d];if(a.bigData){s.save(),s.beginPath();for(var f=0,m=l.length;f<m;f++){var S=l[f];R.draw(s,S,a)}var C=a.bigData;C=="Point"||C=="Polygon"||C=="MultiPolygon"?(s.fill(),s.lineDash&&s.setLineDash(s.lineDash),S.lineDash&&s.setLineDash(S.lineDash),(S.strokeStyle||a.strokeStyle)&&a.lineWidth&&s.stroke()):(C=="LineString"||C=="MultiLineString")&&s.stroke(),s.restore()}else for(var f=0,m=l.length;f<m;f++){var S=l[f];s.save(),(S.fillStyle||S._fillStyle)&&(s.fillStyle=S.fillStyle||S._fillStyle),(S.strokeStyle||S._strokeStyle)&&(s.strokeStyle=S.strokeStyle||S._strokeStyle),s.lineDash&&s.setLineDash(s.lineDash),S.lineDash&&s.setLineDash(S.lineDash);var C=S.geometry.type;s.beginPath(),a.multiPolygonDraw=function(){s.fill(),(S.strokeStyle||a.strokeStyle)&&a.lineWidth&&s.stroke()},R.draw(s,S,a),C=="Point"||C=="Polygon"||C=="MultiPolygon"?(s.fill(),(S.strokeStyle||a.strokeStyle)&&a.lineWidth&&s.stroke()):(C=="LineString"||C=="MultiLineString")&&((S.lineWidth||S._lineWidth)&&(s.lineWidth=S.lineWidth||S._lineWidth),s.stroke()),s.restore()}s.restore()}};function ee(u,s){var o;if(!(typeof document>"u")){var o=document.createElement("canvas");u&&(o.width=u),s&&(o.height=s)}return o}function Y(u){u=u||{},this.gradient=u.gradient||{.25:"rgba(0, 0, 255, 1)",.55:"rgba(0, 255, 0, 1)",.85:"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=u.maxSize||35,this.minSize=u.minSize||0,this.max=u.max||100,this.min=u.min||0,this.initPalette()}Y.prototype.setMax=function(u){this.max=u||100},Y.prototype.setMin=function(u){this.min=u||0},Y.prototype.setMaxSize=function(u){this.maxSize=u||35},Y.prototype.setMinSize=function(u){this.minSize=u||0},Y.prototype.initPalette=function(){var u=this.gradient,s=new ee(256,1),o=this.paletteCtx=s.getContext("2d"),a=o.createLinearGradient(0,0,256,1);for(var l in u)a.addColorStop(parseFloat(l),u[l]);o.fillStyle=a,o.fillRect(0,0,256,1)},Y.prototype.getColor=function(u){var s=this.getImageData(u);return"rgba("+s[0]+", "+s[1]+", "+s[2]+", "+s[3]/256+")"},Y.prototype.getImageData=function(u){var s=this.paletteCtx.getImageData(0,0,256,1).data;if(u===void 0)return s;var o=this.max,a=this.min;u>o&&(u=o),u<a&&(u=a);var l=Math.floor((u-a)/(o-a)*(256-1))*4;return[s[l],s[l+1],s[l+2],s[l+3]]},Y.prototype.getSize=function(u){var s=0,o=this.max,a=this.min,l=this.maxSize,d=this.minSize;if(u>o&&(u=o),u<a&&(u=a),o>a)s=d+(u-a)/(o-a)*(l-d);else return l;return s},Y.prototype.getLegend=function(u){var s=this.gradient,o=u.width||20,a=u.height||180,l=new ee(o,a),d=l.getContext("2d"),f=d.createLinearGradient(0,a,0,0);for(var m in s)f.addColorStop(parseFloat(m),s[m]);return d.fillStyle=f,d.fillRect(0,0,o,a),l};var j=typeof window>"u"?{}:window,re=j.devicePixelRatio||1;function le(u){var s=u/2,o=u+s,a=1e4,l=new ee(o*2,o*2),d=l.getContext("2d");return d.shadowBlur=s,d.shadowColor="black",d.shadowOffsetX=d.shadowOffsetY=a,d.beginPath(),d.arc(o-a,o-a,u,0,Math.PI*2,!0),d.closePath(),d.fill(),l}function De(u,s,o){var a=Le(o),l=At(o),d=a-l,I=o.range||null,f=0,m=1024;I&&I.length===2&&(f=(I[0]-l)/d*1024),I&&I.length===2&&(m=(I[1]-l)/d*1024);for(var S=o.maxOpacity||.8,C=o.minOpacity||0,I=o.range,M=3,F=u.length,T;M<F;M+=4)T=u[M]*4,u[M]/256>S&&(u[M]=256*S),u[M]/256<C&&(u[M]=256*C),T&&T>=f&&T<=m?(u[M-3]=s[T],u[M-2]=s[T+1],u[M-1]=s[T+2]):u[M]=0}function Le(u){var s=u.max||100;return s}function At(u){var s=u.min||0;return s}function Hr(u,s,o){var a=Le(o),l=At(o),d=o._size;d==null&&(d=o.size,d==null&&(d=13));var f=new Y({gradient:o.gradient,max:a,min:l}),m=le(d),S=m.width/2,C=m.height/2,I=s,M={};I.forEach(function(G,B){var V=G.count===void 0?1:G.count,H=Math.min(1,V/a).toFixed(2);M[H]=M[H]||[],M[H].push(G)});for(var F in M)if(!isNaN(F)){var T=M[F];u.beginPath(),o.withoutAlpha||(u.globalAlpha=F),u.strokeStyle=f.getColor(F*a),T.forEach(function(G,B){if(!!G.geometry){var V=G.geometry._coordinates||G.geometry.coordinates,H=G.geometry.type;if(H==="Point"){var Z=G.count===void 0?1:G.count;u.globalAlpha=Z/a,u.drawImage(m,V[0]-S,V[1]-C)}else if(H==="LineString"){var Z=G.count===void 0?1:G.count;u.globalAlpha=Z/a,u.beginPath(),R.draw(u,G,o),u.stroke()}}})}}function to(u,s,o){if(!(u.canvas.width<=0||u.canvas.height<=0)){var a=o.strength||.3;u.strokeStyle="rgba(0,0,0,"+a+")";var l=new ee(u.canvas.width,u.canvas.height),d=l.getContext("2d");d.scale(re,re),o=o||{};var f=s instanceof x?s.get():s;u.save();var m=new Y({gradient:o.gradient});if(Hr(d,f,o),!o.absolute){var S=d.getImageData(0,0,u.canvas.width,u.canvas.height);De(S.data,m.getImageData(),o),u.putImageData(S,0,0),u.restore()}m=null,l=null}}var Xi={draw:to},$i={draw:function(s,o,a){s.save();var l=o instanceof x?o.get():o,d={},f=a._size||a.size||50,m="enableCluster"in a?a.enableCluster:!0,S=a.offset||{x:0,y:0},C=new Y({min:a.min||0,max:a.max||100,gradient:a.gradient});if(m){for(var G=0;G<l.length;G++){var M=l[G].geometry._coordinates||l[G].geometry.coordinates,F=Math.floor((M[0]-S.x)/f)+","+Math.floor((M[1]-S.y)/f);d[F]||(d[F]=0),d[F]+=~~(l[G].count||1)}for(var B in d)B=B.split(","),s.beginPath(),s.rect(B[0]*f+.5+S.x,B[1]*f+.5+S.y,f,f),s.fillStyle=C.getColor(d[B]),s.fill(),a.strokeStyle&&a.lineWidth&&s.stroke()}else{for(var I=0;I<l.length;I++){var M=l[I].geometry._coordinates||l[I].geometry.coordinates,F=M.join(",");d[F]=l[I].count||1}for(var T in d)T=T.split(","),s.beginPath(),s.rect(+T[0]-f/2,+T[1]-f/2,f,f),s.fillStyle=C.getColor(d[T]),s.fill(),a.strokeStyle&&a.lineWidth&&s.stroke()}if(a.label&&a.label.show!==!1){s.fillStyle=a.label.fillStyle||"white",a.label.font&&(s.font=a.label.font),a.label.shadowColor&&(s.shadowColor=a.label.shadowColor),a.label.shadowBlur&&(s.shadowBlur=a.label.shadowBlur);for(var F in d){F=F.split(",");var V=d[F],H=s.measureText(V).width;m?s.fillText(V,F[0]*f+.5+S.x+f/2-H/2,F[1]*f+.5+S.y+f/2+5):s.fillText(V,+F[0]-H/2,+F[1]+5)}}s.restore()}};function ro(u,s,o){var a=60*o+30,l=Math.PI/180*a;return[u.x+s*Math.cos(l),u.y+s*Math.sin(l)]}var en={draw:function(s,o,a){s.save();var l=o instanceof x?o.get():o;for(var d in a)s[d]=a[d];var f=a.offset||{x:10,y:10},m=a._size||a.size||40;m=m/2/Math.sin(Math.PI/3);for(var S=m*2*Math.sin(Math.PI/3),C=m*1.5,I={},M=0;M<l.length;M++){var F=l[M].geometry._coordinates||l[M].geometry.coordinates,T=(F[1]-f.y)/C,G=Math.round(T),B=(F[0]-f.x)/S-(G&1?.5:0),V=Math.round(B),H=T-G;if(Math.abs(H)*3>1){var Z=B-V,ne=V+(B<V?-1:1)/2,K=G+(T<G?-1:1),X=B-ne,he=T-K;Z*Z+H*H>X*X+he*he&&(V=ne+(G&1?1:-1)/2,G=K)}var ye=V+"-"+G,oe=I[ye];oe?oe.push(l[M]):(oe=I[ye]=[l[M]],oe.i=V,oe.j=G,oe.x=(V+(G&1?1/2:0))*S,oe.y=G*C)}var se=new Y({max:a.max||100,maxSize:m,gradient:a.gradient});for(var d in I){var Ae=I[d];s.beginPath();for(var me=0;me<6;me++){var be=ro({x:Ae.x+f.x,y:Ae.y+f.y},m,me);s.lineTo(be[0],be[1])}s.closePath();for(var Oe=0,M=0;M<Ae.length;M++)Oe+=Ae[M].count||1;Ae.count=Oe,s.fillStyle=se.getColor(Oe),s.fill(),a.strokeStyle&&a.lineWidth&&s.stroke()}if(a.label&&a.label.show!==!1){s.fillStyle=a.label.fillStyle||"white",a.label.font&&(s.font=a.label.font),a.label.shadowColor&&(s.shadowColor=a.label.shadowColor),a.label.shadowBlur&&(s.shadowBlur=a.label.shadowBlur);for(var d in I){var Ae=I[d],Ne=Ae.count;Ne<0?Ne=Ne.toFixed(2):Ne=~~Ne;var Zt=s.measureText(Ne).width;s.fillText(Ne,Ae.x+f.x-Zt/2,Ae.y+f.y+5)}}s.restore()}};function tn(u,s,o){var a=u.createShader(o);return u.shaderSource(a,s),u.compileShader(a),a}function Jr(u,s,o){var a=tn(u,s,u.VERTEX_SHADER),l=tn(u,o,u.FRAGMENT_SHADER),d=u.createProgram();return u.attachShader(d,a),u.attachShader(d,l),u.linkProgram(d),u.useProgram(d),d}function Zr(u){var s=document.createElement("canvas"),o=s.getContext("2d");return s.width=1,s.height=1,o.fillStyle=u,o.fillRect(0,0,1,1),o.getImageData(0,0,1,1).data}var io=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),no=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function so(u,s,o){if(!!s){var a=Jr(u,io,no);u.enable(u.BLEND),u.blendFunc(u.SRC_ALPHA,u.ONE),u.clear(u.COLOR_BUFFER_BIT);var l=u.canvas.width/2,d=u.canvas.height/2,f=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,f);var m=u.getAttribLocation(a,"a_Position");u.vertexAttribPointer(m,2,u.FLOAT,!1,0,0),u.enableVertexAttribArray(m);var S=u.getUniformLocation(a,"u_FragColor"),C=Zr(o.strokeStyle||"red");u.uniform4f(S,C[0]/255,C[1]/255,C[2]/255,C[3]/255),u.lineWidth(o.lineWidth||1);for(var I=0,M=s.length;I<M;I++){for(var F=s[I].geometry._coordinates,T=[],G=0;G<F.length;G++){var B=F[G],V=(B[0]-l)/l,H=(d-B[1])/d;T.push(V,H)}var Z=new Float32Array(T);u.bufferData(u.ARRAY_BUFFER,Z,u.STATIC_DRAW),u.drawArrays(u.LINE_STRIP,0,F.length)}}}var rn={draw:so},ao=["attribute vec4 a_Position;","attribute float a_PointSize;","void main() {","gl_Position = a_Position;","gl_PointSize = a_PointSize;","}"].join(""),oo=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function lo(u,s,o){if(!!s){var a=Jr(u,ao,oo),l=u.getAttribLocation(a,"a_Position"),d=u.getAttribLocation(a,"a_PointSize"),f=u.getUniformLocation(a,"u_FragColor");u.clear(u.COLOR_BUFFER_BIT);for(var m=u.canvas.width/2,S=u.canvas.height/2,C=[],I=0,M=0;M<s.length;M++){var F=s[M].geometry._coordinates,T=(F[0]-m)/m,G=(S-F[1])/S;T<-1||T>1||G<-1||G>1||(C.push(T,G),I++)}var B=new Float32Array(C),V=I,H=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,H),u.bufferData(u.ARRAY_BUFFER,B,u.STATIC_DRAW),u.vertexAttribPointer(l,2,u.FLOAT,!1,0,0),u.enableVertexAttribArray(l),u.vertexAttrib1f(d,o._size);var Z=Zr(o.fillStyle||"red");u.uniform4f(f,Z[0]/255,Z[1]/255,Z[2]/255,Z[3]/255),u.drawArrays(u.POINTS,0,V)}}var nn={draw:lo};function dr(u,s,o){o=o||2;var a=s&&s.length,l=a?s[0]*o:u.length,d=sn(u,0,l,o,!0),f=[];if(!d)return f;var m,S,C,I,M,F,T;if(a&&(d=po(u,s,d,o)),u.length>80*o){m=C=u[0],S=I=u[1];for(var G=o;G<l;G+=o)M=u[G],F=u[G+1],M<m&&(m=M),F<S&&(S=F),M>C&&(C=M),F>I&&(I=F);T=Math.max(C-m,I-S)}return Ut(d,f,o,m,S,T),f}function sn(u,s,o,a,l){var d,f;if(l===Qr(u,s,o,a)>0)for(d=s;d<o;d+=a)f=ln(d,u[d],u[d+1],f);else for(d=o-a;d>=s;d-=a)f=ln(d,u[d],u[d+1],f);return f&&ht(f,f.next)&&(Vt(f),f=f.next),f}function zt(u,s){if(!u)return u;s||(s=u);var o=u,a;do if(a=!1,!o.steiner&&(ht(o,o.next)||Me(o.prev,o,o.next)===0)){if(Vt(o),o=s=o.prev,o===o.next)return null;a=!0}else o=o.next;while(a||o!==s);return s}function Ut(u,s,o,a,l,d,f){if(!!u){!f&&d&&mo(u,a,l,d);for(var m=u,S,C;u.prev!==u.next;){if(S=u.prev,C=u.next,d?ho(u,a,l,d):uo(u)){s.push(S.i/o),s.push(u.i/o),s.push(C.i/o),Vt(u),u=C.next,m=C.next;continue}if(u=C,u===m){f?f===1?(u=co(u,s,o),Ut(u,s,o,a,l,d,2)):f===2&&fo(u,s,o,a,l,d):Ut(zt(u),s,o,a,l,d,1);break}}}}function uo(u){var s=u.prev,o=u,a=u.next;if(Me(s,o,a)>=0)return!1;for(var l=u.next.next;l!==u.prev;){if(fr(s.x,s.y,o.x,o.y,a.x,a.y,l.x,l.y)&&Me(l.prev,l,l.next)>=0)return!1;l=l.next}return!0}function ho(u,s,o,a){var l=u.prev,d=u,f=u.next;if(Me(l,d,f)>=0)return!1;for(var m=l.x<d.x?l.x<f.x?l.x:f.x:d.x<f.x?d.x:f.x,S=l.y<d.y?l.y<f.y?l.y:f.y:d.y<f.y?d.y:f.y,C=l.x>d.x?l.x>f.x?l.x:f.x:d.x>f.x?d.x:f.x,I=l.y>d.y?l.y>f.y?l.y:f.y:d.y>f.y?d.y:f.y,M=Kr(m,S,s,o,a),F=Kr(C,I,s,o,a),T=u.nextZ;T&&T.z<=F;){if(T!==u.prev&&T!==u.next&&fr(l.x,l.y,d.x,d.y,f.x,f.y,T.x,T.y)&&Me(T.prev,T,T.next)>=0)return!1;T=T.nextZ}for(T=u.prevZ;T&&T.z>=M;){if(T!==u.prev&&T!==u.next&&fr(l.x,l.y,d.x,d.y,f.x,f.y,T.x,T.y)&&Me(T.prev,T,T.next)>=0)return!1;T=T.prevZ}return!0}function co(u,s,o){var a=u;do{var l=a.prev,d=a.next.next;!ht(l,d)&&an(l,a,a.next,d)&&qt(l,d)&&qt(d,l)&&(s.push(l.i/o),s.push(a.i/o),s.push(d.i/o),Vt(a),Vt(a.next),a=u=d),a=a.next}while(a!==u);return a}function fo(u,s,o,a,l,d){var f=u;do{for(var m=f.next.next;m!==f.prev;){if(f.i!==m.i&&So(f,m)){var S=on(f,m);f=zt(f,f.next),S=zt(S,S.next),Ut(f,s,o,a,l,d),Ut(S,s,o,a,l,d);return}m=m.next}f=f.next}while(f!==u)}function po(u,s,o,a){var l=[],d,f,m,S,C;for(d=0,f=s.length;d<f;d++)m=s[d]*a,S=d<f-1?s[d+1]*a:u.length,C=sn(u,m,S,a,!1),C===C.next&&(C.steiner=!0),l.push(xo(C));for(l.sort(go),d=0;d<l.length;d++)vo(l[d],o),o=zt(o,o.next);return o}function go(u,s){return u.x-s.x}function vo(u,s){if(s=yo(u,s),s){var o=on(s,u);zt(o,o.next)}}function yo(u,s){var o=s,a=u.x,l=u.y,d=-1/0,f;do{if(l<=o.y&&l>=o.next.y){var m=o.x+(l-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(m<=a&&m>d){if(d=m,m===a){if(l===o.y)return o;if(l===o.next.y)return o.next}f=o.x<o.next.x?o:o.next}}o=o.next}while(o!==s);if(!f)return null;if(a===d)return f.prev;var S=f,C=f.x,I=f.y,M=1/0,F;for(o=f.next;o!==S;)a>=o.x&&o.x>=C&&fr(l<I?a:d,l,C,I,l<I?d:a,l,o.x,o.y)&&(F=Math.abs(l-o.y)/(a-o.x),(F<M||F===M&&o.x>f.x)&&qt(o,u)&&(f=o,M=F)),o=o.next;return f}function mo(u,s,o,a){var l=u;do l.z===null&&(l.z=Kr(l.x,l.y,s,o,a)),l.prevZ=l.prev,l.nextZ=l.next,l=l.next;while(l!==u);l.prevZ.nextZ=null,l.prevZ=null,wo(l)}function wo(u){var s,o,a,l,d,f,m,S,C=1;do{for(o=u,u=null,d=null,f=0;o;){for(f++,a=o,m=0,s=0;s<C&&(m++,a=a.nextZ,!!a);s++);for(S=C;m>0||S>0&&a;)m===0?(l=a,a=a.nextZ,S--):S===0||!a||o.z<=a.z?(l=o,o=o.nextZ,m--):(l=a,a=a.nextZ,S--),d?d.nextZ=l:u=l,l.prevZ=d,d=l;o=a}d.nextZ=null,C*=2}while(f>1);return u}function Kr(u,s,o,a,l){return u=32767*(u-o)/l,s=32767*(s-a)/l,u=(u|u<<8)&16711935,u=(u|u<<4)&252645135,u=(u|u<<2)&858993459,u=(u|u<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,u|s<<1}function xo(u){var s=u,o=u;do s.x<o.x&&(o=s),s=s.next;while(s!==u);return o}function fr(u,s,o,a,l,d,f,m){return(l-f)*(s-m)-(u-f)*(d-m)>=0&&(u-f)*(a-m)-(o-f)*(s-m)>=0&&(o-f)*(d-m)-(l-f)*(a-m)>=0}function So(u,s){return u.next.i!==s.i&&u.prev.i!==s.i&&!Co(u,s)&&qt(u,s)&&qt(s,u)&&Eo(u,s)}function Me(u,s,o){return(s.y-u.y)*(o.x-s.x)-(s.x-u.x)*(o.y-s.y)}function ht(u,s){return u.x===s.x&&u.y===s.y}function an(u,s,o,a){return ht(u,s)&&ht(o,a)||ht(u,a)&&ht(o,s)?!0:Me(u,s,o)>0!=Me(u,s,a)>0&&Me(o,a,u)>0!=Me(o,a,s)>0}function Co(u,s){var o=u;do{if(o.i!==u.i&&o.next.i!==u.i&&o.i!==s.i&&o.next.i!==s.i&&an(o,o.next,u,s))return!0;o=o.next}while(o!==u);return!1}function qt(u,s){return Me(u.prev,u,u.next)<0?Me(u,s,u.next)>=0&&Me(u,u.prev,s)>=0:Me(u,s,u.prev)<0||Me(u,u.next,s)<0}function Eo(u,s){var o=u,a=!1,l=(u.x+s.x)/2,d=(u.y+s.y)/2;do o.y>d!=o.next.y>d&&l<(o.next.x-o.x)*(d-o.y)/(o.next.y-o.y)+o.x&&(a=!a),o=o.next;while(o!==u);return a}function on(u,s){var o=new jr(u.i,u.x,u.y),a=new jr(s.i,s.x,s.y),l=u.next,d=s.prev;return u.next=s,s.prev=u,o.next=l,l.prev=o,a.next=o,o.prev=a,d.next=a,a.prev=d,a}function ln(u,s,o,a){var l=new jr(u,s,o);return a?(l.next=a.next,l.prev=a,a.next.prev=l,a.next=l):(l.prev=l,l.next=l),l}function Vt(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function jr(u,s,o){this.i=u,this.x=s,this.y=o,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}dr.deviation=function(u,s,o,a){var l=s&&s.length,d=l?s[0]*o:u.length,f=Math.abs(Qr(u,0,d,o));if(l)for(var m=0,S=s.length;m<S;m++){var C=s[m]*o,I=m<S-1?s[m+1]*o:u.length;f-=Math.abs(Qr(u,C,I,o))}var M=0;for(m=0;m<a.length;m+=3){var F=a[m]*o,T=a[m+1]*o,G=a[m+2]*o;M+=Math.abs((u[F]-u[G])*(u[T+1]-u[F+1])-(u[F]-u[T])*(u[G+1]-u[F+1]))}return f===0&&M===0?0:Math.abs((M-f)/f)};function Qr(u,s,o,a){for(var l=0,d=s,f=o-a;d<o;d+=a)l+=(u[f]-u[d])*(u[d+1]+u[f+1]),f=d;return l}dr.flatten=function(u){for(var s=u[0][0].length,o={vertices:[],holes:[],dimensions:s},a=0,l=0;l<u.length;l++){for(var d=0;d<u[l].length;d++)for(var f=0;f<s;f++)o.vertices.push(u[l][d][f]);l>0&&(a+=u[l-1].length,o.holes.push(a))}return o};var bo=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),Po=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function Ao(u,s,o){if(!!s){u.clear(u.COLOR_BUFFER_BIT),u.viewport(0,0,u.canvas.width,u.canvas.height);var a=Jr(u,bo,Po);u.enable(u.BLEND),u.blendFunc(u.SRC_ALPHA,u.ONE);var l=u.canvas.width/2,d=u.canvas.height/2;u.bindBuffer(u.ARRAY_BUFFER,u.createBuffer()),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,u.createBuffer());var f=u.getAttribLocation(a,"a_Position");u.vertexAttribPointer(f,2,u.FLOAT,!1,0,0),u.enableVertexAttribArray(f);var m=u.getUniformLocation(a,"u_FragColor"),S=Zr(o.fillStyle||"red");u.uniform4f(m,S[0]/255,S[1]/255,S[2]/255,S[3]/255),u.lineWidth(o.lineWidth||1);for(var C=[],I=[],M=65536,F=0,T=0,G=s.length;T<G;T++){var B=dr.flatten(s[T].geometry._coordinates||s[T].geometry.coordinates),V=B.vertices;F=C.length/2;for(var H=0;H<V.length;H+=2)V[H]=(V[H]-l)/l,V[H+1]=(d-V[H+1])/d;(C.length+V.length)/2>M&&(u.bufferData(u.ARRAY_BUFFER,new Float32Array(C),u.STATIC_DRAW),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(I),u.STATIC_DRAW),u.drawElements(u.TRIANGLES,I.length,u.UNSIGNED_SHORT,0),C.length=0,I.length=0,F=0);for(var H=0;H<V.length;H++)C.push(V[H]);for(var Z=dr(V,B.holes,B.dimensions),H=0;H<Z.length;H++)I.push(Z[H]+F)}u.bufferData(u.ARRAY_BUFFER,new Float32Array(C),u.STATIC_DRAW),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(I),u.STATIC_DRAW),u.drawElements(u.TRIANGLES,I.length,u.UNSIGNED_SHORT,0),u.bindBuffer(u.ARRAY_BUFFER,null),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null)}}var un={draw:Ao},hn={draw:function(s,o,a){var l=o instanceof x?o.get():o;l.length>0&&(l[0].geometry.type=="LineString"?rn.draw(s,l,a):l[0].geometry.type=="Polygon"||l[0].geometry.type=="MultiPolygon"?un.draw(s,l,a):nn.draw(s,l,a))}};function Lo(u,s){s=s||{};for(var o=[],a=0;a<u.length-1;a++){var l=Mo(u[a],u[a+1],s.count);l&&l.length>0&&(o=o.concat(l))}return o}function Mo(u,s,m){if(!u||!s)return null;var a=function(se){return 1-2*se+se*se},l=function(se){return 2*se-2*se*se},d=function(se){return se*se},f=[],m=m||40,S,C,I,M,F,T,G=0,B=0;if(typeof s>"u"){typeof f<"u"&&(f=[]);return}var V=parseFloat(u.lat),H=parseFloat(s.lat),Z=parseFloat(u.lng),ne=parseFloat(s.lng);for(ne>Z&&parseFloat(ne-Z)>180&&Z<0&&(Z=parseFloat(360+Z),ne=parseFloat(360+ne)),T=0,H==V?(S=0,C=Z-ne):ne==Z?(S=Math.PI/2,C=V-H):(S=Math.atan((H-V)/(ne-Z)),C=(H-V)/Math.sin(S)),T==0&&(T=S+Math.PI/5),I=C/2,F=I*Math.cos(T)+Z,M=I*Math.sin(T)+V,G=0;G<m+1;G++){var K=Z*a(B)+F*l(B)+ne*d(B),X=V*a(B)+M*l(B)+H*d(B),he=u.lng,ye=s.lng;f.push([he<0&&ye>0?K-360:K,X]),B=B+1/m}return f}var Io={getPoints:Lo},To=function(){var s={},o=[],a=[],l=[],d=.1,f=.1,m=1,S=2,C=6,I=70,M=.6666667,F=.6,T=1e-8;function G(D,U){return D.x*U.x+D.y*U.y}function B(D){return{x:s[D.target].x-s[D.source].x,y:s[D.target].y-s[D.source].y}}function V(D){return Math.sqrt(Math.pow(s[D.source].x-s[D.target].x,2)+Math.pow(s[D.source].y-s[D.target].y,2))}function H(D){return Math.sqrt(Math.pow(D.source.x-D.target.x,2)+Math.pow(D.source.y-D.target.y,2))}function Z(D){var U=(s[D.source].x+s[D.target].x)/2,te=(s[D.source].y+s[D.target].y)/2;return{x:U,y:te}}function ne(D){for(var U=0,te=1;te<l[D].length;te++){var ae=K(l[D][te],l[D][te-1]);U+=ae}return U}function K(D,U){return Math.sqrt(Math.pow(D.x-U.x,2)+Math.pow(D.y-U.y,2))}function X(D,U){var te=Math.sqrt((U.target.x-U.source.x)*(U.target.x-U.source.x)+(U.target.y-U.source.y)*(U.target.y-U.source.y)),ae=((U.source.y-D.y)*(U.source.y-U.target.y)-(U.source.x-D.x)*(U.target.x-U.source.x))/(te*te);return{x:U.source.x+ae*(U.target.x-U.source.x),y:U.source.y+ae*(U.target.y-U.source.y)}}function he(){for(var D=0;D<o.length;D++)l[D]=[]}function ye(){for(var D=0;D<o.length;D++)a[D]=[]}function oe(D){for(var U=[],te=0;te<D.length;te++)s[D[te].source].x!=s[D[te].target].x&&s[D[te].source].y!=s[D[te].target].y&&U.push(D[te]);return U}function se(D,U,te){var ae=l[D][U-1],ge=l[D][U+1],fe=l[D][U],ce=ae.x-fe.x+ge.x-fe.x,Pe=ae.y-fe.y+ge.y-fe.y;return ce*=te,Pe*=te,{x:ce,y:Pe}}function Ae(D,U,te){for(var ae={x:0,y:0},ge=a[D],fe=0;fe<ge.length;fe++){var ce={x:l[ge[fe]][U].x-l[D][U].x,y:l[ge[fe]][U].y-l[D][U].y};if(Math.abs(ce.x)>T||Math.abs(ce.y)>T){var Pe=1/Math.pow(H({source:l[ge[fe]][U],target:l[D][U]}),1);ae.x+=ce.x*Pe,ae.y+=ce.y*Pe}}return ae}function me(D,U,te){for(var ae=d/(V(o[D])*(U+1)),ge=[{x:0,y:0}],fe=1;fe<U+1;fe++){var ce={x:0,y:0},Pe=se(D,fe,ae),ze=Ae(D,fe);ce.x=te*(Pe.x+ze.x),ce.y=te*(Pe.y+ze.y),ge.push(ce)}return ge.push({x:0,y:0}),ge}function be(D){for(var U=0;U<o.length;U++)if(D==1)l[U].push(s[o[U].source]),l[U].push(Z(o[U])),l[U].push(s[o[U].target]);else{var te=ne(U),ae=te/(D+1),ge=ae,fe=[];fe.push(s[o[U].source]);for(var ce=1;ce<l[U].length;ce++){for(var Pe=K(l[U][ce],l[U][ce-1]);Pe>ge;){var ze=ge/Pe,rt=l[U][ce-1].x,Pn=l[U][ce-1].y;rt+=ze*(l[U][ce].x-l[U][ce-1].x),Pn+=ze*(l[U][ce].y-l[U][ce-1].y),fe.push({x:rt,y:Pn}),Pe-=ge,ge=ae}ge-=Pe}fe.push(s[o[U].target]),l[U]=fe}}function Oe(D,U){var te=Math.abs(G(B(D),B(U))/(V(D)*V(U)));return te}function Ne(D,U){var te=(V(D)+V(U))/2,ae=2/(te/Math.min(V(D),V(U))+Math.max(V(D),V(U))/te);return ae}function Zt(D,U){var te=(V(D)+V(U))/2,ae={x:(s[D.source].x+s[D.target].x)/2,y:(s[D.source].y+s[D.target].y)/2},ge={x:(s[U.source].x+s[U.target].x)/2,y:(s[U.source].y+s[U.target].y)/2},fe=te/(te+K(ae,ge));return fe}function Mt(D,U){var te=X(s[U.source],{source:s[D.source],target:s[D.target]}),ae=X(s[U.target],{source:s[D.source],target:s[D.target]}),ge={x:(te.x+ae.x)/2,y:(te.y+ae.y)/2},fe={x:(s[D.source].x+s[D.target].x)/2,y:(s[D.source].y+s[D.target].y)/2},ce=Math.max(0,1-2*K(fe,ge)/K(te,ae));return ce}function yl(D,U){return Math.min(Mt(D,U),Mt(U,D))}function ml(D,U){var te=Oe(D,U)*Ne(D,U)*Zt(D,U)*yl(D,U);return te}function wl(D,U){return ml(D,U)>=F}function xl(){for(var D=0;D<o.length-1;D++)for(var U=D+1;U<o.length;U++)D!=U&&wl(o[D],o[U])&&(a[D].push(U),a[U].push(D))}var xe=function(){var U=f,te=I,ae=m;he(),ye(),be(ae),xl();for(var ge=0;ge<C;ge++){for(var fe=0;fe<te;fe++){for(var ce=[],Pe=0;Pe<o.length;Pe++)ce[Pe]=me(Pe,ae,U);for(var ze=0;ze<o.length;ze++)for(var rt=0;rt<ae+1;rt++)l[ze][rt].x+=ce[ze][rt].x,l[ze][rt].y+=ce[ze][rt].y}U=U/2,ae=ae*2,te=M*te,be(ae)}return l};return xe.nodes=function(D){return arguments.length==0?s:(s=D,xe)},xe.edges=function(D){return arguments.length==0?o:(o=oe(D),xe)},xe.bundling_stiffness=function(D){return arguments.length==0?d:(d=D,xe)},xe.step_size=function(D){return arguments.length==0?f:(f=D,xe)},xe.cycles=function(D){return arguments.length==0?C:(C=D,xe)},xe.iterations=function(D){return arguments.length==0?I:(I=D,xe)},xe.iterations_rate=function(D){return arguments.length==0?M:(M=D,xe)},xe.subdivision_points_seed=function(D){return arguments.length==0?P:(P=D,xe)},xe.subdivision_rate=function(D){return arguments.length==0?S:(S=D,xe)},xe.compatbility_threshold=function(D){return arguments.length==0?compatbility_threshold:(F=D,xe)},xe};function Wt(u){this.splitList=u||{other:1}}Wt.prototype.get=function(u){var s=this.splitList,o=s.other;for(var a in s)if(u==a){o=s[a];break}return o},Wt.prototype.generateByDataSet=function(u,s){var o=s||["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],a=u.get();this.splitList={};for(var l=0,d=0;d<a.length&&(this.splitList[a[d].count]===void 0&&(this.splitList[a[d].count]=o[l],l++),!(l>=o.length-1));d++);this.splitList.other=o[o.length-1]},Wt.prototype.getLegend=function(u){var s=this.splitList,o=document.createElement("div");o.style.cssText="background:#fff; padding: 5px; border: 1px solid #ccc;";var a="";for(var l in s)a+='<div style="line-height: 19px;" value="'+l+'"><span style="vertical-align: -2px; display: inline-block; width: 30px;height: 19px;background:'+s[l]+';"></span><span style="margin-left: 3px;">'+l+"<span></div>";return o.innerHTML=a,o};function Lt(u){this.splitList=u||[{start:0,value:"red"}]}Lt.prototype.get=function(u){for(var s=this.splitList,o=!1,a=0;a<s.length;a++)if((s[a].start===void 0||s[a].start!==void 0&&u>=s[a].start)&&(s[a].end===void 0||s[a].end!==void 0&&u<s[a].end)){o=s[a].value;break}return o},Lt.prototype.generateByDataSet=function(u){var s=u.getMin("count"),o=u.getMax("count");this.generateByMinMax(s,o)},Lt.prototype.generateByMinMax=function(u,s){var o=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],a=Number((s-u)/7);s=Number(s);var l=Number(u);this.splitList=[];for(var d=0;l<s;)this.splitList.push({start:l,end:l+a,value:o[d]}),d++,l+=a},Lt.prototype.getLegend=function(u){this.splitList};var _o=function(){function u(s,o,a){if(y(this,u),!s||!o)return console.warn("id \u548C type \u4E3A\u5FC5\u586B\u9879"),!1;if(o=="baidu"){if(!BMap)return console.warn("\u8BF7\u5148\u5F15\u5165\u767E\u5EA6\u5730\u56FEJS API"),!1}else console.warn("\u6682\u4E0D\u652F\u6301\u4F60\u7684\u5730\u56FE\u7C7B\u578B");this.type=o;var l=a&&a.center?a.center:[106.962497,38.208726],d=a&&a.zoom?a.zoom:5,f=this.map=new BMap.Map(s,{enableMapClick:!1});f.centerAndZoom(new BMap.Point(l[0],l[1]),d),f.enableScrollWheelZoom(!0),f.setMapStyle({style:"light"})}return w(u,[{key:"addLayer",value:function(o,a){if(this.type=="baidu")return new mapv.baiduMapLayer(this.map,dataSet,a)}},{key:"getMap",value:function(){return this.map}}]),u}();function Ge(u){this.options=u||{},this.paneName=this.options.paneName||"mapPane",this.context=this.options.context||"2d",this.zIndex=this.options.zIndex||0,this.mixBlendMode=this.options.mixBlendMode||null,this.enableMassClear=this.options.enableMassClear,this._map=u.map,this._lastDrawTime=null,this.show()}var Yr=typeof window>"u"?{}:window,cn=Yr.BMap||Yr.BMapGL;cn&&(Ge.prototype=new cn.Overlay,Ge.prototype.initialize=function(u){this._map=u;var s=this.canvas=document.createElement("canvas");s.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";user-select:none;",s.style.mixBlendMode=this.mixBlendMode,this.adjustSize();var o=u.getPanes()[this.paneName];o||(o=u.getPanes().floatShadow),o.appendChild(s);var a=this;return u.addEventListener("resize",function(){a.adjustSize(),a._draw()}),u.addEventListener("update",function(){a._draw()}),this.options.updateImmediate&&setTimeout(function(){a._draw()},100),this.canvas},Ge.prototype.adjustSize=function(){var u=this._map.getSize(),s=this.canvas,o=this.devicePixelRatio=Yr.devicePixelRatio||1;s.width=u.width*o,s.height=u.height*o,this.context=="2d"&&s.getContext(this.context).scale(o,o),s.style.width=u.width+"px",s.style.height=u.height+"px"},Ge.prototype.draw=function(){var u=this;this.options.updateImmediate?u._draw():(clearTimeout(u.timeoutID),u.timeoutID=setTimeout(function(){u._draw()},15))},Ge.prototype._draw=function(){var u=this._map,s=u.getSize(),o=u.getCenter();if(o){var a=u.pointToOverlayPixel(o);this.canvas.style.left=a.x-s.width/2+"px",this.canvas.style.top=a.y-s.height/2+"px",this.dispatchEvent("draw"),this.options.update&&this.options.update.call(this)}},Ge.prototype.getContainer=function(){return this.canvas},Ge.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},Ge.prototype.hide=function(){this.canvas.style.display="none"},Ge.prototype.setZIndex=function(u){this.zIndex=u,this.canvas.style.zIndex=this.zIndex},Ge.prototype.getZIndex=function(){return this.zIndex});var ve=ve||function(){var u=[];return{getAll:function(){return u},removeAll:function(){u=[]},add:function(o){u.push(o)},remove:function(o){var a=u.indexOf(o);a!==-1&&u.splice(a,1)},update:function(o,a){if(u.length===0)return!1;var l=0;for(o=o!==void 0?o:ve.now();l<u.length;)u[l].update(o)||a?l++:u.splice(l,1);return!0}}}();typeof window>"u"&&typeof process<"u"?ve.now=function(){var u=process.hrtime();return u[0]*1e3+u[1]/1e6}:typeof window<"u"&&window.performance!==void 0&&window.performance.now!==void 0?ve.now=window.performance.now.bind(window.performance):Date.now!==void 0?ve.now=Date.now:ve.now=function(){return new Date().getTime()},ve.Tween=function(u){var s=u,o={},a={},l={},d=1e3,f=0,m,S=!1,C=!1,I=0,M=null,F=ve.Easing.Linear.None,T=ve.Interpolation.Linear,G=[],B=null,V=!1,H=null,Z=null,ne=null;this.to=function(K,X){return a=K,X!==void 0&&(d=X),this},this.start=function(K){ve.add(this),C=!0,V=!1,M=K!==void 0?K:ve.now(),M+=I;for(var X in a){if(a[X]instanceof Array){if(a[X].length===0)continue;a[X]=[s[X]].concat(a[X])}s[X]!==void 0&&(o[X]=s[X],o[X]instanceof Array||(o[X]*=1),l[X]=o[X]||0)}return this},this.stop=function(){return C?(ve.remove(this),C=!1,ne!==null&&ne.call(s,s),this.stopChainedTweens(),this):this},this.end=function(){return this.update(M+d),this},this.stopChainedTweens=function(){for(var K=0,X=G.length;K<X;K++)G[K].stop()},this.delay=function(K){return I=K,this},this.repeat=function(K){return f=K,this},this.repeatDelay=function(K){return m=K,this},this.yoyo=function(K){return S=K,this},this.easing=function(K){return F=K,this},this.interpolation=function(K){return T=K,this},this.chain=function(){return G=arguments,this},this.onStart=function(K){return B=K,this},this.onUpdate=function(K){return H=K,this},this.onComplete=function(K){return Z=K,this},this.onStop=function(K){return ne=K,this},this.update=function(K){var X,he,ye;if(K<M)return!0;V===!1&&(B!==null&&B.call(s,s),V=!0),he=(K-M)/d,he=he>1?1:he,ye=F(he);for(X in a)if(o[X]!==void 0){var oe=o[X]||0,se=a[X];se instanceof Array?s[X]=T(se,ye):(typeof se=="string"&&(se.charAt(0)==="+"||se.charAt(0)==="-"?se=oe+parseFloat(se):se=parseFloat(se)),typeof se=="number"&&(s[X]=oe+(se-oe)*ye))}if(H!==null&&H.call(s,ye),he===1)if(f>0){isFinite(f)&&f--;for(X in l){if(typeof a[X]=="string"&&(l[X]=l[X]+parseFloat(a[X])),S){var Ae=l[X];l[X]=a[X],a[X]=Ae}o[X]=l[X]}return m!==void 0?M=K+m:M=K+I,!0}else{Z!==null&&Z.call(s,s);for(var me=0,be=G.length;me<be;me++)G[me].start(M+d);return!1}return!0}},ve.Easing={Linear:{None:function(s){return s}},Quadratic:{In:function(s){return s*s},Out:function(s){return s*(2-s)},InOut:function(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)}},Cubic:{In:function(s){return s*s*s},Out:function(s){return--s*s*s+1},InOut:function(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)}},Quartic:{In:function(s){return s*s*s*s},Out:function(s){return 1- --s*s*s*s},InOut:function(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)}},Quintic:{In:function(s){return s*s*s*s*s},Out:function(s){return--s*s*s*s*s+1},InOut:function(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)}},Sinusoidal:{In:function(s){return 1-Math.cos(s*Math.PI/2)},Out:function(s){return Math.sin(s*Math.PI/2)},InOut:function(s){return .5*(1-Math.cos(Math.PI*s))}},Exponential:{In:function(s){return s===0?0:Math.pow(1024,s-1)},Out:function(s){return s===1?1:1-Math.pow(2,-10*s)},InOut:function(s){return s===0?0:s===1?1:(s*=2)<1?.5*Math.pow(1024,s-1):.5*(-Math.pow(2,-10*(s-1))+2)}},Circular:{In:function(s){return 1-Math.sqrt(1-s*s)},Out:function(s){return Math.sqrt(1- --s*s)},InOut:function(s){return(s*=2)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)}},Elastic:{In:function(s){return s===0?0:s===1?1:-Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI)},Out:function(s){return s===0?0:s===1?1:Math.pow(2,-10*s)*Math.sin((s-.1)*5*Math.PI)+1},InOut:function(s){return s===0?0:s===1?1:(s*=2,s<1?-.5*Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI):.5*Math.pow(2,-10*(s-1))*Math.sin((s-1.1)*5*Math.PI)+1)}},Back:{In:function(s){var o=1.70158;return s*s*((o+1)*s-o)},Out:function(s){var o=1.70158;return--s*s*((o+1)*s+o)+1},InOut:function(s){var o=2.5949095;return(s*=2)<1?.5*(s*s*((o+1)*s-o)):.5*((s-=2)*s*((o+1)*s+o)+2)}},Bounce:{In:function(s){return 1-ve.Easing.Bounce.Out(1-s)},Out:function(s){return s<.36363636363636365?7.5625*s*s:s<.7272727272727273?7.5625*(s-=.5454545454545454)*s+.75:s<.9090909090909091?7.5625*(s-=.8181818181818182)*s+.9375:7.5625*(s-=.9545454545454546)*s+.984375},InOut:function(s){return s<.5?ve.Easing.Bounce.In(s*2)*.5:ve.Easing.Bounce.Out(s*2-1)*.5+.5}}},ve.Interpolation={Linear:function(s,o){var a=s.length-1,l=a*o,d=Math.floor(l),f=ve.Interpolation.Utils.Linear;return o<0?f(s[0],s[1],l):o>1?f(s[a],s[a-1],a-l):f(s[d],s[d+1>a?a:d+1],l-d)},Bezier:function(s,o){for(var a=0,l=s.length-1,d=Math.pow,f=ve.Interpolation.Utils.Bernstein,m=0;m<=l;m++)a+=d(1-o,l-m)*d(o,m)*s[m]*f(l,m);return a},CatmullRom:function(s,o){var a=s.length-1,l=a*o,d=Math.floor(l),f=ve.Interpolation.Utils.CatmullRom;return s[0]===s[a]?(o<0&&(d=Math.floor(l=a*(1+o))),f(s[(d-1+a)%a],s[d],s[(d+1)%a],s[(d+2)%a],l-d)):o<0?s[0]-(f(s[0],s[0],s[1],s[1],-l)-s[0]):o>1?s[a]-(f(s[a],s[a],s[a-1],s[a-1],l-a)-s[a]):f(s[d?d-1:0],s[d],s[a<d+1?a:d+1],s[a<d+2?a:d+2],l-d)},Utils:{Linear:function(s,o,a){return(o-s)*a+s},Bernstein:function(s,o){var a=ve.Interpolation.Utils.Factorial;return a(s)/a(o)/a(s-o)},Factorial:function(){var u=[1];return function(s){var o=1;if(u[s])return u[s];for(var a=s;a>1;a--)o*=a;return u[s]=o,o}}(),CatmullRom:function(s,o,a,l,d){var f=(a-s)*.5,m=(l-o)*.5,S=d*d,C=d*S;return(2*o-2*a+f+m)*C+(-3*o+3*a-2*f-m)*S+f*d+o}}};function ko(u,s){var o=s[0]-u[0],a=s[1]-u[1],l=360*Math.atan(a/o)/(2*Math.PI);return s[0]<u[0]&&(l=l+180),l}var pr={},dn={draw:function(s,o,a){var l="http://huiyan.baidu.com/github/tools/gis-drawing/static/images/direction.png";a.arrow&&a.arrow.url&&(l=a.arrow.url),pr[l]||(pr[l]=null);var d=pr[l];if(!d){var f=Array.prototype.slice.call(arguments),m=new Image;m.onload=function(){pr[l]=m,dn.draw.apply(null,f)},m.src=l;return}var S=o instanceof x?o.get():o;s.save();for(var C in a)s[C]=a[C];for(var I=null,M=0,F=S.length;M<F;M++){var T=S[M];s.save(),(T.fillStyle||T._fillStyle)&&(s.fillStyle=T.fillStyle||T._fillStyle),(T.strokeStyle||T._strokeStyle)&&(s.strokeStyle=T.strokeStyle||T._strokeStyle);var G=T.geometry.type;if(s.beginPath(),G==="LineString"){for(var B=T.geometry._coordinates||T.geometry.coordinates,V=a.arrow.interval!==void 0?a.arrow.interval:1,H=0;H<B.length;H+=V)if(B[H]&&B[H+1]){var Z=B[H];if(I&&Fo(Z,I)<30)continue;s.save();var ne=ko(B[H],B[H+1]);s.translate(Z[0],Z[1]),s.rotate(ne*Math.PI/180),s.drawImage(d,-d.width/2/2,-d.height/2/2,d.width/2,d.height/2),s.restore(),I=Z}}s.restore()}s.restore()}};function Fo(u,s){return Math.sqrt(Math.pow(u[0]-s[0],2)+Math.pow(u[1]-s[1],2))}var Ro={draw:function(s,o,a){var l=o instanceof x?o.get():o;s.save(),s.fillStyle=a.fillStyle||"rgba(0, 0, 0, 0.5)",s.fillRect(0,0,s.canvas.width,s.canvas.height),a.multiPolygonDraw=function(){s.save(),s.clip(),i(s),s.restore()};for(var d=0,f=l.length;d<f;d++)s.beginPath(),R.drawDataSet(s,[l[d]],a),s.save(),s.clip(),i(s),s.restore();s.restore()}},Xr={},et={},Oo={draw:function(s,o,a){s.save();for(var l=o instanceof x?o.get():o,d=0;d<l.length;d++){var f=l[d],m=f.geometry._coordinates||f.geometry.coordinates;if(s.beginPath(),f.properties&&f.properties.cluster){if(s.arc(m[0],m[1],f.size,0,Math.PI*2),s.fillStyle=f.fillStyle,s.fill(),a.label&&a.label.show!==!1){s.fillStyle=a.label.fillStyle||"white",a.label.font&&(s.font=a.label.font),a.label.shadowColor&&(s.shadowColor=a.label.shadowColor),a.label.shadowBlur&&(s.shadowBlur=a.label.shadowBlur);var S=f.properties.point_count,C=s.measureText(S).width;s.fillText(S,m[0]+.5-C/2,m[1]+.5+3)}}else this.drawIcon(f,a,s)}s.restore()},drawIcon:function(s,o,a){var l=s.geometry._coordinates||s.geometry.coordinates,d=z(l,2),f=d[0],m=d[1],S=Object.assign({},o.iconOptions,s.iconOptions),C=function(){a.beginPath(),a.arc(f,m,o.size||5,0,Math.PI*2),a.fillStyle=o.fillStyle||"red",a.fill()};if(!S.url){C();return}var I=S.width,M=S.height,F=S.offset||{x:0,y:0};f=f-~~I/2+F.x,m=m-~~M/2+F.y;var T=window.encodeURIComponent(S.url),G=Xr[T];G?G==="error"?C():I&&M?a.drawImage(G,f,m,I,M):a.drawImage(G,f,m):(et[T]||(et[T]=[],No(T,function(B,V){et[V]&&et[V].forEach(function(H){return H(B)}),et[V]=null,Xr[V]=B},function(B){et[B]&&et[B].forEach(function(V){return V("error",B)}),et[B]=null,Xr[B]="error",C()})),et[T].push(function(B,V,H,Z){return function(ne){ne==="error"?C():H&&Z?a.drawImage(ne,B,V,H,Z):a.drawImage(ne,B,V)}}(f,m,I,M)))}};function No(u,s,o){var a=new Image;a.onload=function(){s&&s(a,u)},a.onerror=function(){o&&o(u)},a.src=window.decodeURIComponent(u)}var Do={draw:function(s,o,a){var l=o instanceof x?o.get():o;s.save();for(var d in a)s[d]=a[d];var f=[],m=a._size||a.size;m?s.font="bold "+m+"px Arial":m=12;var S=a.textKey||"text";if(a.textAlign||(s.textAlign="center"),a.textBaseline||(s.textBaseline="middle"),a.avoid)for(var C=0,I=l.length;C<I;C++){var M=l[C].offset||a.offset||{x:0,y:0},F=l[C].geometry._coordinates||l[C].geometry.coordinates,T=F[0]+M.x,G=F[1]+M.y,B=l[C][S],V=s.measureText(B).width,H=T-V/2,Z=G-m/2,ne={sw:{x:H,y:Z+m},ne:{x:H+V,y:Z}};Go(f,ne)||(f.push(ne),H=H+V/2,Z=Z+m/2,s.fillText(B,H,Z))}else for(var C=0,I=l.length;C<I;C++){var M=l[C].offset||a.offset||{x:0,y:0},F=l[C].geometry._coordinates||l[C].geometry.coordinates,T=F[0]+M.x,G=F[1]+M.y,B=l[C][S];s.fillText(B,T,G)}s.restore()}};function Go(u,s){for(var o=0;o<u.length;o++)if(Bo(u[o],s))return!0;return!1}function Bo(u,s){var o=Math.min(u.ne.x,s.ne.x),a=Math.min(u.sw.y,s.sw.y),l=Math.max(u.sw.x,s.sw.x),d=Math.max(u.ne.y,s.ne.y);return o>l&&a>d}var $r={},tt={},zo={draw:function(s,o,a){for(var l=o instanceof x?o.get():o,d=function(){var I=l[f];if(I.geometry)if(S=I.icon||a.icon,typeof S=="string"){var M=window.encodeURIComponent(S),F=$r[M];F?ei(F,a,s,I):(tt[M]||(tt[M]=[],Uo(M,function(T,G){tt[G]&&tt[G].forEach(function(B){return B(T)}),tt[G]=null,$r[G]=T},function(T){tt[T]&&tt[T].forEach(function(G){return G("error")}),tt[T]=null,$r[T]="error"})),tt[M].push(function(T){ei(T,a,s,I)}))}else ei(S,a,s,I)},f=0,m=l.length;f<m;f++){var S;d()}}};function ei(u,s,o,a){o.save();var l=a.geometry._coordinates||a.geometry.coordinates,d=l[0],f=l[1],m=s.offset||{x:0,y:0},S=a.width||s._width||s.width,C=a.height||s._height||s.height;if(d=d-~~S/2+m.x,f=f-~~C/2+m.y,typeof u=="string"){o.beginPath(),o.arc(d,f,s.size||5,0,Math.PI*2),o.fillStyle=s.fillStyle||"red",o.fill();return}var I=a.deg||s.deg;I&&(o.translate(d,f),o.rotate(I*Math.PI/180),o.translate(-d,-f)),s.sx&&s.sy&&s.swidth&&s.sheight&&s.width&&s.height?o.drawImage(u,s.sx,s.sy,s.swidth,s.sheight,d,f,S,C):S&&C?o.drawImage(u,d,f,S,C):o.drawImage(u,d,f),o.restore()}function Uo(u,s,o){var a=new Image;a.onload=function(){s&&s(a,u)},a.onerror=function(){o&&o(u)},a.src=window.decodeURIComponent(u)}function ti(u,s,o,a,l,d){if(!(l-a<=o)){var f=a+l>>1;fn(u,s,f,a,l,d%2),ti(u,s,o,a,f-1,d+1),ti(u,s,o,f+1,l,d+1)}}function fn(u,s,o,a,l,d){for(;l>a;){if(l-a>600){var f=l-a+1,m=o-a+1,S=Math.log(f),C=.5*Math.exp(2*S/3),I=.5*Math.sqrt(S*C*(f-C)/f)*(m-f/2<0?-1:1),M=Math.max(a,Math.floor(o-m*C/f+I)),F=Math.min(l,Math.floor(o+(f-m)*C/f+I));fn(u,s,o,M,F,d)}var T=s[2*o+d],G=a,B=l;for(Ht(u,s,a,o),s[2*l+d]>T&&Ht(u,s,a,l);G<B;){for(Ht(u,s,G,B),G++,B--;s[2*G+d]<T;)G++;for(;s[2*B+d]>T;)B--}s[2*a+d]===T?Ht(u,s,a,B):(B++,Ht(u,s,B,l)),B<=o&&(a=B+1),o<=B&&(l=B-1)}}function Ht(u,s,o,a){ri(u,o,a),ri(s,2*o,2*a),ri(s,2*o+1,2*a+1)}function ri(u,s,o){var a=u[s];u[s]=u[o],u[o]=a}function qo(u,s,o,a,l,d,f){for(var m=[0,u.length-1,0],S=[],C,I;m.length;){var M=m.pop(),F=m.pop(),T=m.pop();if(F-T<=f){for(var G=T;G<=F;G++)C=s[2*G],I=s[2*G+1],C>=o&&C<=l&&I>=a&&I<=d&&S.push(u[G]);continue}var B=Math.floor((T+F)/2);C=s[2*B],I=s[2*B+1],C>=o&&C<=l&&I>=a&&I<=d&&S.push(u[B]);var V=(M+1)%2;(M===0?o<=C:a<=I)&&(m.push(T),m.push(B-1),m.push(V)),(M===0?l>=C:d>=I)&&(m.push(B+1),m.push(F),m.push(V))}return S}function Vo(u,s,o,a,l,d){for(var f=[0,u.length-1,0],m=[],S=l*l;f.length;){var C=f.pop(),I=f.pop(),M=f.pop();if(I-M<=d){for(var F=M;F<=I;F++)pn(s[2*F],s[2*F+1],o,a)<=S&&m.push(u[F]);continue}var T=Math.floor((M+I)/2),G=s[2*T],B=s[2*T+1];pn(G,B,o,a)<=S&&m.push(u[T]);var V=(C+1)%2;(C===0?o-l<=G:a-l<=B)&&(f.push(M),f.push(T-1),f.push(V)),(C===0?o+l>=G:a+l>=B)&&(f.push(T+1),f.push(I),f.push(V))}return m}function pn(u,s,o,a){var l=u-o,d=s-a;return l*l+d*d}var Wo=function(s){return s[0]},Ho=function(s){return s[1]},gr=function(s,o,a,l,d){o===void 0&&(o=Wo),a===void 0&&(a=Ho),l===void 0&&(l=64),d===void 0&&(d=Float64Array),this.nodeSize=l,this.points=s;for(var f=s.length<65536?Uint16Array:Uint32Array,m=this.ids=new f(s.length),S=this.coords=new d(s.length*2),C=0;C<s.length;C++)m[C]=C,S[2*C]=o(s[C]),S[2*C+1]=a(s[C]);ti(m,S,l,0,m.length-1,0)};gr.prototype.range=function(s,o,a,l){return qo(this.ids,this.coords,s,o,a,l,this.nodeSize)},gr.prototype.within=function(s,o,a){return Vo(this.ids,this.coords,s,o,a,this.nodeSize)};var Jo={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(s){return s}},Re=function(s){this.options=Jt(Object.create(Jo),s),this.trees=new Array(this.options.maxZoom+1)};Re.prototype.load=function(s){var o=this.options;o.log;var a=o.minZoom,l=o.maxZoom,d=o.nodeSize;""+s.length,this.points=s;for(var f=[],m=0;m<s.length;m++)!s[m].geometry||f.push(Ko(s[m],m));this.trees[l+1]=new gr(f,yn,mn,d,Float32Array);for(var S=l;S>=a;S--)f=this._cluster(f,S),this.trees[S]=new gr(f,yn,mn,d,Float32Array);return this},Re.prototype.getClusters=function(s,o){var a=((s[0]+180)%360+360)%360-180,l=Math.max(-90,Math.min(90,s[1])),d=s[2]===180?180:((s[2]+180)%360+360)%360-180,f=Math.max(-90,Math.min(90,s[3]));if(s[2]-s[0]>=360)a=-180,d=180;else if(a>d){var m=this.getClusters([a,l,180,f],o),S=this.getClusters([-180,l,d,f],o);return m.concat(S)}for(var C=this.trees[this._limitZoom(o)],I=C.range(ii(a),ni(f),ii(d),ni(l)),M=[],F=0,T=I;F<T.length;F+=1){var G=T[F],B=C.points[G];M.push(B.numPoints?gn(B):this.points[B.index])}return M},Re.prototype.getChildren=function(s){var o=this._getOriginId(s),a=this._getOriginZoom(s),l="No cluster with the specified id.",d=this.trees[a];if(!d)throw new Error(l);var f=d.points[o];if(!f)throw new Error(l);for(var m=this.options.radius/(this.options.extent*Math.pow(2,a-1)),S=d.within(f.x,f.y,m),C=[],I=0,M=S;I<M.length;I+=1){var F=M[I],T=d.points[F];T.parentId===s&&C.push(T.numPoints?gn(T):this.points[T.index])}if(C.length===0)throw new Error(l);return C},Re.prototype.getLeaves=function(s,o,a){o=o||10,a=a||0;var l=[];return this._appendLeaves(l,s,o,a,0),l},Re.prototype.getTile=function(s,o,a){var l=this.trees[this._limitZoom(s)],d=Math.pow(2,s),f=this.options,m=f.extent,S=f.radius,C=S/m,I=(a-C)/d,M=(a+1+C)/d,F={features:[]};return this._addTileFeatures(l.range((o-C)/d,I,(o+1+C)/d,M),l.points,o,a,d,F),o===0&&this._addTileFeatures(l.range(1-C/d,I,1,M),l.points,d,a,d,F),o===d-1&&this._addTileFeatures(l.range(0,I,C/d,M),l.points,-1,a,d,F),F.features.length?F:null},Re.prototype.getClusterExpansionZoom=function(s){for(var o=this._getOriginZoom(s)-1;o<=this.options.maxZoom;){var a=this.getChildren(s);if(o++,a.length!==1)break;s=a[0].properties.cluster_id}return o},Re.prototype._appendLeaves=function(s,o,a,l,d){for(var f=this.getChildren(o),m=0,S=f;m<S.length;m+=1){var C=S[m],I=C.properties;if(I&&I.cluster?d+I.point_count<=l?d+=I.point_count:d=this._appendLeaves(s,I.cluster_id,a,l,d):d<l?d++:s.push(C),s.length===a)break}return d},Re.prototype._addTileFeatures=function(s,o,a,l,d,f){for(var m=0,S=s;m<S.length;m+=1){var C=S[m],I=o[C],M=I.numPoints,F={type:1,geometry:[[Math.round(this.options.extent*(I.x*d-a)),Math.round(this.options.extent*(I.y*d-l))]],tags:M?vn(I):this.points[I.index].properties},T=void 0;M?T=I.id:this.options.generateId?T=I.index:this.points[I.index].id&&(T=this.points[I.index].id),T!==void 0&&(F.id=T),f.features.push(F)}},Re.prototype._limitZoom=function(s){return Math.max(this.options.minZoom,Math.min(+s,this.options.maxZoom+1))},Re.prototype._cluster=function(s,o){for(var a=[],l=this.options,d=l.radius,f=l.extent,m=l.reduce,S=l.minPoints,C=d/(f*Math.pow(2,o)),I=0;I<s.length;I++){var M=s[I];if(!(M.zoom<=o)){M.zoom=o;for(var F=this.trees[o+1],T=F.within(M.x,M.y,C),G=M.numPoints||1,B=G,V=0,H=T;V<H.length;V+=1){var Z=H[V],ne=F.points[Z];ne.zoom>o&&(B+=ne.numPoints||1)}if(B>=S){for(var K=M.x*G,X=M.y*G,he=m&&G>1?this._map(M,!0):null,ye=(I<<5)+(o+1)+this.points.length,oe=0,se=T;oe<se.length;oe+=1){var Ae=se[oe],me=F.points[Ae];if(!(me.zoom<=o)){me.zoom=o;var be=me.numPoints||1;K+=me.x*be,X+=me.y*be,me.parentId=ye,m&&(he||(he=this._map(M,!0)),m(he,this._map(me)))}}M.parentId=ye,a.push(Zo(K/B,X/B,ye,B,he))}else if(a.push(M),B>1)for(var Oe=0,Ne=T;Oe<Ne.length;Oe+=1){var Zt=Ne[Oe],Mt=F.points[Zt];Mt.zoom<=o||(Mt.zoom=o,a.push(Mt))}}}return a},Re.prototype._getOriginId=function(s){return s-this.points.length>>5},Re.prototype._getOriginZoom=function(s){return(s-this.points.length)%32},Re.prototype._map=function(s,o){if(s.numPoints)return o?Jt({},s.properties):s.properties;var a=this.points[s.index].properties,l=this.options.map(a);return o&&l===a?Jt({},l):l};function Zo(u,s,o,a,l){return{x:u,y:s,zoom:1/0,id:o,parentId:-1,numPoints:a,properties:l}}function Ko(u,s){var o=u.geometry.coordinates,a=o[0],l=o[1];return{x:ii(a),y:ni(l),zoom:1/0,index:s,parentId:-1}}function gn(u){return{type:"Feature",id:u.id,properties:vn(u),geometry:{type:"Point",coordinates:[jo(u.x),Qo(u.y)]}}}function vn(u){var s=u.numPoints,o=s>=1e4?Math.round(s/1e3)+"k":s>=1e3?Math.round(s/100)/10+"k":s;return Jt(Jt({},u.properties),{cluster:!0,cluster_id:u.id,point_count:s,point_count_abbreviated:o})}function ii(u){return u/360+.5}function ni(u){var s=Math.sin(u*Math.PI/180),o=.5-.25*Math.log((1+s)/(1-s))/Math.PI;return o<0?0:o>1?1:o}function jo(u){return(u-.5)*360}function Qo(u){var s=(180-u*360)*Math.PI/180;return 360*Math.atan(Math.exp(s))/Math.PI-90}function Jt(u,s){for(var o in s)u[o]=s[o];return u}function yn(u){return u.x}function mn(u){return u.y}typeof window<"u"&&requestAnimationFrame(wn);function wn(u){requestAnimationFrame(wn),ve.update(u)}var Ke=function(){function u(s,o,a){y(this,u),o instanceof x||(o=new x(o)),this.dataSet=o,this.map=s,a.draw==="cluster"&&this.refreshCluster(a)}return w(u,[{key:"refreshCluster",value:function(o){o=o||this.options,this.supercluster=new Re({maxZoom:o.maxZoom||19,radius:o.clusterRadius||100,minPoints:o.minPoints||2,extent:o.extent||512}),this.supercluster.load(this.dataSet.get()),this.supercluster.trees.forEach(function(a){var l=0,d=1/0;a.points.forEach(function(f){l=Math.max(f.numPoints||0,l),d=Math.min(f.numPoints||1/0,d)}),a.max=l,a.min=d}),this.clusterDataSet=new x}},{key:"getDefaultContextConfig",value:function(){return{globalAlpha:1,globalCompositeOperation:"source-over",imageSmoothingEnabled:!0,strokeStyle:"#000000",fillStyle:"#000000",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,lineDashOffset:0,font:"10px sans-serif",textAlign:"start",textBaseline:"alphabetic"}}},{key:"initDataRange",value:function(o){var a=this;if(a.intensity=new Y({maxSize:a.options.maxSize,minSize:a.options.minSize,gradient:a.options.gradient,max:a.options.max||this.dataSet.getMax("count")}),a.category=new Wt(a.options.splitList),a.choropleth=new Lt(a.options.splitList),a.options.splitList===void 0&&a.category.generateByDataSet(this.dataSet,a.options.color),a.options.splitList===void 0){var l=a.options.min||this.dataSet.getMin("count"),d=a.options.max||this.dataSet.getMax("count");a.choropleth.generateByMinMax(l,d)}}},{key:"getLegend",value:function(o){this.options.draw;var a=this;if(a.options.draw=="intensity"||a.options.draw=="heatmap")return this.intensity.getLegend(o);if(a.options.draw=="category")return this.category.getLegend(o)}},{key:"processData",value:function(o){var a=this,l=a.options.draw;if(l=="bubble"||l=="intensity"||l=="category"||l=="choropleth"||l=="simple")for(var d=0;d<o.length;d++){var f=o[d];a.options.draw=="bubble"?o[d]._size=a.intensity.getSize(f.count):o[d]._size=void 0;var m="_fillStyle";(o[d].geometry.type==="LineString"||a.options.styleType==="stroke")&&(m="_strokeStyle"),a.options.draw=="intensity"?o[d][m]=a.intensity.getColor(f.count):a.options.draw=="category"?o[d][m]=a.category.get(f.count):a.options.draw=="choropleth"&&(o[d][m]=a.choropleth.get(f.count))}}},{key:"isEnabledTime",value:function(){var o=this.options.animation,a=o&&o.enabled!==!1;return a}},{key:"argCheck",value:function(o){o.draw=="heatmap"&&o.strokeStyle&&console.warn("[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]")}},{key:"drawContext",value:function(o,a,l,d){var f=this;switch(f.options.draw){case"heatmap":Xi.draw(o,a,f.options);break;case"grid":case"cluster":case"honeycomb":f.options.offset={x:d.x,y:d.y},f.options.draw==="grid"?$i.draw(o,a,f.options):f.options.draw==="cluster"?Oo.draw(o,a,f.options):en.draw(o,a,f.options);break;case"text":Do.draw(o,a,f.options);break;case"icon":zo.draw(o,a,f.options);break;case"clip":Ro.draw(o,a,f.options);break;default:f.options.context=="webgl"?hn.draw(f.canvasLayer.canvas.getContext("webgl"),a,f.options):W.draw(o,a,f.options)}f.options.arrow&&f.options.arrow.show!==!1&&dn.draw(o,a,f.options)}},{key:"isPointInPath",value:function(l,a){var l=this.canvasLayer.canvas.getContext(this.context),d;this.options.draw==="cluster"&&(!this.options.maxClusterZoom||this.options.maxClusterZoom>=this.getZoom())?d=this.clusterDataSet.get():d=this.dataSet.get();for(var f=0;f<d.length;f++){l.beginPath();var m=this.options,S=a.x*this.canvasLayer.devicePixelRatio,C=a.y*this.canvasLayer.devicePixelRatio;m.multiPolygonDraw=function(){if(l.isPointInPath(S,C))return d[f]},R.draw(l,d[f],m);var I=d[f].geometry&&d[f].geometry.type;if(I.indexOf("LineString")>-1){if(l.isPointInStroke&&l.isPointInStroke(S,C))return d[f]}else if(l.isPointInPath(S,C))return d[f]}}},{key:"getClusterPoints",value:function(o){var a=this;if(o.type!=="Feature")return[];var l=this.supercluster.getChildren(o.id);return l.map(function(d){return d.type==="Feature"?a.getClusterPoints(d):d}).flat()}},{key:"clickEvent",value:function(o,a){if(!!this.options.methods){var l=this.isPointInPath(this.getContext(),o);if(l){if(this.options.draw==="cluster"){var d=this.getClusterPoints(l);l.children=d}this.options.methods.click(l,a)}else this.options.methods.click(null,a)}}},{key:"mousemoveEvent",value:function(o,a){if(!!this.options.methods){var l=this.isPointInPath(this.getContext(),o);if(l){if(this.options.draw==="cluster"){var d=this.getClusterPoints(l);l.children=d}this.options.methods.mousemove(l,a)}else this.options.methods.mousemove(null,a)}}},{key:"tapEvent",value:function(o,a){if(!!this.options.methods){var l=this.isPointInPath(this.getContext(),o);if(l){if(this.options.draw==="cluster"){var d=this.getClusterPoints(l);l.children=d}this.options.methods.tap(l,a)}else this.options.methods.tap(null,a)}}},{key:"update",value:function(o,a){var l=this,d=o.options,f=l.options;for(var m in d)f[m]=d[m];l.init(f),a!==!1&&l.draw()}},{key:"setOptions",value:function(o){var a=this;a.dataSet.reset(),a.init(o),a.draw()}},{key:"set",value:function(o){var a=this,l=this.getContext(),d=this.getDefaultContextConfig();for(var f in d)l[f]=d[f];a.init(o.options),a.draw()}},{key:"destroy",value:function(){this.unbindEvent(),this.hide()}},{key:"initAnimator",value:function(){var o=this,a=o.options.animation;if(o.options.draw=="time"||o.isEnabledTime()){a.stepsRange||(a.stepsRange={start:this.dataSet.getMin("time")||0,end:this.dataSet.getMax("time")||0}),this.steps={step:a.stepsRange.start},o.animator=new ve.Tween(this.steps).onUpdate(function(){o._canvasUpdate(this.step)}).repeat(1/0),this.addAnimatorEvent();var l=a.duration*1e3||5e3;o.animator.to({step:a.stepsRange.end},l),o.animator.start()}else o.animator&&o.animator.stop()}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var o=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=o.stepsRange.start,this.animator.stop())}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator&&this.animator.start()}}]),u}(),xn=typeof window>"u"?{}:window,Yo=xn.BMap||xn.BMapGL,Xo=function(u){E(s,u);function s(o,a,l){y(this,s);var d=k(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o,a,l));d.map=o,d.options=l||{},d.dataSet=a;var f=new Ge({map:o,zIndex:d.options.zIndex,update:d._canvasUpdate.bind(d)});d.init(d.options),d.canvasLayer=f,d.transferToMercator();var m=d;return a.on("change",function(){m.transferToMercator(),f.draw()}),d.ctx=f.canvas.getContext("2d"),d.start(),d}return w(s,[{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"init",value:function(a){var l=this;l.options=a,this.initDataRange(a),this.context=l.options.context||"2d",l.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(l.options.zIndex),l.options.max&&this.intensity.setMax(l.options.max),l.options.min&&this.intensity.setMin(l.options.min),this.initAnimator()}},{key:"transferToMercator",value:function(){var a=this.map,l=a.getMapType(),d;if(l.getProjection?d=l.getProjection():d={lngLatToPoint:function(S){var C=a.lnglatToMercator(S.lng,S.lat);return{x:C[0],y:C[1]}}},this.options.coordType!=="bd09mc"){var f=this.dataSet.get();f=this.dataSet.transferCoordinate(f,function(m){var S=d.lngLatToPoint({lng:m[0],lat:m[1]});return[S.x,S.y]},"coordinates","coordinates_mercator"),this.dataSet._set(f)}}},{key:"_canvasUpdate",value:function(){var a=this.ctx;if(!!a){var l=this.map,d,f;l.getMapType().getProjection?(d=l.getMapType().getProjection(),f=d.lngLatToPoint(l.getCenter())):(f={x:l.getCenter().lng,y:l.getCenter().lat},f.x>-180&&f.x<180&&(f=l.lnglatToMercator(f.x,f.y),f={x:f[0],y:f[1]}),d={lngLatToPoint:function(M){var F=l.lnglatToMercator(M.lng,M.lat);return{x:F[0],y:F[1]}}});var m;d.getZoomUnits?m=d.getZoomUnits(l.getZoom()):m=Math.pow(2,18-l.getZoom());var S=new Yo.Pixel(f.x-l.getSize().width/2*m,f.y+l.getSize().height/2*m);i(a);var C={fromColumn:this.options.coordType=="bd09mc"?"coordinates":"coordinates_mercator",transferCoordinate:function(M){if(!!M){var F=(M[0]-S.x)/m,T=(S.y-M[1])/m;return[F,T]}}};this.data=this.dataSet.get(C),this.processData(this.data),this.drawAnimation()}}},{key:"drawAnimation",value:function(){var a=this.ctx,l=this.data;if(!!l){a.save(),a.globalCompositeOperation="destination-out",a.fillStyle="rgba(0, 0, 0, .1)",a.fillRect(0,0,a.canvas.width,a.canvas.height),a.restore(),a.save(),this.options.shadowColor&&(a.shadowColor=this.options.shadowColor),this.options.shadowBlur&&(a.shadowBlur=this.options.shadowBlur),this.options.globalAlpha&&(a.globalAlpha=this.options.globalAlpha),this.options.globalCompositeOperation&&(a.globalCompositeOperation=this.options.globalCompositeOperation);for(var d=this.options,f=0;f<l.length;f++)if(l[f].geometry.type==="Point"){a.beginPath();var m=l[f].size||this.options.size,S=l[f].minSize||this.options.minSize||0;l[f]._size===void 0&&(l[f]._size=S),a.arc(l[f].geometry._coordinates[0],l[f].geometry._coordinates[1],l[f]._size,0,Math.PI*2,!0),a.closePath(),l[f]._size++,l[f]._size>m&&(l[f]._size=S),a.lineWidth=1,a.strokeStyle=l[f].strokeStyle||l[f]._strokeStyle||d.strokeStyle||"yellow",a.stroke();var C=l[f].fillStyle||l[f]._fillStyle||d.fillStyle;C&&(a.fillStyle=C,a.fill())}else if(l[f].geometry.type==="LineString"){a.beginPath();var I=l[f].size||this.options.size||5,S=l[f].minSize||this.options.minSize||0;l[f]._index===void 0&&(l[f]._index=0);var M=l[f]._index;a.arc(l[f].geometry._coordinates[M][0],l[f].geometry._coordinates[M][1],I,0,Math.PI*2,!0),a.closePath(),l[f]._index++,l[f]._index>=l[f].geometry._coordinates.length&&(l[f]._index=0);var F=l[f].strokeStyle||d.strokeStyle,C=l[f].fillStyle||d.fillStyle||"yellow";a.fillStyle=C,a.fill(),F&&d.lineWidth&&(a.lineWidth=d.lineWidth||1,a.strokeStyle=F,a.stroke())}a.restore()}}},{key:"animate",value:function(){this.drawAnimation();var a=this.options.animateTime||100;this.timeout=setTimeout(this.animate.bind(this),a)}},{key:"start",value:function(){this.stop(),this.animate()}},{key:"stop",value:function(){clearTimeout(this.timeout)}},{key:"unbindEvent",value:function(){}},{key:"hide",value:function(){this.canvasLayer.hide(),this.stop()}},{key:"show",value:function(){this.start()}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"destroy",value:function(){this.stop(),this.unbindEvent(),this.clearData(),this.map.removeOverlay(this.canvasLayer),this.canvasLayer=null}}]),s}(Ke),Sn=typeof window>"u"?{}:window,Cn=Sn.BMap||Sn.BMapGL,$o=function(u){E(s,u);function s(o,a,l){y(this,s);var d=k(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o,a,l)),f=d;l=l||{},d.clickEvent=d.clickEvent.bind(d),d.mousemoveEvent=d.mousemoveEvent.bind(d),d.tapEvent=d.tapEvent.bind(d),f.init(l),f.argCheck(l),f.transferToMercator();var m=d.canvasLayer=new Ge({map:o,context:d.context,updateImmediate:l.updateImmediate,paneName:l.paneName,mixBlendMode:l.mixBlendMode,enableMassClear:l.enableMassClear,zIndex:l.zIndex,update:function(){f._canvasUpdate()}});return a.on("change",function(){f.transferToMercator(),l.draw==="cluster"&&f.refreshCluster(),m.draw()}),d}return w(s,[{key:"clickEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"clickEvent",this).call(this,l,a)}},{key:"mousemoveEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"mousemoveEvent",this).call(this,l,a)}},{key:"tapEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"tapEvent",this).call(this,l,a)}},{key:"bindEvent",value:function(a){this.unbindEvent();var l=this.map,d=0,f=this;this.options.methods&&(this.options.methods.click&&(l.setDefaultCursor("default"),l.addEventListener("click",this.clickEvent)),this.options.methods.mousemove&&l.addEventListener("mousemove",this.mousemoveEvent),"ontouchend"in window.document&&this.options.methods.tap&&(l.addEventListener("touchstart",function(m){d=new Date}),l.addEventListener("touchend",function(m){new Date-d<300&&f.tapEvent(m)})))}},{key:"unbindEvent",value:function(a){var l=this.map;this.options.methods&&(this.options.methods.click&&l.removeEventListener("click",this.clickEvent),this.options.methods.mousemove&&l.removeEventListener("mousemove",this.mousemoveEvent))}},{key:"transferToMercator",value:function(a){a||(a=this.dataSet);var l=this.map,d=l.getMapType(),f;if(d.getProjection?f=d.getProjection():f={lngLatToPoint:function(C){var I=l.lnglatToMercator(C.lng,C.lat);return{x:I[0],y:I[1]}}},this.options.coordType!=="bd09mc"){var m=a.get();m=a.transferCoordinate(m,function(S){if(S[0]<-180||S[0]>180||S[1]<-90||S[1]>90)return S;var C=f.lngLatToPoint({lng:S[0],lat:S[1]});return[C.x,C.y]},"coordinates","coordinates_mercator"),a._set(m)}}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function(a){if(!!this.canvasLayer){var l=this,d=this.options.animation,f=this.canvasLayer._map,m,S;f.getMapType().getProjection?(m=f.getMapType().getProjection(),S=m.lngLatToPoint(f.getCenter())):(S={x:f.getCenter().lng,y:f.getCenter().lat},S.x>-180&&S.x<180&&(S=f.lnglatToMercator(S.x,S.y),S={x:S[0],y:S[1]}),m={lngLatToPoint:function(be){var Oe=f.lnglatToMercator(be.lng,be.lat);return{x:Oe[0],y:Oe[1]}}});var C;m.getZoomUnits?C=m.getZoomUnits(f.getZoom()):C=Math.pow(2,18-f.getZoom());var I=new Cn.Pixel(S.x-f.getSize().width/2*C,S.y+f.getSize().height/2*C),M=this.getContext();if(this.isEnabledTime()){if(a===void 0){i(M);return}this.context=="2d"&&(M.save(),M.globalCompositeOperation="destination-out",M.fillStyle="rgba(0, 0, 0, .1)",M.fillRect(0,0,M.canvas.width,M.canvas.height),M.restore())}else i(M);if(this.context=="2d")for(var F in this.options)M[F]=this.options[F];else M.clear(M.COLOR_BUFFER_BIT);if(!(this.options.minZoom&&f.getZoom()<this.options.minZoom||this.options.maxZoom&&f.getZoom()>this.options.maxZoom)){var T=1;this.context!="2d"&&(T=this.canvasLayer.devicePixelRatio);var G={fromColumn:this.options.coordType=="bd09mc"?"coordinates":"coordinates_mercator",transferCoordinate:function(be){var Oe=(be[0]-I.x)/C*T,Ne=(I.y-be[1])/C*T;return[Oe,Ne]}};a!==void 0&&(G.filter=function(me){var be=d.trails||10;return!!(a&&me.time>a-be&&me.time<a)});var B,V=this.getZoom();if(this.options.draw==="cluster"&&(!this.options.maxClusterZoom||this.options.maxClusterZoom>=V)){var H=this.map.getBounds(),Z=H.getNorthEast(),ne=H.getSouthWest(),K=this.supercluster.getClusters([ne.lng,ne.lat,Z.lng,Z.lat],V);this.pointCountMax=this.supercluster.trees[V].max,this.pointCountMin=this.supercluster.trees[V].min;var X={},he=null,ye=null;this.pointCountMax===this.pointCountMin?(he=this.options.fillStyle,ye=this.options.minSize||8):X=new Y({min:this.pointCountMin,max:this.pointCountMax,minSize:this.options.minSize||8,maxSize:this.options.maxSize||30,gradient:this.options.gradient});for(var oe=0;oe<K.length;oe++){var se=K[oe];se.properties&&se.properties.cluster_id?(K[oe].size=ye||X.getSize(se.properties.point_count),K[oe].fillStyle=he||X.getColor(se.properties.point_count)):K[oe].size=l.options.size}this.clusterDataSet.set(K),this.transferToMercator(this.clusterDataSet),B=l.clusterDataSet.get(G)}else B=l.dataSet.get(G);this.processData(B);var Ae=f.pointToPixel(new Cn.Point(0,0));l.options.unit=="m"?(l.options.size&&(l.options._size=l.options.size/C),l.options.width&&(l.options._width=l.options.width/C),l.options.height&&(l.options._height=l.options.height/C)):(l.options._size=l.options.size,l.options._height=l.options.height,l.options._width=l.options.width),this.drawContext(M,B,l.options,Ae),l.options.updateCallback&&l.options.updateCallback(a)}}}},{key:"init",value:function(a){var l=this;l.options=a,this.initDataRange(a),this.context=l.options.context||"2d",l.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(l.options.zIndex),l.options.max&&this.intensity.setMax(l.options.max),l.options.min&&this.intensity.setMin(l.options.min),this.initAnimator(),this.bindEvent()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"addAnimatorEvent",value:function(){this.map.addEventListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addEventListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function(){this.map.addOverlay(this.canvasLayer),this.bindEvent()}},{key:"hide",value:function(){this.unbindEvent(),this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function(){this.canvasLayer&&this.canvasLayer.draw()}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"destroy",value:function(){this.unbindEvent(),this.clearData(),this.map.removeOverlay(this.canvasLayer),this.canvasLayer=null}}]),s}(Ke);function pe(u){this.isAdded_=!1,this.isAnimated_=!1,this.paneName_=pe.DEFAULT_PANE_NAME_,this.updateHandler_=null,this.resizeHandler_=null,this.topLeft_=null,this.centerListener_=null,this.resizeListener_=null,this.needsResize_=!0,this.requestAnimationFrameId_=null;var s=document.createElement("canvas");s.style.position="absolute",s.style.top=0,s.style.left=0,s.style.pointerEvents="none",this.canvas=s,this.canvasCssWidth_=300,this.canvasCssHeight_=150,this.resolutionScale_=1;function o(a,l){return function(){l.apply(a)}}this.repositionFunction_=o(this,this.repositionCanvas_),this.resizeFunction_=o(this,this.resize_),this.requestUpdateFunction_=o(this,this.update_),u&&this.setOptions(u)}var Ie=typeof window>"u"?{}:window;Ie.google&&Ie.google.maps&&(pe.prototype=new google.maps.OverlayView,pe.DEFAULT_PANE_NAME_="overlayLayer",pe.CSS_TRANSFORM_=function(){for(var u=document.createElement("div"),s=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],o=0;o<s.length;o++){var a=s[o];if(u.style[a]!==void 0)return a}return s[0]}(),pe.prototype.requestAnimFrame_=Ie.requestAnimationFrame||Ie.webkitRequestAnimationFrame||Ie.mozRequestAnimationFrame||Ie.oRequestAnimationFrame||Ie.msRequestAnimationFrame||function(u){return Ie.setTimeout(u,16.666666666666668)},pe.prototype.cancelAnimFrame_=Ie.cancelAnimationFrame||Ie.webkitCancelAnimationFrame||Ie.mozCancelAnimationFrame||Ie.oCancelAnimationFrame||Ie.msCancelAnimationFrame||function(u){},pe.prototype.setOptions=function(u){u.animate!==void 0&&this.setAnimate(u.animate),u.paneName!==void 0&&this.setPaneName(u.paneName),u.updateHandler!==void 0&&this.setUpdateHandler(u.updateHandler),u.resizeHandler!==void 0&&this.setResizeHandler(u.resizeHandler),u.resolutionScale!==void 0&&this.setResolutionScale(u.resolutionScale),u.map!==void 0&&this.setMap(u.map)},pe.prototype.setAnimate=function(u){this.isAnimated_=!!u,this.isAnimated_&&this.scheduleUpdate()},pe.prototype.isAnimated=function(){return this.isAnimated_},pe.prototype.setPaneName=function(u){this.paneName_=u,this.setPane_()},pe.prototype.getPaneName=function(){return this.paneName_},pe.prototype.setPane_=function(){if(!!this.isAdded_){var u=this.getPanes();if(!u[this.paneName_])throw new Error('"'+this.paneName_+'" is not a valid MapPane name.');u[this.paneName_].appendChild(this.canvas)}},pe.prototype.setResizeHandler=function(u){this.resizeHandler_=u},pe.prototype.setResolutionScale=function(u){typeof u=="number"&&(this.resolutionScale_=u,this.resize_())},pe.prototype.setUpdateHandler=function(u){this.updateHandler_=u},pe.prototype.onAdd=function(){this.isAdded_||(this.isAdded_=!0,this.setPane_(),this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_),this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_),this.resize_(),this.repositionCanvas_())},pe.prototype.onRemove=function(){!this.isAdded_||(this.isAdded_=!1,this.topLeft_=null,this.canvas.parentElement.removeChild(this.canvas),this.centerListener_&&(google.maps.event.removeListener(this.centerListener_),this.centerListener_=null),this.resizeListener_&&(google.maps.event.removeListener(this.resizeListener_),this.resizeListener_=null),this.requestAnimationFrameId_&&(this.cancelAnimFrame_.call(Ie,this.requestAnimationFrameId_),this.requestAnimationFrameId_=null))},pe.prototype.resize_=function(){if(!!this.isAdded_){var u=this.getMap(),s=u.getDiv().offsetWidth,o=u.getDiv().offsetHeight,a=s*this.resolutionScale_,l=o*this.resolutionScale_,d=this.canvas.width,f=this.canvas.height;(d!==a||f!==l)&&(this.canvas.width=a,this.canvas.height=l,this.needsResize_=!0,this.scheduleUpdate()),(this.canvasCssWidth_!==s||this.canvasCssHeight_!==o)&&(this.canvasCssWidth_=s,this.canvasCssHeight_=o,this.canvas.style.width=s+"px",this.canvas.style.height=o+"px")}},pe.prototype.draw=function(){this.repositionCanvas_()},pe.prototype.repositionCanvas_=function(){var u=this.getMap(),s=u.getBounds().getNorthEast().lat(),o=u.getCenter(),a=Math.pow(2,u.getZoom()),l=o.lng()-this.canvasCssWidth_*180/(256*a);this.topLeft_=new google.maps.LatLng(s,l);var d=this.getProjection(),f=d.fromLatLngToDivPixel(o),m=-Math.round(this.canvasCssWidth_/2-f.x),S=-Math.round(this.canvasCssHeight_/2-f.y);this.canvas.style[pe.CSS_TRANSFORM_]="translate("+m+"px,"+S+"px)",this.scheduleUpdate()},pe.prototype.update_=function(){this.requestAnimationFrameId_=null,this.isAdded_&&(this.isAnimated_&&this.scheduleUpdate(),this.needsResize_&&this.resizeHandler_&&(this.needsResize_=!1,this.resizeHandler_()),this.updateHandler_&&this.updateHandler_())},pe.prototype.getTopLeft=function(){return this.topLeft_},pe.prototype.scheduleUpdate=function(){this.isAdded_&&!this.requestAnimationFrameId_&&(this.requestAnimationFrameId_=this.requestAnimFrame_.call(Ie,this.requestUpdateFunction_))});var el=function(u){E(s,u);function s(o,a,l){y(this,s);var d=k(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o,a,l)),f=d;l=l||{},f.init(l),f.argCheck(l);var m={map:o,animate:!1,updateHandler:function(){f._canvasUpdate()},resolutionScale};return d.canvasLayer=new pe(m),d.clickEvent=d.clickEvent.bind(d),d.mousemoveEvent=d.mousemoveEvent.bind(d),d.bindEvent(),d}return w(s,[{key:"clickEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"clickEvent",this).call(this,l,a)}},{key:"mousemoveEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"mousemoveEvent",this).call(this,l,a)}},{key:"bindEvent",value:function(a){var l=this.map;this.options.methods&&(this.options.methods.click&&(l.setDefaultCursor("default"),l.addListener("click",this.clickEvent)),this.options.methods.mousemove&&l.addListener("mousemove",this.mousemoveEvent))}},{key:"unbindEvent",value:function(a){var l=this.map;this.options.methods&&(this.options.methods.click&&l.removeListener("click",this.clickEvent),this.options.methods.mousemove&&l.removeListener("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function(a){if(!!this.canvasLayer){var l=this,d=l.options.animation,f=this.getContext();if(l.isEnabledTime()){if(a===void 0){i(f);return}this.context=="2d"&&(f.save(),f.globalCompositeOperation="destination-out",f.fillStyle="rgba(0, 0, 0, .1)",f.fillRect(0,0,f.canvas.width,f.canvas.height),f.restore())}else i(f);if(this.context=="2d")for(var m in l.options)f[m]=l.options[m];else f.clear(f.COLOR_BUFFER_BIT);if(!(l.options.minZoom&&S.getZoom()<l.options.minZoom||l.options.maxZoom&&S.getZoom()>l.options.maxZoom)){var I=1;this.context!="2d"&&(I=this.canvasLayer.devicePixelRatio);var S=this.map,C=S.getProjection(),I=Math.pow(2,S.zoom)*resolutionScale,M=C.fromLatLngToPoint(this.canvasLayer.getTopLeft()),F={transferCoordinate:function(Z){var ne=new google.maps.LatLng(Z[1],Z[0]),K=C.fromLatLngToPoint(ne),X={x:(K.x-M.x)*I,y:(K.y-M.y)*I};return[X.x,X.y]}};a!==void 0&&(F.filter=function(H){var Z=d.trails||10;return!!(a&&H.time>a-Z&&H.time<a)});var T=l.dataSet.get(F);this.processData(T);var G=new google.maps.LatLng(0,0),B=C.fromLatLngToPoint(G),V={x:(B.x-M.x)*I,y:(B.y-M.y)*I};l.options.unit=="m"&&l.options.size?l.options._size=l.options.size/zoomUnit:l.options._size=l.options.size,this.drawContext(f,new x(T),l.options,V),l.options.updateCallback&&l.options.updateCallback(a)}}}},{key:"init",value:function(a){var l=this;l.options=a,this.initDataRange(a),this.context=l.options.context||"2d",l.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(l.options.zIndex),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){this.map.addListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function(){this.map.addOverlay(this.canvasLayer)}},{key:"hide",value:function(){this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function(){self.canvasLayer.draw()}}]),s}(Ke),si=void 0;if(typeof maptalks<"u"){si=function(u){E(s,u);function s(o,a,l){y(this,s);var d=k(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o,l));return d.options_=l,d.dataSet=a,d._initBaseLayer(l),d}return w(s,[{key:"_initBaseLayer",value:function(a){var l=this,d=this.baseLayer=new Ke(null,this.dataSet,a);l.init(a),d.argCheck(a)}},{key:"clickEvent",value:function(a){if(!!this.baseLayer){var l=a.containerPoint;this.baseLayer.clickEvent(l,a.domEvent)}}},{key:"mousemoveEvent",value:function(a){if(!!this.baseLayer){var l=a.containerPoint;this.baseLayer.mousemoveEvent(l,a.domEvent)}}},{key:"getEvents",value:function(){return{click:this.clickEvent,mousemove:this.mousemoveEvent}}},{key:"init",value:function(a){var l=this.baseLayer;l.options=a,l.initDataRange(a),l.context=l.options.context||"2d",l.initAnimator()}},{key:"addAnimatorEvent",value:function(){this.map.addListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addListener("moveend",this.animatorMoveendEvent.bind(this))}}]),s}(maptalks.Layer);var tl=function(u){E(s,u);function s(){return y(this,s),k(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments))}return w(s,[{key:"needToRedraw",value:function(){var a=this.layer.baseLayer;return a.isEnabledTime()?!0:A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"needToRedraw",this).call(this)}},{key:"draw",value:function(){var a=this.layer.baseLayer;(!this.canvas||!a.isEnabledTime()||this._shouldClear)&&(this.prepareCanvas(),this._shouldClear=!1),this._update(this.gl||this.context,this._mapvFrameTime),delete this._mapvFrameTime,this.completeRender()}},{key:"drawOnInteracting",value:function(){this.draw(),this._shouldClear=!1}},{key:"onSkipDrawOnInteracting",value:function(){this._shouldClear=!0}},{key:"_canvasUpdate",value:function(a){this.setToRedraw(),this._mapvFrameTime=a}},{key:"_update",value:function(a,l){if(!!this.canvas){var d=this.layer.baseLayer,f=d.options.animation,m=this.getMap();if(d.isEnabledTime()){if(l===void 0){i(a);return}d.context=="2d"&&(a.save(),a.globalCompositeOperation="destination-out",a.fillStyle="rgba(0, 0, 0, .1)",a.fillRect(0,0,a.canvas.width,a.canvas.height),a.restore())}else i(a);if(d.context=="2d")for(var S in d.options)a[S]=d.options[S];else a.clear(a.COLOR_BUFFER_BIT);var C=1,I=new maptalks.Coordinate(0,0),M={fromColumn:d.options.coordType==="bd09mc"?"coordinates_mercator":"coordinates",transferCoordinate:function(V){I.x=V[0],I.y=V[1];var H=m.coordToContainerPoint(I)._multi(C).toArray();return H}};l!==void 0&&(M.filter=function(B){var V=f.trails||10;return!!(l&&B.time>l-V&&B.time<l)});var F=d.dataSet.get(M);d.processData(F),d.options.unit=="m"?(d.options.size&&(d.options._size=d.options.size/zoomUnit),d.options.width&&(d.options._width=d.options.width/zoomUnit),d.options.height&&(d.options._height=d.options.height/zoomUnit)):(d.options._size=d.options.size,d.options._height=d.options.height,d.options._width=d.options.width);var T=new maptalks.Point(0,0),G=m._pointToContainerPoint(T)._multi(C);d.drawContext(a,F,d.options,G),d.options.updateCallback&&d.options.updateCallback(l)}}},{key:"createCanvas",value:function(){if(!this.canvas){var a=this.getMap(),l=a.getSize(),d=a.getDevicePixelRatio?a.getDevicePixelRatio():maptalks.Browser.retina?2:1,f=d*l.width,m=d*l.height;this.canvas=maptalks.Canvas.createCanvas(f,m,a.CanvasClass);var S=this.layer.baseLayer.context;if(S==="2d")this.context=this.canvas.getContext("2d"),this.layer.options.globalCompositeOperation&&(this.context.globalCompositeOperation=this.layer.options.globalCompositeOperation),this.layer.baseLayer.options.draw!=="heatmap"&&d!==1&&this.context.scale(d,d);else{var C={alpha:!0,preserveDrawingBuffer:!0,antialias:!1};this.gl=this.canvas.getContext("webgl",C)}this.onCanvasCreate(),this._bindToMapv(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})}}},{key:"_bindToMapv",value:function(){var a=this.layer.baseLayer,l=this.getMap();this.devicePixelRatio=l.getDevicePixelRatio?l.getDevicePixelRatio():maptalks.Browser.retina?2:1,a.canvasLayer=this,a._canvasUpdate=this._canvasUpdate.bind(this),a.getContext=function(){var d=self.getRenderer();return d.gl||d.context}}}]),s}(maptalks.renderer.CanvasRenderer);si.registerRenderer("canvas",tl)}var rl=si,il=function(s,o,a){if(typeof document<"u"){var l=document.createElement("canvas");return l.width=s,l.height=o,l}else return new a(s,o)},nl=function(u){E(s,u);function s(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=arguments[1],l=arguments[2];y(this,s);var d=k(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o,a,l));return d.options=l,d.canvasLayer={canvas:null,devicePixelRatio:window.devicePixelRatio},d.layer_=null,d.initDataRange(l),d.initAnimator(),d.onEvents(),o.on("complete",function(){this.init(o,l),this.argCheck(l)},d),d}return w(s,[{key:"init",value:function(a,l){if(a)this.map=a,this.context=this.options.context||"2d",this.getCanvasLayer();else throw new Error("not map object")}},{key:"_canvasUpdate",value:function(a){this.render(this.canvasLayer.canvas,a)}},{key:"render",value:function(a,l){if(!!a){var d=this.map,f=a.getContext(this.context),m=this.options.animation;if(this.isEnabledTime()){if(l===void 0)return i(f),this;this.context==="2d"&&(f.save(),f.globalCompositeOperation="destination-out",f.fillStyle="rgba(0, 0, 0, .1)",f.fillRect(0,0,f.canvas.width,f.canvas.height),f.restore())}else i(f);if(this.context==="2d")for(var S in this.options)f[S]=this.options[S];else f.clear(f.COLOR_BUFFER_BIT);var C={transferCoordinate:function(F){var T=d.lngLatToContainer(new AMap.LngLat(F[0],F[1]));return[T.x,T.y]}};l!==void 0&&(C.filter=function(M){var F=m.trails||10;return!!(l&&M.time>l-F&&M.time<l)});var I=this.dataSet.get(C);return this.processData(I),this.options.unit==="m"?(this.options.size&&(this.options._size=this.options.size/zoomUnit),this.options.width&&(this.options._width=this.options.width/zoomUnit),this.options.height&&(this.options._height=this.options.height/zoomUnit)):(this.options._size=this.options.size,this.options._height=this.options.height,this.options._width=this.options.width),this.drawContext(f,new x(I),this.options,{x:0,y:0}),this.options.updateCallback&&this.options.updateCallback(l),this}}},{key:"getCanvasLayer",value:function(){if(!this.canvasLayer.canvas&&!this.layer_){var a=this.canvasFunction(),l=this.map.getBounds();this.layer_=new AMap.CanvasLayer({canvas:a,bounds:this.options.bounds||l,zooms:this.options.zooms||[0,22]}),this.layer_.setMap(this.map),this.map.on("mapmove",this.canvasFunction,this),this.map.on("zoomchange",this.canvasFunction,this)}}},{key:"canvasFunction",value:function(){var a=[this.map.getSize().width,this.map.getSize().height],l=a[0],d=a[1];if(!this.canvasLayer.canvas)this.canvasLayer.canvas=il(l,d);else{this.canvasLayer.canvas.width=l,this.canvasLayer.canvas.height=d;var f=this.map.getBounds();this.layer_&&this.layer_.setBounds(this.options.bounds||f)}return this.render(this.canvasLayer.canvas),this.canvasLayer.canvas}},{key:"removeLayer",value:function(){!this.map||(this.unEvents(),this.map.removeLayer(this.layer_),delete this.map,delete this.layer_,delete this.canvasLayer.canvas)}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"clickEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"clickEvent",this).call(this,l,a)}},{key:"mousemoveEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"mousemoveEvent",this).call(this,l,a)}},{key:"addAnimatorEvent",value:function(){this.map.on("movestart",this.animatorMovestartEvent,this),this.map.on("moveend",this.animatorMoveendEvent,this)}},{key:"onEvents",value:function(){var a=this.map;this.unEvents(),this.options.methods&&(this.options.methods.click&&a.on("click",this.clickEvent,this),this.options.methods.mousemove&&a.on("mousemove",this.mousemoveEvent,this))}},{key:"unEvents",value:function(){var a=this.map;this.options.methods&&(this.options.methods.click&&a.off("click",this.clickEvent,this),this.options.methods.mousemove&&a.off("mousemove",this.mousemoveEvent,this))}}]),s}(Ke),sl=function(s,o){if(typeof document<"u"){var a=document.createElement("canvas");return a.width=s,a.height=o,a}},al=function(u){E(s,u);function s(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=arguments[1],l=arguments[2];y(this,s);var d=k(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o,a,l));return d.options=l,d.canvasLayer={canvas:null,devicePixelRatio:window.devicePixelRatio},d.layer_=null,d.previousCursor_=void 0,d.init(o,l),d.argCheck(l),d}return w(s,[{key:"init",value:function(a,l){if(a&&a instanceof ol.Map)this.$Map=a,this.context=this.options.context||"2d",this.getCanvasLayer(),this.initDataRange(l),this.initAnimator(),this.onEvents();else throw new Error("not map object")}},{key:"_canvasUpdate",value:function(a){this.render(this.canvasLayer.canvas,a)}},{key:"render",value:function(a,l){var d=this.$Map,f=a.getContext(this.context),m=this.options.animation,S=this.options.hasOwnProperty("projection")?this.options.projection:"EPSG:4326",C=this.$Map.getView().getProjection().getCode();if(this.isEnabledTime()){if(l===void 0)return i(f),this;this.context==="2d"&&(f.save(),f.globalCompositeOperation="destination-out",f.fillStyle="rgba(0, 0, 0, .1)",f.fillRect(0,0,f.canvas.width,f.canvas.height),f.restore())}else i(f);if(this.context==="2d")for(var I in this.options)f[I]=this.options[I];else f.clear(f.COLOR_BUFFER_BIT);var M={};M.transferCoordinate=S===C?function(T){return d.getPixelFromCoordinate(T)}:function(T){return d.getPixelFromCoordinate(ol.proj.transform(T,S,C))},l!==void 0&&(M.filter=function(T){var G=m.trails||10;return!!(l&&T.time>l-G&&T.time<l)});var F=this.dataSet.get(M);return this.processData(F),this.options.unit==="m"?(this.options.size&&(this.options._size=this.options.size/zoomUnit),this.options.width&&(this.options._width=this.options.width/zoomUnit),this.options.height&&(this.options._height=this.options.height/zoomUnit)):(this.options._size=this.options.size,this.options._height=this.options.height,this.options._width=this.options.width),this.drawContext(f,new x(F),this.options,{x:0,y:0}),this.options.updateCallback&&this.options.updateCallback(l),this}},{key:"getCanvasLayer",value:function(){if(!this.canvasLayer.canvas&&!this.layer_){var a=this.getMapExtent();this.layer_=new ol.layer.Image({layerName:this.options.layerName,minResolution:this.options.minResolution,maxResolution:this.options.maxResolution,zIndex:this.options.zIndex,extent:a,source:new ol.source.ImageCanvas({canvasFunction:this.canvasFunction.bind(this),projection:this.$Map.getView().getProjection().getCode(),ratio:this.options.hasOwnProperty("ratio")?this.options.ratio:1})}),this.$Map.addLayer(this.layer_),this.$Map.un("precompose",this.reRender,this),this.$Map.on("precompose",this.reRender,this)}}},{key:"reRender",value:function(){if(!!this.layer_){var a=this.getMapExtent();this.layer_.setExtent(a)}}},{key:"canvasFunction",value:function(a,l,d,f,m){return this.canvasLayer.canvas?(this.canvasLayer.canvas.width=f[0],this.canvasLayer.canvas.height=f[1]):this.canvasLayer.canvas=sl(f[0],f[1]),this.render(this.canvasLayer.canvas),this.canvasLayer.canvas}},{key:"getMapExtent",value:function(){var a=this.$Map.getSize();return this.$Map.getView().calculateExtent(a)}},{key:"addTo",value:function(a){this.init(a,this.options)}},{key:"removeLayer",value:function(){!this.$Map||(this.unEvents(),this.$Map.un("precompose",this.reRender,this),this.$Map.removeLayer(this.layer_),delete this.$Map,delete this.layer_,delete this.canvasLayer.canvas)}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"clickEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"clickEvent",this).call(this,{x:l[0],y:l[1]},a)}},{key:"mousemoveEvent",value:function(a){var l=a.pixel;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"mousemoveEvent",this).call(this,{x:l[0],y:l[1]},a)}},{key:"addAnimatorEvent",value:function(){this.$Map.on("movestart",this.animatorMovestartEvent,this),this.$Map.on("moveend",this.animatorMoveendEvent,this)}},{key:"onEvents",value:function(){var a=this.$Map;this.unEvents(),this.options.methods&&(this.options.methods.click&&a.on("click",this.clickEvent,this),this.options.methods.mousemove&&a.on("pointermove",this.mousemoveEvent,this))}},{key:"unEvents",value:function(){var a=this.$Map;this.options.methods&&(this.options.methods.click&&a.un("click",this.clickEvent,this),this.options.methods.pointermove&&a.un("pointermove",this.mousemoveEvent,this))}},{key:"setDefaultCursor",value:function(a,l){if(!!this.$Map){var d=this.$Map.getTargetElement();l?d.style.cursor!==a&&(this.previousCursor_=d.style.cursor,d.style.cursor=a):this.previousCursor_!==void 0&&(d.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}}},{key:"show",value:function(){this.$Map.addLayer(this.layer_)}},{key:"hide",value:function(){this.$Map.removeLayer(this.layer_)}}]),s}(Ke),ll=function(u){E(s,u);function s(o,a,l,d){y(this,s);var f=k(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o,l,d));if(!Ke)return k(f);var m=f;return d=d||{},m.init(d),m.argCheck(d),f.canvasLayer=a,f.clickEvent=f.clickEvent.bind(f),f.mousemoveEvent=f.mousemoveEvent.bind(f),f._moveStartEvent=f.moveStartEvent.bind(f),f._moveEndEvent=f.moveEndEvent.bind(f),f._zoomStartEvent=f.zoomStartEvent.bind(f),f.bindEvent(),f}return w(s,[{key:"clickEvent",value:function(a){var l=this.map.containerPointToLayerPoint([0,0]),d=this.devicePixelRatio=this.canvasLayer.devicePixelRatio=window.devicePixelRatio,f=a.layerPoint;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"clickEvent",this).call(this,L.point((f.x-l.x)/d,(f.y-l.y)/d),a)}},{key:"mousemoveEvent",value:function(a){var l=a.layerPoint;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"mousemoveEvent",this).call(this,l,a)}},{key:"bindEvent",value:function(){var a=this.map;this.options.methods&&(this.options.methods.click&&a.on("click",this.clickEvent),this.options.methods.mousemove&&a.on("mousemove",this.mousemoveEvent)),this.map.on("movestart",this._moveStartEvent),this.map.on("moveend",this._moveEndEvent),this.map.on("zoomstart",this._zoomStartEvent)}},{key:"destroy",value:function(){this.unbindEvent(),this.clearData(),this.animator&&this.animator.stop(),this.animator=null,this.canvasLayer=null}},{key:"unbindEvent",value:function(){var a=this.map;this.options.methods&&(this.options.methods.click&&a.off("click",this.clickEvent),this.options.methods.mousemove&&a.off("mousemove",this.mousemoveEvent)),this.map.off("movestart",this._moveStartEvent),this.map.off("moveend",this._moveEndEvent),this.map.off("zoomstart",this._zoomStartEvent)}},{key:"getContext",value:function(){return this.canvasLayer.getCanvas().getContext(this.context)}},{key:"addData",value:function(a,l){var d=a;a&&a.get&&(d=a.get()),this.dataSet.add(d),this.update({options:l})}},{key:"update",value:function(a){var l=a||{},d=l.data;d&&d.get&&(d=d.get()),d!=null&&this.dataSet.set(d),A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"update",this).call(this,{options:l.options})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(a){if(!!this.dataSet){var l=this.dataSet.get({filter:function(f){return a!=null&&typeof a=="function"?!a(f):!0}});this.dataSet.set(l),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"_canvasUpdate",value:function(a){if(!!this.canvasLayer){var l=this,d=l.options.animation,f=this.getContext(),m=this.map;if(l.isEnabledTime()){if(a===void 0){this.clear(f);return}this.context==="2d"&&(f.save(),f.globalCompositeOperation="destination-out",f.fillStyle="rgba(0, 0, 0, .1)",f.fillRect(0,0,f.canvas.width,f.canvas.height),f.restore())}else this.clear(f);if(this.context==="2d")for(var S in l.options)f[S]=l.options[S];else f.clear(f.COLOR_BUFFER_BIT);if(!(l.options.minZoom&&m.getZoom()<l.options.minZoom||l.options.maxZoom&&m.getZoom()>l.options.maxZoom)){var C=m.getBounds(),I=C.getEast()-C.getWest(),M=C.getNorth()-C.getSouth(),F=m.getSize(),T=I/F.x,G=M/F.y,B=this.canvasLayer.getTopLeft(),V=m.latLngToContainerPoint(B),H={transferCoordinate:function(he){var ye;l.context==="2d"?ye=m.latLngToContainerPoint(L.latLng(he[1],he[0])):ye={x:(he[0]-B.lng)/T,y:(B.lat-he[1])/G};var oe={x:ye.x-V.x,y:ye.y-V.y};return[oe.x,oe.y]}};a!==void 0&&(H.filter=function(X){var he=d.trails||10;return a&&X.time>a-he&&X.time<a});var Z=l.dataSet.get(H);this.processData(Z),l.options._size=l.options.size;var ne=m.latLngToContainerPoint(L.latLng(0,0)),K={x:ne.x-V.x,y:ne.y-V.y};this.drawContext(f,Z,l.options,K),l.options.updateCallback&&l.options.updateCallback(a)}}}},{key:"init",value:function(a){var l=this;l.options=a,this.initDataRange(a),this.context=l.options.context||"2d",l.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(l.options.zIndex),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){}},{key:"moveStartEvent",value:function(){var a=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=a.stepsRange.start,this._hide())}},{key:"moveEndEvent",value:function(){this.canvasLayer.draw(),this._show()}},{key:"zoomStartEvent",value:function(){this._hide()}},{key:"clear",value:function(a){a&&a.clearRect&&a.clearRect(0,0,a.canvas.width,a.canvas.height)}},{key:"_hide",value:function(){this.canvasLayer.canvas.style.display="none"}},{key:"_show",value:function(){this.canvasLayer.canvas.style.display="block"}},{key:"draw",value:function(){this.canvasLayer.draw()}}]),s}(Ke),En;if(typeof L<"u"){var ul=L.Layer.extend({options:{attributionPrefix:null,attribution:""},initialize:function(s,o,a){a=a||{},this.dataSet=s||{},this.mapVOptions=o||{},this.render=this.render.bind(this),L.Util.setOptions(this,a),this.options.attributionPrefix&&(this.options.attribution=this.options.attributionPrefix+this.options.attribution),this.canvas=this._createCanvas(),L.stamp(this)},onAdd:function(s){this._map=s;var o=this.getPane(),a=this.container=L.DomUtil.create("div","leaflet-layer leaflet-zoom-animated",o);a.appendChild(this.canvas);var l=s.getSize();a.style.width=l.x+"px",a.style.height=l.y+"px",this.renderer=new ll(s,this,this.dataSet,this.mapVOptions),this.draw(),this.fire("loaded")},onRemove:function(){L.DomUtil.remove(this.container),this.renderer.destroy()},addData:function(s,o){this.renderer.addData(s,o)},update:function(s){this.renderer.update(s)},getData:function(){return this.renderer&&(this.dataSet=this.renderer.getData()),this.dataSet},removeData:function(s){this.renderer&&this.renderer.removeData(s)},clearData:function(){this.renderer.clearData()},draw:function(){return this._reset()},setZIndex:function(s){this.canvas.style.zIndex=s},render:function(){this.renderer._canvasUpdate()},getCanvas:function(){return this.canvas},getContainer:function(){return this.container},getTopLeft:function(){var s=this._map,o;if(s){var a=s.getBounds();o=a.getNorthWest()}return o},_createCanvas:function(){var s=document.createElement("canvas");s.style.position="absolute",s.style.top=0+"px",s.style.left=0+"px",s.style.pointerEvents="none",s.style.zIndex=this.options.zIndex||600;var o=typeof window>"u"?{}:window,a=this.devicePixelRatio=o.devicePixelRatio;return(!this.mapVOptions.context||this.mapVOptions.context==="2d")&&s.getContext("2d").scale(a,a),s},_resize:function(){var s=this.canvas;if(!!s){var o=this._map,a=o.getSize();s.width=a.x,s.height=a.y,s.style.width=a.x+"px",s.style.height=a.y+"px";var l=o.getBounds(),d=o.latLngToLayerPoint(l.getNorthWest());L.DomUtil.setPosition(s,d)}},_reset:function(){this._resize(),this._render()},redraw:function(){this._resize(),this._render()},_render:function(){this.render()}});En=function(s,o,a){return new ul(s,o,a)}}var hl=En,cl=function(u){E(s,u);function s(o,a,l,d){y(this,s);var f=k(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o,a,l));return Ke?(f.map=o,f.scene=o.scene,f.dataSet=a,l=l||{},f.init(l),f.argCheck(l),f.initDevicePixelRatio(),f.canvasLayer=d,f.stopAniamation=!1,f.animation=l.animation,f.clickEvent=f.clickEvent.bind(f),f.mousemoveEvent=f.mousemoveEvent.bind(f),f.bindEvent(),f):k(f)}return w(s,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"clickEvent",value:function(a){var l=a.point;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"clickEvent",this).call(this,l,a)}},{key:"mousemoveEvent",value:function(a){var l=a.point;A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"mousemoveEvent",this).call(this,l,a)}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var a=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=a.stepsRange.start)}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator}},{key:"bindEvent",value:function(){this.map,this.options.methods&&(this.options.methods.click,this.options.methods.mousemove)}},{key:"unbindEvent",value:function(){var a=this.map;this.options.methods&&(this.options.methods.click&&a.off("click",this.clickEvent),this.options.methods.mousemove&&a.off("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"init",value:function(a){this.options=a,this.initDataRange(a),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}},{key:"_canvasUpdate",value:function(a){this.map;var l=this.scene;if(this.canvasLayer&&!this.stopAniamation){var d=this.options.animation,f=this.getContext();if(this.isEnabledTime()){if(a===void 0)return void this.clear(f);this.context==="2d"&&(f.save(),f.globalCompositeOperation="destination-out",f.fillStyle="rgba(0, 0, 0, .1)",f.fillRect(0,0,f.canvas.width,f.canvas.height),f.restore())}else this.clear(f);if(this.context==="2d")for(var m in this.options)f[m]=this.options[m];else f.clear(f.COLOR_BUFFER_BIT);var S={transferCoordinate:function(F){var T=Cesium.Cartesian3.fromDegrees(F[0],F[1]),G=Cesium.SceneTransforms.wgs84ToWindowCoordinates(l,T);return G==null?[-1,-1]:[G.x,G.y]}};a!==void 0&&(S.filter=function(M){var F=d.trails||10;return!!(a&&M.time>a-F&&M.time<a)});var C=this.dataSet.get(S);this.processData(C),this.options.unit=="m"&&this.options.size,this.options._size=this.options.size;var I=Cesium.SceneTransforms.wgs84ToWindowCoordinates(l,Cesium.Cartesian3.fromDegrees(0,0));this.drawContext(f,new x(C),this.options,I),this.options.updateCallback&&this.options.updateCallback(a)}}},{key:"updateData",value:function(a,l){var d=a;d&&d.get&&(d=d.get()),d!=null&&this.dataSet.set(d),A(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"update",this).call(this,{options:l})}},{key:"addData",value:function(a,l){var d=a;a&&a.get&&(d=a.get()),this.dataSet.add(d),this.update({options:l})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(a){if(this.dataSet){var l=this.dataSet.get({filter:function(f){return a==null||typeof a!="function"||!a(f)}});this.dataSet.set(l),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"clear",value:function(a){a&&a.clearRect&&a.clearRect(0,0,a.canvas.width,a.canvas.height)}}]),s}(Ke),bn;if(typeof Cesium<"u"){var dl=0;Cesium;var fl=function(){function u(s,o,a,l){if(y(this,u),this.map=s,this.scene=s.scene,this.mapvBaseLayer=new cl(s,o,a,this),this.mapVOptions=a,this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.render=this.render.bind(this),l)this.container=l;else{var d=s.container.querySelector(".cesium-viewer-cesiumWidgetContainer");this.container=d||s.container}this.addInnerContainer(),this.bindEvent(),this._reset()}return w(u,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"addInnerContainer",value:function(){this.container.appendChild(this.canvas)}},{key:"bindEvent",value:function(){var o=this;this.innerMoveStart=this.moveStartEvent.bind(this),this.innerMoveEnd=this.moveEndEvent.bind(this),this.scene.camera.moveStart.addEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.addEventListener(this.innerMoveEnd,this);var a=new Cesium.ScreenSpaceEventHandler(this.scene.canvas);a.setInputAction(function(l){o.innerMoveEnd()},Cesium.ScreenSpaceEventType.LEFT_UP),a.setInputAction(function(l){o.innerMoveEnd()},Cesium.ScreenSpaceEventType.MIDDLE_UP),this.handler=a}},{key:"unbindEvent",value:function(){this.scene.camera.moveStart.removeEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.removeEventListener(this.innerMoveEnd,this),this.scene.postRender.removeEventListener(this._reset,this),this.handler&&(this.handler.destroy(),this.handler=null)}},{key:"moveStartEvent",value:function(){this.mapvBaseLayer&&(this.mapvBaseLayer.animatorMovestartEvent(),this.scene.postRender.addEventListener(this._reset,this))}},{key:"moveEndEvent",value:function(){this.mapvBaseLayer&&(this.scene.postRender.removeEventListener(this._reset,this),this.mapvBaseLayer.animatorMoveendEvent(),this._reset())}},{key:"zoomStartEvent",value:function(){this._unvisiable()}},{key:"zoomEndEvent",value:function(){this._unvisiable()}},{key:"addData",value:function(o,a){this.mapvBaseLayer!=null&&this.mapvBaseLayer.addData(o,a)}},{key:"updateData",value:function(o,a){this.mapvBaseLayer!=null&&this.mapvBaseLayer.updateData(o,a)}},{key:"getData",value:function(){return this.mapvBaseLayer&&(this.dataSet=this.mapvBaseLayer.getData()),this.dataSet}},{key:"removeData",value:function(o){this.mapvBaseLayer!=null&&this.mapvBaseLayer&&this.mapvBaseLayer.removeData(o)}},{key:"removeAllData",value:function(){this.mapvBaseLayer!=null&&this.mapvBaseLayer.clearData()}},{key:"_visiable",value:function(){return this.canvas.style.display="block",this}},{key:"_unvisiable",value:function(){return this.canvas.style.display="none",this}},{key:"_createCanvas",value:function(){var o=document.createElement("canvas");o.id=this.mapVOptions.layerid||"mapv"+dl++,o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.style.pointerEvents="none",o.style.zIndex=this.mapVOptions.zIndex||0,o.width=parseInt(this.map.canvas.width),o.height=parseInt(this.map.canvas.height),o.style.width=this.map.canvas.style.width,o.style.height=this.map.canvas.style.height;var a=this.devicePixelRatio;return this.mapVOptions.context=="2d"&&o.getContext(this.mapVOptions.context).scale(a,a),o}},{key:"_reset",value:function(){this.resizeCanvas(),this.fixPosition(),this.onResize(),this.render()}},{key:"draw",value:function(){this._reset()}},{key:"show",value:function(){this._visiable()}},{key:"hide",value:function(){this._unvisiable()}},{key:"destroy",value:function(){this.remove()}},{key:"remove",value:function(){this.mapvBaseLayer!=null&&(this.removeAllData(),this.mapvBaseLayer.clear(this.mapvBaseLayer.getContext()),this.mapvBaseLayer=void 0,this.canvas.parentElement.removeChild(this.canvas))}},{key:"update",value:function(o){o!=null&&this.updateData(o.data,o.options)}},{key:"resizeCanvas",value:function(){if(this.canvas!=null&&this.canvas!=null){var o=this.canvas;o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.width=parseInt(this.map.canvas.width),o.height=parseInt(this.map.canvas.height),o.style.width=this.map.canvas.style.width,o.style.height=this.map.canvas.style.height}}},{key:"fixPosition",value:function(){}},{key:"onResize",value:function(){}},{key:"render",value:function(){this.mapvBaseLayer!=null&&this.mapvBaseLayer._canvasUpdate()}}]),u}();bn=function(s,o,a,l){return new fl(s,o,a,l)}}var pl=bn,gl={getDataSet:function(s){var o=[],a=s.features;if(a)for(var l=0;l<a.length;l++){var d=a[l],f=d.geometry,m=d.properties,S={};for(var C in m)S[C]=m[C];S.geometry=f,o.push(S)}return new x(o)}},vl={CSVToArray:function(s,o){o=o||",";for(var a=new RegExp("(\\"+o+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+o+"\\r\\n]*))","gi"),l=[[]],d=null;d=a.exec(s);){var f=d[1];f.length&&f!==o&&l.push([]);var m;d[2]?m=d[2].replace(new RegExp('""',"g"),'"'):m=d[3],l[l.length-1].push(m)}return l},getDataSet:function(s,o){for(var a=this.CSVToArray(s,o||","),l=[],d=a[0],f=1;f<a.length-1;f++){for(var m=a[f],S={},C=0;C<m.length;C++){var I=m[C];d[C]=="geometry"&&(I=JSON.parse(I)),S[d[C]]=I}l.push(S)}return new x(l)}};t.version=r,t.canvasClear=i,t.canvasResolutionScale=h,t.canvasDrawSimple=W,t.canvasDrawHeatmap=Xi,t.canvasDrawGrid=$i,t.canvasDrawHoneycomb=en,t.webglDrawSimple=hn,t.webglDrawPoint=nn,t.webglDrawLine=rn,t.webglDrawPolygon=un,t.utilCityCenter=v,t.utilCurve=Io,t.utilForceEdgeBundling=To,t.utilDataRangeIntensity=Y,t.utilDataRangeCategory=Wt,t.utilDataRangeChoropleth=Lt,t.Map=_o,t.baiduMapCanvasLayer=Ge,t.baiduMapAnimationLayer=Xo,t.baiduMapLayer=$o,t.googleMapCanvasLayer=pe,t.googleMapLayer=el,t.MaptalksLayer=rl,t.AMapLayer=nl,t.OpenlayersLayer=al,t.leafletMapLayer=hl,t.cesiumMapLayer=pl,t.DataSet=x,t.geojson=gl,t.csv=vl,Object.defineProperty(t,"__esModule",{value:!0})})})(Pt,Pt.exports);const Ga=ra(Pt.exports),Ba=rs({__proto__:null,default:Ga},[Pt.exports]);var za=Pt.exports.baiduMapLayer?Pt.exports.baiduMapLayer.__proto__:Function;class Ua extends za{constructor(e,t,r,i,h,c){super(e,t,r),this.dataSet=t,this.mapWidth=i,this.mapHeight=h;var p=this;r=r||{},this.source=c,p.animator=null,p.map=e,p.init(r),p.argCheck(r),this.canvasLayer=new Da({map:e,context:this.context,paneName:r.paneName,mixBlendMode:r.mixBlendMode,enableMassClear:r.enableMassClear,zIndex:r.zIndex,width:i,height:h,update:function(){p._canvasUpdate()}}),this.clickEvent=this.clickEvent.bind(this),this.mousemoveEvent=this.mousemoveEvent.bind(this),e.on("movestart",this.moveStartEvent.bind(this)),e.on("moveend",this.moveEndEvent.bind(this)),e.getView().on("change:center",this.zoomEvent.bind(this)),e.getView().on("change:size",this.sizeEvent.bind(this)),e.on("pointerdrag",this.dragEvent.bind(this)),this.bindEvent()}init(e){var t=this;t.options=e,this.initDataRange(e),this.context=t.options.context||"2d",t.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(t.options.zIndex),this.initAnimator()}clickEvent(e){var t=e.pixel;super.clickEvent({x:t[0]+this.offset[0],y:t[1]+this.offset[1]},e)}mousemoveEvent(e){var t=e.pixel;super.mousemoveEvent({x:t[0],y:t[1]},e)}dragEvent(){this.clear(this.getContext())}zoomEvent(){this.clear(this.getContext())}sizeEvent(){this.canvasLayer.resize()}moveStartEvent(){var e=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=e.stepsRange.start)}moveEndEvent(){this.canvasLayer.draw()}bindEvent(){var e=this,t=e.map;e.options.methods&&(e.options.methods.click&&t.on("click",e.clickEvent),e.options.methods.mousemove&&(e.pointerInteraction=new ps.default,e.pointerInteraction.handleMoveEvent_=function(r){e.mousemoveEvent(r)},t.addInteraction(e.pointerInteraction)))}unbindEvent(){var e=this.map;this.options.methods&&(this.options.methods.click&&e.un("click",this.clickEvent),this.options.methods.mousemove&&e.removeInteraction(this.pointerInteraction))}addData(e,t){var r=e;e&&e.get&&(r=e.get()),this.dataSet.add(r),this.update({options:t})}update(e){var t=e||{},r=t.data;r&&r.get&&(r=r.get()),r!=null&&this.dataSet.set(r),super.update({options:t.options})}draw(){this.canvasLayer.draw()}getData(){return this.dataSet}removeData(e){if(!!this.dataSet){var t=this.dataSet.get({filter:function(r){return e!=null&&typeof e=="function"?!e(r):!0}});this.dataSet.set(t),this.update({options:null})}}clearData(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}_canvasUpdate(e){if(!this.canvasLayer)return;var t=this,r=t.options.animation,i=t.map,h=t.canvasLayer.canvas.getContext(t.context);if(t.isEnabledTime()){if(e===void 0){t.clear(h);return}(!t.context||t.context==="2d")&&(h.save(),h.globalCompositeOperation="destination-out",h.fillStyle="rgba(0, 0, 0, .1)",h.fillRect(0,0,h.canvas.width,h.canvas.height),h.restore())}else this.clear(h);if(!t.context||t.context==="2d")for(var c in t.options)h[c]=t.options[c];else h.clear(h.COLOR_BUFFER_BIT);var p=i.getView().calculateExtent(),g=i.getPixelFromCoordinate([p[0],p[3]]);t._mapCenter=i.getView().getCenter(),t._mapCenterPx=i.getPixelFromCoordinate(t._mapCenter),t._reselutions=i.getView().getResolution(),t._rotation=-i.getView().getRotation();var v=t._reselutions,y=1;if(this.context!="2d"){var w=typeof window>"u"?{}:window,A=w.devicePixelRatio||1;y=A}var E={transferCoordinate:function(N){var b=(N[0]-t._mapCenter[0])/t._reselutions,R=(t._mapCenter[1]-N[1])/t._reselutions,W=[b+t._mapCenterPx[0],R+t._mapCenterPx[1]];return W=k(W,t._mapCenterPx,1),[(W[0]+t.offset[0])*y,(W[1]+t.offset[1])*y]}};function k(N,b,R){var W=(N[0]-b[0])*R+b[0],ee=(N[1]-b[1])*R+b[1];return[W,ee]}e!==void 0&&(E.filter=function(N){var b=r.trails||10;return e&&N.time>e-b&&N.time<e}),t.isEnabledTime()&&!t.notFirst&&(t.canvasLayer.resize(t.mapWidth,t.mapHeight),t.notFirst=!0);var z=t.dataSet.get(E);t.processData(z),t.options.unit==="m"?(t.options.size&&(t.options._size=t.options.size/v),t.options.width&&(t.options._width=t.options.width/v),t.options.height&&(t.options._height=t.options.height/v)):(t.options._size=t.options.size,t.options._height=t.options.height,t.options._width=t.options.width);var x=i.getPixelFromCoordinate([0,0]);x=[x[0]-g[0],x[1]-g[1]],this.drawContext(h,z,t.options,{x:x[0],y:x[1]}),t.isEnabledTime()&&this.source.changed(),t.options.updateCallback&&t.options.updateCallback(e)}isEnabledTime(){var e=this.options.animation;return e&&e.enabled!==!1}argCheck(e){e.draw==="heatmap"&&e.strokeStyle&&console.warn("[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]")}getContext(){return this.canvasLayer.canvas.getContext(this.context)}clear(e){e&&e.clearRect&&e.clearRect(0,0,e.canvas.width,e.canvas.height)}}class qa extends fi.default{constructor(e){var t=e||{};super({attributions:t.attributions||"\xA9 2018 \u767E\u5EA6 MapV with <span>\xA9 <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>",canvasFunction:r,logo:Ce.getOlVersion()==="4"?t.logo:null,projection:t.projection,ratio:t.ratio,resolutions:t.resolutions,state:t.state}),this.map=e.map,this.dataSet=e.dataSet,this.mapvOptions=e.mapvOptions;function r(i,h,c,p,g){var v=p[0]/c,y=p[1]/c,w=this.map.getSize()[0],A=this.map.getSize()[1];this.layer||(this.layer=new Ua(this.map,this.dataSet,this.mapvOptions,v,y,this)),this.layer.pixelRatio=c,this.layer.offset=[(v-w)/2,(y-A)/2],this.rotate?this.rotate!==this.map.getView().getRotation()&&(this.layer.canvasLayer.resize(v,y),this.rotate=this.map.getView().getRotation()):this.rotate=this.map.getView().getRotation();var E=this.layer.canvasLayer.canvas;this.layer.isEnabledTime()||(this.layer.canvasLayer.resize(v,y),this.layer.canvasLayer.draw()),this.context||(this.context=Ce.createCanvasContext2D(v,y));var k=this.context.canvas;return this.context.clearRect(0,0,k.width,k.height),k.width=p[0],k.height=p[1],k.style.width=p[0]+"px",k.style.height=p[1]+"px",this.context.drawImage(E,0,0),(this.resolution!==h||JSON.stringify(this.extent)!==JSON.stringify(i))&&(this.resolution=h,this.extent=i),this.context.canvas}}addData(e,t){this.layer.addData(e,t)}getData(){return this.layer&&(this.dataSet=this.layer.getData()),this.dataSet}removeData(e){this.layer&&this.layer.removeData(e)}clearData(){this.layer.clearData()}update(e){this.layer.update(e),this.changed()}}class zr extends gs.default{constructor(e){e.stroke?(e.stroke.color=e.stroke.getColor()||"#3388ff",e.stroke.width=e.stroke.getWidth()||1):e.stroke=new pi.default({color:"#3388ff",width:1}),e.fill?e.fill.color=e.fill.getColor()||"#66ccff":e.fill=new jt.default({color:"#66ccff"}),super({angle:e.angle||60,stroke:e.stroke,fill:e.fill,radius:e.radius||10,rotation:e.rotation||0}),this.count_=e.count||3,this.strokeOpacity=e.strokeOpacity||1,this.fillOpacity=e.fillOpacity||1,this._pixelRatio=window?window.devicePixelRatio:1,this._canvas=this.getImage(this._pixelRatio),this._ctx=this._canvas.getContext("2d"),this._render()}_render(){var e=0,t=this.getAngle();if(this.spaceAngle=360/this.count_-this.getAngle(),!(this.spaceAngle<0)){this._ctx.setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0),this._ctx.translate(0,0),this._ctx.beginPath();for(var r=0;r<this.count_;r++)this._drawSector(this._ctx,this.getAnchor()[0],this.getAnchor()[1],this.getRadius(),e,t),e=t+this.spaceAngle,t=e+this.getAngle();this._fillStroke(),this._ctx.closePath()}}_drawSector(e,t,r,i,h,c){h=h/180*Math.PI,c=c/180*Math.PI,e.moveTo(t,r),e.lineTo(t+i*Math.cos(h),r+i*Math.sin(h)),e.arc(t,r,i,h,c),e.lineTo(t,r)}_fillStroke(){this.getFill()&&(this._ctx.globalAlpha=this.fillOpacity,this._ctx.fillStyle=this.getFill().color,this._ctx.fill()),this.getStroke()&&this.weight!==0&&(this._ctx.globalAlpha=this.strokeOpacity,this._ctx.lineWidth=this.getStroke().width,this._ctx.strokeStyle=this.getStroke().color,this._ctx.lineCap=this.getStroke().lineCap,this._ctx.lineJoin=this.getStroke().lineJoin,this._ctx.stroke())}getCount(){return this.count_}getSpaceAngle(){return this.spaceAngle}}class Ur extends zr{constructor(e){super(e),this.sAngle=e.sAngle,this.eAngle=e.eAngle,this._render()}_render(){this._ctx.clearRect(0,0,this.getImage().width,this.getImage().height),this._ctx.setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0),this._ctx.translate(0,0),this._ctx.beginPath(),this._drawSector(this._ctx,this.getAnchor()[0],this.getAnchor()[1],this.getRadius(),this.sAngle,this.eAngle),this._fillStroke(),this._ctx.closePath()}getSAngle(){return this.sAngle}getEAngle(){return this.eAngle}}const Va=()=>!1,Ji=function(){let n=document.createElement("div"),e=["transform","WebkitTransform","MozTransform","OTransform","msTransform"];for(let t=0;t<e.length;t++){let r=e[t];if(n.style[r]!==void 0)return r}return e[0]}();class Zi extends xr.default{constructor(e,t){super(),this.layer=e,this.map=e.map;let r=t||{};O.extend(this,r);let i=this.pixelRatio=window?window.devicePixelRatio:1;this.width=this.map.getSize()[0]*i,this.height=this.map.getSize()[1]*i,this.center=this.map.getView().getCenter(),this._initContainer(),this._registerEvents()}_registerEvents(){let e=this.map,t=e.getView();e.on("change:size",this._resizeEvent.bind(this),this),t.on("change:resolution",this._moveEndEvent.bind(this),this),t.on("change:center",this._moveEvent.bind(this),this),t.on("change:rotation",this._moveEndEvent.bind(this),this),e.on("moveend",this._moveEndEvent.bind(this),this)}_resizeEvent(){this._resize(),this._clearAndRedraw()}_moveEvent(){let e=this.map.getPixelFromCoordinate(this.center),t=this.map.getPixelFromCoordinate(this.map.getView().getCenter()),r=[e[0]-t[0],e[1]-t[1]];this._canvas.style[Ji]="translate("+Math.round(r[0])+"px,"+Math.round(r[1])+"px)"}_moveEndEvent(){this._canvas.style[Ji]="translate(0,0)",this.center=this.map.getView().getCenter(),this._clearAndRedraw()}_clearAndRedraw(){this._clearBuffer(),this.layer.changed()}_resize(){const e=this.map.getSize(),t=e[0]*this.pixelRatio,r=e[1]*this.pixelRatio;this._canvas.width=t,this._canvas.height=r,this._canvas.style.width=t+"px",this._canvas.style.height=r+"px"}_clearBuffer(){if(!this.deckGL)return;let e=this.deckGL.layerManager;return e&&e.context.gl.clear(e.context.gl.COLOR_BUFFER_BIT),this}getCanvas(){return this._canvas}update(e){if(e&&e.length>-1&&(this._data=e),!this._renderLayer)return;this._renderLayer.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,updateTriggersChanged:!0}),this._refreshData();let t=this._getLayerState();t.data=this._data||[],this._renderLayer.setNeedsRedraw(!0),this._renderLayer.setState(t)}drawGraphics(e){this._data=e||(this._data?this._data:[]),this._renderLayer||this._createInnerRender(),this._clearBuffer(),this._draw()}_initContainer(){this._canvas=this._createCanvas(this.width,this.height),this._layerContainer=this.container,this._wrapper=document.createElement("div"),this._wrapper.className="deck-wrapper",this._wrapper.style.position="absolute",this._wrapper.style.top="0",this._wrapper.style.left="0",this._wrapper.appendChild(this._canvas),this._layerContainer&&this._layerContainer.appendChild(this._wrapper)}_createCanvas(e,t){let r=document.createElement("canvas");return r.oncontextmenu=Va,r.width=e,r.height=t,r.style.width=e+"px",r.style.height=t+"px",r}_createInnerRender(){let e=this,t=this._getLayerState(),{color:r,radius:i,opacity:h,highlightColor:c,radiusScale:p,radiusMinPixels:g,radiusMaxPixels:v,strokeWidth:y,outline:w}=t;i=this._pixelToMeter(i);let A={id:"scatter-plot",data:[],pickable:Boolean(this.onClick)||Boolean(this.onHover),autoHighlight:!0,color:r,opacity:h,radius:i,radiusScale:p,highlightColor:c,radiusMinPixels:g,radiusMaxPixels:v,strokeWidth:y,outline:w,getPosition(k){if(!k)return[0,0,0];let z=k.getGeometry(),x=z&&z.getCoordinates();return x=e._project(x),x&&[x[0],x[1],0]},getColor(k){let z=e._getLayerDefaultStyle(),x=k&&k.getStyle();return x&&x.getColor()||z.color},getRadius(k){let z=e._getLayerDefaultStyle(),x=k&&k.getStyle();return x&&x.getRadius()||z.radius},updateTriggers:{getColor:[r],getRadius:[i]}},E=this;this.onClick&&(A.onClick=function(){E._canvas.style.cursor="pointer",E.onClick.apply(E,arguments)}),this.onHover&&(A.onHover=function(){E._canvas.style.cursor="pointer",E.onHover.apply(E,arguments)}),e._renderLayer=new window.DeckGL.ScatterplotLayer(A)}_getLayerDefaultStyle(){let{color:e,opacity:t,radius:r,radiusScale:i,radiusMinPixels:h,radiusMaxPixels:c,strokeWidth:p,outline:g}=this._getLayerState();return r=this._pixelToMeter(r),{color:e,opacity:t,radius:r,radiusScale:i,radiusMinPixels:h,radiusMaxPixels:c,strokeWidth:p,outline:g}}_getLayerState(){let e=this.layer.getLayerState(),r=this.map.getView().getProjection().getCode(),i=ci.transform([e.longitude,e.latitude],r,"EPSG:4326");return e.longitude=i[0],e.latitude=i[1],e.zoom=e.zoom-1,e}_draw(){this._refreshData();let e=this._getLayerState();e.data=this._data||[];let t={};for(let r in e)t[r]=e[r];this._renderLayer.setNeedsRedraw(!0),t.layers=[this._renderLayer],t.canvas=this._canvas,this.onBeforeRender&&(t.onBeforeRender=this.onBeforeRender.bind(this)),this.onAfterRender&&(t.onAfterRender=this.onAfterRender.bind(this)),this.deckGL?this.deckGL.setProps(t):this.deckGL=new window.DeckGL.experimental.DeckGLJS(t)}_refreshData(){let e=this._data||[],t=Ce.isArray(e)?[].concat(e):[e];this._renderLayer.props.data||(this._renderLayer.props.data=[]),this._renderLayer.props.data.length=0;for(let r=0;r<t.length;r++)this._renderLayer.props.data.push(t[r]);this._data=this._renderLayer.props.data}_project(e){let r=this.map.getView().getProjection().getCode();return r==="EPSG:4326"?e:ci.transform(e,r,"EPSG:4326")}_pixelToMeter(e){let t=this.map.getView(),i=t.getProjection().getUnits()||"degrees";i==="degrees"&&(i=Ve.DEGREE),i==="m"&&(i=Ve.METER);const h=t.getResolution();if(i===Ve.DEGREE){let c=h*(Math.PI*6378137/180);return e*c}else return e*h}}function Wa(n,e,t){let r=(n[0]-e[0])*t+e[0],i=(n[1]-e[1])*t+e[1];return[r,i]}class Ha extends xr.default{constructor(e,t){super(),this.layer=e,this.map=e.map;let r=t||{};O.extend(this,r),this.highLightStyle=this.layer.highLightStyle,this.mapWidth=this.size[0]/this.pixelRatio,this.mapHeight=this.size[1]/this.pixelRatio,this.width=this.map.getSize()[0],this.height=this.map.getSize()[1],this.context=Ce.createCanvasContext2D(this.mapWidth,this.mapHeight),this.context.scale(this.pixelRatio,this.pixelRatio),this.canvas=this.context.canvas,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this._registerEvents()}_registerEvents(){this.map.on("change:size",this._resizeEvent.bind(this),this)}_resizeEvent(){this._resize(),this._clearAndRedraw()}_resize(){let e=this.map.getSize(),t=e[0],r=e[1],i=t/this.width,h=r/this.height;this.width=t,this.height=r,this.mapWidth=this.mapWidth*i,this.mapHeight=this.mapHeight*h,this.canvas.width=this.mapWidth,this.canvas.height=this.mapHeight,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px"}_clearAndRedraw(){this._clearBuffer(),this.layer.changed()}update(){this.layer.changed()}_clearBuffer(){}getCanvas(){return this.canvas}drawGraphics(e){this.graphics_=e||[];let t=this.mapWidth,r=this.mapHeight,i=is.toContext(this.context,{size:[t,r],pixelRatio:this.pixelRatio}),h=this.layer._getDefaultStyle(),c=this,p=c.layer,g=p.map;e.map(function(v){let y=v.getStyle()||h;if(c.selected===v){let ee=y;y instanceof ot.Circle?ee=new ot.Circle({radius:y.getRadius(),fill:new ot.Fill({color:"rgba(0, 153, 255, 1)"}),stroke:y.getStroke(),snapToPixel:Ce.getOlVersion()==="4"?y.getSnapToPixel():null}):y instanceof ot.RegularShape&&(ee=new ot.RegularShape({radius:y.getRadius(),radius2:y.getRadius2(),points:y.getPoints(),angle:y.getAngle(),snapToPixel:Ce.getOlVersion()==="4"?y.getSnapToPixel():null,rotation:y.getRotation(),rotateWithView:y.getRotateWithView(),fill:new ot.Fill({color:"rgba(0, 153, 255, 1)"}),stroke:y.getStroke()})),y=c.highLightStyle||ee}i.setStyle(new ot.Style({image:y}));let A=v.getGeometry().getCoordinates(),E=g.getView().getCenter(),k=g.getPixelFromCoordinate(E),z=g.getView().getResolution(),x=(A[0]-E[0])/z,N=(E[1]-A[1])/z,b=[x+k[0],N+k[1]];b=Wa(b,k,1);let R=[b[0]+c.offset[0],b[1]+c.offset[1]],W=new gi.default(R);return i.drawGeometry(W),v})}}class Bt extends xr.default{constructor(e,t){super(),e instanceof mr.default&&(this.geometry_=e),this.attributes=t,this.setStyle()}clone(){var e=new Bt;return e.setId(this.id),e.setGeometry(this.geometry_),e.setAttributes(this.attributes),e.setStyle(this.style_),e}getId(){return this.id}setId(e){this.id=e}getGeometry(){return this.geometry_}setGeometry(e){this.geometry_=e}setAttributes(e){this.attributes=e}getAttributes(){return this.attributes}getStyle(){return this.style_}setStyle(e){!this.style&&!e||(this.style_=e,this.styleFunction_=e?Bt.createStyleFunction(new Sr.default({image:e})):void 0,this.changed())}getStyleFunction(){return this.styleFunction_}static createStyleFunction(e){var t;if(typeof e=="function")e.length==2?t=function(i){return e(this,i)}:t=e;else{var r;Array.isArray(e)?r=e:r=[e],t=function(){return r}}return t}destroy(){this.id=null,this.geometry_=null,this.attributes=null,this.style_=null}}const Ja={color:[0,0,0,255],opacity:.8,radius:10,radiusScale:1,radiusMinPixels:0,radiusMaxPixels:Number.MAX_SAFE_INTEGER,strokeWidth:1,outline:!1},qr=["canvas","webgl"];class Vr extends fi.default{constructor(e){super({attributions:e.attributions,canvasFunction:r,logo:Ce.getOlVersion()==="4"?e.logo:null,projection:e.projection,ratio:e.ratio,resolutions:e.resolutions,state:e.state}),this.graphics=[].concat(e.graphics),this.map=e.map,O.extend(this,e),this.render=e.render||qr[0],Ce.supportWebGL2()||(this.render=qr[0]),this.highLightStyle=e.highLightStyle,this.isHighLight=typeof e.isHighLight>"u"?!0:e.isHighLight,this.hitGraphicLayer=null,this._forEachFeatureAtCoordinate=h;const t=this;e.onClick&&t.map.on("click",function(c){if(t.renderer instanceof Zi)return;const p=t.map.getFeaturesAtPixel(c.pixel)||[];for(let g=0;g<p.length;g++){const v=p[g];if(t.graphics.indexOf(v)>-1){e.onClick(v,c),t.isHighLight&&t._highLight(v.getGeometry().getCoordinates(),new Sr.default({image:v.getStyle()}).getImage(),v,c.pixel);break}}});function r(c,p,g,v,y){var w=v[0]/g,A=v[1]/g,E=t.map.getSize()[0],k=t.map.getSize()[1];t.renderer||(t.renderer=i(v,g)),t.renderer.mapWidth=w,t.renderer.mapHeight=A,t.renderer.pixelRatio=g,t.renderer.offset=[(w-E)/2,(A-k)/2];let z=this.getGraphicsInExtent(c);return t.renderer._clearBuffer(),t.renderer.selected=this.selected,t.renderer.drawGraphics(z),t.renderer.getCanvas()}function i(c,p){let g;if(t.render===qr[0])g=new Ha(t,{size:c,pixelRatio:p});else{let v=O.extend({},Ja),y=O.extend(v,{color:t.color,opacity:t.opacity,radius:t.radius,radiusScale:t.radiusScale,radiusMinPixels:t.radiusMinPixels,radiusMaxPixels:t.radiusMaxPixels,strokeWidth:t.strokeWidth,outline:t.outline,onClick:t.onClick,onHover:t.onHover});y=O.extend(t,y),y.pixelRatio=p,y.container=t.map.getViewport().getElementsByClassName("ol-overlaycontainer")[0],y.onBeforeRender=function(){return!1},y.onAfterRender=function(){return!1},g=new Zi(t,y)}return g}function h(c,p,g,v,y){let w=t.getGraphicsInExtent();t._highLightClose();for(let A=w.length-1;A>=0;A--){let E=w[A].getStyle();if(!E)return;if(E instanceof Ur)continue;let k=w[A].getGeometry().getCoordinates(),z=new Sr.default({image:E}).getImage(),x=!1;if(z instanceof zr&&z.getCount()===1){const N=z.getRotation()*180/Math.PI,b=Number.parseFloat(z.getAngle()),R=z.getRadius()*p;let W=null;if(b>355)W=new vi.default(k,R);else{const ee=[];ee.push(k);const Y=b/8;for(let j=0;j<8;j++){const re=(N+j*Y)/180*Math.PI;ee.push([k[0]+R*Math.cos(re),k[1]-R*Math.sin(re)])}ee.push(k),W=new vs.default([ee])}W.intersectsCoordinate(this.map.getCoordinateFromPixel(v))&&(x=!0)}else{let N=[];N[0]=k[0]-z.getAnchor()[0]*p,N[2]=k[0]+z.getAnchor()[0]*p,N[1]=k[1]-z.getAnchor()[1]*p,N[3]=k[1]+z.getAnchor()[1]*p,yi.containsCoordinate(N,c)&&(x=!0)}if(x===!0){g&&g(w[A],y);continue}}}}setGraphics(e){this.graphics=this.graphics||[],this.graphics.length=0;let t=Ce.isArray(e)?[].concat(e):[e];this.graphics=[].concat(t),this.update()}addGraphics(e){this.graphics=this.graphics||[];let t=Ce.isArray(e)?[].concat(e):[e];this.graphics=this.graphics.concat(t),this.update()}getGraphicBy(e,t){let r=null;for(let i in this.graphics)if(this.graphics[i][e]===t){r=this.graphics[i];break}return r}getGraphicById(e){return this.getGraphicBy("id",e)}getGraphicsByAttribute(e,t){var r,i=[];for(let h in this.graphics)r=this.graphics[h],r&&r.attributes&&r.attributes[e]===t&&i.push(r);return i}removeGraphics(e=null){if(!e||e.length===0||e===this.graphics){this.graphics.length=0,this.update();return}O.isArray(e)||(e=[e]);for(let t=e.length-1;t>=0;t--){let r=e[t],i=O.indexOf(this.graphics,r);i!==-1&&this.graphics.splice(i,1)}this.update()}clear(){this.removeGraphics()}update(){this.renderer.update(this.graphics,this._getDefaultStyle())}_getDefaultStyle(){const e={};return this.color&&(e.fill=new jt.default({color:this.toRGBA(this.color)})),this.radius&&(e.radius=this.radius),this.outline&&(e.stroke=new jt.default({color:this.toRGBA(this.color),width:this.strokeWidth})),new vi.default(e)}toRGBA(e){return`rgba(${e[0]},${e[1]},${e[2]},${(e[3]||255)/255})`}setStyle(e){let t=this,r={color:t.color,radius:t.radius,opacity:t.opacity,highlightColor:t.highlightColor,radiusScale:t.radiusScale,radiusMinPixels:t.radiusMinPixels,radiusMaxPixels:t.radiusMaxPixels,strokeWidth:t.strokeWidth,outline:t.outline};O.extend(t,O.extend(r,e)),t.update()}getLayerState(){let e=this.map,t=e.getSize()[0],r=e.getSize()[1],i=e.getView(),h=i.getCenter(),c=h[0],p=h[1],g=i.getZoom(),v=i.getMaxZoom(),w=-i.getRotation()*180/Math.PI,A={longitude:c,latitude:p,zoom:g,maxZoom:v,pitch:0,bearing:w},E={};for(let k in A)E[k]=A[k];return E.width=t,E.height=r,E.color=this.color,E.radius=this.radius,E.opacity=this.opacity,E.highlightColor=this.highlightColor,E.radiusScale=this.radiusScale,E.radiusMinPixels=this.radiusMinPixels,E.radiusMaxPixels=this.radiusMaxPixels,E.strokeWidth=this.strokeWidth,E.outline=this.outline,E}_highLightClose(){this.selected=null,this.hitGraphicLayer&&(this.map.removeLayer(this.hitGraphicLayer),this.hitGraphicLayer=null),this.changed()}_highLight(e,t,r,i){if(r.getStyle()instanceof zr){this.hitGraphicLayer&&(this.map.removeLayer(this.hitGraphicLayer),this.hitGraphicLayer=null);var h=this.map.getPixelFromCoordinate([e[0],e[1]]);i=i||[0,0];var c=Math.atan2(i[1]-h[1],i[0]-h[0])/Math.PI*180;c=c>0?c:360+c;var p=Math.ceil(c/(t.getAngle()+t.getSpaceAngle())),g=(p-1)*(t.getAngle()+t.getSpaceAngle()),v={stroke:new pi.default({color:"#ff0000",width:1}),fill:new jt.default({color:"#0099ff"}),radius:t.getRadius(),angle:t.getAngle(),eAngle:g+t.getAngle(),sAngle:g,rotation:t.getRotation()};this.highLightStyle&&this.highLightStyle instanceof Ur&&(v.stroke=this.highLightStyle.getStroke(),v.fill=this.highLightStyle.getFill(),v.radius=this.highLightStyle.getRadius(),v.angle=this.highLightStyle.getAngle());var y=new Bt(new gi.default(e));y.setStyle(new Ur(v)),this.hitGraphicLayer=new ys.default({source:new Vr({map:this.map,graphics:[y]})}),this.map.addLayer(this.hitGraphicLayer)}else this.selected=r,this.changed()}getGraphicsInExtent(e){var t=[];return e?(this.graphics.forEach(r=>{yi.containsExtent(e,r.getGeometry().getExtent())&&t.push(r)}),t):(this.graphics.forEach(r=>{t.push(r)}),t)}}class Za extends Br{constructor(e,t){super(e,t)}getFeaturesByIDs(e,t,r){var i=this,h=new ka(i.url,{proxy:i.options.proxy,withCredentials:i.options.withCredentials,crossOrigin:i.options.crossOrigin,headers:i.options.headers,eventListeners:{processCompleted:t,processFailed:t},format:i._processFormat(r)});h.processAsync(i._processParams(e))}getFeaturesByBounds(e,t,r){var i=this,h=new La(i.url,{proxy:i.options.proxy,withCredentials:i.options.withCredentials,crossOrigin:i.options.crossOrigin,headers:i.options.headers,eventListeners:{processCompleted:t,processFailed:t},format:i._processFormat(r)});h.processAsync(i._processParams(e))}getFeaturesByBuffer(e,t,r){var i=this,h=new Ma(i.url,{proxy:i.options.proxy,withCredentials:i.options.withCredentials,crossOrigin:i.options.crossOrigin,headers:i.options.headers,eventListeners:{processCompleted:t,processFailed:t},format:i._processFormat(r)});h.processAsync(i._processParams(e))}getFeaturesBySQL(e,t,r){var i=this,h=new Fa(i.url,{proxy:i.options.proxy,withCredentials:i.options.withCredentials,crossOrigin:i.options.crossOrigin,headers:i.options.headers,eventListeners:{processCompleted:t,processFailed:t},format:i._processFormat(r)});h.processAsync(i._processParams(e))}getFeaturesByGeometry(e,t,r){var i=this,h=new Ta(i.url,{proxy:i.options.proxy,withCredentials:i.options.withCredentials,crossOrigin:i.options.crossOrigin,headers:i.options.headers,eventListeners:{processCompleted:t,processFailed:t},format:i._processFormat(r)});h.processAsync(i._processParams(e))}editFeatures(e,t){if(!(!e||!e.dataSourceName||!e.dataSetName)){var r=this,i=r.url,h=e.dataSourceName,c=e.dataSetName;i=O.urlPathAppend(i,"datasources/"+h+"/datasets/"+c);var p=new Aa(i,{proxy:r.options.proxy,withCredentials:r.options.withCredentials,crossOrigin:r.options.crossOrigin,headers:r.options.headers,eventListeners:{processCompleted:t,processFailed:t}});p.processAsync(r._processParams(e))}}_processParams(e){if(!e)return{};var t=this;if(e.returnContent=e.returnContent==null?!0:e.returnContent,e.fromIndex=e.fromIndex?e.fromIndex:0,e.toIndex=e.toIndex?e.toIndex:-1,e.bounds&&(e.bounds=Ce.toSuperMapBounds(e.bounds)),e.geometry&&(e.geometry=Ce.toSuperMapGeometry(JSON.parse(new Kt.default().writeGeometry(e.geometry)))),e.editType&&(e.editType=e.editType.toLowerCase()),e.features){var r=[];Ce.isArray(e.features)?e.features.map(function(i){return r.push(t._createServerFeature(i)),i}):r.push(t._createServerFeature(e.features)),e.features=r}return e}_createServerFeature(e){var t={},r=[],i=[],h=e.getProperties();for(var c in h)c!==e.getGeometryName()&&(r.push(c),i.push(h[c]));return t.fieldNames=r,t.fieldValues=i,e.getId()&&(t.id=e.getId()),t.geometry=Ce.toSuperMapGeometry(new Kt.default().writeFeatureObject(e)),t}_processFormat(e){return e||Ir.GEOJSON}}class Ka extends Et{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.TilesetsService"}destroy(){super.destroy()}processAsync(){if(!!this.url){var e=this;e.url=O.urlPathAppend(e.url,"tilesets"),e.request({method:"GET",scope:e,success:e.serviceProcessCompleted,failure:e.serviceProcessFailed})}}}class ja extends Br{constructor(e,t){super(e,t)}getMapInfo(e){var t=this,r=new Hi(t.url,{proxy:t.options.proxy,withCredentials:t.options.withCredentials,crossOrigin:t.options.crossOrigin,headers:t.options.headers,eventListeners:{scope:t,processCompleted:e,processFailed:e},projection:t.options.projection});r.processAsync()}getWkt(e){var t=this,r=new Hi(`${t.url}/prjCoordSys.wkt`,{proxy:t.options.proxy,withCredentials:t.options.withCredentials,withoutFormatSuffix:!0,crossOrigin:t.options.crossOrigin,headers:t.options.headers,eventListeners:{scope:t,processCompleted:e,processFailed:e},projection:t.options.projection});r.processAsync()}getTilesets(e){var t=this,r=new Ka(t.url,{proxy:t.options.proxy,withCredentials:t.options.withCredentials,crossOrigin:t.options.crossOrigin,headers:t.options.headers,eventListeners:{scope:t,processCompleted:e,processFailed:e}});r.processAsync()}}const Qa=Object.freeze(Object.defineProperty({__proto__:null,EditFeaturesParameters:Gr,GetFeaturesBySQLParameters:Wi,SecurityManager:Je,OverlayGraphic:Bt,TileSuperMapRest:mt,DataFlow:Na,Mapv:qa,Graphic:Vr,MapService:ja,FeatureService:Za},Symbol.toStringTag,{value:"Module"}));function Ya(n,e){var t,r,i,h,c,p,g,v,y,w,A=0,E=n.type==="FeatureCollection",k=n.type==="Feature",z=E?n.features.length:1;for(t=0;t<z;t++){for(p=E?n.features[t].geometry:k?n.geometry:n,v=E?n.features[t].properties:k?n.properties:{},y=E?n.features[t].bbox:k?n.bbox:void 0,w=E?n.features[t].id:k?n.id:void 0,g=p?p.type==="GeometryCollection":!1,c=g?p.geometries.length:1,i=0;i<c;i++){if(h=g?p.geometries[i]:p,h===null){if(e(null,A,v,y,w)===!1)return!1;continue}switch(h.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(h,A,v,y,w)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<h.geometries.length;r++)if(e(h.geometries[r],A,v,y,w)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}A++}}function Xa(n,e,t){var r=t;return Ya(n,function(i,h,c,p,g){h===0&&t===void 0?r=i:r=e(r,i,h,c,p,g)}),r}var Ki=6378137;function $a(n){return Xa(n,function(e,t){return e+eo(t)},0)}function eo(n){var e=0,t;switch(n.type){case"Polygon":return ji(n.coordinates);case"MultiPolygon":for(t=0;t<n.coordinates.length;t++)e+=ji(n.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function ji(n){var e=0;if(n&&n.length>0){e+=Math.abs(Qi(n[0]));for(var t=1;t<n.length;t++)e-=Math.abs(Qi(n[t]))}return e}function Qi(n){var e,t,r,i,h,c,p,g=0,v=n.length;if(v>2){for(p=0;p<v;p++)p===v-2?(i=v-2,h=v-1,c=0):p===v-1?(i=v-1,h=0,c=1):(i=p,h=p+1,c=p+2),e=n[i],t=n[h],r=n[c],g+=(Wr(r[0])-Wr(e[0]))*Math.sin(Wr(t[1]));g=g*Ki*Ki/2}return g}function Wr(n){return n*Math.PI/180}const Yi={supermap:Qa,mapv:Ba,turf:Object.freeze(Object.defineProperty({__proto__:null,area:$a},Symbol.toStringTag,{value:"Module"}))};if(window.ol){let n=function(){ol.proj.addProjection(new ol.proj.Projection({code:"EPSG:4490",extent:[-180,-90,180,90],units:"degrees"})),ol.color={...ol.color,...mi}},e=function(){const t=Yi.supermap;ol.supermap=t,ol.source.TileSuperMapRest=t.TileSuperMapRest,ol.source.DataFlow=t.DataFlow,ol.source.Graphic=t.Graphic,ol.source.Mapv=t.Mapv,ol.Graphic=t.OverlayGraphic};n(),e()}return window.gis={Map2D:q,Service:He,Position:Te,Entity:tr,TrackLine:Ai},J.ArcGisImageServerImageryProvider=Qs,J.ArcGisMapServerImageryProvider=Ys,J.AssociativeArray=$t,J.BaseControl=Dr,J.BillboardGraphics=Ei,J.Camera=br,J.CustomProjection=Js,J.CustomTilingScheme=Zs,J.DeveloperError=_t,J.DrawHandler=Ns,J.DrawType=Qe,J.Entity=tr,J.EntityCollection=Er,J.EventCallback=er,J.EventCollection=wi,J.Events=Qt,J.GeoAnalysis=ws,J.GeographicProjection=xi,J.GeographicTilingScheme=Si,J.Globe=Mi,J.Graphics=rr,J.ImageryLayer=Li,J.ImageryLayerCollection=Pr,J.ImageryProvider=qe,J.LabelGraphics=bi,J.Map2D=q,J.MapProjection=dt,J.MeasureHandler=Hs,J.MeasureType=Tt,J.MousePositionControl=Pa,J.OlExtend=Ss,J.PointGraphics=Pi,J.Popup=Or,J.Position=Te,J.Resource=Ue,J.SDK=Yi,J.ScaleLineControl=ba,J.Scene=Xs,J.ScreenSpaceEventHandler=Ks,J.ScreenSpaceEventType=_e,J.Service=va,J.SuperMapImageryProvider=da,J.TGisService=He,J.TianDiService=Ot,J.TilingScheme=ft,J.TrackLine=Ai,J.TranslateControl=Ca,J.UrlTemplateImageryProvider=fa,J.Viewer=Sa,J.WebFeatureServiceImageryProvider=pa,J.WebMapTileServiceImageryProvider=ga,J.WebMercatorProjection=Ci,J.WebMercatorTilingScheme=js,J.ZoomSliderControl=Ea,J.createGuid=Ye,J.defined=Se,J.getOlVersion=Cr,Object.defineProperties(J,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),J}({},ol.Overlay,ol.util,ol.geom.Geometry,ol.render,ol.source.Vector,ol.layer.Vector,ol.style,ol.Feature,ol.proj.Projection,ol.proj,ol.source.TileImage,ol.format.GeoJSON,ol.size,ol.tilegrid,ol.tilegrid.TileGrid,ol.Map,ol.View,ol.control,ol.control.Control,ol.control.ScaleLine,ol.control.MousePosition,ol.layer.Group,ol.Observable,ol.interaction.Pointer,ol.source.ImageCanvas,ol.style.RegularShape,ol.style.Fill,ol.style.Stroke,ol.Object,ol.geom.Point,ol.style.Style,ol.style.Circle,ol.extent,ol.geom.Polygon,ol.layer.Image);
